/*
    2016 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2016 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}

 @overview

 Phaser - http://phaser.io

 v2.6.2 "Kore Springs" - Built: Fri Aug 26 2016 01:03:09

 By Richard Davey http://www.photonstorm.com @photonstorm

 Phaser is a fun, free and fast 2D game framework for making HTML5 games
 for desktop and mobile web browsers, supporting Canvas and WebGL rendering.

 Phaser uses Pixi.js for rendering, created by Mat Groves http://matgroves.com @Doormat23
 Phaser uses p2.js for full-body physics, created by Stefan Hedman https://github.com/schteppe/p2.js @schteppe
 Phaser contains a port of N+ Physics, converted by Richard Davey, original by http://www.metanetsoftware.com

 Many thanks to Adam Saltsman (@ADAMATOMIC) for releasing Flixel, from which both Phaser and my love of framework development originate.

 Follow development at http://phaser.io and on our forum

 "If you want your children to be intelligent,  read them fairy tales."
 "If you want them to be more intelligent, read them more fairy tales."
                                                     -- Albert Einstein
      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
 Mat Groves, Rovanion Luckey
    2016 Photon Storm Ltd, Richard Davey
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
 © 2012 Timo Hausmann

 Permission is hereby granted, free of charge, to any person obtaining
 a copy of this software and associated documentation files (the
 "Software"), to deal in the Software without restriction, including
 without limitation the rights to use, copy, modify, merge, publish,
 distribute, sublicense, and/or sell copies of the Software, and to
 permit persons to whom the Software is furnished to do so, subject to
 the following conditions:

 The above copyright notice and this permission notice shall be
 included in all copies or substantial portions of the Software.

 THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
*/
(function(){var g=g||{};g.game=null;g.WEBGL_RENDERER=0;g.CANVAS_RENDERER=1;g.VERSION="v2.2.9";g._UID=0;"undefined"!=typeof Float32Array?(g.Float32Array=Float32Array,g.Uint16Array=Uint16Array,g.Uint32Array=Uint32Array,g.ArrayBuffer=ArrayBuffer):(g.Float32Array=Array,g.Uint16Array=Array);g.PI_2=2*Math.PI;g.RAD_TO_DEG=180/Math.PI;g.DEG_TO_RAD=Math.PI/180;g.RETINA_PREFIX="@2x";g.DisplayObject=function(){this.position=new g.Point(0,0);this.scale=new g.Point(1,1);this.pivot=new g.Point(0,0);this.rotation=
0;this.alpha=1;this.visible=!0;this.hitArea=null;this.renderable=!1;this.parent=null;this.worldAlpha=1;this.worldTransform=new g.Matrix;this.worldPosition=new g.Point(0,0);this.worldScale=new g.Point(1,1);this.worldRotation=0;this.filterArea=null;this._sr=0;this._cr=1;this._bounds=new g.Rectangle(0,0,0,0);this._mask=this._currentBounds=null;this._cacheIsDirty=this._cacheAsBitmap=!1};g.DisplayObject.prototype.constructor=g.DisplayObject;g.DisplayObject.prototype={destroy:function(){if(this.children){for(var b=
this.children.length;b--;)this.children[b].destroy();this.children=[]}this.filterArea=this.worldTransform=this.parent=this.hitArea=null;this.renderable=!1;this._mask=this._currentBounds=this._bounds=null;this._destroyCachedSprite()},updateTransform:function(b){if(!b&&!this.parent&&!this.game)return this;var f=this.parent;b?f=b:this.parent||(f=this.game.world);b=f.worldTransform;var h=this.worldTransform;if(this.rotation%g.PI_2){this.rotation!==this.rotationCache&&(this.rotationCache=this.rotation,
this._sr=Math.sin(this.rotation),this._cr=Math.cos(this.rotation));var l=this._cr*this.scale.x;var n=this._sr*this.scale.x;var p=-this._sr*this.scale.y;var a=this._cr*this.scale.y;var c=this.position.x;var d=this.position.y;if(this.pivot.x||this.pivot.y)c-=this.pivot.x*l+this.pivot.y*p,d-=this.pivot.x*n+this.pivot.y*a;h.a=l*b.a+n*b.c;h.b=l*b.b+n*b.d;h.c=p*b.a+a*b.c;h.d=p*b.b+a*b.d}else l=this.scale.x,a=this.scale.y,c=this.position.x-this.pivot.x*l,d=this.position.y-this.pivot.y*a,h.a=l*b.a,h.b=l*
b.b,h.c=a*b.c,h.d=a*b.d;h.tx=c*b.a+d*b.c+b.tx;h.ty=c*b.b+d*b.d+b.ty;this.worldAlpha=this.alpha*f.worldAlpha;this.worldPosition.set(h.tx,h.ty);this.worldScale.set(this.scale.x*Math.sqrt(h.a*h.a+h.c*h.c),this.scale.y*Math.sqrt(h.b*h.b+h.d*h.d));this.worldRotation=Math.atan2(-h.c,h.d);this._currentBounds=null;this.transformCallback&&this.transformCallback.call(this.transformCallbackContext,h,b);return this},preUpdate:function(){},generateTexture:function(b,f,h){var l=this.getLocalBounds();b=new g.RenderTexture(l.width|
0,l.height|0,h,f,b);g.DisplayObject._tempMatrix.tx=-l.x;g.DisplayObject._tempMatrix.ty=-l.y;b.render(this,g.DisplayObject._tempMatrix);return b},updateCache:function(){this._generateCachedSprite();return this},toGlobal:function(b){this.updateTransform();return this.worldTransform.apply(b)},toLocal:function(b,f){f&&(b=f.toGlobal(b));this.updateTransform();return this.worldTransform.applyInverse(b)},_renderCachedSprite:function(b){this._cachedSprite.worldAlpha=this.worldAlpha;b.gl?g.Sprite.prototype._renderWebGL.call(this._cachedSprite,
b):g.Sprite.prototype._renderCanvas.call(this._cachedSprite,b)},_generateCachedSprite:function(){this._cacheAsBitmap=!1;var b=this.getLocalBounds();b.width=Math.max(1,Math.ceil(b.width));b.height=Math.max(1,Math.ceil(b.height));this.updateTransform();if(this._cachedSprite)this._cachedSprite.texture.resize(b.width,b.height);else{var f=new g.RenderTexture(b.width,b.height);this._cachedSprite=new g.Sprite(f);this._cachedSprite.worldTransform=this.worldTransform}f=this._filters;this._filters=null;this._cachedSprite.filters=
f;g.DisplayObject._tempMatrix.tx=-b.x;g.DisplayObject._tempMatrix.ty=-b.y;this._cachedSprite.texture.render(this,g.DisplayObject._tempMatrix,!0);this._cachedSprite.anchor.x=-(b.x/b.width);this._cachedSprite.anchor.y=-(b.y/b.height);this._filters=f;this._cacheAsBitmap=!0},_destroyCachedSprite:function(){this._cachedSprite&&(this._cachedSprite.texture.destroy(!0),this._cachedSprite=null)}};g.DisplayObject.prototype.displayObjectUpdateTransform=g.DisplayObject.prototype.updateTransform;Object.defineProperties(g.DisplayObject.prototype,
{x:{get:function(){return this.position.x},set:function(b){this.position.x=b}},y:{get:function(){return this.position.y},set:function(b){this.position.y=b}},worldVisible:{get:function(){if(this.visible){var b=this.parent;if(b){do{if(!b.visible)return!1;b=b.parent}while(b)}else return this.visible;return!0}return!1}},mask:{get:function(){return this._mask},set:function(b){this._mask&&(this._mask.isMask=!1);if(this._mask=b)this._mask.isMask=!0}},filters:{get:function(){return this._filters},set:function(b){if(Array.isArray(b)){for(var f=
[],h=0;h<b.length;h++)for(var l=b[h].passes,n=0;n<l.length;n++)f.push(l[n]);this._filterBlock={target:this,filterPasses:f}}this._filters=b;this.blendMode&&this.blendMode===g.blendModes.MULTIPLY&&(this.blendMode=g.blendModes.NORMAL)}},cacheAsBitmap:{get:function(){return this._cacheAsBitmap},set:function(b){this._cacheAsBitmap!==b&&(b?this._generateCachedSprite():this._destroyCachedSprite(),this._cacheAsBitmap=b)}}});g.DisplayObjectContainer=function(){g.DisplayObject.call(this);this.children=[];this.ignoreChildInput=
!1};g.DisplayObjectContainer.prototype=Object.create(g.DisplayObject.prototype);g.DisplayObjectContainer.prototype.constructor=g.DisplayObjectContainer;g.DisplayObjectContainer.prototype.addChild=function(b){return this.addChildAt(b,this.children.length)};g.DisplayObjectContainer.prototype.addChildAt=function(b,f){if(0<=f&&f<=this.children.length)return b.parent&&b.parent.removeChild(b),b.parent=this,this.children.splice(f,0,b),b;throw Error(b+"addChildAt: The index "+f+" supplied is out of bounds "+
this.children.length);};g.DisplayObjectContainer.prototype.swapChildren=function(b,f){if(b!==f){var h=this.getChildIndex(b),g=this.getChildIndex(f);if(0>h||0>g)throw Error("swapChildren: Both the supplied DisplayObjects must be a child of the caller.");this.children[h]=f;this.children[g]=b}};g.DisplayObjectContainer.prototype.getChildIndex=function(b){b=this.children.indexOf(b);if(-1===b)throw Error("The supplied DisplayObject must be a child of the caller");return b};g.DisplayObjectContainer.prototype.setChildIndex=
function(b,f){if(0>f||f>=this.children.length)throw Error("The supplied index is out of bounds");var h=this.getChildIndex(b);this.children.splice(h,1);this.children.splice(f,0,b)};g.DisplayObjectContainer.prototype.getChildAt=function(b){if(0>b||b>=this.children.length)throw Error("getChildAt: Supplied index "+b+" does not exist in the child list, or the supplied DisplayObject must be a child of the caller");return this.children[b]};g.DisplayObjectContainer.prototype.removeChild=function(b){b=this.children.indexOf(b);
if(-1!==b)return this.removeChildAt(b)};g.DisplayObjectContainer.prototype.removeChildAt=function(b){var f=this.getChildAt(b);f&&(f.parent=void 0,this.children.splice(b,1));return f};g.DisplayObjectContainer.prototype.removeChildren=function(b,f){void 0===b&&(b=0);void 0===f&&(f=this.children.length);var h=f-b;if(0<h&&h<=f){h=this.children.splice(begin,h);for(var g=0;g<h.length;g++)h[g].parent=void 0;return h}if(0===h&&0===this.children.length)return[];throw Error("removeChildren: Range Error, numeric values are outside the acceptable range");
};g.DisplayObjectContainer.prototype.updateTransform=function(){if(this.visible&&(this.displayObjectUpdateTransform(),!this._cacheAsBitmap))for(var b=0;b<this.children.length;b++)this.children[b].updateTransform()};g.DisplayObjectContainer.prototype.displayObjectContainerUpdateTransform=g.DisplayObjectContainer.prototype.updateTransform;g.DisplayObjectContainer.prototype.getBounds=function(b){var f=b&&b instanceof g.DisplayObject,h=!0;f?h=b instanceof g.DisplayObjectContainer?b.contains(this):!1:
b=this;var l;if(f){var n=b.worldTransform;b.worldTransform=g.identityMatrix;for(l=0;l<b.children.length;l++)b.children[l].updateTransform()}var p=Infinity,a=Infinity,c=-Infinity,d=-Infinity,e=!1;for(l=0;l<this.children.length;l++)if(this.children[l].visible){e=!0;var k=this.children[l].getBounds();p=p<k.x?p:k.x;a=a<k.y?a:k.y;var m=k.width+k.x;k=k.height+k.y;c=c>m?c:m;d=d>k?d:k}m=this._bounds;if(!e){m=new g.Rectangle;var u=m.x;c=m.width+m.x;d=m.y;e=m.height+m.y;l=this.worldTransform;var v=l.a,z=l.b,
t=l.c,w=l.d,q=l.tx,r=l.ty;p=v*c+t*e+q;a=w*e+z*c+r;l=v*u+t*e+q;e=w*e+z*u+r;k=v*u+t*d+q;u=w*d+z*u+r;v=v*c+t*d+q;z=w*d+z*c+r;c=p;d=a;p=l<p?l:p;p=k<p?k:p;p=v<p?v:p;a=e<a?e:a;a=u<a?u:a;a=z<a?z:a;c=l>c?l:c;c=k>c?k:c;c=v>c?v:c;d=e>d?e:d;d=u>d?u:d;d=z>d?z:d}m.x=p;m.y=a;m.width=c-p;m.height=d-a;if(f)for(b.worldTransform=n,l=0;l<b.children.length;l++)b.children[l].updateTransform();h||(b=b.getBounds(),m.x-=b.x,m.y-=b.y);return m};g.DisplayObjectContainer.prototype.getLocalBounds=function(){return this.getBounds(this)};
g.DisplayObjectContainer.prototype.contains=function(b){return b?b===this?!0:this.contains(b.parent):!1};g.DisplayObjectContainer.prototype._renderWebGL=function(b){if(this.visible&&!(0>=this.alpha))if(this._cacheAsBitmap)this._renderCachedSprite(b);else{var f;if(this._mask||this._filters){this._filters&&(b.spriteBatch.flush(),b.filterManager.pushFilter(this._filterBlock));this._mask&&(b.spriteBatch.stop(),b.maskManager.pushMask(this.mask,b),b.spriteBatch.start());for(f=0;f<this.children.length;f++)this.children[f]._renderWebGL(b);
b.spriteBatch.stop();this._mask&&b.maskManager.popMask(this._mask,b);this._filters&&b.filterManager.popFilter();b.spriteBatch.start()}else for(f=0;f<this.children.length;f++)this.children[f]._renderWebGL(b)}};g.DisplayObjectContainer.prototype._renderCanvas=function(b){if(!1!==this.visible&&0!==this.alpha)if(this._cacheAsBitmap)this._renderCachedSprite(b);else{this._mask&&b.maskManager.pushMask(this._mask,b);for(var f=0;f<this.children.length;f++)this.children[f]._renderCanvas(b);this._mask&&b.maskManager.popMask(b)}};
Object.defineProperty(g.DisplayObjectContainer.prototype,"width",{get:function(){return this.getLocalBounds().width*this.scale.x},set:function(b){var f=this.getLocalBounds().width;this.scale.x=0!==f?b/f:1;this._width=b}});Object.defineProperty(g.DisplayObjectContainer.prototype,"height",{get:function(){return this.getLocalBounds().height*this.scale.y},set:function(b){var f=this.getLocalBounds().height;this.scale.y=0!==f?b/f:1;this._height=b}});g.Sprite=function(b){g.DisplayObjectContainer.call(this);
this.anchor=new g.Point;this.texture=b||g.Texture.emptyTexture;this._height=this._width=0;this.tint=16777215;this.cachedTint=-1;this.tintedTexture=null;this.blendMode=g.blendModes.NORMAL;this.shader=null;this.exists=!0;if(this.texture.baseTexture.hasLoaded)this.onTextureUpdate();this.renderable=!0};g.Sprite.prototype=Object.create(g.DisplayObjectContainer.prototype);g.Sprite.prototype.constructor=g.Sprite;Object.defineProperty(g.Sprite.prototype,"width",{get:function(){return this.scale.x*this.texture.frame.width},
set:function(b){this.scale.x=b/this.texture.frame.width;this._width=b}});Object.defineProperty(g.Sprite.prototype,"height",{get:function(){return this.scale.y*this.texture.frame.height},set:function(b){this.scale.y=b/this.texture.frame.height;this._height=b}});g.Sprite.prototype.setTexture=function(b,f){void 0!==f&&this.texture.baseTexture.destroy();this.texture.baseTexture.skipRender=!1;this.texture=b;this.texture.valid=!0;this.cachedTint=-1};g.Sprite.prototype.onTextureUpdate=function(){this._width&&
(this.scale.x=this._width/this.texture.frame.width);this._height&&(this.scale.y=this._height/this.texture.frame.height)};g.Sprite.prototype.getBounds=function(b){var f=this.texture.frame.width,h=this.texture.frame.height,g=f*(1-this.anchor.x);f*=-this.anchor.x;var n=h*(1-this.anchor.y),p=h*-this.anchor.y;h=b||this.worldTransform;var a=h.a,c=h.b,d=h.c;b=h.d;var e=h.tx,k=h.ty,m=h=-Infinity,u=Infinity,v=Infinity;if(0===c&&0===d)0>a&&(a*=-1,h=g,g=-f,f=-h),0>b&&(b*=-1,h=n,n=-p,p=-h),u=a*f+e,h=a*g+e,v=
b*p+k,m=b*n+k;else{var z=a*f+d*p+e,t=b*p+c*f+k,w=a*g+d*p+e;p=b*p+c*g+k;var q=a*g+d*n+e;g=b*n+c*g+k;a=a*f+d*n+e;f=b*n+c*f+k;u=z<u?z:u;u=w<u?w:u;u=q<u?q:u;u=a<u?a:u;v=t<v?t:v;v=p<v?p:v;v=g<v?g:v;v=f<v?f:v;h=z>h?z:h;h=w>h?w:h;h=q>h?q:h;h=a>h?a:h;m=t>m?t:m;m=p>m?p:m;m=g>m?g:m;m=f>m?f:m}f=this._bounds;f.x=u;f.width=h-u;f.y=v;f.height=m-v;return this._currentBounds=f};g.Sprite.prototype.getLocalBounds=function(){var b=this.worldTransform;this.worldTransform=g.identityMatrix;for(var f=0;f<this.children.length;f++)this.children[f].updateTransform();
var h=this.getBounds();this.worldTransform=b;for(f=0;f<this.children.length;f++)this.children[f].updateTransform();return h};g.Sprite.prototype._renderWebGL=function(b,f){if(this.visible&&!(0>=this.alpha)&&this.renderable){var h=this.worldTransform;f&&(h=f);if(this._mask||this._filters){h=b.spriteBatch;this._filters&&(h.flush(),b.filterManager.pushFilter(this._filterBlock));this._mask&&(h.stop(),b.maskManager.pushMask(this.mask,b),h.start());h.render(this);for(var g=0;g<this.children.length;g++)this.children[g]._renderWebGL(b);
h.stop();this._mask&&b.maskManager.popMask(this._mask,b);this._filters&&b.filterManager.popFilter();h.start()}else for(b.spriteBatch.render(this),g=0;g<this.children.length;g++)this.children[g]._renderWebGL(b,h)}};g.Sprite.prototype._renderCanvas=function(b,f){if(!(!this.visible||0===this.alpha||!this.renderable||0>=this.texture.crop.width||0>=this.texture.crop.height)){var h=this.worldTransform;f&&(h=f);this.blendMode!==b.currentBlendMode&&(b.currentBlendMode=this.blendMode,b.context.globalCompositeOperation=
g.blendModesCanvas[b.currentBlendMode]);this._mask&&b.maskManager.pushMask(this._mask,b);if(this.texture.valid){var l=this.texture.baseTexture.resolution/b.resolution;b.context.globalAlpha=this.worldAlpha;b.smoothProperty&&b.scaleMode!==this.texture.baseTexture.scaleMode&&(b.scaleMode=this.texture.baseTexture.scaleMode,b.context[b.smoothProperty]=b.scaleMode===g.scaleModes.LINEAR);var n=this.texture.trim?this.texture.trim.x-this.anchor.x*this.texture.trim.width:this.anchor.x*-this.texture.frame.width,
p=this.texture.trim?this.texture.trim.y-this.anchor.y*this.texture.trim.height:this.anchor.y*-this.texture.frame.height,a=h.tx*b.resolution+b.shakeX,c=h.ty*b.resolution+b.shakeY;b.roundPixels?(b.context.setTransform(h.a,h.b,h.c,h.d,a|0,c|0),n|=0,p|=0):b.context.setTransform(h.a,h.b,h.c,h.d,a,c);h=this.texture.crop.width;a=this.texture.crop.height;n/=l;p/=l;if(16777215!==this.tint){if(this.texture.requiresReTint||this.cachedTint!==this.tint)this.tintedTexture=g.CanvasTinter.getTintedTexture(this,this.tint),
this.cachedTint=this.tint,this.texture.requiresReTint=!1;b.context.drawImage(this.tintedTexture,0,0,h,a,n,p,h/l,a/l)}else b.context.drawImage(this.texture.baseTexture.source,this.texture.crop.x,this.texture.crop.y,h,a,n,p,h/l,a/l)}for(l=0;l<this.children.length;l++)this.children[l]._renderCanvas(b);this._mask&&b.maskManager.popMask(b)}};g.SpriteBatch=function(b){g.DisplayObjectContainer.call(this);this.textureThing=b;this.ready=!1};g.SpriteBatch.prototype=Object.create(g.DisplayObjectContainer.prototype);
g.SpriteBatch.prototype.constructor=g.SpriteBatch;g.SpriteBatch.prototype.initWebGL=function(b){this.fastSpriteBatch=new g.WebGLFastSpriteBatch(b);this.ready=!0};g.SpriteBatch.prototype.updateTransform=function(){this.displayObjectUpdateTransform()};g.SpriteBatch.prototype._renderWebGL=function(b){!this.visible||0>=this.alpha||!this.children.length||(this.ready||this.initWebGL(b.gl),this.fastSpriteBatch.gl!==b.gl&&this.fastSpriteBatch.setContext(b.gl),b.spriteBatch.stop(),b.shaderManager.setShader(b.shaderManager.fastShader),
this.fastSpriteBatch.begin(this,b),this.fastSpriteBatch.render(this),b.spriteBatch.start())};g.SpriteBatch.prototype._renderCanvas=function(b){if(this.visible&&!(0>=this.alpha)&&this.children.length){var f=b.context;f.globalAlpha=this.worldAlpha;this.displayObjectUpdateTransform();for(var h=this.worldTransform,g=!0,n=0;n<this.children.length;n++){var p=this.children[n];if(p.visible){var a=p.texture,c=a.frame;f.globalAlpha=this.worldAlpha*p.alpha;if(0===p.rotation%(2*Math.PI))g&&(f.setTransform(h.a,
h.b,h.c,h.d,h.tx,h.ty),g=!1),f.drawImage(a.baseTexture.source,c.x,c.y,c.width,c.height,p.anchor.x*-c.width*p.scale.x+p.position.x+.5+b.shakeX|0,p.anchor.y*-c.height*p.scale.y+p.position.y+.5+b.shakeY|0,c.width*p.scale.x,c.height*p.scale.y);else{g||(g=!0);p.displayObjectUpdateTransform();var d=p.worldTransform,e=d.tx*b.resolution+b.shakeX,k=d.ty*b.resolution+b.shakeY;b.roundPixels?f.setTransform(d.a,d.b,d.c,d.d,e|0,k|0):f.setTransform(d.a,d.b,d.c,d.d,e,k);f.drawImage(a.baseTexture.source,c.x,c.y,c.width,
c.height,p.anchor.x*-c.width+.5|0,p.anchor.y*-c.height+.5|0,c.width,c.height)}}}}};g.hex2rgb=function(b){return[(b>>16&255)/255,(b>>8&255)/255,(b&255)/255]};g.rgb2hex=function(b){return(255*b[0]<<16)+(255*b[1]<<8)+255*b[2]};g.canUseNewCanvasBlendModes=function(){if(void 0===document)return!1;var b=new Image;b.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAABAQMAAADD8p2OAAAAA1BMVEX/AP804Oa6AAAACklEQVQI12NgAAAAAgAB4iG8MwAAAABJRU5ErkJggg==";var f=new Image;f.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAABAQMAAADD8p2OAAAAA1BMVEX//wCKxvRFAAAACklEQVQI12NgAAAAAgAB4iG8MwAAAABJRU5ErkJggg==";
var h=g.CanvasPool.create(this,6,1).getContext("2d");h.globalCompositeOperation="multiply";h.drawImage(b,0,0);h.drawImage(f,2,0);if(!h.getImageData(2,0,1,1))return!1;b=h.getImageData(2,0,1,1).data;g.CanvasPool.remove(this);return 255===b[0]&&0===b[1]&&0===b[2]};g.getNextPowerOfTwo=function(b){if(0<b&&0===(b&b-1))return b;for(var f=1;f<b;)f<<=1;return f};g.isPowerOfTwo=function(b,f){return 0<b&&0===(b&b-1)&&0<f&&0===(f&f-1)};g.CanvasPool={create:function(b,f,h){var l=g.CanvasPool.getFirst();-1===l?
(b={parent:b,canvas:document.createElement("canvas")},g.CanvasPool.pool.push(b),b=b.canvas):(g.CanvasPool.pool[l].parent=b,b=g.CanvasPool.pool[l].canvas);void 0!==f&&(b.width=f,b.height=h);return b},getFirst:function(){for(var b=g.CanvasPool.pool,f=0;f<b.length;f++)if(!b[f].parent)return f;return-1},remove:function(b){for(var f=g.CanvasPool.pool,h=0;h<f.length;h++)f[h].parent===b&&(f[h].parent=null,f[h].canvas.width=1,f[h].canvas.height=1)},removeByCanvas:function(b){for(var f=g.CanvasPool.pool,h=
0;h<f.length;h++)f[h].canvas===b&&(f[h].parent=null,f[h].canvas.width=1,f[h].canvas.height=1)},getTotal:function(){for(var b=g.CanvasPool.pool,f=0,h=0;h<b.length;h++)b[h].parent&&f++;return f},getFree:function(){for(var b=g.CanvasPool.pool,f=0,h=0;h<b.length;h++)b[h].parent||f++;return f}};g.CanvasPool.pool=[];g.initDefaultShaders=function(){};g.CompileVertexShader=function(b,f){return g._CompileShader(b,f,b.VERTEX_SHADER)};g.CompileFragmentShader=function(b,f){return g._CompileShader(b,f,b.FRAGMENT_SHADER)};
g._CompileShader=function(b,f,h){var g=f;Array.isArray(f)&&(g=f.join("\n"));f=b.createShader(h);b.shaderSource(f,g);b.compileShader(f);return b.getShaderParameter(f,b.COMPILE_STATUS)?f:(window.console.log(b.getShaderInfoLog(f)),null)};g.compileProgram=function(b,f,h){h=g.CompileFragmentShader(b,h);f=g.CompileVertexShader(b,f);var l=b.createProgram();b.attachShader(l,f);b.attachShader(l,h);b.linkProgram(l);b.getProgramParameter(l,b.LINK_STATUS)||(window.console.log(b.getProgramInfoLog(l)),window.console.log("Could not initialise shaders"));
return l};g.PixiShader=function(b){this._UID=g._UID++;this.gl=b;this.program=null;this.fragmentSrc=["precision lowp float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord) * vColor ;","}"];this.textureCount=0;this.dirty=this.firstRun=!0;this.attributes=[];this.init()};g.PixiShader.prototype.constructor=g.PixiShader;g.PixiShader.prototype.init=function(){var b=this.gl,f=g.compileProgram(b,this.vertexSrc||
g.PixiShader.defaultVertexSrc,this.fragmentSrc);b.useProgram(f);this.uSampler=b.getUniformLocation(f,"uSampler");this.projectionVector=b.getUniformLocation(f,"projectionVector");this.offsetVector=b.getUniformLocation(f,"offsetVector");this.dimensions=b.getUniformLocation(f,"dimensions");this.aVertexPosition=b.getAttribLocation(f,"aVertexPosition");this.aTextureCoord=b.getAttribLocation(f,"aTextureCoord");this.colorAttribute=b.getAttribLocation(f,"aColor");-1===this.colorAttribute&&(this.colorAttribute=
2);this.attributes=[this.aVertexPosition,this.aTextureCoord,this.colorAttribute];for(var h in this.uniforms)this.uniforms[h].uniformLocation=b.getUniformLocation(f,h);this.initUniforms();this.program=f};g.PixiShader.prototype.initUniforms=function(){this.textureCount=1;var b=this.gl,f;for(f in this.uniforms){var h=this.uniforms[f];var g=h.type;"sampler2D"===g?(h._init=!1,null!==h.value&&this.initSampler2D(h)):"mat2"===g||"mat3"===g||"mat4"===g?(h.glMatrix=!0,h.glValueLength=1,"mat2"===g?h.glFunc=
b.uniformMatrix2fv:"mat3"===g?h.glFunc=b.uniformMatrix3fv:"mat4"===g&&(h.glFunc=b.uniformMatrix4fv)):(h.glFunc=b["uniform"+g],h.glValueLength="2f"===g||"2i"===g?2:"3f"===g||"3i"===g?3:"4f"===g||"4i"===g?4:1)}};g.PixiShader.prototype.initSampler2D=function(b){if(b.value&&b.value.baseTexture&&b.value.baseTexture.hasLoaded){var f=this.gl;f.activeTexture(f["TEXTURE"+this.textureCount]);f.bindTexture(f.TEXTURE_2D,b.value.baseTexture._glTextures[f.id]);if(b.textureData){var h=b.textureData,g=h.magFilter?
h.magFilter:f.LINEAR,n=h.minFilter?h.minFilter:f.LINEAR,p=h.wrapS?h.wrapS:f.CLAMP_TO_EDGE,a=h.wrapT?h.wrapT:f.CLAMP_TO_EDGE,c=h.luminance?f.LUMINANCE:f.RGBA;h.repeat&&(a=p=f.REPEAT);f.pixelStorei(f.UNPACK_FLIP_Y_WEBGL,!!h.flipY);h.width?f.texImage2D(f.TEXTURE_2D,0,c,h.width?h.width:512,h.height?h.height:2,h.border?h.border:0,c,f.UNSIGNED_BYTE,null):f.texImage2D(f.TEXTURE_2D,0,c,f.RGBA,f.UNSIGNED_BYTE,b.value.baseTexture.source);f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,g);f.texParameteri(f.TEXTURE_2D,
f.TEXTURE_MIN_FILTER,n);f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,p);f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,a)}f.uniform1i(b.uniformLocation,this.textureCount);b._init=!0;this.textureCount++}};g.PixiShader.prototype.syncUniforms=function(){this.textureCount=1;var b=this.gl,f;for(f in this.uniforms){var h=this.uniforms[f];1===h.glValueLength?!0===h.glMatrix?h.glFunc.call(b,h.uniformLocation,h.transpose,h.value):h.glFunc.call(b,h.uniformLocation,h.value):2===h.glValueLength?h.glFunc.call(b,
h.uniformLocation,h.value.x,h.value.y):3===h.glValueLength?h.glFunc.call(b,h.uniformLocation,h.value.x,h.value.y,h.value.z):4===h.glValueLength?h.glFunc.call(b,h.uniformLocation,h.value.x,h.value.y,h.value.z,h.value.w):"sampler2D"===h.type&&(h._init?(b.activeTexture(b["TEXTURE"+this.textureCount]),h.value.baseTexture._dirty[b.id]?g.instances[b.id].updateTexture(h.value.baseTexture):b.bindTexture(b.TEXTURE_2D,h.value.baseTexture._glTextures[b.id]),b.uniform1i(h.uniformLocation,this.textureCount),this.textureCount++):
this.initSampler2D(h))}};g.PixiShader.prototype.destroy=function(){this.gl.deleteProgram(this.program);this.attributes=this.gl=this.uniforms=null};g.PixiShader.defaultVertexSrc=["attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","attribute vec4 aColor;","uniform vec2 projectionVector;","uniform vec2 offsetVector;","varying vec2 vTextureCoord;","varying vec4 vColor;","const vec2 center = vec2(-1.0, 1.0);","void main(void) {","   gl_Position = vec4( ((aVertexPosition + offsetVector) / projectionVector) + center , 0.0, 1.0);",
"   vTextureCoord = aTextureCoord;","   vColor = vec4(aColor.rgb * aColor.a, aColor.a);","}"];g.PixiFastShader=function(b){this._UID=g._UID++;this.gl=b;this.program=null;this.fragmentSrc=["precision lowp float;","varying vec2 vTextureCoord;","varying float vColor;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord) * vColor ;","}"];this.vertexSrc=["attribute vec2 aVertexPosition;","attribute vec2 aPositionCoord;","attribute vec2 aScale;","attribute float aRotation;",
"attribute vec2 aTextureCoord;","attribute float aColor;","uniform vec2 projectionVector;","uniform vec2 offsetVector;","uniform mat3 uMatrix;","varying vec2 vTextureCoord;","varying float vColor;","const vec2 center = vec2(-1.0, 1.0);","void main(void) {","   vec2 v;","   vec2 sv = aVertexPosition * aScale;","   v.x = (sv.x) * cos(aRotation) - (sv.y) * sin(aRotation);","   v.y = (sv.x) * sin(aRotation) + (sv.y) * cos(aRotation);","   v = ( uMatrix * vec3(v + aPositionCoord , 1.0) ).xy ;","   gl_Position = vec4( ( v / projectionVector) + center , 0.0, 1.0);",
"   vTextureCoord = aTextureCoord;","   vColor = aColor;","}"];this.textureCount=0;this.init()};g.PixiFastShader.prototype.constructor=g.PixiFastShader;g.PixiFastShader.prototype.init=function(){var b=this.gl,f=g.compileProgram(b,this.vertexSrc,this.fragmentSrc);b.useProgram(f);this.uSampler=b.getUniformLocation(f,"uSampler");this.projectionVector=b.getUniformLocation(f,"projectionVector");this.offsetVector=b.getUniformLocation(f,"offsetVector");this.dimensions=b.getUniformLocation(f,"dimensions");
this.uMatrix=b.getUniformLocation(f,"uMatrix");this.aVertexPosition=b.getAttribLocation(f,"aVertexPosition");this.aPositionCoord=b.getAttribLocation(f,"aPositionCoord");this.aScale=b.getAttribLocation(f,"aScale");this.aRotation=b.getAttribLocation(f,"aRotation");this.aTextureCoord=b.getAttribLocation(f,"aTextureCoord");this.colorAttribute=b.getAttribLocation(f,"aColor");-1===this.colorAttribute&&(this.colorAttribute=2);this.attributes=[this.aVertexPosition,this.aPositionCoord,this.aScale,this.aRotation,
this.aTextureCoord,this.colorAttribute];this.program=f};g.PixiFastShader.prototype.destroy=function(){this.gl.deleteProgram(this.program);this.attributes=this.gl=this.uniforms=null};g.StripShader=function(b){this._UID=g._UID++;this.gl=b;this.program=null;this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","uniform float alpha;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor = texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y)) * alpha;","}"];this.vertexSrc=
["attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","uniform mat3 translationMatrix;","uniform vec2 projectionVector;","uniform vec2 offsetVector;","varying vec2 vTextureCoord;","void main(void) {","   vec3 v = translationMatrix * vec3(aVertexPosition , 1.0);","   v -= offsetVector.xyx;","   gl_Position = vec4( v.x / projectionVector.x -1.0, v.y / -projectionVector.y + 1.0 , 0.0, 1.0);","   vTextureCoord = aTextureCoord;","}"];this.init()};g.StripShader.prototype.constructor=g.StripShader;
g.StripShader.prototype.init=function(){var b=this.gl,f=g.compileProgram(b,this.vertexSrc,this.fragmentSrc);b.useProgram(f);this.uSampler=b.getUniformLocation(f,"uSampler");this.projectionVector=b.getUniformLocation(f,"projectionVector");this.offsetVector=b.getUniformLocation(f,"offsetVector");this.colorAttribute=b.getAttribLocation(f,"aColor");this.aVertexPosition=b.getAttribLocation(f,"aVertexPosition");this.aTextureCoord=b.getAttribLocation(f,"aTextureCoord");this.attributes=[this.aVertexPosition,
this.aTextureCoord];this.translationMatrix=b.getUniformLocation(f,"translationMatrix");this.alpha=b.getUniformLocation(f,"alpha");this.program=f};g.StripShader.prototype.destroy=function(){this.gl.deleteProgram(this.program);this.attribute=this.gl=this.uniforms=null};g.PrimitiveShader=function(b){this._UID=g._UID++;this.gl=b;this.program=null;this.fragmentSrc=["precision mediump float;","varying vec4 vColor;","void main(void) {","   gl_FragColor = vColor;","}"];this.vertexSrc=["attribute vec2 aVertexPosition;",
"attribute vec4 aColor;","uniform mat3 translationMatrix;","uniform vec2 projectionVector;","uniform vec2 offsetVector;","uniform float alpha;","uniform float flipY;","uniform vec3 tint;","varying vec4 vColor;","void main(void) {","   vec3 v = translationMatrix * vec3(aVertexPosition , 1.0);","   v -= offsetVector.xyx;","   gl_Position = vec4( v.x / projectionVector.x -1.0, (v.y / projectionVector.y * -flipY) + flipY , 0.0, 1.0);","   vColor = aColor * vec4(tint * alpha, alpha);","}"];this.init()};
g.PrimitiveShader.prototype.constructor=g.PrimitiveShader;g.PrimitiveShader.prototype.init=function(){var b=this.gl,f=g.compileProgram(b,this.vertexSrc,this.fragmentSrc);b.useProgram(f);this.projectionVector=b.getUniformLocation(f,"projectionVector");this.offsetVector=b.getUniformLocation(f,"offsetVector");this.tintColor=b.getUniformLocation(f,"tint");this.flipY=b.getUniformLocation(f,"flipY");this.aVertexPosition=b.getAttribLocation(f,"aVertexPosition");this.colorAttribute=b.getAttribLocation(f,
"aColor");this.attributes=[this.aVertexPosition,this.colorAttribute];this.translationMatrix=b.getUniformLocation(f,"translationMatrix");this.alpha=b.getUniformLocation(f,"alpha");this.program=f};g.PrimitiveShader.prototype.destroy=function(){this.gl.deleteProgram(this.program);this.attributes=this.gl=this.uniforms=null};g.ComplexPrimitiveShader=function(b){this._UID=g._UID++;this.gl=b;this.program=null;this.fragmentSrc=["precision mediump float;","varying vec4 vColor;","void main(void) {","   gl_FragColor = vColor;",
"}"];this.vertexSrc=["attribute vec2 aVertexPosition;","uniform mat3 translationMatrix;","uniform vec2 projectionVector;","uniform vec2 offsetVector;","uniform vec3 tint;","uniform float alpha;","uniform vec3 color;","uniform float flipY;","varying vec4 vColor;","void main(void) {","   vec3 v = translationMatrix * vec3(aVertexPosition , 1.0);","   v -= offsetVector.xyx;","   gl_Position = vec4( v.x / projectionVector.x -1.0, (v.y / projectionVector.y * -flipY) + flipY , 0.0, 1.0);","   vColor = vec4(color * alpha * tint, alpha);",
"}"];this.init()};g.ComplexPrimitiveShader.prototype.constructor=g.ComplexPrimitiveShader;g.ComplexPrimitiveShader.prototype.init=function(){var b=this.gl,f=g.compileProgram(b,this.vertexSrc,this.fragmentSrc);b.useProgram(f);this.projectionVector=b.getUniformLocation(f,"projectionVector");this.offsetVector=b.getUniformLocation(f,"offsetVector");this.tintColor=b.getUniformLocation(f,"tint");this.color=b.getUniformLocation(f,"color");this.flipY=b.getUniformLocation(f,"flipY");this.aVertexPosition=b.getAttribLocation(f,
"aVertexPosition");this.attributes=[this.aVertexPosition,this.colorAttribute];this.translationMatrix=b.getUniformLocation(f,"translationMatrix");this.alpha=b.getUniformLocation(f,"alpha");this.program=f};g.ComplexPrimitiveShader.prototype.destroy=function(){this.gl.deleteProgram(this.program);this.attribute=this.gl=this.uniforms=null};g.glContexts=[];g.instances=[];g.WebGLRenderer=function(b){this.game=b;g.defaultRenderer||(g.defaultRenderer=this);this.type=g.WEBGL_RENDERER;this.resolution=b.resolution;
this.transparent=b.transparent;this.autoResize=!1;this.preserveDrawingBuffer=b.preserveDrawingBuffer;this.clearBeforeRender=b.clearBeforeRender;this.width=b.width;this.height=b.height;this.view=b.canvas;this._contextOptions={alpha:this.transparent,antialias:b.antialias,premultipliedAlpha:this.transparent&&"notMultiplied"!==this.transparent,stencil:!0,preserveDrawingBuffer:this.preserveDrawingBuffer};this.projection=new g.Point;this.offset=new g.Point;this.shaderManager=new g.WebGLShaderManager;this.spriteBatch=
new g.WebGLSpriteBatch;this.maskManager=new g.WebGLMaskManager;this.filterManager=new g.WebGLFilterManager;this.stencilManager=new g.WebGLStencilManager;this.blendModeManager=new g.WebGLBlendModeManager;this.renderSession={};this.renderSession.game=this.game;this.renderSession.gl=this.gl;this.renderSession.drawCount=0;this.renderSession.shaderManager=this.shaderManager;this.renderSession.maskManager=this.maskManager;this.renderSession.filterManager=this.filterManager;this.renderSession.blendModeManager=
this.blendModeManager;this.renderSession.spriteBatch=this.spriteBatch;this.renderSession.stencilManager=this.stencilManager;this.renderSession.renderer=this;this.renderSession.resolution=this.resolution;this.initContext();this.mapBlendModes()};g.WebGLRenderer.prototype.constructor=g.WebGLRenderer;g.WebGLRenderer.prototype.initContext=function(){var b=this.view.getContext("webgl",this._contextOptions)||this.view.getContext("experimental-webgl",this._contextOptions);this.gl=b;if(!b)throw Error("This browser does not support webGL. Try using the canvas renderer");
this.glContextId=b.id=g.WebGLRenderer.glContextId++;g.glContexts[this.glContextId]=b;g.instances[this.glContextId]=this;b.disable(b.DEPTH_TEST);b.disable(b.CULL_FACE);b.enable(b.BLEND);this.shaderManager.setContext(b);this.spriteBatch.setContext(b);this.maskManager.setContext(b);this.filterManager.setContext(b);this.blendModeManager.setContext(b);this.stencilManager.setContext(b);this.renderSession.gl=this.gl;this.resize(this.width,this.height)};g.WebGLRenderer.prototype.render=function(b){if(!this.contextLost){var f=
this.gl;f.viewport(0,0,this.width,this.height);f.bindFramebuffer(f.FRAMEBUFFER,null);this.game.clearBeforeRender&&(f.clearColor(b._bgColor.r,b._bgColor.g,b._bgColor.b,b._bgColor.a),f.clear(f.COLOR_BUFFER_BIT));this.offset.x=this.game.camera._shake.x;this.offset.y=this.game.camera._shake.y;this.renderDisplayObject(b,this.projection)}};g.WebGLRenderer.prototype.renderDisplayObject=function(b,f,h,l){this.renderSession.blendModeManager.setBlendMode(g.blendModes.NORMAL);this.renderSession.drawCount=0;
this.renderSession.flipY=h?-1:1;this.renderSession.projection=f;this.renderSession.offset=this.offset;this.spriteBatch.begin(this.renderSession);this.filterManager.begin(this.renderSession,h);b._renderWebGL(this.renderSession,l);this.spriteBatch.end()};g.WebGLRenderer.prototype.resize=function(b,f){this.width=b*this.resolution;this.height=f*this.resolution;this.view.width=this.width;this.view.height=this.height;this.autoResize&&(this.view.style.width=this.width/this.resolution+"px",this.view.style.height=
this.height/this.resolution+"px");this.gl.viewport(0,0,this.width,this.height);this.projection.x=this.width/2/this.resolution;this.projection.y=-this.height/2/this.resolution};g.WebGLRenderer.prototype.updateTexture=function(b){if(!b.hasLoaded)return!1;var f=this.gl;b._glTextures[f.id]||(b._glTextures[f.id]=f.createTexture());f.bindTexture(f.TEXTURE_2D,b._glTextures[f.id]);f.pixelStorei(f.UNPACK_PREMULTIPLY_ALPHA_WEBGL,b.premultipliedAlpha);f.texImage2D(f.TEXTURE_2D,0,f.RGBA,f.RGBA,f.UNSIGNED_BYTE,
b.source);f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,b.scaleMode===g.scaleModes.LINEAR?f.LINEAR:f.NEAREST);b.mipmap&&g.isPowerOfTwo(b.width,b.height)?(f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,b.scaleMode===g.scaleModes.LINEAR?f.LINEAR_MIPMAP_LINEAR:f.NEAREST_MIPMAP_NEAREST),f.generateMipmap(f.TEXTURE_2D)):f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,b.scaleMode===g.scaleModes.LINEAR?f.LINEAR:f.NEAREST);b._powerOf2?(f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,f.REPEAT),f.texParameteri(f.TEXTURE_2D,
f.TEXTURE_WRAP_T,f.REPEAT)):(f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,f.CLAMP_TO_EDGE),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,f.CLAMP_TO_EDGE));b._dirty[f.id]=!1;return!0};g.WebGLRenderer.prototype.destroy=function(){this.offset=this.projection=g.glContexts[this.glContextId]=null;this.shaderManager.destroy();this.spriteBatch.destroy();this.maskManager.destroy();this.filterManager.destroy();this.renderSession=this.gl=this.filterManager=this.maskManager=this.spriteBatch=this.shaderManager=
null;g.CanvasPool.remove(this);g.instances[this.glContextId]=null;g.WebGLRenderer.glContextId--};g.WebGLRenderer.prototype.mapBlendModes=function(){var b=this.gl;if(!g.blendModesWebGL){var f=[],h=g.blendModes;f[h.NORMAL]=[b.ONE,b.ONE_MINUS_SRC_ALPHA];f[h.ADD]=[b.SRC_ALPHA,b.DST_ALPHA];f[h.MULTIPLY]=[b.DST_COLOR,b.ONE_MINUS_SRC_ALPHA];f[h.SCREEN]=[b.SRC_ALPHA,b.ONE];f[h.OVERLAY]=[b.ONE,b.ONE_MINUS_SRC_ALPHA];f[h.DARKEN]=[b.ONE,b.ONE_MINUS_SRC_ALPHA];f[h.LIGHTEN]=[b.ONE,b.ONE_MINUS_SRC_ALPHA];f[h.COLOR_DODGE]=
[b.ONE,b.ONE_MINUS_SRC_ALPHA];f[h.COLOR_BURN]=[b.ONE,b.ONE_MINUS_SRC_ALPHA];f[h.HARD_LIGHT]=[b.ONE,b.ONE_MINUS_SRC_ALPHA];f[h.SOFT_LIGHT]=[b.ONE,b.ONE_MINUS_SRC_ALPHA];f[h.DIFFERENCE]=[b.ONE,b.ONE_MINUS_SRC_ALPHA];f[h.EXCLUSION]=[b.ONE,b.ONE_MINUS_SRC_ALPHA];f[h.HUE]=[b.ONE,b.ONE_MINUS_SRC_ALPHA];f[h.SATURATION]=[b.ONE,b.ONE_MINUS_SRC_ALPHA];f[h.COLOR]=[b.ONE,b.ONE_MINUS_SRC_ALPHA];f[h.LUMINOSITY]=[b.ONE,b.ONE_MINUS_SRC_ALPHA];g.blendModesWebGL=f}};g.WebGLRenderer.glContextId=0;g.WebGLBlendModeManager=
function(){this.currentBlendMode=99999};g.WebGLBlendModeManager.prototype.constructor=g.WebGLBlendModeManager;g.WebGLBlendModeManager.prototype.setContext=function(b){this.gl=b};g.WebGLBlendModeManager.prototype.setBlendMode=function(b){if(this.currentBlendMode===b)return!1;this.currentBlendMode=b;(b=g.blendModesWebGL[this.currentBlendMode])&&this.gl.blendFunc(b[0],b[1]);return!0};g.WebGLBlendModeManager.prototype.destroy=function(){this.gl=null};g.WebGLMaskManager=function(){};g.WebGLMaskManager.prototype.constructor=
g.WebGLMaskManager;g.WebGLMaskManager.prototype.setContext=function(b){this.gl=b};g.WebGLMaskManager.prototype.pushMask=function(b,f){var h=f.gl;b.dirty&&g.WebGLGraphics.updateGraphics(b,h);void 0!==b._webGL[h.id]&&void 0!==b._webGL[h.id].data&&0!==b._webGL[h.id].data.length&&f.stencilManager.pushStencil(b,b._webGL[h.id].data[0],f)};g.WebGLMaskManager.prototype.popMask=function(b,f){var g=this.gl;void 0!==b._webGL[g.id]&&void 0!==b._webGL[g.id].data&&0!==b._webGL[g.id].data.length&&f.stencilManager.popStencil(b,
b._webGL[g.id].data[0],f)};g.WebGLMaskManager.prototype.destroy=function(){this.gl=null};g.WebGLStencilManager=function(){this.stencilStack=[];this.reverse=!0;this.count=0};g.WebGLStencilManager.prototype.setContext=function(b){this.gl=b};g.WebGLStencilManager.prototype.pushStencil=function(b,f,g){var h=this.gl;this.bindGraphics(b,f,g);0===this.stencilStack.length&&(h.enable(h.STENCIL_TEST),h.clear(h.STENCIL_BUFFER_BIT),this.reverse=!0,this.count=0);this.stencilStack.push(f);b=this.count;h.colorMask(!1,
!1,!1,!1);h.stencilFunc(h.ALWAYS,0,255);h.stencilOp(h.KEEP,h.KEEP,h.INVERT);1===f.mode?(h.drawElements(h.TRIANGLE_FAN,f.indices.length-4,h.UNSIGNED_SHORT,0),this.reverse?(h.stencilFunc(h.EQUAL,255-b,255),h.stencilOp(h.KEEP,h.KEEP,h.DECR)):(h.stencilFunc(h.EQUAL,b,255),h.stencilOp(h.KEEP,h.KEEP,h.INCR)),h.drawElements(h.TRIANGLE_FAN,4,h.UNSIGNED_SHORT,2*(f.indices.length-4)),this.reverse?h.stencilFunc(h.EQUAL,255-(b+1),255):h.stencilFunc(h.EQUAL,b+1,255),this.reverse=!this.reverse):(this.reverse?(h.stencilFunc(h.EQUAL,
b,255),h.stencilOp(h.KEEP,h.KEEP,h.INCR)):(h.stencilFunc(h.EQUAL,255-b,255),h.stencilOp(h.KEEP,h.KEEP,h.DECR)),h.drawElements(h.TRIANGLE_STRIP,f.indices.length,h.UNSIGNED_SHORT,0),this.reverse?h.stencilFunc(h.EQUAL,b+1,255):h.stencilFunc(h.EQUAL,255-(b+1),255));h.colorMask(!0,!0,!0,!0);h.stencilOp(h.KEEP,h.KEEP,h.KEEP);this.count++};g.WebGLStencilManager.prototype.bindGraphics=function(b,f,h){this._currentGraphics=b;var l=this.gl,n=h.projection,p=h.offset;if(1===f.mode){var a=h.shaderManager.complexPrimitiveShader;
h.shaderManager.setShader(a);l.uniform1f(a.flipY,h.flipY);l.uniformMatrix3fv(a.translationMatrix,!1,b.worldTransform.toArray(!0));l.uniform2f(a.projectionVector,n.x,-n.y);l.uniform2f(a.offsetVector,-p.x,-p.y);l.uniform3fv(a.tintColor,g.hex2rgb(b.tint));l.uniform3fv(a.color,f.color);l.uniform1f(a.alpha,b.worldAlpha*f.alpha);l.bindBuffer(l.ARRAY_BUFFER,f.buffer);l.vertexAttribPointer(a.aVertexPosition,2,l.FLOAT,!1,8,0)}else a=h.shaderManager.primitiveShader,h.shaderManager.setShader(a),l.uniformMatrix3fv(a.translationMatrix,
!1,b.worldTransform.toArray(!0)),l.uniform1f(a.flipY,h.flipY),l.uniform2f(a.projectionVector,n.x,-n.y),l.uniform2f(a.offsetVector,-p.x,-p.y),l.uniform3fv(a.tintColor,g.hex2rgb(b.tint)),l.uniform1f(a.alpha,b.worldAlpha),l.bindBuffer(l.ARRAY_BUFFER,f.buffer),l.vertexAttribPointer(a.aVertexPosition,2,l.FLOAT,!1,24,0),l.vertexAttribPointer(a.colorAttribute,4,l.FLOAT,!1,24,8);l.bindBuffer(l.ELEMENT_ARRAY_BUFFER,f.indexBuffer)};g.WebGLStencilManager.prototype.popStencil=function(b,f,h){var g=this.gl;this.stencilStack.pop();
this.count--;if(0===this.stencilStack.length)g.disable(g.STENCIL_TEST);else{var n=this.count;this.bindGraphics(b,f,h);g.colorMask(!1,!1,!1,!1);1===f.mode?((this.reverse=!this.reverse)?(g.stencilFunc(g.EQUAL,255-(n+1),255),g.stencilOp(g.KEEP,g.KEEP,g.INCR)):(g.stencilFunc(g.EQUAL,n+1,255),g.stencilOp(g.KEEP,g.KEEP,g.DECR)),g.drawElements(g.TRIANGLE_FAN,4,g.UNSIGNED_SHORT,2*(f.indices.length-4)),g.stencilFunc(g.ALWAYS,0,255),g.stencilOp(g.KEEP,g.KEEP,g.INVERT),g.drawElements(g.TRIANGLE_FAN,f.indices.length-
4,g.UNSIGNED_SHORT,0)):(this.reverse?(g.stencilFunc(g.EQUAL,n+1,255),g.stencilOp(g.KEEP,g.KEEP,g.DECR)):(g.stencilFunc(g.EQUAL,255-(n+1),255),g.stencilOp(g.KEEP,g.KEEP,g.INCR)),g.drawElements(g.TRIANGLE_STRIP,f.indices.length,g.UNSIGNED_SHORT,0));this.reverse?g.stencilFunc(g.EQUAL,n,255):g.stencilFunc(g.EQUAL,255-n,255);g.colorMask(!0,!0,!0,!0);g.stencilOp(g.KEEP,g.KEEP,g.KEEP)}};g.WebGLStencilManager.prototype.destroy=function(){this.gl=this.stencilStack=null};g.WebGLShaderManager=function(){this.maxAttibs=
10;this.attribState=[];this.tempAttribState=[];for(var b=0;b<this.maxAttibs;b++)this.attribState[b]=!1;this.stack=[]};g.WebGLShaderManager.prototype.constructor=g.WebGLShaderManager;g.WebGLShaderManager.prototype.setContext=function(b){this.gl=b;this.primitiveShader=new g.PrimitiveShader(b);this.complexPrimitiveShader=new g.ComplexPrimitiveShader(b);this.defaultShader=new g.PixiShader(b);this.fastShader=new g.PixiFastShader(b);this.stripShader=new g.StripShader(b);this.setShader(this.defaultShader)};
g.WebGLShaderManager.prototype.setAttribs=function(b){var f;for(f=0;f<this.tempAttribState.length;f++)this.tempAttribState[f]=!1;for(f=0;f<b.length;f++)this.tempAttribState[b[f]]=!0;b=this.gl;for(f=0;f<this.attribState.length;f++)this.attribState[f]!==this.tempAttribState[f]&&(this.attribState[f]=this.tempAttribState[f],this.tempAttribState[f]?b.enableVertexAttribArray(f):b.disableVertexAttribArray(f))};g.WebGLShaderManager.prototype.setShader=function(b){if(this._currentId===b._UID)return!1;this._currentId=
b._UID;this.currentShader=b;this.gl.useProgram(b.program);this.setAttribs(b.attributes);return!0};g.WebGLShaderManager.prototype.destroy=function(){this.tempAttribState=this.attribState=null;this.primitiveShader.destroy();this.complexPrimitiveShader.destroy();this.defaultShader.destroy();this.fastShader.destroy();this.stripShader.destroy();this.gl=null};g.WebGLSpriteBatch=function(){this.vertSize=5;this.size=2E3;var b=6*this.size;this.vertices=new g.ArrayBuffer(16*this.size*this.vertSize);this.positions=
new g.Float32Array(this.vertices);this.colors=new g.Uint32Array(this.vertices);this.indices=new g.Uint16Array(b);for(var f=this.lastIndexCount=0,h=0;f<b;f+=6,h+=4)this.indices[f+0]=h+0,this.indices[f+1]=h+1,this.indices[f+2]=h+2,this.indices[f+3]=h+0,this.indices[f+4]=h+2,this.indices[f+5]=h+3;this.drawing=!1;this.currentBatchSize=0;this.currentBaseTexture=null;this.dirty=!0;this.textures=[];this.blendModes=[];this.shaders=[];this.sprites=[];this.defaultShader=new g.AbstractFilter(["precision lowp float;",
"varying vec2 vTextureCoord;","varying vec4 vColor;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord) * vColor ;","}"])};g.WebGLSpriteBatch.prototype.setContext=function(b){this.gl=b;this.vertexBuffer=b.createBuffer();this.indexBuffer=b.createBuffer();b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,this.indexBuffer);b.bufferData(b.ELEMENT_ARRAY_BUFFER,this.indices,b.STATIC_DRAW);b.bindBuffer(b.ARRAY_BUFFER,this.vertexBuffer);b.bufferData(b.ARRAY_BUFFER,this.vertices,
b.DYNAMIC_DRAW);this.currentBlendMode=99999;var f=new g.PixiShader(b);f.fragmentSrc=this.defaultShader.fragmentSrc;f.uniforms={};f.init();this.defaultShader.shaders[b.id]=f};g.WebGLSpriteBatch.prototype.begin=function(b){this.renderSession=b;this.shader=this.renderSession.shaderManager.defaultShader;this.start()};g.WebGLSpriteBatch.prototype.end=function(){this.flush()};g.WebGLSpriteBatch.prototype.render=function(b,f){var g=b.texture,l=b.worldTransform;f&&(l=f);this.currentBatchSize>=this.size&&
(this.flush(),this.currentBaseTexture=g.baseTexture);var n=g._uvs;if(n){var p=b.anchor.x,a=b.anchor.y;if(g.trim){var c=g.trim;p=c.x-p*c.width;var d=p+g.crop.width;var e=c.y-a*c.height;c=e+g.crop.height}else d=g.frame.width*(1-p),p=g.frame.width*-p,c=g.frame.height*(1-a),e=g.frame.height*-a;a=4*this.currentBatchSize*this.vertSize;var k=g.baseTexture.resolution;g=l.a/k;var m=l.b/k,u=l.c/k;k=l.d/k;var v=l.tx,z=l.ty;l=this.colors;var t=this.positions;this.renderSession.roundPixels?(t[a]=g*p+u*e+v|0,t[a+
1]=k*e+m*p+z|0,t[a+5]=g*d+u*e+v|0,t[a+6]=k*e+m*d+z|0,t[a+10]=g*d+u*c+v|0,t[a+11]=k*c+m*d+z|0,t[a+15]=g*p+u*c+v|0,t[a+16]=k*c+m*p+z|0):(t[a]=g*p+u*e+v,t[a+1]=k*e+m*p+z,t[a+5]=g*d+u*e+v,t[a+6]=k*e+m*d+z,t[a+10]=g*d+u*c+v,t[a+11]=k*c+m*d+z,t[a+15]=g*p+u*c+v,t[a+16]=k*c+m*p+z);t[a+2]=n.x0;t[a+3]=n.y0;t[a+7]=n.x1;t[a+8]=n.y1;t[a+12]=n.x2;t[a+13]=n.y2;t[a+17]=n.x3;t[a+18]=n.y3;n=b.tint;l[a+4]=l[a+9]=l[a+14]=l[a+19]=(n>>16)+(n&65280)+((n&255)<<16)+(255*b.worldAlpha<<24);this.sprites[this.currentBatchSize++]=
b}};g.WebGLSpriteBatch.prototype.renderTilingSprite=function(b){var f=b.tilingTexture;this.currentBatchSize>=this.size&&(this.flush(),this.currentBaseTexture=f.baseTexture);b._uvs||(b._uvs=new g.TextureUvs);var h=b._uvs,l=f.baseTexture.width,n=f.baseTexture.height;b.tilePosition.x%=l*b.tileScaleOffset.x;b.tilePosition.y%=n*b.tileScaleOffset.y;var p=b.tilePosition.x/(l*b.tileScaleOffset.x),a=b.tilePosition.y/(n*b.tileScaleOffset.y);l=b.width/l/(b.tileScale.x*b.tileScaleOffset.x);n=b.height/n/(b.tileScale.y*
b.tileScaleOffset.y);h.x0=0-p;h.y0=0-a;h.x1=1*l-p;h.y1=0-a;h.x2=1*l-p;h.y2=1*n-a;h.x3=0-p;h.y3=1*n-a;p=b.tint;p=(p>>16)+(p&65280)+((p&255)<<16)+(255*b.worldAlpha<<24);a=this.positions;n=this.colors;var c=b.width,d=b.height,e=b.anchor.x,k=b.anchor.y;l=c*(1-e);c*=-e;e=d*(1-k);d*=-k;k=4*this.currentBatchSize*this.vertSize;var m=f.baseTexture.resolution,u=b.worldTransform;f=u.a/m;var v=u.b/m,z=u.c/m;m=u.d/m;var t=u.tx;u=u.ty;a[k++]=f*c+z*d+t;a[k++]=m*d+v*c+u;a[k++]=h.x0;a[k++]=h.y0;n[k++]=p;a[k++]=f*
l+z*d+t;a[k++]=m*d+v*l+u;a[k++]=h.x1;a[k++]=h.y1;n[k++]=p;a[k++]=f*l+z*e+t;a[k++]=m*e+v*l+u;a[k++]=h.x2;a[k++]=h.y2;n[k++]=p;a[k++]=f*c+z*e+t;a[k++]=m*e+v*c+u;a[k++]=h.x3;a[k++]=h.y3;n[k++]=p;this.sprites[this.currentBatchSize++]=b};g.WebGLSpriteBatch.prototype.flush=function(){if(0!==this.currentBatchSize){var b=this.gl;if(this.dirty){this.dirty=!1;b.activeTexture(b.TEXTURE0);b.bindBuffer(b.ARRAY_BUFFER,this.vertexBuffer);b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,this.indexBuffer);var f=this.defaultShader.shaders[b.id];
var h=4*this.vertSize;b.vertexAttribPointer(f.aVertexPosition,2,b.FLOAT,!1,h,0);b.vertexAttribPointer(f.aTextureCoord,2,b.FLOAT,!1,h,8);b.vertexAttribPointer(f.colorAttribute,4,b.UNSIGNED_BYTE,!0,h,16)}this.currentBatchSize>.5*this.size?b.bufferSubData(b.ARRAY_BUFFER,0,this.vertices):(h=this.positions.subarray(0,4*this.currentBatchSize*this.vertSize),b.bufferSubData(b.ARRAY_BUFFER,0,h));for(var l,n,p=h=0,a=null,c=this.renderSession.blendModeManager.currentBlendMode,d=null,e,k,m,u=0,v=this.currentBatchSize;u<
v;u++){m=this.sprites[u];f=m.tilingTexture?m.tilingTexture.baseTexture:m.texture.baseTexture;l=m.blendMode;n=m.shader||this.defaultShader;e=c!==l;k=d!==n;var z=f.skipRender;z&&0<m.children.length&&(z=!1);if(a!==f&&!z||e||k)this.renderBatch(a,h,p),p=u,h=0,a=f,e&&(c=l,this.renderSession.blendModeManager.setBlendMode(c)),k&&(d=n,f=d.shaders[b.id],f||(f=new g.PixiShader(b),f.fragmentSrc=d.fragmentSrc,f.uniforms=d.uniforms,f.init(),d.shaders[b.id]=f),this.renderSession.shaderManager.setShader(f),f.dirty&&
f.syncUniforms(),l=this.renderSession.projection,b.uniform2f(f.projectionVector,l.x,l.y),l=this.renderSession.offset,b.uniform2f(f.offsetVector,l.x,l.y));h++}this.renderBatch(a,h,p);this.currentBatchSize=0}};g.WebGLSpriteBatch.prototype.renderBatch=function(b,f,g){if(0!==f){var h=this.gl;if(b._dirty[h.id]){if(!this.renderSession.renderer.updateTexture(b))return}else h.bindTexture(h.TEXTURE_2D,b._glTextures[h.id]);h.drawElements(h.TRIANGLES,6*f,h.UNSIGNED_SHORT,12*g);this.renderSession.drawCount++}};
g.WebGLSpriteBatch.prototype.stop=function(){this.flush();this.dirty=!0};g.WebGLSpriteBatch.prototype.start=function(){this.dirty=!0};g.WebGLSpriteBatch.prototype.destroy=function(){this.indices=this.vertices=null;this.gl.deleteBuffer(this.vertexBuffer);this.gl.deleteBuffer(this.indexBuffer);this.gl=this.currentBaseTexture=null};g.WebGLFastSpriteBatch=function(b){this.vertSize=10;this.size=this.maxSize=6E3;var f=6*this.maxSize;this.vertices=new g.Float32Array(4*this.size*this.vertSize);this.indices=
new g.Uint16Array(f);this.indexBuffer=this.vertexBuffer=null;for(var h=this.lastIndexCount=0,l=0;h<f;h+=6,l+=4)this.indices[h+0]=l+0,this.indices[h+1]=l+1,this.indices[h+2]=l+2,this.indices[h+3]=l+0,this.indices[h+4]=l+2,this.indices[h+5]=l+3;this.drawing=!1;this.currentBatchSize=0;this.currentBaseTexture=null;this.currentBlendMode=0;this.matrix=this.shader=this.renderSession=null;this.setContext(b)};g.WebGLFastSpriteBatch.prototype.constructor=g.WebGLFastSpriteBatch;g.WebGLFastSpriteBatch.prototype.setContext=
function(b){this.gl=b;this.vertexBuffer=b.createBuffer();this.indexBuffer=b.createBuffer();b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,this.indexBuffer);b.bufferData(b.ELEMENT_ARRAY_BUFFER,this.indices,b.STATIC_DRAW);b.bindBuffer(b.ARRAY_BUFFER,this.vertexBuffer);b.bufferData(b.ARRAY_BUFFER,this.vertices,b.DYNAMIC_DRAW)};g.WebGLFastSpriteBatch.prototype.begin=function(b,f){this.renderSession=f;this.shader=this.renderSession.shaderManager.fastShader;this.matrix=b.worldTransform.toArray(!0);this.start()};g.WebGLFastSpriteBatch.prototype.end=
function(){this.flush()};g.WebGLFastSpriteBatch.prototype.render=function(b){b=b.children;var f=b[0];if(f.texture._uvs){this.currentBaseTexture=f.texture.baseTexture;f.blendMode!==this.renderSession.blendModeManager.currentBlendMode&&(this.flush(),this.renderSession.blendModeManager.setBlendMode(f.blendMode));f=0;for(var g=b.length;f<g;f++)this.renderSprite(b[f]);this.flush()}};g.WebGLFastSpriteBatch.prototype.renderSprite=function(b){if(b.visible){if(b.texture.baseTexture!==this.currentBaseTexture&&
!b.texture.baseTexture.skipRender&&(this.flush(),this.currentBaseTexture=b.texture.baseTexture,!b.texture._uvs))return;var f=this.vertices;var g=b.texture._uvs;if(b.texture.trim){var l=b.texture.trim;var n=l.x-b.anchor.x*l.width;var p=n+b.texture.crop.width;var a=l.y-b.anchor.y*l.height;l=a+b.texture.crop.height}else p=b.texture.frame.width*(1-b.anchor.x),n=b.texture.frame.width*-b.anchor.x,l=b.texture.frame.height*(1-b.anchor.y),a=b.texture.frame.height*-b.anchor.y;var c=4*this.currentBatchSize*
this.vertSize;f[c++]=n;f[c++]=a;f[c++]=b.position.x;f[c++]=b.position.y;f[c++]=b.scale.x;f[c++]=b.scale.y;f[c++]=b.rotation;f[c++]=g.x0;f[c++]=g.y1;f[c++]=b.alpha;f[c++]=p;f[c++]=a;f[c++]=b.position.x;f[c++]=b.position.y;f[c++]=b.scale.x;f[c++]=b.scale.y;f[c++]=b.rotation;f[c++]=g.x1;f[c++]=g.y1;f[c++]=b.alpha;f[c++]=p;f[c++]=l;f[c++]=b.position.x;f[c++]=b.position.y;f[c++]=b.scale.x;f[c++]=b.scale.y;f[c++]=b.rotation;f[c++]=g.x2;f[c++]=g.y2;f[c++]=b.alpha;f[c++]=n;f[c++]=l;f[c++]=b.position.x;f[c++]=
b.position.y;f[c++]=b.scale.x;f[c++]=b.scale.y;f[c++]=b.rotation;f[c++]=g.x3;f[c++]=g.y3;f[c++]=b.alpha;this.currentBatchSize++;this.currentBatchSize>=this.size&&this.flush()}};g.WebGLFastSpriteBatch.prototype.flush=function(){if(0!==this.currentBatchSize){var b=this.gl;this.currentBaseTexture._glTextures[b.id]||this.renderSession.renderer.updateTexture(this.currentBaseTexture,b);b.bindTexture(b.TEXTURE_2D,this.currentBaseTexture._glTextures[b.id]);if(this.currentBatchSize>.5*this.size)b.bufferSubData(b.ARRAY_BUFFER,
0,this.vertices);else{var f=this.vertices.subarray(0,4*this.currentBatchSize*this.vertSize);b.bufferSubData(b.ARRAY_BUFFER,0,f)}b.drawElements(b.TRIANGLES,6*this.currentBatchSize,b.UNSIGNED_SHORT,0);this.currentBatchSize=0;this.renderSession.drawCount++}};g.WebGLFastSpriteBatch.prototype.stop=function(){this.flush()};g.WebGLFastSpriteBatch.prototype.start=function(){var b=this.gl;b.activeTexture(b.TEXTURE0);b.bindBuffer(b.ARRAY_BUFFER,this.vertexBuffer);b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,this.indexBuffer);
var f=this.renderSession.projection;b.uniform2f(this.shader.projectionVector,f.x,f.y);b.uniformMatrix3fv(this.shader.uMatrix,!1,this.matrix);f=4*this.vertSize;b.vertexAttribPointer(this.shader.aVertexPosition,2,b.FLOAT,!1,f,0);b.vertexAttribPointer(this.shader.aPositionCoord,2,b.FLOAT,!1,f,8);b.vertexAttribPointer(this.shader.aScale,2,b.FLOAT,!1,f,16);b.vertexAttribPointer(this.shader.aRotation,1,b.FLOAT,!1,f,24);b.vertexAttribPointer(this.shader.aTextureCoord,2,b.FLOAT,!1,f,28);b.vertexAttribPointer(this.shader.colorAttribute,
1,b.FLOAT,!1,f,36)};g.WebGLFilterManager=function(){this.filterStack=[];this.offsetY=this.offsetX=0};g.WebGLFilterManager.prototype.constructor=g.WebGLFilterManager;g.WebGLFilterManager.prototype.setContext=function(b){this.gl=b;this.texturePool=[];this.initShaderBuffers()};g.WebGLFilterManager.prototype.begin=function(b,f){this.renderSession=b;this.defaultShader=b.shaderManager.defaultShader;var g=this.renderSession.projection;this.width=2*g.x;this.height=2*-g.y;this.buffer=f};g.WebGLFilterManager.prototype.pushFilter=
function(b){var f=this.gl,h=this.renderSession.projection,l=this.renderSession.offset;b._filterArea=b.target.filterArea||b.target.getBounds();b._previous_stencil_mgr=this.renderSession.stencilManager;this.renderSession.stencilManager=new g.WebGLStencilManager;this.renderSession.stencilManager.setContext(f);f.disable(f.STENCIL_TEST);this.filterStack.push(b);var n=b.filterPasses[0];this.offsetX+=b._filterArea.x;this.offsetY+=b._filterArea.y;var p=this.texturePool.pop();p?p.resize(this.width*this.renderSession.resolution,
this.height*this.renderSession.resolution):p=new g.FilterTexture(this.gl,this.width*this.renderSession.resolution,this.height*this.renderSession.resolution);f.bindTexture(f.TEXTURE_2D,p.texture);var a=b._filterArea;n=n.padding;a.x-=n;a.y-=n;a.width+=2*n;a.height+=2*n;0>a.x&&(a.x=0);a.width>this.width&&(a.width=this.width);0>a.y&&(a.y=0);a.height>this.height&&(a.height=this.height);f.bindFramebuffer(f.FRAMEBUFFER,p.frameBuffer);f.viewport(0,0,a.width*this.renderSession.resolution,a.height*this.renderSession.resolution);
h.x=a.width/2;h.y=-a.height/2;l.x=-a.x;l.y=-a.y;f.colorMask(!0,!0,!0,!0);f.clearColor(0,0,0,0);f.clear(f.COLOR_BUFFER_BIT);b._glFilterTexture=p};g.WebGLFilterManager.prototype.popFilter=function(){var b=this.gl,f=this.filterStack.pop(),h=f._filterArea,l=f._glFilterTexture,n=this.renderSession.projection,p=this.renderSession.offset;if(1<f.filterPasses.length){b.viewport(0,0,h.width*this.renderSession.resolution,h.height*this.renderSession.resolution);b.bindBuffer(b.ARRAY_BUFFER,this.vertexBuffer);
this.vertexArray[0]=0;this.vertexArray[1]=h.height;this.vertexArray[2]=h.width;this.vertexArray[3]=h.height;this.vertexArray[4]=0;this.vertexArray[5]=0;this.vertexArray[6]=h.width;this.vertexArray[7]=0;b.bufferSubData(b.ARRAY_BUFFER,0,this.vertexArray);b.bindBuffer(b.ARRAY_BUFFER,this.uvBuffer);this.uvArray[2]=h.width/this.width;this.uvArray[5]=h.height/this.height;this.uvArray[6]=h.width/this.width;this.uvArray[7]=h.height/this.height;b.bufferSubData(b.ARRAY_BUFFER,0,this.uvArray);var a=this.texturePool.pop();
a||(a=new g.FilterTexture(this.gl,this.width*this.renderSession.resolution,this.height*this.renderSession.resolution));a.resize(this.width*this.renderSession.resolution,this.height*this.renderSession.resolution);b.bindFramebuffer(b.FRAMEBUFFER,a.frameBuffer);b.clear(b.COLOR_BUFFER_BIT);b.disable(b.BLEND);for(var c=0;c<f.filterPasses.length-1;c++){var d=f.filterPasses[c];b.bindFramebuffer(b.FRAMEBUFFER,a.frameBuffer);b.activeTexture(b.TEXTURE0);b.bindTexture(b.TEXTURE_2D,l.texture);this.applyFilterPass(d,
h,h.width,h.height);d=l;l=a;a=d}b.enable(b.BLEND);this.texturePool.push(a)}a=f.filterPasses[f.filterPasses.length-1];this.offsetX-=h.x;this.offsetY-=h.y;c=this.width;d=this.height;var e=0,k=0,m=this.buffer;0===this.filterStack.length?b.colorMask(!0,!0,!0,!0):(m=this.filterStack[this.filterStack.length-1],h=m._filterArea,c=h.width,d=h.height,e=h.x,k=h.y,m=m._glFilterTexture.frameBuffer);n.x=c/2;n.y=-d/2;p.x=e;p.y=k;h=f._filterArea;n=h.x-e;p=h.y-k;b.bindBuffer(b.ARRAY_BUFFER,this.vertexBuffer);this.vertexArray[0]=
n;this.vertexArray[1]=p+h.height;this.vertexArray[2]=n+h.width;this.vertexArray[3]=p+h.height;this.vertexArray[4]=n;this.vertexArray[5]=p;this.vertexArray[6]=n+h.width;this.vertexArray[7]=p;b.bufferSubData(b.ARRAY_BUFFER,0,this.vertexArray);b.bindBuffer(b.ARRAY_BUFFER,this.uvBuffer);this.uvArray[2]=h.width/this.width;this.uvArray[5]=h.height/this.height;this.uvArray[6]=h.width/this.width;this.uvArray[7]=h.height/this.height;b.bufferSubData(b.ARRAY_BUFFER,0,this.uvArray);b.viewport(0,0,c*this.renderSession.resolution,
d*this.renderSession.resolution);b.bindFramebuffer(b.FRAMEBUFFER,m);b.activeTexture(b.TEXTURE0);b.bindTexture(b.TEXTURE_2D,l.texture);this.renderSession.stencilManager&&this.renderSession.stencilManager.destroy();this.renderSession.stencilManager=f._previous_stencil_mgr;f._previous_stencil_mgr=null;0<this.renderSession.stencilManager.count?b.enable(b.STENCIL_TEST):b.disable(b.STENCIL_TEST);this.applyFilterPass(a,h,c,d);this.texturePool.push(l);f._glFilterTexture=null};g.WebGLFilterManager.prototype.applyFilterPass=
function(b,f,h,l){f=this.gl;var n=b.shaders[f.id];n||(n=new g.PixiShader(f),n.fragmentSrc=b.fragmentSrc,n.uniforms=b.uniforms,n.init(),b.shaders[f.id]=n);this.renderSession.shaderManager.setShader(n);f.uniform2f(n.projectionVector,h/2,-l/2);f.uniform2f(n.offsetVector,0,0);b.uniforms.dimensions&&(b.uniforms.dimensions.value[0]=this.width,b.uniforms.dimensions.value[1]=this.height,b.uniforms.dimensions.value[2]=this.vertexArray[0],b.uniforms.dimensions.value[3]=this.vertexArray[5]);n.syncUniforms();
f.bindBuffer(f.ARRAY_BUFFER,this.vertexBuffer);f.vertexAttribPointer(n.aVertexPosition,2,f.FLOAT,!1,0,0);f.bindBuffer(f.ARRAY_BUFFER,this.uvBuffer);f.vertexAttribPointer(n.aTextureCoord,2,f.FLOAT,!1,0,0);f.bindBuffer(f.ARRAY_BUFFER,this.colorBuffer);f.vertexAttribPointer(n.colorAttribute,2,f.FLOAT,!1,0,0);f.bindBuffer(f.ELEMENT_ARRAY_BUFFER,this.indexBuffer);f.drawElements(f.TRIANGLES,6,f.UNSIGNED_SHORT,0);this.renderSession.drawCount++};g.WebGLFilterManager.prototype.initShaderBuffers=function(){var b=
this.gl;this.vertexBuffer=b.createBuffer();this.uvBuffer=b.createBuffer();this.colorBuffer=b.createBuffer();this.indexBuffer=b.createBuffer();this.vertexArray=new g.Float32Array([0,0,1,0,0,1,1,1]);b.bindBuffer(b.ARRAY_BUFFER,this.vertexBuffer);b.bufferData(b.ARRAY_BUFFER,this.vertexArray,b.STATIC_DRAW);this.uvArray=new g.Float32Array([0,0,1,0,0,1,1,1]);b.bindBuffer(b.ARRAY_BUFFER,this.uvBuffer);b.bufferData(b.ARRAY_BUFFER,this.uvArray,b.STATIC_DRAW);this.colorArray=new g.Float32Array([1,16777215,
1,16777215,1,16777215,1,16777215]);b.bindBuffer(b.ARRAY_BUFFER,this.colorBuffer);b.bufferData(b.ARRAY_BUFFER,this.colorArray,b.STATIC_DRAW);b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,this.indexBuffer);b.bufferData(b.ELEMENT_ARRAY_BUFFER,new Uint16Array([0,1,2,1,3,2]),b.STATIC_DRAW)};g.WebGLFilterManager.prototype.destroy=function(){var b=this.gl;this.filterStack=null;for(var f=this.offsetY=this.offsetX=0;f<this.texturePool.length;f++)this.texturePool[f].destroy();this.texturePool=null;b.deleteBuffer(this.vertexBuffer);
b.deleteBuffer(this.uvBuffer);b.deleteBuffer(this.colorBuffer);b.deleteBuffer(this.indexBuffer)};g.FilterTexture=function(b,f,h,l){this.gl=b;this.frameBuffer=b.createFramebuffer();this.texture=b.createTexture();l=l||g.scaleModes.DEFAULT;b.bindTexture(b.TEXTURE_2D,this.texture);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,l===g.scaleModes.LINEAR?b.LINEAR:b.NEAREST);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,l===g.scaleModes.LINEAR?b.LINEAR:b.NEAREST);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,
b.CLAMP_TO_EDGE);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,b.CLAMP_TO_EDGE);b.bindFramebuffer(b.FRAMEBUFFER,this.frameBuffer);b.bindFramebuffer(b.FRAMEBUFFER,this.frameBuffer);b.framebufferTexture2D(b.FRAMEBUFFER,b.COLOR_ATTACHMENT0,b.TEXTURE_2D,this.texture,0);this.renderBuffer=b.createRenderbuffer();b.bindRenderbuffer(b.RENDERBUFFER,this.renderBuffer);b.framebufferRenderbuffer(b.FRAMEBUFFER,b.DEPTH_STENCIL_ATTACHMENT,b.RENDERBUFFER,this.renderBuffer);this.resize(f,h)};g.FilterTexture.prototype.constructor=
g.FilterTexture;g.FilterTexture.prototype.clear=function(){var b=this.gl;b.clearColor(0,0,0,0);b.clear(b.COLOR_BUFFER_BIT)};g.FilterTexture.prototype.resize=function(b,f){if(this.width!==b||this.height!==f){this.width=b;this.height=f;var g=this.gl;g.bindTexture(g.TEXTURE_2D,this.texture);g.texImage2D(g.TEXTURE_2D,0,g.RGBA,b,f,0,g.RGBA,g.UNSIGNED_BYTE,null);g.bindRenderbuffer(g.RENDERBUFFER,this.renderBuffer);g.renderbufferStorage(g.RENDERBUFFER,g.DEPTH_STENCIL,b,f)}};g.FilterTexture.prototype.destroy=
function(){var b=this.gl;b.deleteFramebuffer(this.frameBuffer);b.deleteTexture(this.texture);this.texture=this.frameBuffer=null};g.CanvasBuffer=function(b,f){this.width=b;this.height=f;this.canvas=g.CanvasPool.create(this,this.width,this.height);this.context=this.canvas.getContext("2d");this.canvas.width=b;this.canvas.height=f};g.CanvasBuffer.prototype.constructor=g.CanvasBuffer;g.CanvasBuffer.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0);this.context.clearRect(0,0,this.width,
this.height)};g.CanvasBuffer.prototype.resize=function(b,f){this.width=this.canvas.width=b;this.height=this.canvas.height=f};g.CanvasBuffer.prototype.destroy=function(){g.CanvasPool.remove(this)};g.CanvasMaskManager=function(){};g.CanvasMaskManager.prototype.constructor=g.CanvasMaskManager;g.CanvasMaskManager.prototype.pushMask=function(b,f){var h=f.context;h.save();var l=b.alpha,n=b.worldTransform,p=f.resolution;h.setTransform(n.a*p,n.b*p,n.c*p,n.d*p,n.tx*p,n.ty*p);g.CanvasGraphics.renderGraphicsMask(b,
h);h.clip();b.worldAlpha=l};g.CanvasMaskManager.prototype.popMask=function(b){b.context.restore()};g.CanvasTinter=function(){};g.CanvasTinter.getTintedTexture=function(b,f){var h=b.tintedTexture||g.CanvasPool.create(this);g.CanvasTinter.tintMethod(b.texture,f,h);return h};g.CanvasTinter.tintWithMultiply=function(b,f,g){var h=g.getContext("2d"),n=b.crop;if(g.width!==n.width||g.height!==n.height)g.width=n.width,g.height=n.height;h.clearRect(0,0,n.width,n.height);h.fillStyle="#"+("00000"+(f|0).toString(16)).substr(-6);
h.fillRect(0,0,n.width,n.height);h.globalCompositeOperation="multiply";h.drawImage(b.baseTexture.source,n.x,n.y,n.width,n.height,0,0,n.width,n.height);h.globalCompositeOperation="destination-atop";h.drawImage(b.baseTexture.source,n.x,n.y,n.width,n.height,0,0,n.width,n.height)};g.CanvasTinter.tintWithPerPixel=function(b,f,h){var l=h.getContext("2d"),n=b.crop;h.width=n.width;h.height=n.height;l.globalCompositeOperation="copy";l.drawImage(b.baseTexture.source,n.x,n.y,n.width,n.height,0,0,n.width,n.height);
h=g.hex2rgb(f);b=h[0];f=h[1];h=h[2];n=l.getImageData(0,0,n.width,n.height);for(var p=n.data,a=0;a<p.length;a+=4)if(p[a+0]*=b,p[a+1]*=f,p[a+2]*=h,!g.CanvasTinter.canHandleAlpha){var c=p[a+3];p[a+0]/=255/c;p[a+1]/=255/c;p[a+2]/=255/c}l.putImageData(n,0,0)};g.CanvasTinter.checkInverseAlpha=function(){var b=new g.CanvasBuffer(2,1);b.context.fillStyle="rgba(10, 20, 30, 0.5)";b.context.fillRect(0,0,1,1);var f=b.context.getImageData(0,0,1,1);if(null===f)return!1;b.context.putImageData(f,1,0);b=b.context.getImageData(1,
0,1,1);return b.data[0]===f.data[0]&&b.data[1]===f.data[1]&&b.data[2]===f.data[2]&&b.data[3]===f.data[3]};g.CanvasTinter.canHandleAlpha=g.CanvasTinter.checkInverseAlpha();g.CanvasTinter.canUseMultiply=g.canUseNewCanvasBlendModes();g.CanvasTinter.tintMethod=g.CanvasTinter.canUseMultiply?g.CanvasTinter.tintWithMultiply:g.CanvasTinter.tintWithPerPixel;g.CanvasRenderer=function(b){this.game=b;g.defaultRenderer||(g.defaultRenderer=this);this.type=g.CANVAS_RENDERER;this.resolution=b.resolution;this.clearBeforeRender=
b.clearBeforeRender;this.transparent=b.transparent;this.autoResize=!1;this.width=b.width*this.resolution;this.height=b.height*this.resolution;this.view=b.canvas;this.context=this.view.getContext("2d",{alpha:this.transparent});this.refresh=!0;this.count=0;this.maskManager=new g.CanvasMaskManager;this.renderSession={context:this.context,maskManager:this.maskManager,scaleMode:null,smoothProperty:Phaser.Canvas.getSmoothingPrefix(this.context),roundPixels:!1};this.mapBlendModes();this.resize(this.width,
this.height)};g.CanvasRenderer.prototype.constructor=g.CanvasRenderer;g.CanvasRenderer.prototype.render=function(b){this.context.setTransform(1,0,0,1,0,0);this.context.globalAlpha=1;this.renderSession.currentBlendMode=0;this.renderSession.shakeX=this.game.camera._shake.x;this.renderSession.shakeY=this.game.camera._shake.y;this.context.globalCompositeOperation="source-over";navigator.isCocoonJS&&this.view.screencanvas&&(this.context.fillStyle="black",this.context.clear());this.clearBeforeRender&&(this.transparent?
this.context.clearRect(0,0,this.width,this.height):b._bgColor&&(this.context.fillStyle=b._bgColor.rgba,this.context.fillRect(0,0,this.width,this.height)));this.renderDisplayObject(b)};g.CanvasRenderer.prototype.destroy=function(b){void 0===b&&(b=!0);b&&this.view.parent&&this.view.parent.removeChild(this.view);this.renderSession=this.maskManager=this.context=this.view=null};g.CanvasRenderer.prototype.resize=function(b,f){this.width=b*this.resolution;this.height=f*this.resolution;this.view.width=this.width;
this.view.height=this.height;this.autoResize&&(this.view.style.width=this.width/this.resolution+"px",this.view.style.height=this.height/this.resolution+"px");this.renderSession.smoothProperty&&(this.context[this.renderSession.smoothProperty]=this.renderSession.scaleMode===g.scaleModes.LINEAR)};g.CanvasRenderer.prototype.renderDisplayObject=function(b,f,g){this.renderSession.context=f||this.context;this.renderSession.resolution=this.resolution;b._renderCanvas(this.renderSession,g)};g.CanvasRenderer.prototype.mapBlendModes=
function(){if(!g.blendModesCanvas){var b=[],f=g.blendModes,h=g.canUseNewCanvasBlendModes();b[f.NORMAL]="source-over";b[f.ADD]="lighter";b[f.MULTIPLY]=h?"multiply":"source-over";b[f.SCREEN]=h?"screen":"source-over";b[f.OVERLAY]=h?"overlay":"source-over";b[f.DARKEN]=h?"darken":"source-over";b[f.LIGHTEN]=h?"lighten":"source-over";b[f.COLOR_DODGE]=h?"color-dodge":"source-over";b[f.COLOR_BURN]=h?"color-burn":"source-over";b[f.HARD_LIGHT]=h?"hard-light":"source-over";b[f.SOFT_LIGHT]=h?"soft-light":"source-over";
b[f.DIFFERENCE]=h?"difference":"source-over";b[f.EXCLUSION]=h?"exclusion":"source-over";b[f.HUE]=h?"hue":"source-over";b[f.SATURATION]=h?"saturation":"source-over";b[f.COLOR]=h?"color":"source-over";b[f.LUMINOSITY]=h?"luminosity":"source-over";g.blendModesCanvas=b}};g.BaseTexture=function(b,f){this.resolution=1;this.height=this.width=100;this.scaleMode=f||g.scaleModes.DEFAULT;this.hasLoaded=!1;this.source=b;this.premultipliedAlpha=!0;this._glTextures=[];this.mipmap=!1;this._dirty=[!0,!0,!0,!0];b&&
((this.source.complete||this.source.getContext)&&this.source.width&&this.source.height&&(this.hasLoaded=!0,this.width=this.source.naturalWidth||this.source.width,this.height=this.source.naturalHeight||this.source.height,this.dirty()),this._powerOf2=this.skipRender=!1)};g.BaseTexture.prototype.constructor=g.BaseTexture;g.BaseTexture.prototype.forceLoaded=function(b,f){this.hasLoaded=!0;this.width=b;this.height=f;this.dirty()};g.BaseTexture.prototype.destroy=function(){this.source&&g.CanvasPool.removeByCanvas(this.source);
this.source=null;this.unloadFromGPU()};g.BaseTexture.prototype.updateSourceImage=function(b){console.warn("PIXI.BaseTexture.updateSourceImage is deprecated. Use Phaser.Sprite.loadTexture instead.")};g.BaseTexture.prototype.dirty=function(){for(var b=0;b<this._glTextures.length;b++)this._dirty[b]=!0};g.BaseTexture.prototype.unloadFromGPU=function(){this.dirty();for(var b=this._glTextures.length-1;0<=b;b--){var f=this._glTextures[b],h=g.glContexts[b];h&&f&&h.deleteTexture(f)}this._glTextures.length=
0;this.dirty()};g.BaseTexture.fromCanvas=function(b,f){0===b.width&&(b.width=1);0===b.height&&(b.height=1);return new g.BaseTexture(b,f)};g.TextureSilentFail=!1;g.Texture=function(b,f,h,l){this.noFrame=!1;f||(this.noFrame=!0,f=new g.Rectangle(0,0,1,1));b instanceof g.Texture&&(b=b.baseTexture);this.baseTexture=b;this.frame=f;this.trim=l;this.requiresReTint=this.requiresUpdate=this.isTiling=this.valid=!1;this._uvs=null;this.height=this.width=0;this.crop=h||new g.Rectangle(0,0,1,1);b.hasLoaded&&(this.noFrame&&
(f=new g.Rectangle(0,0,b.width,b.height)),this.setFrame(f))};g.Texture.prototype.constructor=g.Texture;g.Texture.prototype.onBaseTextureLoaded=function(){var b=this.baseTexture;this.noFrame&&(this.frame=new g.Rectangle(0,0,b.width,b.height));this.setFrame(this.frame)};g.Texture.prototype.destroy=function(b){b&&this.baseTexture.destroy();this.valid=!1};g.Texture.prototype.setFrame=function(b){this.noFrame=!1;this.frame=b;this.width=b.width;this.height=b.height;this.crop.x=b.x;this.crop.y=b.y;this.crop.width=
b.width;this.crop.height=b.height;if(!this.trim&&(b.x+b.width>this.baseTexture.width||b.y+b.height>this.baseTexture.height)){if(!g.TextureSilentFail)throw Error("Texture Error: frame does not fit inside the base Texture dimensions "+this);this.valid=!1}else this.valid=b&&b.width&&b.height&&this.baseTexture.source&&this.baseTexture.hasLoaded,this.trim&&(this.width=this.trim.width,this.height=this.trim.height,this.frame.width=this.trim.width,this.frame.height=this.trim.height),this.valid&&this._updateUvs()};
g.Texture.prototype._updateUvs=function(){this._uvs||(this._uvs=new g.TextureUvs);var b=this.crop,f=this.baseTexture.width,h=this.baseTexture.height;this._uvs.x0=b.x/f;this._uvs.y0=b.y/h;this._uvs.x1=(b.x+b.width)/f;this._uvs.y1=b.y/h;this._uvs.x2=(b.x+b.width)/f;this._uvs.y2=(b.y+b.height)/h;this._uvs.x3=b.x/f;this._uvs.y3=(b.y+b.height)/h};g.Texture.fromCanvas=function(b,f){var h=g.BaseTexture.fromCanvas(b,f);return new g.Texture(h)};g.TextureUvs=function(){this.y3=this.x3=this.y2=this.x2=this.y1=
this.x1=this.y0=this.x0=0};g.RenderTexture=function(b,f,h,l,n){this.width=b||100;this.height=f||100;this.resolution=n||1;this.frame=new g.Rectangle(0,0,this.width*this.resolution,this.height*this.resolution);this.crop=new g.Rectangle(0,0,this.width*this.resolution,this.height*this.resolution);this.baseTexture=new g.BaseTexture;this.baseTexture.width=this.width*this.resolution;this.baseTexture.height=this.height*this.resolution;this.baseTexture._glTextures=[];this.baseTexture.resolution=this.resolution;
this.baseTexture.scaleMode=l||g.scaleModes.DEFAULT;this.baseTexture.hasLoaded=!0;g.Texture.call(this,this.baseTexture,new g.Rectangle(0,0,this.width*this.resolution,this.height*this.resolution));this.renderer=h||g.defaultRenderer;this.renderer.type===g.WEBGL_RENDERER?(b=this.renderer.gl,this.baseTexture._dirty[b.id]=!1,this.textureBuffer=new g.FilterTexture(b,this.width,this.height,this.baseTexture.scaleMode),this.baseTexture._glTextures[b.id]=this.textureBuffer.texture,this.render=this.renderWebGL,
this.projection=new g.Point(.5*this.width,.5*-this.height)):(this.render=this.renderCanvas,this.textureBuffer=new g.CanvasBuffer(this.width*this.resolution,this.height*this.resolution),this.baseTexture.source=this.textureBuffer.canvas);this.valid=!0;this.tempMatrix=new Phaser.Matrix;this._updateUvs()};g.RenderTexture.prototype=Object.create(g.Texture.prototype);g.RenderTexture.prototype.constructor=g.RenderTexture;g.RenderTexture.prototype.resize=function(b,f,h){if(b!==this.width||f!==this.height)this.valid=
0<b&&0<f,this.width=b,this.height=f,this.frame.width=this.crop.width=b*this.resolution,this.frame.height=this.crop.height=f*this.resolution,h&&(this.baseTexture.width=this.width*this.resolution,this.baseTexture.height=this.height*this.resolution),this.renderer.type===g.WEBGL_RENDERER&&(this.projection.x=this.width/2,this.projection.y=-this.height/2),this.valid&&this.textureBuffer.resize(this.width,this.height)};g.RenderTexture.prototype.clear=function(){this.valid&&(this.renderer.type===g.WEBGL_RENDERER&&
this.renderer.gl.bindFramebuffer(this.renderer.gl.FRAMEBUFFER,this.textureBuffer.frameBuffer),this.textureBuffer.clear())};g.RenderTexture.prototype.renderWebGL=function(b,f,g){if(this.valid&&0!==b.alpha){var h=b.worldTransform;h.identity();h.translate(0,2*this.projection.y);f&&h.append(f);h.scale(1,-1);for(h=0;h<b.children.length;h++)b.children[h].updateTransform();h=this.renderer.gl;h.viewport(0,0,this.width*this.resolution,this.height*this.resolution);h.bindFramebuffer(h.FRAMEBUFFER,this.textureBuffer.frameBuffer);
g&&this.textureBuffer.clear();this.renderer.spriteBatch.dirty=!0;this.renderer.renderDisplayObject(b,this.projection,this.textureBuffer.frameBuffer,f);this.renderer.spriteBatch.dirty=!0}};g.RenderTexture.prototype.renderCanvas=function(b,f,g){if(this.valid&&0!==b.alpha){var h=b.worldTransform;h.identity();f&&h.append(f);for(h=0;h<b.children.length;h++)b.children[h].updateTransform();g&&this.textureBuffer.clear();g=this.renderer.resolution;this.renderer.resolution=this.resolution;this.renderer.renderDisplayObject(b,
this.textureBuffer.context,f);this.renderer.resolution=g}};g.RenderTexture.prototype.getImage=function(){var b=new Image;b.src=this.getBase64();return b};g.RenderTexture.prototype.getBase64=function(){return this.getCanvas().toDataURL()};g.RenderTexture.prototype.getCanvas=function(){if(this.renderer.type===g.WEBGL_RENDERER){var b=this.renderer.gl,f=this.textureBuffer.width,h=this.textureBuffer.height,l=new Uint8Array(4*f*h);b.bindFramebuffer(b.FRAMEBUFFER,this.textureBuffer.frameBuffer);b.readPixels(0,
0,f,h,b.RGBA,b.UNSIGNED_BYTE,l);b.bindFramebuffer(b.FRAMEBUFFER,null);b=new g.CanvasBuffer(f,h);f=b.context.getImageData(0,0,f,h);f.data.set(l);b.context.putImageData(f,0,0);return b.canvas}return this.textureBuffer.canvas};g.AbstractFilter=function(b,f){this.passes=[this];this.shaders=[];this.dirty=!0;this.padding=0;this.uniforms=f||{};this.fragmentSrc=b||[]};g.AbstractFilter.prototype.constructor=g.AbstractFilter;g.AbstractFilter.prototype.syncUniforms=function(){for(var b=0,f=this.shaders.length;b<
f;b++)this.shaders[b].dirty=!0};g.Strip=function(b){g.DisplayObjectContainer.call(this);this.texture=b;this.uvs=new g.Float32Array([0,1,1,1,1,0,0,1]);this.vertices=new g.Float32Array([0,0,100,0,100,100,0,100]);this.colors=new g.Float32Array([1,1,1,1]);this.indices=new g.Uint16Array([0,1,2,3]);this.dirty=!0;this.blendMode=g.blendModes.NORMAL;this.canvasPadding=0;this.drawMode=g.Strip.DrawModes.TRIANGLE_STRIP};g.Strip.prototype=Object.create(g.DisplayObjectContainer.prototype);g.Strip.prototype.constructor=
g.Strip;g.Strip.prototype._renderWebGL=function(b){!this.visible||0>=this.alpha||(b.spriteBatch.stop(),this._vertexBuffer||this._initWebGL(b),b.shaderManager.setShader(b.shaderManager.stripShader),this._renderStrip(b),b.spriteBatch.start())};g.Strip.prototype._initWebGL=function(b){b=b.gl;this._vertexBuffer=b.createBuffer();this._indexBuffer=b.createBuffer();this._uvBuffer=b.createBuffer();this._colorBuffer=b.createBuffer();b.bindBuffer(b.ARRAY_BUFFER,this._vertexBuffer);b.bufferData(b.ARRAY_BUFFER,
this.vertices,b.DYNAMIC_DRAW);b.bindBuffer(b.ARRAY_BUFFER,this._uvBuffer);b.bufferData(b.ARRAY_BUFFER,this.uvs,b.STATIC_DRAW);b.bindBuffer(b.ARRAY_BUFFER,this._colorBuffer);b.bufferData(b.ARRAY_BUFFER,this.colors,b.STATIC_DRAW);b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,this._indexBuffer);b.bufferData(b.ELEMENT_ARRAY_BUFFER,this.indices,b.STATIC_DRAW)};g.Strip.prototype._renderStrip=function(b){var f=b.gl,h=b.projection,l=b.offset,n=b.shaderManager.stripShader,p=this.drawMode===g.Strip.DrawModes.TRIANGLE_STRIP?
f.TRIANGLE_STRIP:f.TRIANGLES;b.blendModeManager.setBlendMode(this.blendMode);f.uniformMatrix3fv(n.translationMatrix,!1,this.worldTransform.toArray(!0));f.uniform2f(n.projectionVector,h.x,-h.y);f.uniform2f(n.offsetVector,-l.x,-l.y);f.uniform1f(n.alpha,this.worldAlpha);this.dirty?(this.dirty=!1,f.bindBuffer(f.ARRAY_BUFFER,this._vertexBuffer),f.bufferData(f.ARRAY_BUFFER,this.vertices,f.STATIC_DRAW),f.vertexAttribPointer(n.aVertexPosition,2,f.FLOAT,!1,0,0),f.bindBuffer(f.ARRAY_BUFFER,this._uvBuffer),
f.bufferData(f.ARRAY_BUFFER,this.uvs,f.STATIC_DRAW),f.vertexAttribPointer(n.aTextureCoord,2,f.FLOAT,!1,0,0),f.activeTexture(f.TEXTURE0),this.texture.baseTexture._dirty[f.id]?b.renderer.updateTexture(this.texture.baseTexture):f.bindTexture(f.TEXTURE_2D,this.texture.baseTexture._glTextures[f.id]),f.bindBuffer(f.ELEMENT_ARRAY_BUFFER,this._indexBuffer),f.bufferData(f.ELEMENT_ARRAY_BUFFER,this.indices,f.STATIC_DRAW)):(f.bindBuffer(f.ARRAY_BUFFER,this._vertexBuffer),f.bufferSubData(f.ARRAY_BUFFER,0,this.vertices),
f.vertexAttribPointer(n.aVertexPosition,2,f.FLOAT,!1,0,0),f.bindBuffer(f.ARRAY_BUFFER,this._uvBuffer),f.vertexAttribPointer(n.aTextureCoord,2,f.FLOAT,!1,0,0),f.activeTexture(f.TEXTURE0),this.texture.baseTexture._dirty[f.id]?b.renderer.updateTexture(this.texture.baseTexture):f.bindTexture(f.TEXTURE_2D,this.texture.baseTexture._glTextures[f.id]),f.bindBuffer(f.ELEMENT_ARRAY_BUFFER,this._indexBuffer));f.drawElements(p,this.indices.length,f.UNSIGNED_SHORT,0)};g.Strip.prototype._renderCanvas=function(b){var f=
b.context,h=this.worldTransform,l=h.tx*b.resolution+b.shakeX,n=h.ty*b.resolution+b.shakeY;b.roundPixels?f.setTransform(h.a,h.b,h.c,h.d,l|0,n|0):f.setTransform(h.a,h.b,h.c,h.d,l,n);this.drawMode===g.Strip.DrawModes.TRIANGLE_STRIP?this._renderCanvasTriangleStrip(f):this._renderCanvasTriangles(f)};g.Strip.prototype._renderCanvasTriangleStrip=function(b){var f=this.vertices,g=this.uvs,l=f.length/2;this.count++;for(var n=0;n<l-2;n++){var p=2*n;this._renderCanvasDrawTriangle(b,f,g,p,p+2,p+4)}};g.Strip.prototype._renderCanvasTriangles=
function(b){var f=this.vertices,g=this.uvs,l=this.indices,n=l.length;this.count++;for(var p=0;p<n;p+=3)this._renderCanvasDrawTriangle(b,f,g,2*l[p],2*l[p+1],2*l[p+2])};g.Strip.prototype._renderCanvasDrawTriangle=function(b,f,g,l,n,p){var a=this.texture.baseTexture.source,c=this.texture.width,d=this.texture.height,e=f[l],k=f[n],m=f[p],u=f[l+1],h=f[n+1];f=f[p+1];var z=g[l]*c,t=g[n]*c;c*=g[p];l=g[l+1]*d;n=g[n+1]*d;g=g[p+1]*d;if(0<this.canvasPadding){p=this.canvasPadding/this.worldTransform.a;d=this.canvasPadding/
this.worldTransform.d;var w=(e+k+m)/3,q=(u+h+f)/3,r=e-w,x=u-q,y=Math.sqrt(r*r+x*x);e=w+r/y*(y+p);u=q+x/y*(y+d);r=k-w;x=h-q;y=Math.sqrt(r*r+x*x);k=w+r/y*(y+p);h=q+x/y*(y+d);r=m-w;x=f-q;y=Math.sqrt(r*r+x*x);m=w+r/y*(y+p);f=q+x/y*(y+d)}b.save();b.beginPath();b.moveTo(e,u);b.lineTo(k,h);b.lineTo(m,f);b.closePath();b.clip();p=z*n+l*c+t*g-n*c-l*t-z*g;b.transform((e*n+l*m+k*g-n*m-l*k-e*g)/p,(u*n+l*f+h*g-n*f-l*h-u*g)/p,(z*k+e*c+t*m-k*c-e*t-z*m)/p,(z*h+u*c+t*f-h*c-u*t-z*f)/p,(z*n*m+l*k*c+e*t*g-e*n*c-l*t*m-
z*k*g)/p,(z*n*f+l*h*c+u*t*g-u*n*c-l*t*f-z*h*g)/p);b.drawImage(a,0,0);b.restore()};g.Strip.prototype.renderStripFlat=function(b){var f=this.context;b=b.vertices;var g=b.length/2;this.count++;f.beginPath();for(var l=1;l<g-2;l++){var n=2*l,p=b[n+2],a=b[n+4],c=b[n+3],d=b[n+5];f.moveTo(b[n],b[n+1]);f.lineTo(p,c);f.lineTo(a,d)}f.fillStyle="#FF0000";f.fill();f.closePath()};g.Strip.prototype.onTextureUpdate=function(){this.updateFrame=!0};g.Strip.prototype.getBounds=function(b){var f=b||this.worldTransform;
b=f.a;for(var h=f.b,l=f.c,n=f.d,p=f.tx,a=f.ty,c=f=-Infinity,d=Infinity,e=Infinity,k=this.vertices,m=0,u=k.length;m<u;m+=2){var v=k[m],z=k[m+1],t=b*v+l*z+p;v=n*z+h*v+a;d=t<d?t:d;e=v<e?v:e;f=t>f?t:f;c=v>c?v:c}if(-Infinity===d||Infinity===c)return g.EmptyRectangle;b=this._bounds;b.x=d;b.width=f-d;b.y=e;b.height=c-e;return this._currentBounds=b};g.Strip.DrawModes={TRIANGLE_STRIP:0,TRIANGLES:1};g.Rope=function(b,f){g.Strip.call(this,b);this.points=f;this.vertices=new g.Float32Array(4*f.length);this.uvs=
new g.Float32Array(4*f.length);this.colors=new g.Float32Array(2*f.length);this.indices=new g.Uint16Array(2*f.length);this.refresh()};g.Rope.prototype=Object.create(g.Strip.prototype);g.Rope.prototype.constructor=g.Rope;g.Rope.prototype.refresh=function(){var b=this.points;if(!(1>b.length)){var f=this.uvs,g=this.indices,l=this.colors;this.count-=.2;f[0]=0;f[1]=0;f[2]=0;f[3]=1;l[0]=1;l[1]=1;g[0]=0;g[1]=1;b=b.length;for(var n,p,a=1;a<b;a++)n=4*a,p=a/(b-1),f[n]=p,f[n+1]=0,f[n+2]=p,f[n+3]=1,n=2*a,l[n]=
1,l[n+1]=1,n=2*a,g[n]=n,g[n+1]=n+1}};g.Rope.prototype.updateTransform=function(){var b=this.points;if(!(1>b.length)){var f=b[0];this.count-=.2;for(var h=this.vertices,l=b.length,n,p,a,c=0;c<l;c++){n=b[c];p=4*c;var d=c<b.length-1?b[c+1]:n;var e=-(d.x-f.x);f=d.y-f.y;d=Math.sqrt(f*f+e*e);a=this.texture.height/2;f/=d;e/=d;f*=a;e*=a;h[p]=n.x+f;h[p+1]=n.y+e;h[p+2]=n.x-f;h[p+3]=n.y-e;f=n}g.DisplayObjectContainer.prototype.updateTransform.call(this)}};g.Rope.prototype.setTexture=function(b){this.texture=
b};g.TilingSprite=function(b,f,h){g.Sprite.call(this,b);this._width=f||128;this._height=h||128;this.tileScale=new g.Point(1,1);this.tileScaleOffset=new g.Point(1,1);this.tilePosition=new g.Point;this.renderable=!0;this.tint=16777215;this.textureDebug=!1;this.blendMode=g.blendModes.NORMAL;this.tilePattern=this.tilingTexture=this.canvasBuffer=null;this.refreshTexture=!0;this.frameHeight=this.frameWidth=0};g.TilingSprite.prototype=Object.create(g.Sprite.prototype);g.TilingSprite.prototype.constructor=
g.TilingSprite;g.TilingSprite.prototype.setTexture=function(b){this.texture!==b&&(this.texture=b,this.refreshTexture=!0,this.cachedTint=16777215)};g.TilingSprite.prototype._renderWebGL=function(b){if(this.visible&&this.renderable&&0!==this.alpha){this._mask&&(b.spriteBatch.stop(),b.maskManager.pushMask(this.mask,b),b.spriteBatch.start());this._filters&&(b.spriteBatch.flush(),b.filterManager.pushFilter(this._filterBlock));if(this.refreshTexture)if(this.generateTilingTexture(!0,b),this.tilingTexture)this.tilingTexture.needsUpdate&&
(b.renderer.updateTexture(this.tilingTexture.baseTexture),this.tilingTexture.needsUpdate=!1);else return;b.spriteBatch.renderTilingSprite(this);for(var f=0;f<this.children.length;f++)this.children[f]._renderWebGL(b);b.spriteBatch.stop();this._filters&&b.filterManager.popFilter();this._mask&&b.maskManager.popMask(this._mask,b);b.spriteBatch.start()}};g.TilingSprite.prototype._renderCanvas=function(b){if(this.visible&&this.renderable&&0!==this.alpha){var f=b.context;this._mask&&b.maskManager.pushMask(this._mask,
b);f.globalAlpha=this.worldAlpha;var h=this.worldTransform,l=b.resolution,n=h.tx*l+b.shakeX,p=h.ty*l+b.shakeY;f.setTransform(h.a*l,h.b*l,h.c*l,h.d*l,n,p);if(this.refreshTexture)if(this.generateTilingTexture(!1,b),this.tilingTexture)this.tilePattern=f.createPattern(this.tilingTexture.baseTexture.source,"repeat");else return;h=b.currentBlendMode;this.blendMode!==b.currentBlendMode&&(b.currentBlendMode=this.blendMode,f.globalCompositeOperation=g.blendModesCanvas[b.currentBlendMode]);l=this.tilePosition;
var a=this.tileScale;l.x%=this.tilingTexture.baseTexture.width;l.y%=this.tilingTexture.baseTexture.height;f.scale(a.x,a.y);f.translate(l.x+this.anchor.x*-this._width,l.y+this.anchor.y*-this._height);f.fillStyle=this.tilePattern;n=-l.x;p=-l.y;var c=this._width/a.x,d=this._height/a.y;b.roundPixels&&(n|=0,p|=0,c|=0,d|=0);f.fillRect(n,p,c,d);f.scale(1/a.x,1/a.y);f.translate(-l.x+this.anchor.x*this._width,-l.y+this.anchor.y*this._height);this._mask&&b.maskManager.popMask(b);for(n=0;n<this.children.length;n++)this.children[n]._renderCanvas(b);
h!==this.blendMode&&(b.currentBlendMode=h,f.globalCompositeOperation=g.blendModesCanvas[h])}};g.TilingSprite.prototype.onTextureUpdate=function(){};g.TilingSprite.prototype.generateTilingTexture=function(b,f){if(this.texture.baseTexture.hasLoaded){var h=this.texture,l=h.frame,n=this._frame.sourceSizeW||this._frame.width,p=this._frame.sourceSizeH||this._frame.height,a=0,c=0;this._frame.trimmed&&(a=this._frame.spriteSourceSizeX,c=this._frame.spriteSourceSizeY);b&&(n=g.getNextPowerOfTwo(n),p=g.getNextPowerOfTwo(p));
this.canvasBuffer?(this.canvasBuffer.resize(n,p),this.tilingTexture.baseTexture.width=n,this.tilingTexture.baseTexture.height=p):(this.canvasBuffer=new g.CanvasBuffer(n,p),this.tilingTexture=g.Texture.fromCanvas(this.canvasBuffer.canvas),this.tilingTexture.isTiling=!0);this.tilingTexture.needsUpdate=!0;this.textureDebug&&(this.canvasBuffer.context.strokeStyle="#00ff00",this.canvasBuffer.context.strokeRect(0,0,n,p));var d=h.crop.width,e=h.crop.height;if(d!==n||e!==p)d=n,e=p;this.canvasBuffer.context.drawImage(h.baseTexture.source,
h.crop.x,h.crop.y,h.crop.width,h.crop.height,a,c,d,e);this.tileScaleOffset.x=l.width/n;this.tileScaleOffset.y=l.height/p;this.refreshTexture=!1;this.tilingTexture.baseTexture._powerOf2=!0}};g.TilingSprite.prototype.getBounds=function(){var b=this._width,f=this._height,g=b*(1-this.anchor.x),l=b*-this.anchor.x,n=f*(1-this.anchor.y),p=f*-this.anchor.y;f=this.worldTransform;var a=f.a,c=f.b,d=f.c,e=f.d,k=f.tx,m=f.ty;f=a*l+d*p+k;b=e*p+c*l+m;var u=a*g+d*p+k;p=e*p+c*g+m;var v=a*g+d*n+k;g=e*n+c*g+m;a=a*l+
d*n+k;l=e*n+c*l+m;c=n=-Infinity;d=e=Infinity;e=f<e?f:e;e=u<e?u:e;e=v<e?v:e;e=a<e?a:e;d=b<d?b:d;d=p<d?p:d;d=g<d?g:d;d=l<d?l:d;n=f>n?f:n;n=u>n?u:n;n=v>n?v:n;c=b>c?b:c;c=p>c?p:c;c=g>c?g:c;f=this._bounds;f.x=e;f.width=(a>n?a:n)-e;f.y=d;f.height=(l>c?l:c)-d;return this._currentBounds=f};g.TilingSprite.prototype.destroy=function(){g.Sprite.prototype.destroy.call(this);this.canvasBuffer&&(this.canvasBuffer.destroy(),this.canvasBuffer=null);this.tilePosition=this.tileScaleOffset=this.tileScale=null;this.tilingTexture&&
(this.tilingTexture.destroy(!0),this.tilingTexture=null)};Object.defineProperty(g.TilingSprite.prototype,"width",{get:function(){return this._width},set:function(b){this._width=b}});Object.defineProperty(g.TilingSprite.prototype,"height",{get:function(){return this._height},set:function(b){this._height=b}});"undefined"!==typeof exports?("undefined"!==typeof module&&module.exports&&(exports=module.exports=g),exports.PIXI=g):"undefined"!==typeof define&&define.amd?define("PIXI",this.PIXI=g):this.PIXI=
g;return g}).call(this);
(function(){function g(a,c){this._scaleFactor=a;this._deltaMode=c;this.originalEvent=null}var b=b||{VERSION:"2.6.2",GAMES:[],AUTO:0,CANVAS:1,WEBGL:2,HEADLESS:3,NONE:0,LEFT:1,RIGHT:2,UP:3,DOWN:4,SPRITE:0,BUTTON:1,IMAGE:2,GRAPHICS:3,TEXT:4,TILESPRITE:5,BITMAPTEXT:6,GROUP:7,RENDERTEXTURE:8,TILEMAP:9,TILEMAPLAYER:10,EMITTER:11,POLYGON:12,BITMAPDATA:13,CANVAS_FILTER:14,WEBGL_FILTER:15,ELLIPSE:16,SPRITEBATCH:17,RETROFONT:18,POINTER:19,ROPE:20,CIRCLE:21,RECTANGLE:22,LINE:23,MATRIX:24,POINT:25,ROUNDEDRECTANGLE:26,
CREATURE:27,VIDEO:28,PENDING_ATLAS:-1,HORIZONTAL:0,VERTICAL:1,LANDSCAPE:0,PORTRAIT:1,ANGLE_UP:270,ANGLE_DOWN:90,ANGLE_LEFT:180,ANGLE_RIGHT:0,ANGLE_NORTH_EAST:315,ANGLE_NORTH_WEST:225,ANGLE_SOUTH_EAST:45,ANGLE_SOUTH_WEST:135,TOP_LEFT:0,TOP_CENTER:1,TOP_RIGHT:2,LEFT_TOP:3,LEFT_CENTER:4,LEFT_BOTTOM:5,CENTER:6,RIGHT_TOP:7,RIGHT_CENTER:8,RIGHT_BOTTOM:9,BOTTOM_LEFT:10,BOTTOM_CENTER:11,BOTTOM_RIGHT:12,blendModes:{NORMAL:0,ADD:1,MULTIPLY:2,SCREEN:3,OVERLAY:4,DARKEN:5,LIGHTEN:6,COLOR_DODGE:7,COLOR_BURN:8,
HARD_LIGHT:9,SOFT_LIGHT:10,DIFFERENCE:11,EXCLUSION:12,HUE:13,SATURATION:14,COLOR:15,LUMINOSITY:16},scaleModes:{DEFAULT:0,LINEAR:0,NEAREST:1},PIXI:PIXI||{}};Math.trunc||(Math.trunc=function(a){return 0>a?Math.ceil(a):Math.floor(a)});Function.prototype.bind||(Function.prototype.bind=function(){var a=Array.prototype.slice;return function(c){function b(){var d=k.concat(a.call(arguments));e.apply(this instanceof b?this:c,d)}var e=this,k=a.call(arguments,1);if("function"!==typeof e)throw new TypeError;
b.prototype=function v(a){a&&(v.prototype=a);if(!(this instanceof v))return new v}(e.prototype);return b}}());Array.isArray||(Array.isArray=function(a){return"[object Array]"===Object.prototype.toString.call(a)});Array.prototype.forEach||(Array.prototype.forEach=function(a){if(void 0===this||null===this)throw new TypeError;var c=Object(this),b=c.length>>>0;if("function"!==typeof a)throw new TypeError;for(var e=2<=arguments.length?arguments[1]:void 0,k=0;k<b;k++)k in c&&a.call(e,c[k],k,c)});if("function"!==
typeof window.Uint32Array&&"object"!==typeof window.Uint32Array){var f=function(a){window[a]=function(a){if("number"===typeof a){Array.call(this,a);this.length=a;for(var c=0;c<this.length;c++)this[c]=0}else for(Array.call(this,a.length),this.length=a.length,c=0;c<this.length;c++)this[c]=a[c]};window[a].prototype=[];window[a].constructor=window[a]};f("Uint32Array");f("Int16Array")}window.console||(window.console={},window.console.log=window.console.assert=function(){},window.console.warn=window.console.assert=
function(){});b.Utils={reverseString:function(a){return a.split("").reverse().join("")},getProperty:function(a,c){for(var b=c.split("."),e=b.pop(),k=b.length,m=1,f=b[0];m<k&&(a=a[f]);)f=b[m],m++;return a?a[e]:null},setProperty:function(a,c,b){c=c.split(".");for(var d=c.pop(),k=c.length,m=1,f=c[0];m<k&&(a=a[f]);)f=c[m],m++;a&&(a[d]=b);return a},chanceRoll:function(a){void 0===a&&(a=50);return 0<a&&100*Math.random()<=a},randomChoice:function(a,c){return.5>Math.random()?a:c},parseDimension:function(a,
c){if("string"===typeof a)if("%"===a.substr(-1)){var b=parseInt(a,10)/100;b=0===c?window.innerWidth*b:window.innerHeight*b}else b=parseInt(a,10);else b=a;return b},pad:function(a,c,b,e){void 0===c&&(c=0);void 0===b&&(b=" ");void 0===e&&(e=3);a=a.toString();if(c+1>=a.length)switch(e){case 1:a=Array(c+1-a.length).join(b)+a;break;case 3:e=Math.ceil((c-=a.length)/2);a=Array(c-e+1).join(b)+a+Array(e+1).join(b);break;default:a+=Array(c+1-a.length).join(b)}return a},isPlainObject:function(a){if("object"!==
typeof a||a.nodeType||a===a.window)return!1;try{if(a.constructor&&!{}.hasOwnProperty.call(a.constructor.prototype,"isPrototypeOf"))return!1}catch(c){return!1}return!0},extend:function(){var a,c,d,e=arguments[0]||{},k=1,m=arguments.length,f=!1;"boolean"===typeof e&&(f=e,e=arguments[1]||{},k=2);m===k&&(e=this,--k);for(;k<m;k++)if(null!=(a=arguments[k]))for(c in a){var g=e[c];var h=a[c];e!==h&&(f&&h&&(b.Utils.isPlainObject(h)||(d=Array.isArray(h)))?(d?(d=!1,g=g&&Array.isArray(g)?g:[]):g=g&&b.Utils.isPlainObject(g)?
g:{},e[c]=b.Utils.extend(f,g,h)):void 0!==h&&(e[c]=h))}return e},mixinPrototype:function(a,c,b){void 0===b&&(b=!1);for(var d=Object.keys(c),k=0;k<d.length;k++){var m=d[k],f=c[m];!b&&m in a||(!f||"function"!==typeof f.get&&"function"!==typeof f.set?a[m]=f:"function"===typeof f.clone?a[m]=f.clone():Object.defineProperty(a,m,f))}},mixin:function(a,c){if(!a||"object"!==typeof a)return c;for(var d in a){var e=a[d];if(!e.childNodes&&!e.cloneNode){var k=typeof a[d];c[d]=a[d]&&"object"===k?typeof c[d]===
k?b.Utils.mixin(a[d],c[d]):b.Utils.mixin(a[d],new e.constructor):a[d]}}return c}};b.Circle=function(a,c,d){d=d||0;this.x=a||0;this.y=c||0;this._diameter=d;this._radius=0;0<d&&(this._radius=.5*d);this.type=b.CIRCLE};b.Circle.prototype={circumference:function(){return 2*Math.PI*this._radius},random:function(a){void 0===a&&(a=new b.Point);var c=2*Math.PI*Math.random(),d=Math.random()+Math.random();d=1<d?2-d:d;var e=d*Math.sin(c);a.x=this.x+d*Math.cos(c)*this.radius;a.y=this.y+e*this.radius;return a},
getBounds:function(){return new b.Rectangle(this.x-this.radius,this.y-this.radius,this.diameter,this.diameter)},setTo:function(a,c,b){this.x=a;this.y=c;this._diameter=b;this._radius=.5*b;return this},copyFrom:function(a){return this.setTo(a.x,a.y,a.diameter)},copyTo:function(a){a.x=this.x;a.y=this.y;a.diameter=this._diameter;return a},distance:function(a,c){var d=b.Math.distance(this.x,this.y,a.x,a.y);return c?Math.round(d):d},clone:function(a){void 0===a||null===a?a=new b.Circle(this.x,this.y,this.diameter):
a.setTo(this.x,this.y,this.diameter);return a},contains:function(a,c){return b.Circle.contains(this,a,c)},circumferencePoint:function(a,c,d){return b.Circle.circumferencePoint(this,a,c,d)},offset:function(a,c){this.x+=a;this.y+=c;return this},offsetPoint:function(a){return this.offset(a.x,a.y)},toString:function(){return"[{Phaser.Circle (x="+this.x+" y="+this.y+" diameter="+this.diameter+" radius="+this.radius+")}]"}};b.Circle.prototype.constructor=b.Circle;Object.defineProperty(b.Circle.prototype,
"diameter",{get:function(){return this._diameter},set:function(a){0<a&&(this._diameter=a,this._radius=.5*a)}});Object.defineProperty(b.Circle.prototype,"radius",{get:function(){return this._radius},set:function(a){0<a&&(this._radius=a,this._diameter=2*a)}});Object.defineProperty(b.Circle.prototype,"left",{get:function(){return this.x-this._radius},set:function(a){a>this.x?this._diameter=this._radius=0:this.radius=this.x-a}});Object.defineProperty(b.Circle.prototype,"right",{get:function(){return this.x+
this._radius},set:function(a){a<this.x?this._diameter=this._radius=0:this.radius=a-this.x}});Object.defineProperty(b.Circle.prototype,"top",{get:function(){return this.y-this._radius},set:function(a){a>this.y?this._diameter=this._radius=0:this.radius=this.y-a}});Object.defineProperty(b.Circle.prototype,"bottom",{get:function(){return this.y+this._radius},set:function(a){a<this.y?this._diameter=this._radius=0:this.radius=a-this.y}});Object.defineProperty(b.Circle.prototype,"area",{get:function(){return 0<
this._radius?Math.PI*this._radius*this._radius:0}});Object.defineProperty(b.Circle.prototype,"empty",{get:function(){return 0===this._diameter},set:function(a){!0===a&&this.setTo(0,0,0)}});b.Circle.contains=function(a,c,b){return 0<a.radius&&c>=a.left&&c<=a.right&&b>=a.top&&b<=a.bottom?(a.x-c)*(a.x-c)+(a.y-b)*(a.y-b)<=a.radius*a.radius:!1};b.Circle.equals=function(a,c){return a.x===c.x&&a.y===c.y&&a.diameter===c.diameter};b.Circle.intersects=function(a,c){return b.Math.distance(a.x,a.y,c.x,c.y)<=
a.radius+c.radius};b.Circle.circumferencePoint=function(a,c,d,e){void 0===d&&(d=!1);void 0===e&&(e=new b.Point);!0===d&&(c=b.Math.degToRad(c));e.x=a.x+a.radius*Math.cos(c);e.y=a.y+a.radius*Math.sin(c);return e};b.Circle.intersectsRectangle=function(a,c){var b=Math.abs(a.x-c.x-c.halfWidth);if(b>c.halfWidth+a.radius)return!1;var e=Math.abs(a.y-c.y-c.halfHeight);if(e>c.halfHeight+a.radius)return!1;if(b<=c.halfWidth||e<=c.halfHeight)return!0;b-=c.halfWidth;e-=c.halfHeight;return b*b+e*e<=a.radius*a.radius};
PIXI.Circle=b.Circle;b.Ellipse=function(a,c,d,e){this.x=a||0;this.y=c||0;this.width=d||0;this.height=e||0;this.type=b.ELLIPSE};b.Ellipse.prototype={setTo:function(a,c,b,e){this.x=a;this.y=c;this.width=b;this.height=e;return this},getBounds:function(){return new b.Rectangle(this.x-this.width,this.y-this.height,this.width,this.height)},copyFrom:function(a){return this.setTo(a.x,a.y,a.width,a.height)},copyTo:function(a){a.x=this.x;a.y=this.y;a.width=this.width;a.height=this.height;return a},clone:function(a){void 0===
a||null===a?a=new b.Ellipse(this.x,this.y,this.width,this.height):a.setTo(this.x,this.y,this.width,this.height);return a},contains:function(a,c){return b.Ellipse.contains(this,a,c)},random:function(a){void 0===a&&(a=new b.Point);var c=Math.random()*Math.PI*2,d=Math.random();a.x=Math.sqrt(d)*Math.cos(c);a.y=Math.sqrt(d)*Math.sin(c);a.x=this.x+a.x*this.width/2;a.y=this.y+a.y*this.height/2;return a},toString:function(){return"[{Phaser.Ellipse (x="+this.x+" y="+this.y+" width="+this.width+" height="+
this.height+")}]"}};b.Ellipse.prototype.constructor=b.Ellipse;Object.defineProperty(b.Ellipse.prototype,"left",{get:function(){return this.x},set:function(a){this.x=a}});Object.defineProperty(b.Ellipse.prototype,"right",{get:function(){return this.x+this.width},set:function(a){this.width=a<this.x?0:a-this.x}});Object.defineProperty(b.Ellipse.prototype,"top",{get:function(){return this.y},set:function(a){this.y=a}});Object.defineProperty(b.Ellipse.prototype,"bottom",{get:function(){return this.y+this.height},
set:function(a){this.height=a<this.y?0:a-this.y}});Object.defineProperty(b.Ellipse.prototype,"empty",{get:function(){return 0===this.width||0===this.height},set:function(a){!0===a&&this.setTo(0,0,0,0)}});b.Ellipse.contains=function(a,c,b){if(0>=a.width||0>=a.height)return!1;c=(c-a.x)/a.width-.5;a=(b-a.y)/a.height-.5;return.25>c*c+a*a};PIXI.Ellipse=b.Ellipse;b.Line=function(a,c,d,e){d=d||0;e=e||0;this.start=new b.Point(a||0,c||0);this.end=new b.Point(d,e);this.type=b.LINE};b.Line.prototype={setTo:function(a,
c,b,e){this.start.setTo(a,c);this.end.setTo(b,e);return this},fromSprite:function(a,c,b){void 0===b&&(b=!1);return b?this.setTo(a.center.x,a.center.y,c.center.x,c.center.y):this.setTo(a.x,a.y,c.x,c.y)},fromAngle:function(a,c,b,e){this.start.setTo(a,c);this.end.setTo(a+Math.cos(b)*e,c+Math.sin(b)*e);return this},rotate:function(a,c){var b=(this.start.x+this.end.x)/2,e=(this.start.y+this.end.y)/2;this.start.rotate(b,e,a,c);this.end.rotate(b,e,a,c);return this},rotateAround:function(a,c,b,e){this.start.rotate(a,
c,b,e);this.end.rotate(a,c,b,e);return this},intersects:function(a,c,d){return b.Line.intersectsPoints(this.start,this.end,a.start,a.end,c,d)},reflect:function(a){return b.Line.reflect(this,a)},midPoint:function(a){void 0===a&&(a=new b.Point);a.x=(this.start.x+this.end.x)/2;a.y=(this.start.y+this.end.y)/2;return a},centerOn:function(a,c){var b=a-(this.start.x+this.end.x)/2,e=c-(this.start.y+this.end.y)/2;this.start.add(b,e);this.end.add(b,e)},pointOnLine:function(a,c){return(a-this.start.x)*(this.end.y-
this.start.y)===(this.end.x-this.start.x)*(c-this.start.y)},pointOnSegment:function(a,c){var b=Math.min(this.start.x,this.end.x),e=Math.max(this.start.x,this.end.x),k=Math.min(this.start.y,this.end.y),m=Math.max(this.start.y,this.end.y);return this.pointOnLine(a,c)&&a>=b&&a<=e&&c>=k&&c<=m},random:function(a){void 0===a&&(a=new b.Point);var c=Math.random();a.x=this.start.x+c*(this.end.x-this.start.x);a.y=this.start.y+c*(this.end.y-this.start.y);return a},coordinatesOnLine:function(a,c){void 0===a&&
(a=1);void 0===c&&(c=[]);var b=Math.round(this.start.x),e=Math.round(this.start.y),k=Math.round(this.end.x),m=Math.round(this.end.y),f=Math.abs(k-b),g=Math.abs(m-e),h=b<k?1:-1,t=e<m?1:-1,l=f-g;c.push([b,e]);for(var n=1;b!==k||e!==m;){var p=l<<1;p>-g&&(l-=g,b+=h);p<f&&(l+=f,e+=t);0===n%a&&c.push([b,e]);n++}return c},clone:function(a){void 0===a||null===a?a=new b.Line(this.start.x,this.start.y,this.end.x,this.end.y):a.setTo(this.start.x,this.start.y,this.end.x,this.end.y);return a}};Object.defineProperty(b.Line.prototype,
"length",{get:function(){return Math.sqrt((this.end.x-this.start.x)*(this.end.x-this.start.x)+(this.end.y-this.start.y)*(this.end.y-this.start.y))}});Object.defineProperty(b.Line.prototype,"angle",{get:function(){return Math.atan2(this.end.y-this.start.y,this.end.x-this.start.x)}});Object.defineProperty(b.Line.prototype,"slope",{get:function(){return(this.end.y-this.start.y)/(this.end.x-this.start.x)}});Object.defineProperty(b.Line.prototype,"perpSlope",{get:function(){return-((this.end.x-this.start.x)/
(this.end.y-this.start.y))}});Object.defineProperty(b.Line.prototype,"x",{get:function(){return Math.min(this.start.x,this.end.x)}});Object.defineProperty(b.Line.prototype,"y",{get:function(){return Math.min(this.start.y,this.end.y)}});Object.defineProperty(b.Line.prototype,"left",{get:function(){return Math.min(this.start.x,this.end.x)}});Object.defineProperty(b.Line.prototype,"right",{get:function(){return Math.max(this.start.x,this.end.x)}});Object.defineProperty(b.Line.prototype,"top",{get:function(){return Math.min(this.start.y,
this.end.y)}});Object.defineProperty(b.Line.prototype,"bottom",{get:function(){return Math.max(this.start.y,this.end.y)}});Object.defineProperty(b.Line.prototype,"width",{get:function(){return Math.abs(this.start.x-this.end.x)}});Object.defineProperty(b.Line.prototype,"height",{get:function(){return Math.abs(this.start.y-this.end.y)}});Object.defineProperty(b.Line.prototype,"normalX",{get:function(){return Math.cos(this.angle-1.5707963267948966)}});Object.defineProperty(b.Line.prototype,"normalY",
{get:function(){return Math.sin(this.angle-1.5707963267948966)}});Object.defineProperty(b.Line.prototype,"normalAngle",{get:function(){return b.Math.wrap(this.angle-1.5707963267948966,-Math.PI,Math.PI)}});b.Line.intersectsPoints=function(a,c,d,e,k,m){void 0===k&&(k=!0);void 0===m&&(m=new b.Point);var f=c.y-a.y,g=e.y-d.y,h=a.x-c.x,t=d.x-e.x,l=c.x*a.y-a.x*c.y,n=e.x*d.y-d.x*e.y,p=f*t-g*h;if(0===p)return null;m.x=(h*n-t*l)/p;m.y=(g*l-f*n)/p;return!k||(k=(e.y-d.y)*(c.x-a.x)-(e.x-d.x)*(c.y-a.y),e=((e.x-
d.x)*(a.y-d.y)-(e.y-d.y)*(a.x-d.x))/k,a=((c.x-a.x)*(a.y-d.y)-(c.y-a.y)*(a.x-d.x))/k,0<=e&&1>=e&&0<=a&&1>=a)?m:null};b.Line.intersects=function(a,c,d,e){return b.Line.intersectsPoints(a.start,a.end,c.start,c.end,d,e)};b.Line.intersectsRectangle=function(a,c){if(!b.Rectangle.intersects(a,c))return!1;var d=a.start.x,e=a.start.y,k=a.end.x,m=a.end.y,f=c.x,g=c.y,h=c.right,t=c.bottom;if(d>=f&&d<=h&&e>=g&&e<=t||k>=f&&k<=h&&m>=g&&m<=t)return!0;if(d<f&&k>=f){var l=e+(m-e)*(f-d)/(k-d);if(l>g&&l<=t)return!0}else if(d>
h&&k<=h&&(l=e+(m-e)*(h-d)/(k-d),l>=g&&l<=t))return!0;if(e<g&&m>=g){if(l=d+(k-d)*(g-e)/(m-e),l>=f&&l<=h)return!0}else if(e>t&&m<=t&&(l=d+(k-d)*(t-e)/(m-e),l>=f&&l<=h))return!0;return!1};b.Line.reflect=function(a,c){return 2*c.normalAngle-3.141592653589793-a.angle};b.Matrix=function(a,c,d,e,k,m){if(void 0===a||null===a)a=1;if(void 0===c||null===c)c=0;if(void 0===d||null===d)d=0;if(void 0===e||null===e)e=1;if(void 0===k||null===k)k=0;if(void 0===m||null===m)m=0;this.a=a;this.b=c;this.c=d;this.d=e;this.tx=
k;this.ty=m;this.type=b.MATRIX};b.Matrix.prototype={fromArray:function(a){return this.setTo(a[0],a[1],a[3],a[4],a[2],a[5])},setTo:function(a,c,b,e,k,m){this.a=a;this.b=c;this.c=b;this.d=e;this.tx=k;this.ty=m;return this},clone:function(a){void 0===a||null===a?a=new b.Matrix(this.a,this.b,this.c,this.d,this.tx,this.ty):(a.a=this.a,a.b=this.b,a.c=this.c,a.d=this.d,a.tx=this.tx,a.ty=this.ty);return a},copyTo:function(a){a.copyFrom(this);return a},copyFrom:function(a){this.a=a.a;this.b=a.b;this.c=a.c;
this.d=a.d;this.tx=a.tx;this.ty=a.ty;return this},toArray:function(a,c){void 0===c&&(c=new PIXI.Float32Array(9));a?(c[0]=this.a,c[1]=this.b,c[2]=0,c[3]=this.c,c[4]=this.d,c[5]=0,c[6]=this.tx,c[7]=this.ty):(c[0]=this.a,c[1]=this.c,c[2]=this.tx,c[3]=this.b,c[4]=this.d,c[5]=this.ty,c[6]=0,c[7]=0);c[8]=1;return c},apply:function(a,c){void 0===c&&(c=new b.Point);c.x=this.a*a.x+this.c*a.y+this.tx;c.y=this.b*a.x+this.d*a.y+this.ty;return c},applyInverse:function(a,c){void 0===c&&(c=new b.Point);var d=1/
(this.a*this.d+this.c*-this.b),e=a.x,k=a.y;c.x=this.d*d*e+-this.c*d*k+(this.ty*this.c-this.tx*this.d)*d;c.y=this.a*d*k+-this.b*d*e+(-this.ty*this.a+this.tx*this.b)*d;return c},translate:function(a,c){this.tx+=a;this.ty+=c;return this},scale:function(a,c){this.a*=a;this.d*=c;this.c*=a;this.b*=c;this.tx*=a;this.ty*=c;return this},rotate:function(a){var c=Math.cos(a);a=Math.sin(a);var b=this.a,e=this.c,k=this.tx;this.a=b*c-this.b*a;this.b=b*a+this.b*c;this.c=e*c-this.d*a;this.d=e*a+this.d*c;this.tx=
k*c-this.ty*a;this.ty=k*a+this.ty*c;return this},append:function(a){var c=this.a,b=this.b,e=this.c,k=this.d;this.a=a.a*c+a.b*e;this.b=a.a*b+a.b*k;this.c=a.c*c+a.d*e;this.d=a.c*b+a.d*k;this.tx=a.tx*c+a.ty*e+this.tx;this.ty=a.tx*b+a.ty*k+this.ty;return this},identity:function(){return this.setTo(1,0,0,1,0,0)}};b.identityMatrix=new b.Matrix;PIXI.Matrix=b.Matrix;PIXI.identityMatrix=b.identityMatrix;b.Point=function(a,c){this.x=a||0;this.y=c||0;this.type=b.POINT};b.Point.prototype={copyFrom:function(a){return this.setTo(a.x,
a.y)},invert:function(){return this.setTo(this.y,this.x)},setTo:function(a,c){this.x=a||0;this.y=c||(0!==c?this.x:0);return this},set:function(a,c){this.x=a||0;this.y=c||(0!==c?this.x:0);return this},add:function(a,c){this.x+=a;this.y+=c;return this},subtract:function(a,c){this.x-=a;this.y-=c;return this},multiply:function(a,c){this.x*=a;this.y*=c;return this},divide:function(a,c){this.x/=a;this.y/=c;return this},clampX:function(a,c){this.x=b.Math.clamp(this.x,a,c);return this},clampY:function(a,
c){this.y=b.Math.clamp(this.y,a,c);return this},clamp:function(a,c){this.x=b.Math.clamp(this.x,a,c);this.y=b.Math.clamp(this.y,a,c);return this},clone:function(a){void 0===a||null===a?a=new b.Point(this.x,this.y):a.setTo(this.x,this.y);return a},copyTo:function(a){a.x=this.x;a.y=this.y;return a},distance:function(a,c){return b.Point.distance(this,a,c)},equals:function(a){return a.x===this.x&&a.y===this.y},angle:function(a,c){void 0===c&&(c=!1);return c?b.Math.radToDeg(Math.atan2(a.y-this.y,a.x-this.x)):
Math.atan2(a.y-this.y,a.x-this.x)},rotate:function(a,c,d,e,k){return b.Point.rotate(this,a,c,d,e,k)},getMagnitude:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},getMagnitudeSq:function(){return this.x*this.x+this.y*this.y},setMagnitude:function(a){return this.normalize().multiply(a,a)},normalize:function(){if(!this.isZero()){var a=this.getMagnitude();this.x/=a;this.y/=a}return this},isZero:function(){return 0===this.x&&0===this.y},dot:function(a){return this.x*a.x+this.y*a.y},cross:function(a){return this.x*
a.y-this.y*a.x},perp:function(){return this.setTo(-this.y,this.x)},rperp:function(){return this.setTo(this.y,-this.x)},normalRightHand:function(){return this.setTo(-1*this.y,this.x)},floor:function(){return this.setTo(Math.floor(this.x),Math.floor(this.y))},ceil:function(){return this.setTo(Math.ceil(this.x),Math.ceil(this.y))},toString:function(){return"[{Point (x="+this.x+" y="+this.y+")}]"}};b.Point.prototype.constructor=b.Point;b.Point.add=function(a,c,d){void 0===d&&(d=new b.Point);d.x=a.x+c.x;
d.y=a.y+c.y;return d};b.Point.subtract=function(a,c,d){void 0===d&&(d=new b.Point);d.x=a.x-c.x;d.y=a.y-c.y;return d};b.Point.multiply=function(a,c,d){void 0===d&&(d=new b.Point);d.x=a.x*c.x;d.y=a.y*c.y;return d};b.Point.divide=function(a,c,d){void 0===d&&(d=new b.Point);d.x=a.x/c.x;d.y=a.y/c.y;return d};b.Point.equals=function(a,c){return a.x===c.x&&a.y===c.y};b.Point.angle=function(a,c){return Math.atan2(a.y-c.y,a.x-c.x)};b.Point.negative=function(a,c){void 0===c&&(c=new b.Point);return c.setTo(-a.x,
-a.y)};b.Point.multiplyAdd=function(a,c,d,e){void 0===e&&(e=new b.Point);return e.setTo(a.x+c.x*d,a.y+c.y*d)};b.Point.interpolate=function(a,c,d,e){void 0===e&&(e=new b.Point);return e.setTo(a.x+(c.x-a.x)*d,a.y+(c.y-a.y)*d)};b.Point.perp=function(a,c){void 0===c&&(c=new b.Point);return c.setTo(-a.y,a.x)};b.Point.rperp=function(a,c){void 0===c&&(c=new b.Point);return c.setTo(a.y,-a.x)};b.Point.distance=function(a,c,d){a=b.Math.distance(a.x,a.y,c.x,c.y);return d?Math.round(a):a};b.Point.project=function(a,
c,d){void 0===d&&(d=new b.Point);a=a.dot(c)/c.getMagnitudeSq();0!==a&&d.setTo(a*c.x,a*c.y);return d};b.Point.projectUnit=function(a,c,d){void 0===d&&(d=new b.Point);a=a.dot(c);0!==a&&d.setTo(a*c.x,a*c.y);return d};b.Point.normalRightHand=function(a,c){void 0===c&&(c=new b.Point);return c.setTo(-1*a.y,a.x)};b.Point.normalize=function(a,c){void 0===c&&(c=new b.Point);var d=a.getMagnitude();0!==d&&c.setTo(a.x/d,a.y/d);return c};b.Point.rotate=function(a,c,d,e,k,m){k&&(e=b.Math.degToRad(e));void 0===
m?(a.subtract(c,d),m=Math.sin(e),e=Math.cos(e),k=m*a.x+e*a.y,a.x=e*a.x-m*a.y+c,a.y=k+d):(e+=Math.atan2(a.y-d,a.x-c),a.x=c+m*Math.cos(e),a.y=d+m*Math.sin(e));return a};b.Point.centroid=function(a,c){void 0===c&&(c=new b.Point);if("[object Array]"!==Object.prototype.toString.call(a))throw Error("Phaser.Point. Parameter 'points' must be an array");var d=a.length;if(1>d)throw Error("Phaser.Point. Parameter 'points' array must not be empty");if(1===d)return c.copyFrom(a[0]),c;for(var e=0;e<d;e++)b.Point.add(c,
a[e],c);c.divide(d,d);return c};b.Point.parse=function(a,c,d){c=c||"x";d=d||"y";var e=new b.Point;a[c]&&(e.x=parseInt(a[c],10));a[d]&&(e.y=parseInt(a[d],10));return e};PIXI.Point=b.Point;b.Polygon=function(){this.area=0;this._points=[];0<arguments.length&&this.setTo.apply(this,arguments);this.closed=!0;this.flattened=!1;this.type=b.POLYGON};b.Polygon.prototype={toNumberArray:function(a){void 0===a&&(a=[]);for(var c=0;c<this._points.length;c++)"number"===typeof this._points[c]?(a.push(this._points[c]),
a.push(this._points[c+1]),c++):(a.push(this._points[c].x),a.push(this._points[c].y));return a},flatten:function(){this._points=this.toNumberArray();this.flattened=!0;return this},clone:function(a){var c=this._points.slice();void 0===a||null===a?a=new b.Polygon(c):a.setTo(c);return a},contains:function(a,c){var b=!1;if(this.flattened)for(var e=-2,k=this._points.length-2;(e+=2)<this._points.length;k=e){var m=this._points[e],f=this._points[e+1],g=this._points[k];k=this._points[k+1];(f<=c&&c<k||k<=c&&
c<f)&&a<(g-m)*(c-f)/(k-f)+m&&(b=!b)}else for(e=-1,k=this._points.length-1;++e<this._points.length;k=e)m=this._points[e].x,f=this._points[e].y,g=this._points[k].x,k=this._points[k].y,(f<=c&&c<k||k<=c&&c<f)&&a<(g-m)*(c-f)/(k-f)+m&&(b=!b);return b},setTo:function(a){this.area=0;this._points=[];if(0<arguments.length){Array.isArray(a)||(a=Array.prototype.slice.call(arguments));for(var c=Number.MAX_VALUE,b=0,e=a.length;b<e;b++){if("number"===typeof a[b]){var k=new PIXI.Point(a[b],a[b+1]);b++}else k=Array.isArray(a[b])?
new PIXI.Point(a[b][0],a[b][1]):new PIXI.Point(a[b].x,a[b].y);this._points.push(k);k.y<c&&(c=k.y)}this.calculateArea(c)}return this},calculateArea:function(a){for(var c,b,e,k=0,m=this._points.length;k<m;k++)c=this._points[k],b=k===m-1?this._points[0]:this._points[k+1],e=(c.y-a+(b.y-a))/2,c=c.x-b.x,this.area+=e*c;return this.area}};b.Polygon.prototype.constructor=b.Polygon;Object.defineProperty(b.Polygon.prototype,"points",{get:function(){return this._points},set:function(a){null!=a?this.setTo(a):
this.setTo()}});PIXI.Polygon=b.Polygon;b.Rectangle=function(a,c,d,e){this.x=a||0;this.y=c||0;this.width=d||0;this.height=e||0;this.type=b.RECTANGLE};b.Rectangle.prototype={offset:function(a,c){this.x+=a;this.y+=c;return this},offsetPoint:function(a){return this.offset(a.x,a.y)},setTo:function(a,c,b,e){this.x=a;this.y=c;this.width=b;this.height=e;return this},scale:function(a,c){void 0===c&&(c=a);this.width*=a;this.height*=c;return this},centerOn:function(a,c){this.centerX=a;this.centerY=c;return this},
floor:function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y)},floorAll:function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);this.width=Math.floor(this.width);this.height=Math.floor(this.height)},ceil:function(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y)},ceilAll:function(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);this.width=Math.ceil(this.width);this.height=Math.ceil(this.height)},copyFrom:function(a){return this.setTo(a.x,a.y,a.width,a.height)},copyTo:function(a){a.x=
this.x;a.y=this.y;a.width=this.width;a.height=this.height;return a},inflate:function(a,c){return b.Rectangle.inflate(this,a,c)},size:function(a){return b.Rectangle.size(this,a)},resize:function(a,c){this.width=a;this.height=c;return this},clone:function(a){return b.Rectangle.clone(this,a)},contains:function(a,c){return b.Rectangle.contains(this,a,c)},containsRect:function(a){return b.Rectangle.containsRect(a,this)},equals:function(a){return b.Rectangle.equals(this,a)},intersection:function(a,c){return b.Rectangle.intersection(this,
a,c)},intersects:function(a){return b.Rectangle.intersects(this,a)},intersectsRaw:function(a,c,d,e,k){return b.Rectangle.intersectsRaw(this,a,c,d,e,k)},union:function(a,c){return b.Rectangle.union(this,a,c)},random:function(a){void 0===a&&(a=new b.Point);a.x=this.randomX;a.y=this.randomY;return a},getPoint:function(a,c){void 0===c&&(c=new b.Point);switch(a){default:case b.TOP_LEFT:return c.set(this.x,this.y);case b.TOP_CENTER:return c.set(this.centerX,this.y);case b.TOP_RIGHT:return c.set(this.right,
this.y);case b.LEFT_CENTER:return c.set(this.x,this.centerY);case b.CENTER:return c.set(this.centerX,this.centerY);case b.RIGHT_CENTER:return c.set(this.right,this.centerY);case b.BOTTOM_LEFT:return c.set(this.x,this.bottom);case b.BOTTOM_CENTER:return c.set(this.centerX,this.bottom);case b.BOTTOM_RIGHT:return c.set(this.right,this.bottom)}},toString:function(){return"[{Rectangle (x="+this.x+" y="+this.y+" width="+this.width+" height="+this.height+" empty="+this.empty+")}]"}};Object.defineProperty(b.Rectangle.prototype,
"halfWidth",{get:function(){return Math.round(this.width/2)}});Object.defineProperty(b.Rectangle.prototype,"halfHeight",{get:function(){return Math.round(this.height/2)}});Object.defineProperty(b.Rectangle.prototype,"bottom",{get:function(){return this.y+this.height},set:function(a){this.height=a<=this.y?0:a-this.y}});Object.defineProperty(b.Rectangle.prototype,"bottomLeft",{get:function(){return new b.Point(this.x,this.bottom)},set:function(a){this.x=a.x;this.bottom=a.y}});Object.defineProperty(b.Rectangle.prototype,
"bottomRight",{get:function(){return new b.Point(this.right,this.bottom)},set:function(a){this.right=a.x;this.bottom=a.y}});Object.defineProperty(b.Rectangle.prototype,"left",{get:function(){return this.x},set:function(a){this.width=a>=this.right?0:this.right-a;this.x=a}});Object.defineProperty(b.Rectangle.prototype,"right",{get:function(){return this.x+this.width},set:function(a){this.width=a<=this.x?0:a-this.x}});Object.defineProperty(b.Rectangle.prototype,"volume",{get:function(){return this.width*
this.height}});Object.defineProperty(b.Rectangle.prototype,"perimeter",{get:function(){return 2*this.width+2*this.height}});Object.defineProperty(b.Rectangle.prototype,"centerX",{get:function(){return this.x+this.halfWidth},set:function(a){this.x=a-this.halfWidth}});Object.defineProperty(b.Rectangle.prototype,"centerY",{get:function(){return this.y+this.halfHeight},set:function(a){this.y=a-this.halfHeight}});Object.defineProperty(b.Rectangle.prototype,"randomX",{get:function(){return this.x+Math.random()*
this.width}});Object.defineProperty(b.Rectangle.prototype,"randomY",{get:function(){return this.y+Math.random()*this.height}});Object.defineProperty(b.Rectangle.prototype,"top",{get:function(){return this.y},set:function(a){a>=this.bottom?(this.height=0,this.y=a):this.height=this.bottom-a}});Object.defineProperty(b.Rectangle.prototype,"topLeft",{get:function(){return new b.Point(this.x,this.y)},set:function(a){this.x=a.x;this.y=a.y}});Object.defineProperty(b.Rectangle.prototype,"topRight",{get:function(){return new b.Point(this.x+
this.width,this.y)},set:function(a){this.right=a.x;this.y=a.y}});Object.defineProperty(b.Rectangle.prototype,"empty",{get:function(){return!this.width||!this.height},set:function(a){!0===a&&this.setTo(0,0,0,0)}});b.Rectangle.prototype.constructor=b.Rectangle;b.Rectangle.inflate=function(a,c,b){a.x-=c;a.width+=2*c;a.y-=b;a.height+=2*b;return a};b.Rectangle.inflatePoint=function(a,c){return b.Rectangle.inflate(a,c.x,c.y)};b.Rectangle.size=function(a,c){void 0===c||null===c?c=new b.Point(a.width,a.height):
c.setTo(a.width,a.height);return c};b.Rectangle.clone=function(a,c){void 0===c||null===c?c=new b.Rectangle(a.x,a.y,a.width,a.height):c.setTo(a.x,a.y,a.width,a.height);return c};b.Rectangle.contains=function(a,c,b){return 0>=a.width||0>=a.height?!1:c>=a.x&&c<a.right&&b>=a.y&&b<a.bottom};b.Rectangle.containsRaw=function(a,c,b,e,k,m){return k>=a&&k<a+b&&m>=c&&m<c+e};b.Rectangle.containsPoint=function(a,c){return b.Rectangle.contains(a,c.x,c.y)};b.Rectangle.containsRect=function(a,c){return a.volume>
c.volume?!1:a.x>=c.x&&a.y>=c.y&&a.right<c.right&&a.bottom<c.bottom};b.Rectangle.equals=function(a,c){return a.x===c.x&&a.y===c.y&&a.width===c.width&&a.height===c.height};b.Rectangle.sameDimensions=function(a,c){return a.width===c.width&&a.height===c.height};b.Rectangle.intersection=function(a,c,d){void 0===d&&(d=new b.Rectangle);b.Rectangle.intersects(a,c)&&(d.x=Math.max(a.x,c.x),d.y=Math.max(a.y,c.y),d.width=Math.min(a.right,c.right)-d.x,d.height=Math.min(a.bottom,c.bottom)-d.y);return d};b.Rectangle.intersects=
function(a,c){return 0>=a.width||0>=a.height||0>=c.width||0>=c.height?!1:!(a.right<c.x||a.bottom<c.y||a.x>c.right||a.y>c.bottom)};b.Rectangle.intersectsRaw=function(a,c,b,e,k,m){void 0===m&&(m=0);return!(c>a.right+m||b<a.left-m||e>a.bottom+m||k<a.top-m)};b.Rectangle.union=function(a,c,d){void 0===d&&(d=new b.Rectangle);return d.setTo(Math.min(a.x,c.x),Math.min(a.y,c.y),Math.max(a.right,c.right)-Math.min(a.left,c.left),Math.max(a.bottom,c.bottom)-Math.min(a.top,c.top))};b.Rectangle.aabb=function(a,
c){void 0===c&&(c=new b.Rectangle);var d=Number.NEGATIVE_INFINITY,e=Number.POSITIVE_INFINITY,k=Number.NEGATIVE_INFINITY,m=Number.POSITIVE_INFINITY;a.forEach(function(a){a.x>d&&(d=a.x);a.x<e&&(e=a.x);a.y>k&&(k=a.y);a.y<m&&(m=a.y)});c.setTo(e,m,d-e,k-m);return c};PIXI.Rectangle=b.Rectangle;PIXI.EmptyRectangle=new b.Rectangle(0,0,0,0);b.RoundedRectangle=function(a,c,d,e,k){void 0===a&&(a=0);void 0===c&&(c=0);void 0===d&&(d=0);void 0===e&&(e=0);void 0===k&&(k=20);this.x=a;this.y=c;this.width=d;this.height=
e;this.radius=k||20;this.type=b.ROUNDEDRECTANGLE};b.RoundedRectangle.prototype={clone:function(){return new b.RoundedRectangle(this.x,this.y,this.width,this.height,this.radius)},contains:function(a,c){if(0>=this.width||0>=this.height)return!1;var b=this.x;return a>=b&&a<=b+this.width&&(b=this.y,c>=b&&c<=b+this.height)?!0:!1}};b.RoundedRectangle.prototype.constructor=b.RoundedRectangle;PIXI.RoundedRectangle=b.RoundedRectangle;b.Camera=function(a,c,d,e,k,m){this.game=a;this.world=a.world;this.id=0;
this.view=new b.Rectangle(d,e,k,m);this.bounds=new b.Rectangle(d,e,k,m);this.deadzone=null;this.roundPx=this.visible=!0;this.atLimit={x:!1,y:!1};this.scale=this.displayObject=this.target=null;this.totalInView=0;this.lerp=new b.Point(1,1);this.onShakeComplete=new b.Signal;this.onFlashComplete=new b.Signal;this.onFadeComplete=new b.Signal;this.fx=null;this._targetPosition=new b.Point;this._edge=0;this._position=new b.Point;this._shake={intensity:0,duration:0,horizontal:!1,vertical:!1,shakeBounds:!0,
x:0,y:0};this._fxType=this._fxDuration=0};b.Camera.FOLLOW_LOCKON=0;b.Camera.FOLLOW_PLATFORMER=1;b.Camera.FOLLOW_TOPDOWN=2;b.Camera.FOLLOW_TOPDOWN_TIGHT=3;b.Camera.SHAKE_BOTH=4;b.Camera.SHAKE_HORIZONTAL=5;b.Camera.SHAKE_VERTICAL=6;b.Camera.ENABLE_FX=!0;b.Camera.prototype={boot:function(){this.displayObject=this.game.world;this.scale=this.game.world.scale;this.game.camera=this;b.Graphics&&b.Camera.ENABLE_FX&&(this.fx=new b.Graphics(this.game),this.game.stage.addChild(this.fx))},preUpdate:function(){this.totalInView=
0},follow:function(a,c,d,e){void 0===c&&(c=b.Camera.FOLLOW_LOCKON);void 0===d&&(d=1);void 0===e&&(e=1);this.target=a;this.lerp.set(d,e);switch(c){case b.Camera.FOLLOW_PLATFORMER:a=this.width/8;c=this.height/3;this.deadzone=new b.Rectangle((this.width-a)/2,(this.height-c)/2-.25*c,a,c);break;case b.Camera.FOLLOW_TOPDOWN:a=Math.max(this.width,this.height)/4;this.deadzone=new b.Rectangle((this.width-a)/2,(this.height-a)/2,a,a);break;case b.Camera.FOLLOW_TOPDOWN_TIGHT:a=Math.max(this.width,this.height)/
8;this.deadzone=new b.Rectangle((this.width-a)/2,(this.height-a)/2,a,a);break;case b.Camera.FOLLOW_LOCKON:this.deadzone=null;break;default:this.deadzone=null}},unfollow:function(){this.target=null},focusOn:function(a){this.setPosition(Math.round(a.x-this.view.halfWidth),Math.round(a.y-this.view.halfHeight))},focusOnXY:function(a,c){this.setPosition(Math.round(a-this.view.halfWidth),Math.round(c-this.view.halfHeight))},shake:function(a,c,d,e,k){void 0===a&&(a=.05);void 0===c&&(c=500);void 0===d&&(d=
!0);void 0===e&&(e=b.Camera.SHAKE_BOTH);void 0===k&&(k=!0);if(!d&&0<this._shake.duration)return!1;this._shake.intensity=a;this._shake.duration=c;this._shake.shakeBounds=k;this._shake.x=0;this._shake.y=0;this._shake.horizontal=e===b.Camera.SHAKE_BOTH||e===b.Camera.SHAKE_HORIZONTAL;this._shake.vertical=e===b.Camera.SHAKE_BOTH||e===b.Camera.SHAKE_VERTICAL;return!0},flash:function(a,c,b){void 0===a&&(a=16777215);void 0===c&&(c=500);void 0===b&&(b=!1);if(!this.fx||!b&&0<this._fxDuration)return!1;this.fx.clear();
this.fx.beginFill(a);this.fx.drawRect(0,0,this.width,this.height);this.fx.endFill();this.fx.alpha=1;this._fxDuration=c;this._fxType=0;return!0},fade:function(a,c,b){void 0===a&&(a=0);void 0===c&&(c=500);void 0===b&&(b=!1);if(!this.fx||!b&&0<this._fxDuration)return!1;this.fx.clear();this.fx.beginFill(a);this.fx.drawRect(0,0,this.width,this.height);this.fx.endFill();this.fx.alpha=0;this._fxDuration=c;this._fxType=1;return!0},update:function(){0<this._fxDuration&&this.updateFX();0<this._shake.duration&&
this.updateShake();this.bounds&&this.checkBounds();this.roundPx&&(this.view.floor(),this._shake.x=Math.floor(this._shake.x),this._shake.y=Math.floor(this._shake.y));this.displayObject.position.x=-this.view.x;this.displayObject.position.y=-this.view.y},updateFX:function(){0===this._fxType?(this.fx.alpha-=this.game.time.elapsedMS/this._fxDuration,0>=this.fx.alpha&&(this._fxDuration=0,this.fx.alpha=0,this.onFlashComplete.dispatch())):(this.fx.alpha+=this.game.time.elapsedMS/this._fxDuration,1<=this.fx.alpha&&
(this._fxDuration=0,this.fx.alpha=1,this.onFadeComplete.dispatch()))},updateShake:function(){this._shake.duration-=this.game.time.elapsedMS;0>=this._shake.duration?(this.onShakeComplete.dispatch(),this._shake.x=0,this._shake.y=0):(this._shake.horizontal&&(this._shake.x=this.game.rnd.frac()*this._shake.intensity*this.view.width*2-this._shake.intensity*this.view.width),this._shake.vertical&&(this._shake.y=this.game.rnd.frac()*this._shake.intensity*this.view.height*2-this._shake.intensity*this.view.height))},
updateTarget:function(){this._targetPosition.x=this.view.x+this.target.worldPosition.x;this._targetPosition.y=this.view.y+this.target.worldPosition.y;this.deadzone?(this._edge=this._targetPosition.x-this.view.x,this._edge<this.deadzone.left?this.view.x=this.game.math.linear(this.view.x,this._targetPosition.x-this.deadzone.left,this.lerp.x):this._edge>this.deadzone.right&&(this.view.x=this.game.math.linear(this.view.x,this._targetPosition.x-this.deadzone.right,this.lerp.x)),this._edge=this._targetPosition.y-
this.view.y,this._edge<this.deadzone.top?this.view.y=this.game.math.linear(this.view.y,this._targetPosition.y-this.deadzone.top,this.lerp.y):this._edge>this.deadzone.bottom&&(this.view.y=this.game.math.linear(this.view.y,this._targetPosition.y-this.deadzone.bottom,this.lerp.y))):(this.view.x=this.game.math.linear(this.view.x,this._targetPosition.x-this.view.halfWidth,this.lerp.x),this.view.y=this.game.math.linear(this.view.y,this._targetPosition.y-this.view.halfHeight,this.lerp.y));this.bounds&&this.checkBounds();
this.roundPx&&this.view.floor();this.displayObject.position.x=-this.view.x;this.displayObject.position.y=-this.view.y},setBoundsToWorld:function(){this.bounds&&this.bounds.copyFrom(this.game.world.bounds)},checkBounds:function(){this.atLimit.x=!1;this.atLimit.y=!1;var a=this.view.right+this._shake.x,c=this.view.y+this._shake.y,b=this.view.bottom+this._shake.y;this.view.x+this._shake.x<=this.bounds.x*this.scale.x&&(this.atLimit.x=!0,this.view.x=this.bounds.x*this.scale.x,this._shake.shakeBounds||(this._shake.x=
0));a>=this.bounds.right*this.scale.x&&(this.atLimit.x=!0,this.view.x=this.bounds.right*this.scale.x-this.width,this._shake.shakeBounds||(this._shake.x=0));c<=this.bounds.top*this.scale.y&&(this.atLimit.y=!0,this.view.y=this.bounds.top*this.scale.y,this._shake.shakeBounds||(this._shake.y=0));b>=this.bounds.bottom*this.scale.y&&(this.atLimit.y=!0,this.view.y=this.bounds.bottom*this.scale.y-this.height,this._shake.shakeBounds||(this._shake.y=0))},setPosition:function(a,c){this.view.x=a;this.view.y=
c;this.bounds&&this.checkBounds()},setSize:function(a,c){this.view.width=a;this.view.height=c},reset:function(){this.target=null;this.view.x=0;this.view.y=0;this._shake.duration=0;this.resetFX()},resetFX:function(){this.fx.clear();this._fxDuration=this.fx.alpha=0}};b.Camera.prototype.constructor=b.Camera;Object.defineProperty(b.Camera.prototype,"x",{get:function(){return this.view.x},set:function(a){this.view.x=a;this.bounds&&this.checkBounds()}});Object.defineProperty(b.Camera.prototype,"y",{get:function(){return this.view.y},
set:function(a){this.view.y=a;this.bounds&&this.checkBounds()}});Object.defineProperty(b.Camera.prototype,"position",{get:function(){this._position.set(this.view.x,this.view.y);return this._position},set:function(a){"undefined"!==typeof a.x&&(this.view.x=a.x);"undefined"!==typeof a.y&&(this.view.y=a.y);this.bounds&&this.checkBounds()}});Object.defineProperty(b.Camera.prototype,"width",{get:function(){return this.view.width},set:function(a){this.view.width=a}});Object.defineProperty(b.Camera.prototype,
"height",{get:function(){return this.view.height},set:function(a){this.view.height=a}});Object.defineProperty(b.Camera.prototype,"shakeIntensity",{get:function(){return this._shake.intensity},set:function(a){this._shake.intensity=a}});b.State=function(){this.game=null;this.key="";this.rnd=this.physics=this.particles=this.world=this.tweens=this.time=this.state=this.stage=this.scale=this.sound=this.math=this.load=this.input=this.cache=this.camera=this.make=this.add=null};b.State.prototype={init:function(){},
preload:function(){},loadUpdate:function(){},loadRender:function(){},create:function(){},update:function(){},preRender:function(){},render:function(){},resize:function(){},paused:function(){},resumed:function(){},pauseUpdate:function(){},shutdown:function(){}};b.State.prototype.constructor=b.State;b.StateManager=function(a,c){this.game=a;this.states={};this._pendingState=null;"undefined"!==typeof c&&null!==c&&(this._pendingState=c);this._created=this._clearCache=this._clearWorld=!1;this._args=[];
this.current="";this.onStateChange=new b.Signal;this.onShutDownCallback=this.onPauseUpdateCallback=this.onResumedCallback=this.onPausedCallback=this.onLoadRenderCallback=this.onLoadUpdateCallback=this.onPreRenderCallback=this.onResizeCallback=this.onRenderCallback=this.onUpdateCallback=this.onCreateCallback=this.onPreloadCallback=this.onInitCallback=null};b.StateManager.prototype={boot:function(){this.game.onPause.add(this.pause,this);this.game.onResume.add(this.resume,this);null!==this._pendingState&&
"string"!==typeof this._pendingState&&this.add("default",this._pendingState,!0)},add:function(a,c,d){void 0===d&&(d=!1);if(c instanceof b.State)var e=c;else"object"===typeof c?(e=c,e.game=this.game):"function"===typeof c&&(e=new c(this.game));this.states[a]=e;d&&(this.game.isBooted?this.start(a):this._pendingState=a);return e},remove:function(a){this.current===a&&(this.onPauseUpdateCallback=this.onResumedCallback=this.onPausedCallback=this.onResizeCallback=this.onRenderCallback=this.onPreRenderCallback=
this.onUpdateCallback=this.onCreateCallback=this.onLoadUpdateCallback=this.onLoadRenderCallback=this.onPreloadCallback=this.onShutDownCallback=this.onInitCallback=this.callbackContext=null);delete this.states[a]},start:function(a,c,b){void 0===c&&(c=!0);void 0===b&&(b=!1);this.checkState(a)&&(this._pendingState=a,this._clearWorld=c,this._clearCache=b,3<arguments.length&&(this._args=Array.prototype.splice.call(arguments,3)))},restart:function(a,c){void 0===a&&(a=!0);void 0===c&&(c=!1);this._pendingState=
this.current;this._clearWorld=a;this._clearCache=c;2<arguments.length&&(this._args=Array.prototype.slice.call(arguments,2))},dummy:function(){},preUpdate:function(){if(this._pendingState&&this.game.isBooted){var a=this.current;this.clearCurrentState();this.setCurrentState(this._pendingState);this.onStateChange.dispatch(this.current,a);this.current===this._pendingState&&(this._pendingState=null,this.onPreloadCallback?(this.game.load.reset(!0),this.onPreloadCallback.call(this.callbackContext,this.game),
0===this.game.load.totalQueuedFiles()&&0===this.game.load.totalQueuedPacks()?this.loadComplete():this.game.load.start()):this.loadComplete())}},clearCurrentState:function(){this.current&&(this.onShutDownCallback&&this.onShutDownCallback.call(this.callbackContext,this.game),this.game.tweens.removeAll(),this.game.camera.reset(),this.game.input.reset(!0),this.game.physics.clear(),this.game.time.removeAll(),this.game.scale.reset(this._clearWorld),this.game.debug&&this.game.debug.reset(),this._clearWorld&&
(this.game.world.shutdown(),this._clearCache&&this.game.cache.destroy()))},checkState:function(a){if(this.states[a]){if(this.states[a].preload||this.states[a].create||this.states[a].update||this.states[a].render)return!0;console.warn("Invalid Phaser State object given. Must contain at least a one of the required functions: preload, create, update or render");return!1}console.warn("Phaser.StateManager - No state found with the key: "+a);return!1},link:function(a){this.states[a].game=this.game;this.states[a].add=
this.game.add;this.states[a].make=this.game.make;this.states[a].camera=this.game.camera;this.states[a].cache=this.game.cache;this.states[a].input=this.game.input;this.states[a].load=this.game.load;this.states[a].math=this.game.math;this.states[a].sound=this.game.sound;this.states[a].scale=this.game.scale;this.states[a].state=this;this.states[a].stage=this.game.stage;this.states[a].time=this.game.time;this.states[a].tweens=this.game.tweens;this.states[a].world=this.game.world;this.states[a].particles=
this.game.particles;this.states[a].rnd=this.game.rnd;this.states[a].physics=this.game.physics;this.states[a].key=a},unlink:function(a){this.states[a]&&(this.states[a].game=null,this.states[a].add=null,this.states[a].make=null,this.states[a].camera=null,this.states[a].cache=null,this.states[a].input=null,this.states[a].load=null,this.states[a].math=null,this.states[a].sound=null,this.states[a].scale=null,this.states[a].state=null,this.states[a].stage=null,this.states[a].time=null,this.states[a].tweens=
null,this.states[a].world=null,this.states[a].particles=null,this.states[a].rnd=null,this.states[a].physics=null)},setCurrentState:function(a){this.callbackContext=this.states[a];this.link(a);this.onInitCallback=this.states[a].init||this.dummy;this.onPreloadCallback=this.states[a].preload||null;this.onLoadRenderCallback=this.states[a].loadRender||null;this.onLoadUpdateCallback=this.states[a].loadUpdate||null;this.onCreateCallback=this.states[a].create||null;this.onUpdateCallback=this.states[a].update||
null;this.onPreRenderCallback=this.states[a].preRender||null;this.onRenderCallback=this.states[a].render||null;this.onResizeCallback=this.states[a].resize||null;this.onPausedCallback=this.states[a].paused||null;this.onResumedCallback=this.states[a].resumed||null;this.onPauseUpdateCallback=this.states[a].pauseUpdate||null;this.onShutDownCallback=this.states[a].shutdown||this.dummy;""!==this.current&&this.game.physics.reset();this.current=a;this._created=!1;this.onInitCallback.apply(this.callbackContext,
this._args);a===this._pendingState&&(this._args=[]);this.game._kickstart=!0},getCurrentState:function(){return this.states[this.current]},loadComplete:function(){!1===this._created&&this.onLoadUpdateCallback&&this.onLoadUpdateCallback.call(this.callbackContext,this.game);!1===this._created&&this.onCreateCallback?(this._created=!0,this.onCreateCallback.call(this.callbackContext,this.game)):this._created=!0},pause:function(){this._created&&this.onPausedCallback&&this.onPausedCallback.call(this.callbackContext,
this.game)},resume:function(){this._created&&this.onResumedCallback&&this.onResumedCallback.call(this.callbackContext,this.game)},update:function(){this._created?this.onUpdateCallback&&this.onUpdateCallback.call(this.callbackContext,this.game):this.onLoadUpdateCallback&&this.onLoadUpdateCallback.call(this.callbackContext,this.game)},pauseUpdate:function(){this._created?this.onPauseUpdateCallback&&this.onPauseUpdateCallback.call(this.callbackContext,this.game):this.onLoadUpdateCallback&&this.onLoadUpdateCallback.call(this.callbackContext,
this.game)},preRender:function(a){this._created&&this.onPreRenderCallback&&this.onPreRenderCallback.call(this.callbackContext,this.game,a)},resize:function(a,c){this.onResizeCallback&&this.onResizeCallback.call(this.callbackContext,a,c)},render:function(){this._created?this.onRenderCallback&&(this.game.renderType===b.CANVAS?(this.game.context.save(),this.game.context.setTransform(1,0,0,1,0,0),this.onRenderCallback.call(this.callbackContext,this.game),this.game.context.restore()):this.onRenderCallback.call(this.callbackContext,
this.game)):this.onLoadRenderCallback&&this.onLoadRenderCallback.call(this.callbackContext,this.game)},destroy:function(){this._clearCache=this._clearWorld=!0;this.clearCurrentState();this.game=this.onPauseUpdateCallback=this.onResumedCallback=this.onPausedCallback=this.onRenderCallback=this.onUpdateCallback=this.onCreateCallback=this.onLoadUpdateCallback=this.onLoadRenderCallback=this.onPreloadCallback=this.onShutDownCallback=this.onInitCallback=this.callbackContext=null;this.states={};this._pendingState=
null;this.current=""}};b.StateManager.prototype.constructor=b.StateManager;Object.defineProperty(b.StateManager.prototype,"created",{get:function(){return this._created}});b.Signal=function(){};b.Signal.prototype={_bindings:null,_prevParams:null,memorize:!1,_shouldPropagate:!0,active:!0,_boundDispatch:!1,validateListener:function(a,c){if("function"!==typeof a)throw Error("Phaser.Signal: listener is a required param of {fn}() and should be a Function.".replace("{fn}",c));},_registerListener:function(a,
c,d,e,k){var m=this._indexOfListener(a,d);if(-1!==m){if(a=this._bindings[m],a.isOnce()!==c)throw Error("You cannot add"+(c?"":"Once")+"() then add"+(c?"Once":"")+"() the same listener without removing the relationship first.");}else a=new b.SignalBinding(this,a,c,d,e,k),this._addBinding(a);this.memorize&&this._prevParams&&a.execute(this._prevParams);return a},_addBinding:function(a){this._bindings||(this._bindings=[]);var c=this._bindings.length;do c--;while(this._bindings[c]&&a._priority<=this._bindings[c]._priority);
this._bindings.splice(c+1,0,a)},_indexOfListener:function(a,c){if(!this._bindings)return-1;void 0===c&&(c=null);for(var b=this._bindings.length,e;b--;)if(e=this._bindings[b],e._listener===a&&e.context===c)return b;return-1},has:function(a,c){return-1!==this._indexOfListener(a,c)},add:function(a,c,b){this.validateListener(a,"add");var d=[];if(3<arguments.length)for(var k=3;k<arguments.length;k++)d.push(arguments[k]);return this._registerListener(a,!1,c,b,d)},addOnce:function(a,c,b){this.validateListener(a,
"addOnce");var d=[];if(3<arguments.length)for(var k=3;k<arguments.length;k++)d.push(arguments[k]);return this._registerListener(a,!0,c,b,d)},remove:function(a,c){this.validateListener(a,"remove");var b=this._indexOfListener(a,c);-1!==b&&(this._bindings[b]._destroy(),this._bindings.splice(b,1));return a},removeAll:function(a){void 0===a&&(a=null);if(this._bindings){for(var c=this._bindings.length;c--;)a?this._bindings[c].context===a&&(this._bindings[c]._destroy(),this._bindings.splice(c,1)):this._bindings[c]._destroy();
a||(this._bindings.length=0)}},getNumListeners:function(){return this._bindings?this._bindings.length:0},halt:function(){this._shouldPropagate=!1},dispatch:function(){if(this.active&&this._bindings){var a=Array.prototype.slice.call(arguments),c=this._bindings.length;this.memorize&&(this._prevParams=a);if(c){var b=this._bindings.slice();this._shouldPropagate=!0;do c--;while(b[c]&&this._shouldPropagate&&!1!==b[c].execute(a))}}},forget:function(){this._prevParams&&(this._prevParams=null)},dispose:function(){this.removeAll();
this._bindings=null;this._prevParams&&(this._prevParams=null)},toString:function(){return"[Phaser.Signal active:"+this.active+" numListeners:"+this.getNumListeners()+"]"}};Object.defineProperty(b.Signal.prototype,"boundDispatch",{get:function(){var a=this;return this._boundDispatch||(this._boundDispatch=function(){return a.dispatch.apply(a,arguments)})}});b.Signal.prototype.constructor=b.Signal;b.SignalBinding=function(a,c,b,e,k,m){this._listener=c;b&&(this._isOnce=!0);null!=e&&(this.context=e);this._signal=
a;k&&(this._priority=k);m&&m.length&&(this._args=m)};b.SignalBinding.prototype={context:null,_isOnce:!1,_priority:0,_args:null,callCount:0,active:!0,params:null,execute:function(a){if(this.active&&this._listener){a=this.params?this.params.concat(a):a;this._args&&(a=a.concat(this._args));var c=this._listener.apply(this.context,a);this.callCount++;this._isOnce&&this.detach()}return c},detach:function(){return this.isBound()?this._signal.remove(this._listener,this.context):null},isBound:function(){return!!this._signal&&
!!this._listener},isOnce:function(){return this._isOnce},getListener:function(){return this._listener},getSignal:function(){return this._signal},_destroy:function(){delete this._signal;delete this._listener;delete this.context},toString:function(){return"[Phaser.SignalBinding isOnce:"+this._isOnce+", isBound:"+this.isBound()+", active:"+this.active+"]"}};b.SignalBinding.prototype.constructor=b.SignalBinding;b.Filter=function(a,c,d){this.game=a;this.type=b.WEBGL_FILTER;this.passes=[this];this.shaders=
[];this.dirty=!0;this.padding=0;this.prevPoint=new b.Point;a=new Date;this.uniforms={resolution:{type:"2f",value:{x:256,y:256}},time:{type:"1f",value:0},mouse:{type:"2f",value:{x:0,y:0}},date:{type:"4fv",value:[a.getFullYear(),a.getMonth(),a.getDate(),3600*a.getHours()+60*a.getMinutes()+a.getSeconds()]},sampleRate:{type:"1f",value:44100},iChannel0:{type:"sampler2D",value:null,textureData:{repeat:!0}},iChannel1:{type:"sampler2D",value:null,textureData:{repeat:!0}},iChannel2:{type:"sampler2D",value:null,
textureData:{repeat:!0}},iChannel3:{type:"sampler2D",value:null,textureData:{repeat:!0}}};if(c)for(var e in c)this.uniforms[e]=c[e];this.fragmentSrc=d||""};b.Filter.prototype={init:function(){},setResolution:function(a,c){this.uniforms.resolution.value.x=a;this.uniforms.resolution.value.y=c},update:function(a){if("undefined"!==typeof a){var c=a.x/this.game.width;a=1-a.y/this.game.height;if(c!==this.prevPoint.x||a!==this.prevPoint.y)this.uniforms.mouse.value.x=c.toFixed(2),this.uniforms.mouse.value.y=
a.toFixed(2),this.prevPoint.set(c,a)}this.uniforms.time.value=this.game.time.totalElapsedSeconds()},addToWorld:function(a,c,b,e,k,m){void 0===k&&(k=0);void 0===m&&(m=0);void 0!==b&&null!==b?this.width=b:b=this.width;void 0!==e&&null!==e?this.height=e:e=this.height;a=this.game.add.image(a,c,"__default");a.width=b;a.height=e;a.anchor.set(k,m);a.filters=[this];return a},destroy:function(){this.game=null}};b.Filter.prototype.constructor=b.Filter;Object.defineProperty(b.Filter.prototype,"width",{get:function(){return this.uniforms.resolution.value.x},
set:function(a){this.uniforms.resolution.value.x=a}});Object.defineProperty(b.Filter.prototype,"height",{get:function(){return this.uniforms.resolution.value.y},set:function(a){this.uniforms.resolution.value.y=a}});b.Plugin=function(a,c){void 0===c&&(c=null);this.game=a;this.parent=c;this.hasPostRender=this.hasRender=this.hasPostUpdate=this.hasUpdate=this.hasPreUpdate=this.visible=this.active=!1};b.Plugin.prototype={preUpdate:function(){},update:function(){},render:function(){},postRender:function(){},
destroy:function(){this.parent=this.game=null;this.visible=this.active=!1}};b.Plugin.prototype.constructor=b.Plugin;b.PluginManager=function(a){this.game=a;this.plugins=[];this._i=this._len=0};b.PluginManager.prototype={add:function(a){var c=Array.prototype.slice.call(arguments,1),b=!1;"function"===typeof a?a=new a(this.game,this):(a.game=this.game,a.parent=this);"function"===typeof a.preUpdate&&(b=a.hasPreUpdate=!0);"function"===typeof a.update&&(b=a.hasUpdate=!0);"function"===typeof a.postUpdate&&
(b=a.hasPostUpdate=!0);"function"===typeof a.render&&(b=a.hasRender=!0);"function"===typeof a.postRender&&(b=a.hasPostRender=!0);if(b){if(a.hasPreUpdate||a.hasUpdate||a.hasPostUpdate)a.active=!0;if(a.hasRender||a.hasPostRender)a.visible=!0;this._len=this.plugins.push(a);"function"===typeof a.init&&a.init.apply(a,c);return a}return null},remove:function(a,c){void 0===c&&(c=!0);for(this._i=this._len;this._i--;)if(this.plugins[this._i]===a){c&&a.destroy();this.plugins.splice(this._i,1);this._len--;break}},
removeAll:function(){for(this._i=this._len;this._i--;)this.plugins[this._i].destroy();this._len=this.plugins.length=0},preUpdate:function(){for(this._i=this._len;this._i--;)this.plugins[this._i].active&&this.plugins[this._i].hasPreUpdate&&this.plugins[this._i].preUpdate()},update:function(){for(this._i=this._len;this._i--;)this.plugins[this._i].active&&this.plugins[this._i].hasUpdate&&this.plugins[this._i].update()},postUpdate:function(){for(this._i=this._len;this._i--;)this.plugins[this._i].active&&
this.plugins[this._i].hasPostUpdate&&this.plugins[this._i].postUpdate()},render:function(){for(this._i=this._len;this._i--;)this.plugins[this._i].visible&&this.plugins[this._i].hasRender&&this.plugins[this._i].render()},postRender:function(){for(this._i=this._len;this._i--;)this.plugins[this._i].visible&&this.plugins[this._i].hasPostRender&&this.plugins[this._i].postRender()},destroy:function(){this.removeAll();this.game=null}};b.PluginManager.prototype.constructor=b.PluginManager;b.Stage=function(a){this.game=
a;PIXI.DisplayObjectContainer.call(this);this.name="_stage_root";this.disableVisibilityChange=!1;this.exists=!0;this.worldTransform=new PIXI.Matrix;this.stage=this;this.currentRenderOrderID=0;this._hiddenVar="hidden";this._onChange=null;this._bgColor={r:0,g:0,b:0,a:0,color:0,rgba:"#000000"};this.game.transparent||(this._bgColor.a=1);a.config&&this.parseConfig(a.config)};b.Stage.prototype=Object.create(PIXI.DisplayObjectContainer.prototype);b.Stage.prototype.constructor=b.Stage;b.Stage.prototype.parseConfig=
function(a){a.disableVisibilityChange&&(this.disableVisibilityChange=a.disableVisibilityChange);a.backgroundColor&&this.setBackgroundColor(a.backgroundColor)};b.Stage.prototype.boot=function(){b.DOM.getOffset(this.game.canvas,this.offset);b.Canvas.setUserSelect(this.game.canvas,"none");b.Canvas.setTouchAction(this.game.canvas,"none");this.checkVisibility()};b.Stage.prototype.preUpdate=function(){for(var a=this.currentRenderOrderID=0;a<this.children.length;a++)this.children[a].preUpdate()};b.Stage.prototype.update=
function(){for(var a=this.children.length;a--;)this.children[a].update()};b.Stage.prototype.postUpdate=function(){this.game.camera.update();this.game.camera.target&&(this.game.camera.target.postUpdate(),this.updateTransform(),this.game.camera.updateTarget());for(var a=0;a<this.children.length;a++)this.children[a].postUpdate();this.updateTransform()};b.Stage.prototype.updateTransform=function(){this.worldAlpha=1;for(var a=0;a<this.children.length;a++)this.children[a].updateTransform()};b.Stage.prototype.checkVisibility=
function(){this._hiddenVar=void 0!==document.hidden?"visibilitychange":void 0!==document.webkitHidden?"webkitvisibilitychange":void 0!==document.mozHidden?"mozvisibilitychange":void 0!==document.msHidden?"msvisibilitychange":null;var a=this;this._onChange=function(c){return a.visibilityChange(c)};this._hiddenVar&&document.addEventListener(this._hiddenVar,this._onChange,!1);window.onblur=this._onChange;window.onfocus=this._onChange;window.onpagehide=this._onChange;window.onpageshow=this._onChange;
this.game.device.cocoonJSApp&&(CocoonJS.App.onSuspended.addEventListener(function(){b.Stage.prototype.visibilityChange.call(a,{type:"pause"})}),CocoonJS.App.onActivated.addEventListener(function(){b.Stage.prototype.visibilityChange.call(a,{type:"resume"})}))};b.Stage.prototype.visibilityChange=function(a){"pagehide"===a.type||"blur"===a.type||"pageshow"===a.type||"focus"===a.type?"pagehide"===a.type||"blur"===a.type?this.game.focusLoss(a):("pageshow"===a.type||"focus"===a.type)&&this.game.focusGain(a):
this.disableVisibilityChange||(document.hidden||document.mozHidden||document.msHidden||document.webkitHidden||"pause"===a.type?this.game.gamePaused(a):this.game.gameResumed(a))};b.Stage.prototype.setBackgroundColor=function(a){this.game.transparent||(b.Color.valueToColor(a,this._bgColor),b.Color.updateColor(this._bgColor),this._bgColor.r/=255,this._bgColor.g/=255,this._bgColor.b/=255,this._bgColor.a=1)};b.Stage.prototype.destroy=function(){this._hiddenVar&&document.removeEventListener(this._hiddenVar,
this._onChange,!1);window.onpagehide=null;window.onpageshow=null;window.onblur=null;window.onfocus=null};Object.defineProperty(b.Stage.prototype,"backgroundColor",{get:function(){return this._bgColor.color},set:function(a){this.setBackgroundColor(a)}});Object.defineProperty(b.Stage.prototype,"smoothed",{get:function(){return PIXI.scaleModes.DEFAULT===PIXI.scaleModes.LINEAR},set:function(a){PIXI.scaleModes.DEFAULT=a?PIXI.scaleModes.LINEAR:PIXI.scaleModes.NEAREST}});b.Group=function(a,c,d,e,k,m){void 0===
e&&(e=!1);void 0===k&&(k=!1);void 0===m&&(m=b.Physics.ARCADE);this.game=a;void 0===c&&(c=a.world);this.name=d||"group";this.z=0;PIXI.DisplayObjectContainer.call(this);e?(this.game.stage.addChild(this),this.z=this.game.stage.children.length):c&&(c.addChild(this),this.z=c.children.length);this.physicsType=this.type=b.GROUP;this.exists=this.alive=!0;this.pendingDestroy=this.ignoreDestroy=!1;this.classType=b.Sprite;this.cursor=null;this.inputEnableChildren=!1;this.onChildInputDown=new b.Signal;this.onChildInputUp=
new b.Signal;this.onChildInputOver=new b.Signal;this.onChildInputOut=new b.Signal;this.enableBody=k;this.enableBodyDebug=!1;this.physicsBodyType=m;this.physicsSortDirection=null;this.onDestroy=new b.Signal;this.cursorIndex=0;this.fixedToCamera=!1;this.cameraOffset=new b.Point;this.hash=[];this._sortProperty="z"};b.Group.prototype=Object.create(PIXI.DisplayObjectContainer.prototype);b.Group.prototype.constructor=b.Group;b.Group.RETURN_NONE=0;b.Group.RETURN_TOTAL=1;b.Group.RETURN_CHILD=2;b.Group.RETURN_ALL=
3;b.Group.SORT_ASCENDING=-1;b.Group.SORT_DESCENDING=1;b.Group.prototype.add=function(a,c,b){void 0===c&&(c=!1);if(a.parent===this)return a;a.body&&a.parent&&a.parent.hash&&a.parent.removeFromHash(a);void 0===b?(a.z=this.children.length,this.addChild(a)):(this.addChildAt(a,b),this.updateZ());this.enableBody&&a.hasOwnProperty("body")&&null===a.body?this.game.physics.enable(a,this.physicsBodyType):a.body&&this.addToHash(a);!this.inputEnableChildren||a.input&&!a.inputEnabled||(a.inputEnabled=!0);if(!c&&
a.events)a.events.onAddedToGroup$dispatch(a,this);null===this.cursor&&(this.cursor=a);return a};b.Group.prototype.addAt=function(a,c,b){this.add(a,b,c)};b.Group.prototype.addToHash=function(a){return a.parent===this&&-1===this.hash.indexOf(a)?(this.hash.push(a),!0):!1};b.Group.prototype.removeFromHash=function(a){return a&&(a=this.hash.indexOf(a),-1!==a)?(this.hash.splice(a,1),!0):!1};b.Group.prototype.addMultiple=function(a,c){if(a instanceof b.Group)a.moveAll(this,c);else if(Array.isArray(a))for(var d=
0;d<a.length;d++)this.add(a[d],c);return a};b.Group.prototype.getAt=function(a){return 0>a||a>=this.children.length?-1:this.getChildAt(a)};b.Group.prototype.create=function(a,c,b,e,k,m){void 0===k&&(k=!0);a=new this.classType(this.game,a,c,b,e);a.exists=k;a.visible=k;a.alive=k;return this.add(a,!1,m)};b.Group.prototype.createMultiple=function(a,c,b,e){void 0===b&&(b=0);void 0===e&&(e=!1);Array.isArray(c)||(c=[c]);Array.isArray(b)||(b=[b]);var d=this,m=[];c.forEach(function(c){b.forEach(function(b){for(var k=
0;k<a;k++)m.push(d.create(0,0,c,b,e))})});return m};b.Group.prototype.updateZ=function(){for(var a=this.children.length;a--;)this.children[a].z=a};b.Group.prototype.align=function(a,c,d,e,k,m){void 0===k&&(k=b.TOP_LEFT);void 0===m&&(m=0);if(0===this.children.length||m>this.children.length||-1===a&&-1===c)return!1;for(var f=new b.Rectangle(0,0,d,e),g=a*d,h=c*e;m<this.children.length;m++){var t=this.children[m];if(t.alignIn)if(t.alignIn(f,k),-1===a)f.y+=e,f.y===h&&(f.x+=d,f.y=0);else if(-1===c)f.x+=
d,f.x===g&&(f.x=0,f.y+=e);else if(f.x+=d,f.x===g&&(f.x=0,f.y+=e,f.y===h))break}return!0};b.Group.prototype.resetCursor=function(a){void 0===a&&(a=0);a>this.children.length-1&&(a=0);if(this.cursor)return this.cursorIndex=a,this.cursor=this.children[this.cursorIndex]};b.Group.prototype.next=function(){if(this.cursor)return this.cursorIndex>=this.children.length-1?this.cursorIndex=0:this.cursorIndex++,this.cursor=this.children[this.cursorIndex]};b.Group.prototype.previous=function(){if(this.cursor)return 0===
this.cursorIndex?this.cursorIndex=this.children.length-1:this.cursorIndex--,this.cursor=this.children[this.cursorIndex]};b.Group.prototype.swap=function(a,c){this.swapChildren(a,c);this.updateZ()};b.Group.prototype.bringToTop=function(a){a.parent===this&&this.getIndex(a)<this.children.length&&(this.remove(a,!1,!0),this.add(a,!0));return a};b.Group.prototype.sendToBack=function(a){a.parent===this&&0<this.getIndex(a)&&(this.remove(a,!1,!0),this.addAt(a,0,!0));return a};b.Group.prototype.moveUp=function(a){if(a.parent===
this&&this.getIndex(a)<this.children.length-1){var c=this.getIndex(a);(c=this.getAt(c+1))&&this.swap(a,c)}return a};b.Group.prototype.moveDown=function(a){if(a.parent===this&&0<this.getIndex(a)){var c=this.getIndex(a);(c=this.getAt(c-1))&&this.swap(a,c)}return a};b.Group.prototype.xy=function(a,c,b){if(0>a||a>this.children.length)return-1;this.getChildAt(a).x=c;this.getChildAt(a).y=b};b.Group.prototype.reverse=function(){this.children.reverse();this.updateZ()};b.Group.prototype.getIndex=function(a){return this.children.indexOf(a)};
b.Group.prototype.getByName=function(a){for(var c=0;c<this.children.length;c++)if(this.children[c].name===a)return this.children[c];return null};b.Group.prototype.replace=function(a,c){var d=this.getIndex(a);if(-1!==d)return c.parent&&(c.parent instanceof b.Group?c.parent.remove(c):c.parent.removeChild(c)),this.remove(a),this.addAt(c,d),a};b.Group.prototype.hasProperty=function(a,c){var b=c.length;return 1===b&&c[0]in a||2===b&&c[0]in a&&c[1]in a[c[0]]||3===b&&c[0]in a&&c[1]in a[c[0]]&&c[2]in a[c[0]][c[1]]||
4===b&&c[0]in a&&c[1]in a[c[0]]&&c[2]in a[c[0]][c[1]]&&c[3]in a[c[0]][c[1]][c[2]]?!0:!1};b.Group.prototype.setProperty=function(a,c,b,e,k){void 0===k&&(k=!1);e=e||0;if(!this.hasProperty(a,c)&&(!k||0<e))return!1;k=c.length;1===k?0===e?a[c[0]]=b:1===e?a[c[0]]+=b:2===e?a[c[0]]-=b:3===e?a[c[0]]*=b:4===e&&(a[c[0]]/=b):2===k?0===e?a[c[0]][c[1]]=b:1===e?a[c[0]][c[1]]+=b:2===e?a[c[0]][c[1]]-=b:3===e?a[c[0]][c[1]]*=b:4===e&&(a[c[0]][c[1]]/=b):3===k?0===e?a[c[0]][c[1]][c[2]]=b:1===e?a[c[0]][c[1]][c[2]]+=b:
2===e?a[c[0]][c[1]][c[2]]-=b:3===e?a[c[0]][c[1]][c[2]]*=b:4===e&&(a[c[0]][c[1]][c[2]]/=b):4===k&&(0===e?a[c[0]][c[1]][c[2]][c[3]]=b:1===e?a[c[0]][c[1]][c[2]][c[3]]+=b:2===e?a[c[0]][c[1]][c[2]][c[3]]-=b:3===e?a[c[0]][c[1]][c[2]][c[3]]*=b:4===e&&(a[c[0]][c[1]][c[2]][c[3]]/=b));return!0};b.Group.prototype.checkProperty=function(a,c,d,e){void 0===e&&(e=!1);return!b.Utils.getProperty(a,c)&&e||b.Utils.getProperty(a,c)!==d?!1:!0};b.Group.prototype.set=function(a,c,b,e,k,m,f){void 0===f&&(f=!1);c=c.split(".");
void 0===e&&(e=!1);void 0===k&&(k=!1);if((!1===e||e&&a.alive)&&(!1===k||k&&a.visible))return this.setProperty(a,c,b,m,f)};b.Group.prototype.setAll=function(a,c,b,e,k,m){void 0===b&&(b=!1);void 0===e&&(e=!1);void 0===m&&(m=!1);a=a.split(".");k=k||0;for(var d=0;d<this.children.length;d++)(!b||b&&this.children[d].alive)&&(!e||e&&this.children[d].visible)&&this.setProperty(this.children[d],a,c,k,m)};b.Group.prototype.setAllChildren=function(a,c,d,e,k,m){void 0===d&&(d=!1);void 0===e&&(e=!1);void 0===
m&&(m=!1);k=k||0;for(var f=0;f<this.children.length;f++)(!d||d&&this.children[f].alive)&&(!e||e&&this.children[f].visible)&&(this.children[f]instanceof b.Group?this.children[f].setAllChildren(a,c,d,e,k,m):this.setProperty(this.children[f],a.split("."),c,k,m))};b.Group.prototype.checkAll=function(a,c,b,e,k){void 0===b&&(b=!1);void 0===e&&(e=!1);void 0===k&&(k=!1);for(var d=0;d<this.children.length;d++)if((!b||b&&this.children[d].alive)&&(!e||e&&this.children[d].visible)&&!this.checkProperty(this.children[d],
a,c,k))return!1;return!0};b.Group.prototype.addAll=function(a,c,b,e){this.setAll(a,c,b,e,1)};b.Group.prototype.subAll=function(a,c,b,e){this.setAll(a,c,b,e,2)};b.Group.prototype.multiplyAll=function(a,c,b,e){this.setAll(a,c,b,e,3)};b.Group.prototype.divideAll=function(a,c,b,e){this.setAll(a,c,b,e,4)};b.Group.prototype.callAllExists=function(a,c){if(2<arguments.length){var b=[];for(var e=2;e<arguments.length;e++)b.push(arguments[e])}for(e=0;e<this.children.length;e++)this.children[e].exists===c&&this.children[e][a]&&
this.children[e][a].apply(this.children[e],b)};b.Group.prototype.callbackFromArray=function(a,c,b){if(1===b){if(a[c[0]])return a[c[0]]}else if(2===b){if(a[c[0]][c[1]])return a[c[0]][c[1]]}else if(3===b){if(a[c[0]][c[1]][c[2]])return a[c[0]][c[1]][c[2]]}else if(4===b){if(a[c[0]][c[1]][c[2]][c[3]])return a[c[0]][c[1]][c[2]][c[3]]}else if(a[c])return a[c];return!1};b.Group.prototype.callAll=function(a,c){if(void 0!==a){a=a.split(".");var b=a.length;if(void 0===c||null===c||""===c)c=null;else if("string"===
typeof c){c=c.split(".");var e=c.length}if(2<arguments.length){var k=[];for(var m=2;m<arguments.length;m++)k.push(arguments[m])}for(m=0;m<this.children.length;m++){var f=this.callbackFromArray(this.children[m],a,b);if(c&&f){var g=this.callbackFromArray(this.children[m],c,e);f&&f.apply(g,k)}else f&&f.apply(this.children[m],k)}}};b.Group.prototype.preUpdate=function(){if(this.pendingDestroy)return this.destroy(),!1;if(!this.exists||!this.parent.exists)return this.renderOrderID=-1,!1;for(var a=0;a<this.children.length;a++)this.children[a].preUpdate();
return!0};b.Group.prototype.update=function(){for(var a=this.children.length;a--;)this.children[a].update()};b.Group.prototype.postUpdate=function(){this.fixedToCamera&&(this.x=this.game.camera.view.x+this.cameraOffset.x,this.y=this.game.camera.view.y+this.cameraOffset.y);for(var a=0;a<this.children.length;a++)this.children[a].postUpdate()};b.Group.prototype.filter=function(a,c){for(var d=-1,e=this.children.length,k=[];++d<e;){var m=this.children[d];(!c||c&&m.exists)&&a(m,d,this.children)&&k.push(m)}return new b.ArraySet(k)};
b.Group.prototype.forEach=function(a,c,b){void 0===b&&(b=!1);if(3>=arguments.length)for(var d=0;d<this.children.length;d++)(!b||b&&this.children[d].exists)&&a.call(c,this.children[d]);else{var k=[null];for(d=3;d<arguments.length;d++)k.push(arguments[d]);for(d=0;d<this.children.length;d++)if(!b||b&&this.children[d].exists)k[0]=this.children[d],a.apply(c,k)}};b.Group.prototype.forEachExists=function(a,c){if(2<arguments.length){var d=[null];for(var e=2;e<arguments.length;e++)d.push(arguments[e])}this.iterate("exists",
!0,b.Group.RETURN_TOTAL,a,c,d)};b.Group.prototype.forEachAlive=function(a,c){if(2<arguments.length){var d=[null];for(var e=2;e<arguments.length;e++)d.push(arguments[e])}this.iterate("alive",!0,b.Group.RETURN_TOTAL,a,c,d)};b.Group.prototype.forEachDead=function(a,c){if(2<arguments.length){var d=[null];for(var e=2;e<arguments.length;e++)d.push(arguments[e])}this.iterate("alive",!1,b.Group.RETURN_TOTAL,a,c,d)};b.Group.prototype.sort=function(a,c){2>this.children.length||(void 0===a&&(a="z"),void 0===
c&&(c=b.Group.SORT_ASCENDING),this._sortProperty=a,c===b.Group.SORT_ASCENDING?this.children.sort(this.ascendingSortHandler.bind(this)):this.children.sort(this.descendingSortHandler.bind(this)),this.updateZ())};b.Group.prototype.customSort=function(a,c){2>this.children.length||(this.children.sort(a.bind(c)),this.updateZ())};b.Group.prototype.ascendingSortHandler=function(a,c){return a[this._sortProperty]<c[this._sortProperty]?-1:a[this._sortProperty]>c[this._sortProperty]?1:a.z<c.z?-1:1};b.Group.prototype.descendingSortHandler=
function(a,c){return a[this._sortProperty]<c[this._sortProperty]?1:a[this._sortProperty]>c[this._sortProperty]?-1:0};b.Group.prototype.iterate=function(a,c,d,e,k,m){if(0===this.children.length){if(d===b.Group.RETURN_TOTAL)return 0;if(d===b.Group.RETURN_ALL)return[]}var f=0;if(d===b.Group.RETURN_ALL)var g=[];for(var h=0;h<this.children.length;h++)if(this.children[h][a]===c){f++;e&&(m?(m[0]=this.children[h],e.apply(k,m)):e.call(k,this.children[h]));if(d===b.Group.RETURN_CHILD)return this.children[h];
d===b.Group.RETURN_ALL&&g.push(this.children[h])}return d===b.Group.RETURN_TOTAL?f:d===b.Group.RETURN_ALL?g:null};b.Group.prototype.getFirstExists=function(a,c,d,e,k,m){void 0===c&&(c=!1);"boolean"!==typeof a&&(a=!0);a=this.iterate("exists",a,b.Group.RETURN_CHILD);return null===a&&c?this.create(d,e,k,m):this.resetChild(a,d,e,k,m)};b.Group.prototype.getFirstAlive=function(a,c,d,e,k){void 0===a&&(a=!1);var m=this.iterate("alive",!0,b.Group.RETURN_CHILD);return null===m&&a?this.create(c,d,e,k):this.resetChild(m,
c,d,e,k)};b.Group.prototype.getFirstDead=function(a,c,d,e,k){void 0===a&&(a=!1);var m=this.iterate("alive",!1,b.Group.RETURN_CHILD);return null===m&&a?this.create(c,d,e,k):this.resetChild(m,c,d,e,k)};b.Group.prototype.resetChild=function(a,c,b,e,k){if(null===a)return null;void 0===c&&(c=null);void 0===b&&(b=null);null!==c&&null!==b&&a.reset(c,b);void 0!==e&&a.loadTexture(e,k);return a};b.Group.prototype.getTop=function(){if(0<this.children.length)return this.children[this.children.length-1]};b.Group.prototype.getBottom=
function(){if(0<this.children.length)return this.children[0]};b.Group.prototype.getClosestTo=function(a,c,d){for(var e=Number.MAX_VALUE,k,m=null,f=0;f<this.children.length;f++){var g=this.children[f];g.exists&&(k=Math.abs(b.Point.distance(a,g)),k<e&&(!c||c.call(d,g,k))&&(e=k,m=g))}return m};b.Group.prototype.getFurthestFrom=function(a,c,d){for(var e=0,k,m=null,f=0;f<this.children.length;f++){var g=this.children[f];g.exists&&(k=Math.abs(b.Point.distance(a,g)),k>e&&(!c||c.call(d,g,k))&&(e=k,m=g))}return m};
b.Group.prototype.countLiving=function(){return this.iterate("alive",!0,b.Group.RETURN_TOTAL)};b.Group.prototype.countDead=function(){return this.iterate("alive",!1,b.Group.RETURN_TOTAL)};b.Group.prototype.getRandom=function(a,c){void 0===a&&(a=0);void 0===c&&(c=this.children.length);return 0===c?null:b.ArrayUtils.getRandomItem(this.children,a,c)};b.Group.prototype.getRandomExists=function(a,c){var b=this.getAll("exists",!0,a,c);return this.game.rnd.pick(b)};b.Group.prototype.getAll=function(a,c,
b,e){void 0===b&&(b=0);void 0===e&&(e=this.children.length);for(var d=[];b<e;b++){var m=this.children[b];a&&m[a]===c&&d.push(m)}return d};b.Group.prototype.remove=function(a,c,b){void 0===c&&(c=!1);void 0===b&&(b=!1);if(0===this.children.length||-1===this.children.indexOf(a))return!1;if(!b&&a.events&&!a.destroyPhase)a.events.onRemovedFromGroup$dispatch(a,this);b=this.removeChild(a);this.removeFromHash(a);this.updateZ();this.cursor===a&&this.next();c&&b&&b.destroy(!0);return!0};b.Group.prototype.moveAll=
function(a,c){void 0===c&&(c=!1);if(0<this.children.length&&a instanceof b.Group){do a.add(this.children[0],c);while(0<this.children.length);this.hash=[];this.cursor=null}return a};b.Group.prototype.removeAll=function(a,c,b){void 0===a&&(a=!1);void 0===c&&(c=!1);void 0===b&&(b=!1);if(0!==this.children.length){do{if(!c&&this.children[0].events)this.children[0].events.onRemovedFromGroup$dispatch(this.children[0],this);var d=this.removeChild(this.children[0]);this.removeFromHash(d);a&&d&&d.destroy(!0,
b)}while(0<this.children.length);this.hash=[];this.cursor=null}};b.Group.prototype.removeBetween=function(a,c,b,e){void 0===c&&(c=this.children.length-1);void 0===b&&(b=!1);void 0===e&&(e=!1);if(0!==this.children.length){if(a>c||0>a||c>this.children.length)return!1;for(;c>=a;){if(!e&&this.children[c].events)this.children[c].events.onRemovedFromGroup$dispatch(this.children[c],this);var d=this.removeChild(this.children[c]);this.removeFromHash(d);b&&d&&d.destroy(!0);this.cursor===this.children[c]&&(this.cursor=
null);c--}this.updateZ()}};b.Group.prototype.destroy=function(a,c){null===this.game||this.ignoreDestroy||(void 0===a&&(a=!0),void 0===c&&(c=!1),this.onDestroy.dispatch(this,a,c),this.removeAll(a),this.filters=this.cursor=null,this.pendingDestroy=!1,c||(this.parent&&this.parent.removeChild(this),this.game=null,this.exists=!1))};Object.defineProperty(b.Group.prototype,"total",{get:function(){return this.iterate("exists",!0,b.Group.RETURN_TOTAL)}});Object.defineProperty(b.Group.prototype,"length",{get:function(){return this.children.length}});
Object.defineProperty(b.Group.prototype,"angle",{get:function(){return b.Math.radToDeg(this.rotation)},set:function(a){this.rotation=b.Math.degToRad(a)}});Object.defineProperty(b.Group.prototype,"centerX",{get:function(){return this.getBounds(this.parent).centerX},set:function(a){var c=this.getBounds(this.parent);this.x=a+(this.x-c.x)-c.halfWidth}});Object.defineProperty(b.Group.prototype,"centerY",{get:function(){return this.getBounds(this.parent).centerY},set:function(a){var c=this.getBounds(this.parent);
this.y=a+(this.y-c.y)-c.halfHeight}});Object.defineProperty(b.Group.prototype,"left",{get:function(){return this.getBounds(this.parent).left},set:function(a){var c=this.getBounds(this.parent);this.x=a+(this.x-c.x)}});Object.defineProperty(b.Group.prototype,"right",{get:function(){return this.getBounds(this.parent).right},set:function(a){var c=this.getBounds(this.parent);this.x=a+(this.x-c.x)-c.width}});Object.defineProperty(b.Group.prototype,"top",{get:function(){return this.getBounds(this.parent).top},
set:function(a){var c=this.getBounds(this.parent);this.y=a+(this.y-c.y)}});Object.defineProperty(b.Group.prototype,"bottom",{get:function(){return this.getBounds(this.parent).bottom},set:function(a){var c=this.getBounds(this.parent);this.y=a+(this.y-c.y)-c.height}});b.World=function(a){b.Group.call(this,a,null,"__world",!1);this.bounds=new b.Rectangle(0,0,a.width,a.height);this.camera=null;this._definedSize=!1;this._width=a.width;this._height=a.height;this.game.state.onStateChange.add(this.stateChange,
this)};b.World.prototype=Object.create(b.Group.prototype);b.World.prototype.constructor=b.World;b.World.prototype.boot=function(){this.camera=new b.Camera(this.game,0,0,0,this.game.width,this.game.height);this.game.stage.addChild(this);this.camera.boot()};b.World.prototype.stateChange=function(){this.y=this.x=0;this.camera.reset()};b.World.prototype.setBounds=function(a,c,b,e){this._definedSize=!0;this._width=b;this._height=e;this.bounds.setTo(a,c,b,e);this.x=a;this.y=c;this.camera.bounds&&this.camera.bounds.setTo(a,
c,Math.max(b,this.game.width),Math.max(e,this.game.height));this.game.physics.setBoundsToWorld()};b.World.prototype.resize=function(a,c){this._definedSize&&(a<this._width&&(a=this._width),c<this._height&&(c=this._height));this.bounds.width=a;this.bounds.height=c;this.game.camera.setBoundsToWorld();this.game.physics.setBoundsToWorld()};b.World.prototype.shutdown=function(){this.destroy(!0,!0)};b.World.prototype.wrap=function(a,c,b,e,k){void 0===c&&(c=0);void 0===b&&(b=!1);void 0===e&&(e=!0);void 0===
k&&(k=!0);b?(a.getBounds(),e&&(a.x+a._currentBounds.width<this.bounds.x?a.x=this.bounds.right:a.x>this.bounds.right&&(a.x=this.bounds.left)),k&&(a.y+a._currentBounds.height<this.bounds.top?a.y=this.bounds.bottom:a.y>this.bounds.bottom&&(a.y=this.bounds.top))):(e&&a.x+c<this.bounds.x?a.x=this.bounds.right+c:e&&a.x-c>this.bounds.right&&(a.x=this.bounds.left-c),k&&a.y+c<this.bounds.top?a.y=this.bounds.bottom+c:k&&a.y-c>this.bounds.bottom&&(a.y=this.bounds.top-c))};Object.defineProperty(b.World.prototype,
"width",{get:function(){return this.bounds.width},set:function(a){a<this.game.width&&(a=this.game.width);this._width=this.bounds.width=a;this._definedSize=!0}});Object.defineProperty(b.World.prototype,"height",{get:function(){return this.bounds.height},set:function(a){a<this.game.height&&(a=this.game.height);this._height=this.bounds.height=a;this._definedSize=!0}});Object.defineProperty(b.World.prototype,"centerX",{get:function(){return this.bounds.halfWidth+this.bounds.x}});Object.defineProperty(b.World.prototype,
"centerY",{get:function(){return this.bounds.halfHeight+this.bounds.y}});Object.defineProperty(b.World.prototype,"randomX",{get:function(){return 0>this.bounds.x?this.game.rnd.between(this.bounds.x,this.bounds.width-Math.abs(this.bounds.x)):this.game.rnd.between(this.bounds.x,this.bounds.width)}});Object.defineProperty(b.World.prototype,"randomY",{get:function(){return 0>this.bounds.y?this.game.rnd.between(this.bounds.y,this.bounds.height-Math.abs(this.bounds.y)):this.game.rnd.between(this.bounds.y,
this.bounds.height)}});b.Game=function(a,c,d,e,k,m,f,g){this.id=b.GAMES.push(this)-1;this.config=null;this.physicsConfig=g;this.parent="";this.width=800;this.height=600;this.resolution=1;this._width=800;this._height=600;this.transparent=!1;this.antialias=!0;this.preserveDrawingBuffer=!1;this.clearBeforeRender=!0;this.renderer=null;this.renderType=b.AUTO;this.state=null;this.isRunning=this.isBooted=!1;this.rnd=this.plugins=this.physics=this.world=this.tweens=this.time=this.stage=this.sound=this.scale=
this.net=this.math=this.load=this.input=this.cache=this.make=this.add=this.raf=null;this.device=b.Device;this.create=this.particles=this.debug=this.context=this.canvas=this.camera=null;this.pendingStep=this.stepping=this.lockRender=!1;this.stepCount=0;this.onFocus=this.onBlur=this.onResume=this.onPause=null;this._codePaused=this._paused=!1;this.currentUpdateID=0;this.updatesThisFrame=1;this._spiraling=this._lastCount=this._deltaTime=0;this._kickstart=!0;this.fpsProblemNotifier=new b.Signal;this.forceSingleUpdate=
!0;this._nextFpsNotification=0;1===arguments.length&&"object"===typeof arguments[0]?this.parseConfig(arguments[0]):(this.config={enableDebug:!0},"undefined"!==typeof a&&(this._width=a),"undefined"!==typeof c&&(this._height=c),"undefined"!==typeof d&&(this.renderType=d),"undefined"!==typeof e&&(this.parent=e),"undefined"!==typeof m&&(this.transparent=m),"undefined"!==typeof f&&(this.antialias=f),this.rnd=new b.RandomDataGenerator([(Date.now()*Math.random()).toString()]),this.state=new b.StateManager(this,
k));this.device.whenReady(this.boot,this);return this};b.Game.prototype={parseConfig:function(a){this.config=a;void 0===a.enableDebug&&(this.config.enableDebug=!0);a.width&&(this._width=a.width);a.height&&(this._height=a.height);a.renderer&&(this.renderType=a.renderer);a.parent&&(this.parent=a.parent);void 0!==a.transparent&&(this.transparent=a.transparent);void 0!==a.antialias&&(this.antialias=a.antialias);a.resolution&&(this.resolution=a.resolution);void 0!==a.preserveDrawingBuffer&&(this.preserveDrawingBuffer=
a.preserveDrawingBuffer);a.physicsConfig&&(this.physicsConfig=a.physicsConfig);var c=[(Date.now()*Math.random()).toString()];a.seed&&(c=a.seed);this.rnd=new b.RandomDataGenerator(c);c=null;a.state&&(c=a.state);this.state=new b.StateManager(this,c)},boot:function(){this.isBooted||(this.onPause=new b.Signal,this.onResume=new b.Signal,this.onBlur=new b.Signal,this.onFocus=new b.Signal,this.isBooted=!0,PIXI.game=this,this.math=b.Math,this.scale=new b.ScaleManager(this,this._width,this._height),this.stage=
new b.Stage(this),this.setUpRenderer(),this.world=new b.World(this),this.add=new b.GameObjectFactory(this),this.make=new b.GameObjectCreator(this),this.cache=new b.Cache(this),this.load=new b.Loader(this),this.time=new b.Time(this),this.tweens=new b.TweenManager(this),this.input=new b.Input(this),this.sound=new b.SoundManager(this),this.physics=new b.Physics(this,this.physicsConfig),this.particles=new b.Particles(this),this.create=new b.Create(this),this.plugins=new b.PluginManager(this),this.net=
new b.Net(this),this.time.boot(),this.stage.boot(),this.world.boot(),this.scale.boot(),this.input.boot(),this.sound.boot(),this.state.boot(),this.config.enableDebug?(this.debug=new b.Utils.Debug(this),this.debug.boot()):this.debug={preUpdate:function(){},update:function(){},reset:function(){}},this.showDebugHeader(),this.isRunning=!0,this.raf=this.config&&this.config.forceSetTimeOut?new b.RequestAnimationFrame(this,this.config.forceSetTimeOut):new b.RequestAnimationFrame(this,!1),this._kickstart=
!0,window.focus&&(!window.PhaserGlobal||window.PhaserGlobal&&!window.PhaserGlobal.stopFocus)&&window.focus(),this.raf.start())},showDebugHeader:function(){if(!window.PhaserGlobal||!window.PhaserGlobal.hideBanner){var a=b.VERSION,c="Canvas",d="HTML Audio",e=1;this.renderType===b.WEBGL?(c="WebGL",e++):this.renderType===b.HEADLESS&&(c="Headless");this.device.webAudio&&(d="WebAudio",e++);if(this.device.chrome){a=["%c %c %c Phaser v"+a+" | Pixi.js | "+c+" | "+d+"  %c %c %c http://phaser.io %c\u2665%c\u2665%c\u2665",
"background: #fb8cb3","background: #d44a52","color: #ffffff; background: #871905;","background: #d44a52","background: #fb8cb3","background: #ffffff"];for(c=0;3>c;c++)c<e?a.push("color: #ff2424; background: #fff"):a.push("color: #959595; background: #fff");console.log.apply(console,a)}else window.console&&console.log("Phaser v"+a+" | Pixi.js "+PIXI.VERSION+" | "+c+" | "+d+" | http://phaser.io")}},setUpRenderer:function(){this.canvas=this.config.canvas?this.config.canvas:b.Canvas.create(this,this.width,
this.height,this.config.canvasID,!0);this.config.canvasStyle?this.canvas.style=this.config.canvasStyle:this.canvas.style["-webkit-full-screen"]="width: 100%; height: 100%";if(this.renderType===b.HEADLESS||this.renderType===b.CANVAS||this.renderType===b.AUTO&&!this.device.webGL)if(this.device.canvas)this.renderType=b.CANVAS,this.renderer=new PIXI.CanvasRenderer(this),this.context=this.renderer.context;else throw Error("Phaser.Game - Cannot create Canvas or WebGL context, aborting.");else this.renderType=
b.WEBGL,this.renderer=new PIXI.WebGLRenderer(this),this.context=null,this.canvas.addEventListener("webglcontextlost",this.contextLost.bind(this),!1),this.canvas.addEventListener("webglcontextrestored",this.contextRestored.bind(this),!1);this.device.cocoonJS&&(this.canvas.screencanvas=this.renderType===b.CANVAS?!0:!1);this.renderType!==b.HEADLESS&&(this.stage.smoothed=this.antialias,b.Canvas.addToDOM(this.canvas,this.parent,!1),b.Canvas.setTouchAction(this.canvas))},contextLost:function(a){a.preventDefault();
this.renderer.contextLost=!0},contextRestored:function(){this.renderer.initContext();this.cache.clearGLTextures();this.renderer.contextLost=!1},update:function(a){this.time.update(a);if(this._kickstart)this.updateLogic(this.time.desiredFpsMult),this.updateRender(this.time.slowMotion*this.time.desiredFps),this._kickstart=!1;else if(1<this._spiraling&&!this.forceSingleUpdate)this.time.time>this._nextFpsNotification&&(this._nextFpsNotification=this.time.time+1E4,this.fpsProblemNotifier.dispatch()),this._spiraling=
this._deltaTime=0,this.updateRender(this.time.slowMotion*this.time.desiredFps);else{a=1E3*this.time.slowMotion/this.time.desiredFps;this._deltaTime+=Math.max(Math.min(3*a,this.time.elapsed),0);var c=0;this.updatesThisFrame=Math.floor(this._deltaTime/a);this.forceSingleUpdate&&(this.updatesThisFrame=Math.min(1,this.updatesThisFrame));for(;this._deltaTime>=a&&(this._deltaTime-=a,this.currentUpdateID=c,this.updateLogic(this.time.desiredFpsMult),c++,!this.forceSingleUpdate||1!==c);)this.time.refresh();
c>this._lastCount?this._spiraling++:c<this._lastCount&&(this._spiraling=0);this._lastCount=c;this.updateRender(this._deltaTime/a)}},updateLogic:function(a){this._paused||this.pendingStep?(this.scale.pauseUpdate(),this.state.pauseUpdate(),this.debug.preUpdate()):(this.stepping&&(this.pendingStep=!0),this.scale.preUpdate(),this.debug.preUpdate(),this.camera.preUpdate(),this.physics.preUpdate(),this.state.preUpdate(a),this.plugins.preUpdate(a),this.stage.preUpdate(),this.state.update(),this.stage.update(),
this.tweens.update(),this.sound.update(),this.input.update(),this.physics.update(),this.particles.update(),this.plugins.update(),this.stage.postUpdate(),this.plugins.postUpdate());this.stage.updateTransform()},updateRender:function(a){this.lockRender||(this.state.preRender(a),this.renderType!==b.HEADLESS&&(this.renderer.render(this.stage),this.plugins.render(a),this.state.render(a)),this.plugins.postRender(a))},enableStep:function(){this.stepping=!0;this.pendingStep=!1;this.stepCount=0},disableStep:function(){this.pendingStep=
this.stepping=!1},step:function(){this.pendingStep=!1;this.stepCount++},destroy:function(){this.raf.stop();this.state.destroy();this.sound.destroy();this.scale.destroy();this.stage.destroy();this.input.destroy();this.physics.destroy();this.plugins.destroy();this.world=this.time=this.load=this.cache=this.plugins=this.physics=this.input=this.stage=this.scale=this.sound=this.state=null;this.isBooted=!1;this.renderer.destroy(!1);b.Canvas.removeFromDOM(this.canvas);PIXI.defaultRenderer=null;b.GAMES[this.id]=
null},gamePaused:function(a){this._paused||(this._paused=!0,this.time.gamePaused(),this.sound.muteOnPause&&this.sound.setMute(),this.onPause.dispatch(a),this.device.cordova&&this.device.iOS&&(this.lockRender=!0))},gameResumed:function(a){this._paused&&!this._codePaused&&(this._paused=!1,this.time.gameResumed(),this.input.reset(),this.sound.muteOnPause&&this.sound.unsetMute(),this.onResume.dispatch(a),this.device.cordova&&this.device.iOS&&(this.lockRender=!1))},focusLoss:function(a){this.onBlur.dispatch(a);
this.stage.disableVisibilityChange||this.gamePaused(a)},focusGain:function(a){this.onFocus.dispatch(a);this.stage.disableVisibilityChange||this.gameResumed(a)}};b.Game.prototype.constructor=b.Game;Object.defineProperty(b.Game.prototype,"paused",{get:function(){return this._paused},set:function(a){!0===a?(!1===this._paused&&(this._paused=!0,this.sound.setMute(),this.time.gamePaused(),this.onPause.dispatch(this)),this._codePaused=!0):(this._paused&&(this._paused=!1,this.input.reset(),this.sound.unsetMute(),
this.time.gameResumed(),this.onResume.dispatch(this)),this._codePaused=!1)}});b.Input=function(a){this.game=a;this.hitContext=this.hitCanvas=null;this.moveCallbacks=[];this.customCandidateHandlerContext=this.customCandidateHandler=null;this.pollRate=0;this.enabled=!0;this.multiInputOverride=b.Input.MOUSE_TOUCH_COMBINE;this.scale=this.circle=this.speed=this.position=null;this.maxPointers=-1;this.tapRate=200;this.doubleTapRate=300;this.holdRate=2E3;this.justReleasedRate=this.justPressedRate=200;this.recordPointerHistory=
!1;this.recordLimit=this.recordRate=100;this.pointer10=this.pointer9=this.pointer8=this.pointer7=this.pointer6=this.pointer5=this.pointer4=this.pointer3=this.pointer2=this.pointer1=null;this.pointers=[];this.gamepad=this.mspointer=this.touch=this.keyboard=this.mouse=this.mousePointer=this.activePointer=null;this.resetLocked=!1;this.onHold=this.onTap=this.onUp=this.onDown=null;this.minPriorityID=0;this.interactiveItems=new b.ArraySet;this._localPoint=new b.Point;this._pollCounter=0;this._oldPosition=
null;this._y=this._x=0};b.Input.MOUSE_OVERRIDES_TOUCH=0;b.Input.TOUCH_OVERRIDES_MOUSE=1;b.Input.MOUSE_TOUCH_COMBINE=2;b.Input.MAX_POINTERS=10;b.Input.prototype={boot:function(){this.mousePointer=new b.Pointer(this.game,0,b.PointerMode.CURSOR);this.addPointer();this.addPointer();this.mouse=new b.Mouse(this.game);this.touch=new b.Touch(this.game);this.mspointer=new b.MSPointer(this.game);b.Keyboard&&(this.keyboard=new b.Keyboard(this.game));b.Gamepad&&(this.gamepad=new b.Gamepad(this.game));this.onDown=
new b.Signal;this.onUp=new b.Signal;this.onTap=new b.Signal;this.onHold=new b.Signal;this.scale=new b.Point(1,1);this.speed=new b.Point;this.position=new b.Point;this._oldPosition=new b.Point;this.circle=new b.Circle(0,0,44);this.activePointer=this.mousePointer;this.hitCanvas=PIXI.CanvasPool.create(this,1,1);this.hitContext=this.hitCanvas.getContext("2d");this.mouse.start();this.touch.start();this.mspointer.start();this.mousePointer.active=!0;this.keyboard&&this.keyboard.start();var a=this;this._onClickTrampoline=
function(c){a.onClickTrampoline(c)};this.game.canvas.addEventListener("click",this._onClickTrampoline,!1)},destroy:function(){this.mouse.stop();this.touch.stop();this.mspointer.stop();this.keyboard&&this.keyboard.stop();this.gamepad&&this.gamepad.stop();this.moveCallbacks=[];PIXI.CanvasPool.remove(this);this.game.canvas.removeEventListener("click",this._onClickTrampoline)},setInteractiveCandidateHandler:function(a,c){this.customCandidateHandler=a;this.customCandidateHandlerContext=c},addMoveCallback:function(a,
c){this.moveCallbacks.push({callback:a,context:c})},deleteMoveCallback:function(a,c){for(var b=this.moveCallbacks.length;b--;)if(this.moveCallbacks[b].callback===a&&this.moveCallbacks[b].context===c){this.moveCallbacks.splice(b,1);break}},addPointer:function(){if(this.pointers.length>=b.Input.MAX_POINTERS)return console.warn("Phaser.Input.addPointer: Maximum limit of "+b.Input.MAX_POINTERS+" pointers reached."),null;var a=this.pointers.length+1,c=new b.Pointer(this.game,a,b.PointerMode.TOUCH);this.pointers.push(c);
return this["pointer"+a]=c},update:function(){this.keyboard&&this.keyboard.update();if(0<this.pollRate&&this._pollCounter<this.pollRate)this._pollCounter++;else{this.speed.x=this.position.x-this._oldPosition.x;this.speed.y=this.position.y-this._oldPosition.y;this._oldPosition.copyFrom(this.position);this.mousePointer.update();this.gamepad&&this.gamepad.active&&this.gamepad.update();for(var a=0;a<this.pointers.length;a++)this.pointers[a].update();this._pollCounter=0}},reset:function(a){if(this.game.isBooted&&
!this.resetLocked){void 0===a&&(a=!1);this.mousePointer.reset();this.keyboard&&this.keyboard.reset(a);this.gamepad&&this.gamepad.reset();for(var c=0;c<this.pointers.length;c++)this.pointers[c].reset();"none"!==this.game.canvas.style.cursor&&(this.game.canvas.style.cursor="inherit");a&&(this.onDown.dispose(),this.onUp.dispose(),this.onTap.dispose(),this.onHold.dispose(),this.onDown=new b.Signal,this.onUp=new b.Signal,this.onTap=new b.Signal,this.onHold=new b.Signal,this.moveCallbacks=[]);this._pollCounter=
0}},resetSpeed:function(a,c){this._oldPosition.setTo(a,c);this.speed.setTo(0,0)},startPointer:function(a){if(0<=this.maxPointers&&this.countActivePointers(this.maxPointers)>=this.maxPointers)return null;if(!this.pointer1.active)return this.pointer1.start(a);if(!this.pointer2.active)return this.pointer2.start(a);for(var c=2;c<this.pointers.length;c++){var b=this.pointers[c];if(!b.active)return b.start(a)}return null},updatePointer:function(a){if(this.pointer1.active&&this.pointer1.identifier===a.identifier)return this.pointer1.move(a);
if(this.pointer2.active&&this.pointer2.identifier===a.identifier)return this.pointer2.move(a);for(var c=2;c<this.pointers.length;c++){var b=this.pointers[c];if(b.active&&b.identifier===a.identifier)return b.move(a)}return null},stopPointer:function(a){if(this.pointer1.active&&this.pointer1.identifier===a.identifier)return this.pointer1.stop(a);if(this.pointer2.active&&this.pointer2.identifier===a.identifier)return this.pointer2.stop(a);for(var c=2;c<this.pointers.length;c++){var b=this.pointers[c];
if(b.active&&b.identifier===a.identifier)return b.stop(a)}return null},countActivePointers:function(a){void 0===a&&(a=this.pointers.length);for(var c=a,b=0;b<this.pointers.length&&0<c;b++)this.pointers[b].active&&c--;return a-c},getPointer:function(a){void 0===a&&(a=!1);for(var c=0;c<this.pointers.length;c++){var b=this.pointers[c];if(b.active===a)return b}return null},getPointerFromIdentifier:function(a){for(var c=0;c<this.pointers.length;c++){var b=this.pointers[c];if(b.identifier===a)return b}return null},
getPointerFromId:function(a){for(var c=0;c<this.pointers.length;c++){var b=this.pointers[c];if(b.pointerId===a)return b}return null},getLocalPosition:function(a,c,d){void 0===d&&(d=new b.Point);a=a.worldTransform;var e=1/(a.a*a.d+a.c*-a.b);return d.setTo(a.d*e*c.x+-a.c*e*c.y+(a.ty*a.c-a.tx*a.d)*e,a.a*e*c.y+-a.b*e*c.x+(-a.ty*a.a+a.tx*a.b)*e)},hitTest:function(a,c,d){if(!a.worldVisible)return!1;this.getLocalPosition(a,c,this._localPoint);d.copyFrom(this._localPoint);if(a.hitArea&&a.hitArea.contains)return a.hitArea.contains(this._localPoint.x,
this._localPoint.y);if(a instanceof b.TileSprite){var e=a.width,k=a.height,m=-e*a.anchor.x;if(this._localPoint.x>=m&&this._localPoint.x<m+e&&(e=-k*a.anchor.y,this._localPoint.y>=e&&this._localPoint.y<e+k))return!0}else if(a instanceof PIXI.Sprite){if(e=a.texture.frame.width,k=a.texture.frame.height,m=-e*a.anchor.x,this._localPoint.x>=m&&this._localPoint.x<m+e&&(e=-k*a.anchor.y,this._localPoint.y>=e&&this._localPoint.y<e+k))return!0}else if(a instanceof b.Graphics)for(k=0;k<a.graphicsData.length;k++)if(e=
a.graphicsData[k],e.fill&&e.shape&&e.shape.contains(this._localPoint.x,this._localPoint.y))return!0;for(k=0;k<a.children.length;k++)if(this.hitTest(a.children[k],c,d))return!0;return!1},onClickTrampoline:function(){this.activePointer.processClickTrampolines()}};b.Input.prototype.constructor=b.Input;Object.defineProperty(b.Input.prototype,"x",{get:function(){return this._x},set:function(a){this._x=Math.floor(a)}});Object.defineProperty(b.Input.prototype,"y",{get:function(){return this._y},set:function(a){this._y=
Math.floor(a)}});Object.defineProperty(b.Input.prototype,"pollLocked",{get:function(){return 0<this.pollRate&&this._pollCounter<this.pollRate}});Object.defineProperty(b.Input.prototype,"totalInactivePointers",{get:function(){return this.pointers.length-this.countActivePointers()}});Object.defineProperty(b.Input.prototype,"totalActivePointers",{get:function(){return this.countActivePointers()}});Object.defineProperty(b.Input.prototype,"worldX",{get:function(){return this.game.camera.view.x+this.x}});
Object.defineProperty(b.Input.prototype,"worldY",{get:function(){return this.game.camera.view.y+this.y}});b.Mouse=function(a){this.game=a;this.input=a.input;this.callbackContext=this.game;this.mouseWheelCallback=this.mouseOverCallback=this.mouseOutCallback=this.mouseUpCallback=this.mouseDownCallback=null;this.capture=!1;this.button=-1;this.wheelDelta=0;this.enabled=!0;this.stopOnGameOut=this.locked=!1;this.pointerLock=new b.Signal;this._wheelEvent=this._onMouseWheel=this._onMouseOver=this._onMouseOut=
this._onMouseUp=this._onMouseMove=this._onMouseDown=this.event=null};b.Mouse.NO_BUTTON=-1;b.Mouse.LEFT_BUTTON=0;b.Mouse.MIDDLE_BUTTON=1;b.Mouse.RIGHT_BUTTON=2;b.Mouse.BACK_BUTTON=3;b.Mouse.FORWARD_BUTTON=4;b.Mouse.WHEEL_UP=1;b.Mouse.WHEEL_DOWN=-1;b.Mouse.prototype={start:function(){if((!this.game.device.android||!1!==this.game.device.chrome)&&null===this._onMouseDown){var a=this;this._onMouseDown=function(c){return a.onMouseDown(c)};this._onMouseMove=function(c){return a.onMouseMove(c)};this._onMouseUp=
function(c){return a.onMouseUp(c)};this._onMouseUpGlobal=function(c){return a.onMouseUpGlobal(c)};this._onMouseOutGlobal=function(c){return a.onMouseOutGlobal(c)};this._onMouseOut=function(c){return a.onMouseOut(c)};this._onMouseOver=function(c){return a.onMouseOver(c)};this._onMouseWheel=function(c){return a.onMouseWheel(c)};var c=this.game.canvas;c.addEventListener("mousedown",this._onMouseDown,!0);c.addEventListener("mousemove",this._onMouseMove,!0);c.addEventListener("mouseup",this._onMouseUp,
!0);this.game.device.cocoonJS||(window.addEventListener("mouseup",this._onMouseUpGlobal,!0),window.addEventListener("mouseout",this._onMouseOutGlobal,!0),c.addEventListener("mouseover",this._onMouseOver,!0),c.addEventListener("mouseout",this._onMouseOut,!0));var b=this.game.device.wheelEvent;b&&(c.addEventListener(b,this._onMouseWheel,!0),"mousewheel"===b?this._wheelEvent=new g(-.025,1):"DOMMouseScroll"===b&&(this._wheelEvent=new g(1,1)))}},onMouseDown:function(a){this.event=a;this.capture&&a.preventDefault();
this.mouseDownCallback&&this.mouseDownCallback.call(this.callbackContext,a);this.input.enabled&&this.enabled&&(a.identifier=0,this.input.mousePointer.start(a))},onMouseMove:function(a){this.event=a;this.capture&&a.preventDefault();this.mouseMoveCallback&&this.mouseMoveCallback.call(this.callbackContext,a);this.input.enabled&&this.enabled&&(a.identifier=0,this.input.mousePointer.move(a))},onMouseUp:function(a){this.event=a;this.capture&&a.preventDefault();this.mouseUpCallback&&this.mouseUpCallback.call(this.callbackContext,
a);this.input.enabled&&this.enabled&&(a.identifier=0,this.input.mousePointer.stop(a))},onMouseUpGlobal:function(a){this.input.mousePointer.withinGame||(this.mouseUpCallback&&this.mouseUpCallback.call(this.callbackContext,a),a.identifier=0,this.input.mousePointer.stop(a))},onMouseOutGlobal:function(a){this.event=a;this.capture&&a.preventDefault();this.input.mousePointer.withinGame=!1;this.input.enabled&&this.enabled&&(this.input.mousePointer.stop(a),this.input.mousePointer.leftButton.stop(a),this.input.mousePointer.rightButton.stop(a))},
onMouseOut:function(a){this.event=a;this.capture&&a.preventDefault();this.input.mousePointer.withinGame=!1;this.mouseOutCallback&&this.mouseOutCallback.call(this.callbackContext,a);this.input.enabled&&this.enabled&&this.stopOnGameOut&&(a.identifier=0,this.input.mousePointer.stop(a))},onMouseOver:function(a){this.event=a;this.capture&&a.preventDefault();this.input.mousePointer.withinGame=!0;this.mouseOverCallback&&this.mouseOverCallback.call(this.callbackContext,a)},onMouseWheel:function(a){this._wheelEvent&&
(a=this._wheelEvent.bindEvent(a));this.event=a;this.capture&&a.preventDefault();this.wheelDelta=b.Math.clamp(-a.deltaY,-1,1);this.mouseWheelCallback&&this.mouseWheelCallback.call(this.callbackContext,a)},requestPointerLock:function(){if(this.game.device.pointerLock){var a=this.game.canvas;a.requestPointerLock=a.requestPointerLock||a.mozRequestPointerLock||a.webkitRequestPointerLock;a.requestPointerLock();var c=this;this._pointerLockChange=function(a){return c.pointerLockChange(a)};document.addEventListener("pointerlockchange",
this._pointerLockChange,!0);document.addEventListener("mozpointerlockchange",this._pointerLockChange,!0);document.addEventListener("webkitpointerlockchange",this._pointerLockChange,!0)}},pointerLockChange:function(a){var c=this.game.canvas;document.pointerLockElement===c||document.mozPointerLockElement===c||document.webkitPointerLockElement===c?(this.locked=!0,this.pointerLock.dispatch(!0,a)):(this.locked=!1,this.pointerLock.dispatch(!1,a))},releasePointerLock:function(){document.exitPointerLock=
document.exitPointerLock||document.mozExitPointerLock||document.webkitExitPointerLock;document.exitPointerLock();document.removeEventListener("pointerlockchange",this._pointerLockChange,!0);document.removeEventListener("mozpointerlockchange",this._pointerLockChange,!0);document.removeEventListener("webkitpointerlockchange",this._pointerLockChange,!0)},stop:function(){var a=this.game.canvas;a.removeEventListener("mousedown",this._onMouseDown,!0);a.removeEventListener("mousemove",this._onMouseMove,
!0);a.removeEventListener("mouseup",this._onMouseUp,!0);a.removeEventListener("mouseover",this._onMouseOver,!0);a.removeEventListener("mouseout",this._onMouseOut,!0);var c=this.game.device.wheelEvent;c&&a.removeEventListener(c,this._onMouseWheel,!0);window.removeEventListener("mouseup",this._onMouseUpGlobal,!0);window.removeEventListener("mouseout",this._onMouseOutGlobal,!0);document.removeEventListener("pointerlockchange",this._pointerLockChange,!0);document.removeEventListener("mozpointerlockchange",
this._pointerLockChange,!0);document.removeEventListener("webkitpointerlockchange",this._pointerLockChange,!0)}};b.Mouse.prototype.constructor=b.Mouse;g.prototype={};g.prototype.constructor=g;g.prototype.bindEvent=function(a){if(!g._stubsGenerated&&a){var c=function(a){return function(){var c=this.originalEvent[a];return"function"!==typeof c?c:c.bind(this.originalEvent)}},b;for(b in a)b in g.prototype||Object.defineProperty(g.prototype,b,{get:c(b)});g._stubsGenerated=!0}this.originalEvent=a;return this};
Object.defineProperties(g.prototype,{type:{value:"wheel"},deltaMode:{get:function(){return this._deltaMode}},deltaY:{get:function(){return this._scaleFactor*(this.originalEvent.wheelDelta||this.originalEvent.detail)||0}},deltaX:{get:function(){return this._scaleFactor*this.originalEvent.wheelDeltaX||0}},deltaZ:{value:0}});b.MSPointer=function(a){this.game=a;this.input=a.input;this.callbackContext=this.game;this.pointerUpCallback=this.pointerMoveCallback=this.pointerDownCallback=null;this.capture=
!0;this.button=-1;this.event=null;this.enabled=!0;this._onMSPointerOver=this._onMSPointerOut=this._onMSPointerUpGlobal=this._onMSPointerUp=this._onMSPointerMove=this._onMSPointerDown=null};b.MSPointer.prototype={start:function(){if(null===this._onMSPointerDown){var a=this;if(this.game.device.mspointer){this._onMSPointerDown=function(c){return a.onPointerDown(c)};this._onMSPointerMove=function(c){return a.onPointerMove(c)};this._onMSPointerUp=function(c){return a.onPointerUp(c)};this._onMSPointerUpGlobal=
function(c){return a.onPointerUpGlobal(c)};this._onMSPointerOut=function(c){return a.onPointerOut(c)};this._onMSPointerOver=function(c){return a.onPointerOver(c)};var c=this.game.canvas;c.addEventListener("MSPointerDown",this._onMSPointerDown,!1);c.addEventListener("MSPointerMove",this._onMSPointerMove,!1);c.addEventListener("MSPointerUp",this._onMSPointerUp,!1);c.addEventListener("pointerdown",this._onMSPointerDown,!1);c.addEventListener("pointermove",this._onMSPointerMove,!1);c.addEventListener("pointerup",
this._onMSPointerUp,!1);c.style["-ms-content-zooming"]="none";c.style["-ms-touch-action"]="none";this.game.device.cocoonJS||(window.addEventListener("MSPointerUp",this._onMSPointerUpGlobal,!0),c.addEventListener("MSPointerOver",this._onMSPointerOver,!0),c.addEventListener("MSPointerOut",this._onMSPointerOut,!0),window.addEventListener("pointerup",this._onMSPointerUpGlobal,!0),c.addEventListener("pointerover",this._onMSPointerOver,!0),c.addEventListener("pointerout",this._onMSPointerOut,!0))}}},onPointerDown:function(a){this.event=
a;this.capture&&a.preventDefault();this.pointerDownCallback&&this.pointerDownCallback.call(this.callbackContext,a);this.input.enabled&&this.enabled&&(a.identifier=a.pointerId,"mouse"===a.pointerType||4===a.pointerType?this.input.mousePointer.start(a):this.input.startPointer(a))},onPointerMove:function(a){this.event=a;this.capture&&a.preventDefault();this.pointerMoveCallback&&this.pointerMoveCallback.call(this.callbackContext,a);this.input.enabled&&this.enabled&&(a.identifier=a.pointerId,"mouse"===
a.pointerType||4===a.pointerType?this.input.mousePointer.move(a):this.input.updatePointer(a))},onPointerUp:function(a){this.event=a;this.capture&&a.preventDefault();this.pointerUpCallback&&this.pointerUpCallback.call(this.callbackContext,a);this.input.enabled&&this.enabled&&(a.identifier=a.pointerId,"mouse"===a.pointerType||4===a.pointerType?this.input.mousePointer.stop(a):this.input.stopPointer(a))},onPointerUpGlobal:function(a){if("mouse"!==a.pointerType&&4!==a.pointerType||this.input.mousePointer.withinGame){var c=
this.input.getPointerFromIdentifier(a.identifier);if(c&&c.withinGame)this.onPointerUp(a)}else this.onPointerUp(a)},onPointerOut:function(a){this.event=a;this.capture&&a.preventDefault();if("mouse"===a.pointerType||4===a.pointerType)this.input.mousePointer.withinGame=!1;else{var c=this.input.getPointerFromIdentifier(a.identifier);c&&(c.withinGame=!1)}this.input.mouse.mouseOutCallback&&this.input.mouse.mouseOutCallback.call(this.input.mouse.callbackContext,a);this.input.enabled&&this.enabled&&this.input.mouse.stopOnGameOut&&
(a.identifier=0,c?c.stop(a):this.input.mousePointer.stop(a))},onPointerOver:function(a){this.event=a;this.capture&&a.preventDefault();if("mouse"===a.pointerType||4===a.pointerType)this.input.mousePointer.withinGame=!0;else{var c=this.input.getPointerFromIdentifier(a.identifier);c&&(c.withinGame=!0)}this.input.mouse.mouseOverCallback&&this.input.mouse.mouseOverCallback.call(this.input.mouse.callbackContext,a)},stop:function(){var a=this.game.canvas;a.removeEventListener("MSPointerDown",this._onMSPointerDown,
!1);a.removeEventListener("MSPointerMove",this._onMSPointerMove,!1);a.removeEventListener("MSPointerUp",this._onMSPointerUp,!1);a.removeEventListener("pointerdown",this._onMSPointerDown,!1);a.removeEventListener("pointermove",this._onMSPointerMove,!1);a.removeEventListener("pointerup",this._onMSPointerUp,!1);window.removeEventListener("MSPointerUp",this._onMSPointerUpGlobal,!0);a.removeEventListener("MSPointerOver",this._onMSPointerOver,!0);a.removeEventListener("MSPointerOut",this._onMSPointerOut,
!0);window.removeEventListener("pointerup",this._onMSPointerUpGlobal,!0);a.removeEventListener("pointerover",this._onMSPointerOver,!0);a.removeEventListener("pointerout",this._onMSPointerOut,!0)}};b.MSPointer.prototype.constructor=b.MSPointer;b.DeviceButton=function(a,c){this.parent=a;this.game=a.game;this.event=null;this.isDown=!1;this.isUp=!0;this.repeats=this.timeUp=this.timeDown=0;this.ctrlKey=this.shiftKey=this.altKey=!1;this.value=0;this.buttonCode=c;this.onDown=new b.Signal;this.onUp=new b.Signal;
this.onFloat=new b.Signal};b.DeviceButton.prototype={start:function(a,c){this.isDown||(this.isDown=!0,this.isUp=!1,this.timeDown=this.game.time.time,this.repeats=0,this.event=a,this.value=c,a&&(this.altKey=a.altKey,this.shiftKey=a.shiftKey,this.ctrlKey=a.ctrlKey),this.onDown.dispatch(this,c))},stop:function(a,c){this.isUp||(this.isDown=!1,this.isUp=!0,this.timeUp=this.game.time.time,this.event=a,this.value=c,a&&(this.altKey=a.altKey,this.shiftKey=a.shiftKey,this.ctrlKey=a.ctrlKey),this.onUp.dispatch(this,
c))},padFloat:function(a){this.value=a;this.onFloat.dispatch(this,a)},justPressed:function(a){return this.isDown&&this.timeDown+(a||250)>this.game.time.time},justReleased:function(a){return this.isUp&&this.timeUp+(a||250)>this.game.time.time},reset:function(){this.isDown=!1;this.isUp=!0;this.timeDown=this.game.time.time;this.repeats=0;this.ctrlKey=this.shiftKey=this.altKey=!1},destroy:function(){this.onDown.dispose();this.onUp.dispose();this.onFloat.dispose();this.game=this.parent=null}};b.DeviceButton.prototype.constructor=
b.DeviceButton;Object.defineProperty(b.DeviceButton.prototype,"duration",{get:function(){return this.isUp?-1:this.game.time.time-this.timeDown}});b.Pointer=function(a,c,d){this.game=a;this.id=c;this.type=b.POINTER;this.exists=!0;this.identifier=0;this.pointerId=null;this.pointerMode=d||b.PointerMode.CURSOR|b.PointerMode.CONTACT;this.button=this.target=null;this.leftButton=new b.DeviceButton(this,b.Pointer.LEFT_BUTTON);this.middleButton=new b.DeviceButton(this,b.Pointer.MIDDLE_BUTTON);this.rightButton=
new b.DeviceButton(this,b.Pointer.RIGHT_BUTTON);this.backButton=new b.DeviceButton(this,b.Pointer.BACK_BUTTON);this.forwardButton=new b.DeviceButton(this,b.Pointer.FORWARD_BUTTON);this.eraserButton=new b.DeviceButton(this,b.Pointer.ERASER_BUTTON);this._holdSent=!1;this._history=[];this._nextDrop=0;this.withinGame=this._stateReset=!1;this.screenY=this.screenX=this.pageY=this.pageX=this.clientY=this.clientX=-1;this.movementY=this.movementX=this.rawMovementY=this.rawMovementX=0;this.y=this.x=-1;this.isMouse=
0===c;this.isDown=!1;this.isUp=!0;this.totalTouches=this.previousTapTime=this.timeUp=this.timeDown=0;this.msSinceLastClick=Number.MAX_VALUE;this.targetObject=null;this.interactiveCandidates=[];this.dirty=this.active=!1;this.position=new b.Point;this.positionDown=new b.Point;this.positionUp=new b.Point;this.circle=new b.Circle(0,0,44);this._trampolineTargetObject=this._clickTrampolines=null};b.Pointer.NO_BUTTON=0;b.Pointer.LEFT_BUTTON=1;b.Pointer.RIGHT_BUTTON=2;b.Pointer.MIDDLE_BUTTON=4;b.Pointer.BACK_BUTTON=
8;b.Pointer.FORWARD_BUTTON=16;b.Pointer.ERASER_BUTTON=32;b.Pointer.prototype={resetButtons:function(){this.isDown=!1;this.isUp=!0;this.isMouse&&(this.leftButton.reset(),this.middleButton.reset(),this.rightButton.reset(),this.backButton.reset(),this.forwardButton.reset(),this.eraserButton.reset())},processButtonsDown:function(a,c){b.Pointer.LEFT_BUTTON&a&&this.leftButton.start(c);b.Pointer.RIGHT_BUTTON&a&&this.rightButton.start(c);b.Pointer.MIDDLE_BUTTON&a&&this.middleButton.start(c);b.Pointer.BACK_BUTTON&
a&&this.backButton.start(c);b.Pointer.FORWARD_BUTTON&a&&this.forwardButton.start(c);b.Pointer.ERASER_BUTTON&a&&this.eraserButton.start(c)},processButtonsUp:function(a,c){a===b.Mouse.LEFT_BUTTON&&this.leftButton.stop(c);a===b.Mouse.RIGHT_BUTTON&&this.rightButton.stop(c);a===b.Mouse.MIDDLE_BUTTON&&this.middleButton.stop(c);a===b.Mouse.BACK_BUTTON&&this.backButton.stop(c);a===b.Mouse.FORWARD_BUTTON&&this.forwardButton.stop(c);5===a&&this.eraserButton.stop(c)},updateButtons:function(a){this.button=a.button;
var c="down"===a.type.toLowerCase().substr(-4);void 0!==a.buttons?c?this.processButtonsDown(a.buttons,a):this.processButtonsUp(a.button,a):c?this.leftButton.start(a):(this.leftButton.stop(a),this.rightButton.stop(a));1===a.buttons&&a.ctrlKey&&this.leftButton.isDown&&(this.leftButton.stop(a),this.rightButton.start(a));this.isUp=!0;this.isDown=!1;if(this.leftButton.isDown||this.rightButton.isDown||this.middleButton.isDown||this.backButton.isDown||this.forwardButton.isDown||this.eraserButton.isDown)this.isUp=
!1,this.isDown=!0},start:function(a){var c=this.game.input;a.pointerId&&(this.pointerId=a.pointerId);this.identifier=a.identifier;this.target=a.target;this.isMouse?this.updateButtons(a):(this.isDown=!0,this.isUp=!1);this.withinGame=this.active=!0;this.dirty=!1;this._history=[];this._trampolineTargetObject=this._clickTrampolines=null;this.msSinceLastClick=this.game.time.time-this.timeDown;this.timeDown=this.game.time.time;this._holdSent=!1;this.move(a,!0);this.positionDown.setTo(this.x,this.y);if(c.multiInputOverride===
b.Input.MOUSE_OVERRIDES_TOUCH||c.multiInputOverride===b.Input.MOUSE_TOUCH_COMBINE||c.multiInputOverride===b.Input.TOUCH_OVERRIDES_MOUSE&&0===c.totalActivePointers)c.x=this.x,c.y=this.y,c.position.setTo(this.x,this.y),c.onDown.dispatch(this,a),c.resetSpeed(this.x,this.y);this._stateReset=!1;this.totalTouches++;null!==this.targetObject&&this.targetObject._touchedHandler(this);return this},update:function(){var a=this.game.input;this.active&&(this.dirty&&(0<a.interactiveItems.total&&this.processInteractiveObjects(!1),
this.dirty=!1),!1===this._holdSent&&this.duration>=a.holdRate&&((a.multiInputOverride===b.Input.MOUSE_OVERRIDES_TOUCH||a.multiInputOverride===b.Input.MOUSE_TOUCH_COMBINE||a.multiInputOverride===b.Input.TOUCH_OVERRIDES_MOUSE&&0===a.totalActivePointers)&&a.onHold.dispatch(this),this._holdSent=!0),a.recordPointerHistory&&this.game.time.time>=this._nextDrop&&(this._nextDrop=this.game.time.time+a.recordRate,this._history.push({x:this.position.x,y:this.position.y}),this._history.length>a.recordLimit&&this._history.shift()))},
move:function(a,c){var d=this.game.input;if(!d.pollLocked){void 0===c&&(c=!1);void 0!==a.button&&(this.button=a.button);c&&this.isMouse&&this.updateButtons(a);this.clientX=a.clientX;this.clientY=a.clientY;this.pageX=a.pageX;this.pageY=a.pageY;this.screenX=a.screenX;this.screenY=a.screenY;this.isMouse&&d.mouse.locked&&!c&&(this.rawMovementX=a.movementX||a.mozMovementX||a.webkitMovementX||0,this.rawMovementY=a.movementY||a.mozMovementY||a.webkitMovementY||0,this.movementX+=this.rawMovementX,this.movementY+=
this.rawMovementY);this.x=(this.pageX-this.game.scale.offset.x)*d.scale.x;this.y=(this.pageY-this.game.scale.offset.y)*d.scale.y;this.position.setTo(this.x,this.y);this.circle.x=this.x;this.circle.y=this.y;if(d.multiInputOverride===b.Input.MOUSE_OVERRIDES_TOUCH||d.multiInputOverride===b.Input.MOUSE_TOUCH_COMBINE||d.multiInputOverride===b.Input.TOUCH_OVERRIDES_MOUSE&&0===d.totalActivePointers)d.activePointer=this,d.x=this.x,d.y=this.y,d.position.setTo(d.x,d.y),d.circle.x=d.x,d.circle.y=d.y;this.withinGame=
this.game.scale.bounds.contains(this.pageX,this.pageY);if(this.game.paused)return this;for(var e=d.moveCallbacks.length;e--;)d.moveCallbacks[e].callback.call(d.moveCallbacks[e].context,this,this.x,this.y,c);null!==this.targetObject&&!0===this.targetObject.isDragged?!1===this.targetObject.update(this)&&(this.targetObject=null):0<d.interactiveItems.total&&this.processInteractiveObjects(c);return this}},processInteractiveObjects:function(a){var c=0,b=-1,e=null,k=this.game.input.interactiveItems.first;
for(this.interactiveCandidates=[];k;)k.checked=!1,k.validForInput(b,c,!1)&&(k.checked=!0,a&&k.checkPointerDown(this,!0)||!a&&k.checkPointerOver(this,!0))&&(c=k.sprite.renderOrderID,b=k.priorityID,e=k,this.interactiveCandidates.push(k)),k=this.game.input.interactiveItems.next;for(k=this.game.input.interactiveItems.first;k;)!k.checked&&k.validForInput(b,c,!0)&&(a&&k.checkPointerDown(this,!1)||!a&&k.checkPointerOver(this,!1))&&(c=k.sprite.renderOrderID,b=k.priorityID,e=k,this.interactiveCandidates.push(k)),
k=this.game.input.interactiveItems.next;this.game.input.customCandidateHandler&&(e=this.game.input.customCandidateHandler.call(this.game.input.customCandidateHandlerContext,this,this.interactiveCandidates,e));this.swapTarget(e,!1);return null!==this.targetObject},swapTarget:function(a,c){void 0===c&&(c=!1);null===a?this.targetObject&&(this.targetObject._pointerOutHandler(this,c),this.targetObject=null):null===this.targetObject?(this.targetObject=a,a._pointerOverHandler(this,c)):this.targetObject===
a?!1===a.update(this)&&(this.targetObject=null):(this.targetObject._pointerOutHandler(this,c),this.targetObject=a,this.targetObject._pointerOverHandler(this,c))},leave:function(a){this.withinGame=!1;this.move(a,!1)},stop:function(a){var c=this.game.input;if(this._stateReset&&this.withinGame)a.preventDefault();else{this.timeUp=this.game.time.time;if(c.multiInputOverride===b.Input.MOUSE_OVERRIDES_TOUCH||c.multiInputOverride===b.Input.MOUSE_TOUCH_COMBINE||c.multiInputOverride===b.Input.TOUCH_OVERRIDES_MOUSE&&
0===c.totalActivePointers)c.onUp.dispatch(this,a),0<=this.duration&&this.duration<=c.tapRate&&(this.timeUp-this.previousTapTime<c.doubleTapRate?c.onTap.dispatch(this,!0):c.onTap.dispatch(this,!1),this.previousTapTime=this.timeUp);this.isMouse?this.updateButtons(a):(this.isDown=!1,this.isUp=!0);0<this.id&&(this.active=!1);this.withinGame=this.game.scale.bounds.contains(a.pageX,a.pageY);this.identifier=this.pointerId=null;this.positionUp.setTo(this.x,this.y);!1===this.isMouse&&c.currentPointers--;c.interactiveItems.callAll("_releasedHandler",
this);this._clickTrampolines&&(this._trampolineTargetObject=this.targetObject);this.targetObject=null;return this}},justPressed:function(a){a=a||this.game.input.justPressedRate;return!0===this.isDown&&this.timeDown+a>this.game.time.time},justReleased:function(a){a=a||this.game.input.justReleasedRate;return this.isUp&&this.timeUp+a>this.game.time.time},addClickTrampoline:function(a,c,b,e){if(this.isDown){for(var d=this._clickTrampolines=this._clickTrampolines||[],m=0;m<d.length;m++)if(d[m].name===
a){d.splice(m,1);break}d.push({name:a,targetObject:this.targetObject,callback:c,callbackContext:b,callbackArgs:e})}},processClickTrampolines:function(){var a=this._clickTrampolines;if(a){for(var c=0;c<a.length;c++){var b=a[c];b.targetObject===this._trampolineTargetObject&&b.callback.apply(b.callbackContext,b.callbackArgs)}this._trampolineTargetObject=this._clickTrampolines=null}},reset:function(){!1===this.isMouse&&(this.active=!1);this.identifier=this.pointerId=null;this.dirty=!1;this.totalTouches=
0;this._holdSent=!1;this._history.length=0;this._stateReset=!0;this.resetButtons();this.targetObject&&this.targetObject._releasedHandler(this);this.targetObject=null},resetMovement:function(){this.movementY=this.movementX=0}};b.Pointer.prototype.constructor=b.Pointer;Object.defineProperty(b.Pointer.prototype,"duration",{get:function(){return this.isUp?-1:this.game.time.time-this.timeDown}});Object.defineProperty(b.Pointer.prototype,"worldX",{get:function(){return this.game.world.camera.x+this.x}});
Object.defineProperty(b.Pointer.prototype,"worldY",{get:function(){return this.game.world.camera.y+this.y}});b.PointerMode={CURSOR:1,CONTACT:2};b.Touch=function(a){this.game=a;this.enabled=!0;this.touchLockCallbacks=[];this.callbackContext=this.game;this.touchCancelCallback=this.touchLeaveCallback=this.touchEnterCallback=this.touchEndCallback=this.touchMoveCallback=this.touchStartCallback=null;this.preventDefault=!0;this._onTouchMove=this._onTouchCancel=this._onTouchLeave=this._onTouchEnter=this._onTouchEnd=
this._onTouchMove=this._onTouchStart=this.event=null};b.Touch.prototype={start:function(){if(null===this._onTouchStart){var a=this;this.game.device.touch&&(this._onTouchStart=function(c){return a.onTouchStart(c)},this._onTouchMove=function(c){return a.onTouchMove(c)},this._onTouchEnd=function(c){return a.onTouchEnd(c)},this._onTouchEnter=function(c){return a.onTouchEnter(c)},this._onTouchLeave=function(c){return a.onTouchLeave(c)},this._onTouchCancel=function(c){return a.onTouchCancel(c)},this.game.canvas.addEventListener("touchstart",
this._onTouchStart,!1),this.game.canvas.addEventListener("touchmove",this._onTouchMove,!1),this.game.canvas.addEventListener("touchend",this._onTouchEnd,!1),this.game.canvas.addEventListener("touchcancel",this._onTouchCancel,!1),this.game.device.cocoonJS||(this.game.canvas.addEventListener("touchenter",this._onTouchEnter,!1),this.game.canvas.addEventListener("touchleave",this._onTouchLeave,!1)))}},consumeDocumentTouches:function(){this._documentTouchMove=function(a){a.preventDefault()};document.addEventListener("touchmove",
this._documentTouchMove,!1)},addTouchLockCallback:function(a,c,b){void 0===b&&(b=!1);this.touchLockCallbacks.push({callback:a,context:c,onEnd:b})},removeTouchLockCallback:function(a,c){for(var b=this.touchLockCallbacks.length;b--;)if(this.touchLockCallbacks[b].callback===a&&this.touchLockCallbacks[b].context===c)return this.touchLockCallbacks.splice(b,1),!0;return!1},onTouchStart:function(a){for(var c=this.touchLockCallbacks.length;c--;){var b=this.touchLockCallbacks[c];!b.onEnd&&b.callback.call(b.context,
this,a)&&this.touchLockCallbacks.splice(c,1)}this.event=a;if(this.game.input.enabled&&this.enabled)for(this.touchStartCallback&&this.touchStartCallback.call(this.callbackContext,a),this.preventDefault&&a.preventDefault(),c=0;c<a.changedTouches.length;c++)this.game.input.startPointer(a.changedTouches[c])},onTouchCancel:function(a){this.event=a;this.touchCancelCallback&&this.touchCancelCallback.call(this.callbackContext,a);if(this.game.input.enabled&&this.enabled){this.preventDefault&&a.preventDefault();
for(var c=0;c<a.changedTouches.length;c++)this.game.input.stopPointer(a.changedTouches[c])}},onTouchEnter:function(a){this.event=a;this.touchEnterCallback&&this.touchEnterCallback.call(this.callbackContext,a);this.game.input.enabled&&this.enabled&&this.preventDefault&&a.preventDefault()},onTouchLeave:function(a){this.event=a;this.touchLeaveCallback&&this.touchLeaveCallback.call(this.callbackContext,a);this.preventDefault&&a.preventDefault()},onTouchMove:function(a){this.event=a;this.touchMoveCallback&&
this.touchMoveCallback.call(this.callbackContext,a);this.preventDefault&&a.preventDefault();for(var c=0;c<a.changedTouches.length;c++)this.game.input.updatePointer(a.changedTouches[c])},onTouchEnd:function(a){for(var c=this.touchLockCallbacks.length;c--;){var b=this.touchLockCallbacks[c];b.onEnd&&b.callback.call(b.context,this,a)&&this.touchLockCallbacks.splice(c,1)}this.event=a;this.touchEndCallback&&this.touchEndCallback.call(this.callbackContext,a);this.preventDefault&&a.preventDefault();for(c=
0;c<a.changedTouches.length;c++)this.game.input.stopPointer(a.changedTouches[c])},stop:function(){this.game.device.touch&&(this.game.canvas.removeEventListener("touchstart",this._onTouchStart),this.game.canvas.removeEventListener("touchmove",this._onTouchMove),this.game.canvas.removeEventListener("touchend",this._onTouchEnd),this.game.canvas.removeEventListener("touchenter",this._onTouchEnter),this.game.canvas.removeEventListener("touchleave",this._onTouchLeave),this.game.canvas.removeEventListener("touchcancel",
this._onTouchCancel))}};b.Touch.prototype.constructor=b.Touch;b.InputHandler=function(a){this.sprite=a;this.game=a.game;this.checked=this.enabled=!1;this.priorityID=0;this.isDragged=this._setHandCursor=this.useHandCursor=!1;this.allowVerticalDrag=this.allowHorizontalDrag=!0;this.bringToTop=!1;this.snapOffset=null;this.snapOnRelease=this.snapOnDrag=!1;this.snapOffsetY=this.snapOffsetX=this.snapY=this.snapX=0;this.pixelPerfectClick=this.pixelPerfectOver=!1;this.pixelPerfectAlpha=255;this.draggable=
!1;this.boundsSprite=this.boundsRect=null;this.scaleLayer=!1;this.dragOffset=new b.Point;this.dragStopBlocksInputUp=this.dragFromCenter=!1;this.dragStartPoint=new b.Point;this.dragTimeThreshold=this.dragDistanceThreshold=0;this.downPoint=new b.Point;this.snapPoint=new b.Point;this._dragPoint=new b.Point;this._wasEnabled=this._dragDistancePass=this._dragTimePass=this._pendingDrag=this._dragPhase=!1;this._tempPoint=new b.Point;this._pointerData=[];this._pointerData.push({id:0,x:0,y:0,camX:0,camY:0,
isDown:!1,isUp:!1,isOver:!1,isOut:!1,timeOver:0,timeOut:0,timeDown:0,timeUp:0,downDuration:0,isDragged:!1})};b.InputHandler.prototype={start:function(a,c){a=a||0;void 0===c&&(c=!1);if(!1===this.enabled){this.game.input.interactiveItems.add(this);this.useHandCursor=c;this.priorityID=a;for(var d=0;10>d;d++)this._pointerData[d]={id:d,x:0,y:0,isDown:!1,isUp:!1,isOver:!1,isOut:!1,timeOver:0,timeOut:0,timeDown:0,timeUp:0,downDuration:0,isDragged:!1};this.snapOffset=new b.Point;this._wasEnabled=this.enabled=
!0}this.sprite.events.onAddedToGroup.add(this.addedToGroup,this);this.sprite.events.onRemovedFromGroup.add(this.removedFromGroup,this);return this.sprite},addedToGroup:function(){this._dragPhase||this._wasEnabled&&!this.enabled&&this.start()},removedFromGroup:function(){this._dragPhase||(this.enabled?(this._wasEnabled=!0,this.stop()):this._wasEnabled=!1)},reset:function(){this.enabled=!1;for(var a=0;10>a;a++)this._pointerData[a]={id:a,x:0,y:0,isDown:!1,isUp:!1,isOver:!1,isOut:!1,timeOver:0,timeOut:0,
timeDown:0,timeUp:0,downDuration:0,isDragged:!1}},stop:function(){!1!==this.enabled&&(this.enabled=!1,this.game.input.interactiveItems.remove(this))},destroy:function(){this.sprite&&(this._setHandCursor&&(this.game.canvas.style.cursor="default",this._setHandCursor=!1),this.enabled=!1,this.game.input.interactiveItems.remove(this),this._pointerData.length=0,this.sprite=this.boundsSprite=this.boundsRect=null)},validForInput:function(a,c,b){void 0===b&&(b=!0);return!this.enabled||0===this.sprite.scale.x||
0===this.sprite.scale.y||this.priorityID<this.game.input.minPriorityID||this.sprite.parent&&this.sprite.parent.ignoreChildInput||!b&&(this.pixelPerfectClick||this.pixelPerfectOver)?!1:this.priorityID>a||this.priorityID===a&&this.sprite.renderOrderID>c?!0:!1},isPixelPerfect:function(){return this.pixelPerfectClick||this.pixelPerfectOver},pointerX:function(a){return this._pointerData[a||0].x},pointerY:function(a){return this._pointerData[a||0].y},pointerDown:function(a){return this._pointerData[a||
0].isDown},pointerUp:function(a){return this._pointerData[a||0].isUp},pointerTimeDown:function(a){return this._pointerData[a||0].timeDown},pointerTimeUp:function(a){return this._pointerData[a||0].timeUp},pointerOver:function(a){if(!this.enabled)return!1;if(void 0===a){for(a=0;10>a;a++)if(this._pointerData[a].isOver)return!0;return!1}return this._pointerData[a].isOver},pointerOut:function(a){if(!this.enabled)return!1;if(void 0===a)for(a=0;10>a;a++){if(this._pointerData[a].isOut)return!0}else return this._pointerData[a].isOut},
pointerTimeOver:function(a){return this._pointerData[a||0].timeOver},pointerTimeOut:function(a){return this._pointerData[a||0].timeOut},pointerDragged:function(a){return this._pointerData[a||0].isDragged},checkPointerDown:function(a,c){return a.isDown&&this.enabled&&this.sprite&&this.sprite.parent&&this.sprite.visible&&this.sprite.parent.visible&&0!==this.sprite.worldScale.x&&0!==this.sprite.worldScale.y?this.game.input.hitTest(this.sprite,a,this._tempPoint)?(void 0===c&&(c=!1),!c&&this.pixelPerfectClick?
this.checkPixel(this._tempPoint.x,this._tempPoint.y):!0):!1:!1},checkPointerOver:function(a,c){return this.enabled&&this.sprite&&this.sprite.parent&&this.sprite.visible&&this.sprite.parent.visible&&0!==this.sprite.worldScale.x&&0!==this.sprite.worldScale.y?this.game.input.hitTest(this.sprite,a,this._tempPoint)?(void 0===c&&(c=!1),!c&&this.pixelPerfectOver?this.checkPixel(this._tempPoint.x,this._tempPoint.y):!0):!1:!1},checkPixel:function(a,c,b){if(this.sprite.texture.baseTexture.source){null===a&&
null===c&&(this.game.input.getLocalPosition(this.sprite,b,this._tempPoint),a=this._tempPoint.x,c=this._tempPoint.y);0!==this.sprite.anchor.x&&(a-=-this.sprite.texture.frame.width*this.sprite.anchor.x);0!==this.sprite.anchor.y&&(c-=-this.sprite.texture.frame.height*this.sprite.anchor.y);a+=this.sprite.texture.frame.x;c+=this.sprite.texture.frame.y;if(this.sprite.texture.trim&&(a-=this.sprite.texture.trim.x,c-=this.sprite.texture.trim.y,a<this.sprite.texture.crop.x||a>this.sprite.texture.crop.right||
c<this.sprite.texture.crop.y||c>this.sprite.texture.crop.bottom))return this._dx=a,this._dy=c,!1;this._dx=a;this._dy=c;this.game.input.hitContext.clearRect(0,0,1,1);this.game.input.hitContext.drawImage(this.sprite.texture.baseTexture.source,a,c,1,1,0,0,1,1);if(this.game.input.hitContext.getImageData(0,0,1,1).data[3]>=this.pixelPerfectAlpha)return!0}return!1},update:function(a){if(null!==this.sprite&&void 0!==this.sprite.parent){if(!this.enabled||!this.sprite.visible||!this.sprite.parent.visible)return this._pointerOutHandler(a),
!1;if(this._pendingDrag)return this._dragDistancePass||(this._dragDistancePass=b.Math.distance(a.x,a.y,this.downPoint.x,this.downPoint.y)>=this.dragDistanceThreshold),this._dragDistancePass&&this._dragTimePass&&this.startDrag(a),!0;if(this.draggable&&this._draggedPointerID===a.id)return this.updateDrag(a,!1);if(this._pointerData[a.id].isOver){if(this.checkPointerOver(a))return this._pointerData[a.id].x=a.x-this.sprite.x,this._pointerData[a.id].y=a.y-this.sprite.y,!0;this._pointerOutHandler(a);return!1}}},
_pointerOverHandler:function(a,c){if(null!==this.sprite){var d=this._pointerData[a.id];if(!1===d.isOver||a.dirty){var e=!1===d.isOver;d.isOver=!0;d.isOut=!1;d.timeOver=this.game.time.time;d.x=a.x-this.sprite.x;d.y=a.y-this.sprite.y;this.useHandCursor&&!1===d.isDragged&&(this.game.canvas.style.cursor="pointer",this._setHandCursor=!0);if(!c&&e&&this.sprite&&this.sprite.events)this.sprite.events.onInputOver$dispatch(this.sprite,a);this.sprite.parent&&this.sprite.parent.type===b.GROUP&&this.sprite.parent.onChildInputOver.dispatch(this.sprite,
a)}}},_pointerOutHandler:function(a,c){if(null!==this.sprite){var d=this._pointerData[a.id];d.isOver=!1;d.isOut=!0;d.timeOut=this.game.time.time;this.useHandCursor&&!1===d.isDragged&&(this.game.canvas.style.cursor="default",this._setHandCursor=!1);!c&&this.sprite&&this.sprite.events&&(this.sprite.events.onInputOut$dispatch(this.sprite,a),this.sprite&&this.sprite.parent&&this.sprite.parent.type===b.GROUP&&this.sprite.parent.onChildInputOut.dispatch(this.sprite,a))}},_touchedHandler:function(a){if(null!==
this.sprite){var c=this._pointerData[a.id];if(!c.isDown&&c.isOver&&(!this.pixelPerfectClick||this.checkPixel(null,null,a))){c.isDown=!0;c.isUp=!1;c.timeDown=this.game.time.time;this.downPoint.set(a.x,a.y);a.dirty=!0;if(this.sprite&&this.sprite.events&&(this.sprite.events.onInputDown$dispatch(this.sprite,a),this.sprite&&this.sprite.parent&&this.sprite.parent.type===b.GROUP&&this.sprite.parent.onChildInputDown.dispatch(this.sprite,a),null===this.sprite))return;this.draggable&&!1===this.isDragged&&(0===
this.dragTimeThreshold&&0===this.dragDistanceThreshold?this.startDrag(a):(this._pendingDrag=!0,this._dragDistancePass=0===this.dragDistanceThreshold,0<this.dragTimeThreshold?(this._dragTimePass=!1,this.game.time.events.add(this.dragTimeThreshold,this.dragTimeElapsed,this,a)):this._dragTimePass=!0));this.bringToTop&&this.sprite.bringToTop()}}},dragTimeElapsed:function(a){this._dragTimePass=!0;this._pendingDrag&&this.sprite&&this._dragDistancePass&&this.startDrag(a)},_releasedHandler:function(a){if(null!==
this.sprite){var c=this._pointerData[a.id];if(c.isDown&&a.isUp){c.isDown=!1;c.isUp=!0;c.timeUp=this.game.time.time;c.downDuration=c.timeUp-c.timeDown;var d=this.checkPointerOver(a);if(this.sprite&&this.sprite.events){if(!this.dragStopBlocksInputUp||this.dragStopBlocksInputUp&&(!this.draggable||!this.isDragged||this._draggedPointerID!==a.id))this.sprite.events.onInputUp$dispatch(this.sprite,a,d);this.sprite&&this.sprite.parent&&this.sprite.parent.type===b.GROUP&&this.sprite.parent.onChildInputUp.dispatch(this.sprite,
a,d);d&&(d=this.checkPointerOver(a))}c.isOver=d;!d&&this.useHandCursor&&(this.game.canvas.style.cursor="default",this._setHandCursor=!1);a.dirty=!0;this._pendingDrag=!1;this.draggable&&this.isDragged&&this._draggedPointerID===a.id&&this.stopDrag(a)}}},updateDrag:function(a,c){void 0===c&&(c=!1);if(a.isUp)return this.stopDrag(a),!1;var b=this.globalToLocalX(a.x)+this._dragPoint.x+this.dragOffset.x,e=this.globalToLocalY(a.y)+this._dragPoint.y+this.dragOffset.y;if(this.sprite.fixedToCamera)this.allowHorizontalDrag&&
(this.sprite.cameraOffset.x=b),this.allowVerticalDrag&&(this.sprite.cameraOffset.y=e),this.boundsRect&&this.checkBoundsRect(),this.boundsSprite&&this.checkBoundsSprite(),this.snapOnDrag&&(this.sprite.cameraOffset.x=Math.round((this.sprite.cameraOffset.x-this.snapOffsetX%this.snapX)/this.snapX)*this.snapX+this.snapOffsetX%this.snapX,this.sprite.cameraOffset.y=Math.round((this.sprite.cameraOffset.y-this.snapOffsetY%this.snapY)/this.snapY)*this.snapY+this.snapOffsetY%this.snapY,this.snapPoint.set(this.sprite.cameraOffset.x,
this.sprite.cameraOffset.y));else{var k=this.game.camera.x-this._pointerData[a.id].camX,m=this.game.camera.y-this._pointerData[a.id].camY;this.allowHorizontalDrag&&(this.sprite.x=b+k);this.allowVerticalDrag&&(this.sprite.y=e+m);this.boundsRect&&this.checkBoundsRect();this.boundsSprite&&this.checkBoundsSprite();this.snapOnDrag&&(this.sprite.x=Math.round((this.sprite.x-this.snapOffsetX%this.snapX)/this.snapX)*this.snapX+this.snapOffsetX%this.snapX,this.sprite.y=Math.round((this.sprite.y-this.snapOffsetY%
this.snapY)/this.snapY)*this.snapY+this.snapOffsetY%this.snapY,this.snapPoint.set(this.sprite.x,this.sprite.y))}this.sprite.events.onDragUpdate.dispatch(this.sprite,a,b,e,this.snapPoint,c);return!0},justOver:function(a,c){a=a||0;c=c||500;return this._pointerData[a].isOver&&this.overDuration(a)<c},justOut:function(a,c){a=a||0;return this._pointerData[a].isOut&&this.game.time.time-this._pointerData[a].timeOut<(c||500)},justPressed:function(a,c){a=a||0;c=c||500;return this._pointerData[a].isDown&&this.downDuration(a)<
c},justReleased:function(a,c){a=a||0;return this._pointerData[a].isUp&&this.game.time.time-this._pointerData[a].timeUp<(c||500)},overDuration:function(a){a=a||0;return this._pointerData[a].isOver?this.game.time.time-this._pointerData[a].timeOver:-1},downDuration:function(a){a=a||0;return this._pointerData[a].isDown?this.game.time.time-this._pointerData[a].timeDown:-1},enableDrag:function(a,c,d,e,k,m){void 0===a&&(a=!1);void 0===c&&(c=!1);void 0===d&&(d=!1);void 0===e&&(e=255);void 0===k&&(k=null);
void 0===m&&(m=null);this._dragPoint=new b.Point;this.draggable=!0;this.bringToTop=c;this.dragOffset=new b.Point;this.dragFromCenter=a;this.pixelPerfectClick=d;this.pixelPerfectAlpha=e;k&&(this.boundsRect=k);m&&(this.boundsSprite=m)},disableDrag:function(){if(this._pointerData)for(var a=0;10>a;a++)this._pointerData[a].isDragged=!1;this.isDragged=this.draggable=!1;this._draggedPointerID=-1;this._pendingDrag=!1},startDrag:function(a){var c=this.sprite.x,b=this.sprite.y;this.isDragged=!0;this._draggedPointerID=
a.id;this._pointerData[a.id].camX=this.game.camera.x;this._pointerData[a.id].camY=this.game.camera.y;this._pointerData[a.id].isDragged=!0;if(this.sprite.fixedToCamera){if(this.dragFromCenter){var e=this.sprite.getBounds();this.sprite.cameraOffset.x=this.globalToLocalX(a.x)+(this.sprite.cameraOffset.x-e.centerX);this.sprite.cameraOffset.y=this.globalToLocalY(a.y)+(this.sprite.cameraOffset.y-e.centerY)}this._dragPoint.setTo(this.sprite.cameraOffset.x-a.x,this.sprite.cameraOffset.y-a.y)}else this.dragFromCenter&&
(e=this.sprite.getBounds(),this.sprite.x=this.globalToLocalX(a.x)+(this.sprite.x-e.centerX),this.sprite.y=this.globalToLocalY(a.y)+(this.sprite.y-e.centerY)),this._dragPoint.setTo(this.sprite.x-this.globalToLocalX(a.x),this.sprite.y-this.globalToLocalY(a.y));this.updateDrag(a,!0);this.bringToTop&&(this._dragPhase=!0,this.sprite.bringToTop());this.dragStartPoint.set(c,b);this.sprite.events.onDragStart$dispatch(this.sprite,a,c,b);this._pendingDrag=!1},globalToLocalX:function(a){this.scaleLayer&&(a-=
this.game.scale.grid.boundsFluid.x,a*=this.game.scale.grid.scaleFluidInversed.x);return a},globalToLocalY:function(a){this.scaleLayer&&(a-=this.game.scale.grid.boundsFluid.y,a*=this.game.scale.grid.scaleFluidInversed.y);return a},stopDrag:function(a){this.isDragged=!1;this._draggedPointerID=-1;this._pendingDrag=this._dragPhase=this._pointerData[a.id].isDragged=!1;this.snapOnRelease&&(this.sprite.fixedToCamera?(this.sprite.cameraOffset.x=Math.round((this.sprite.cameraOffset.x-this.snapOffsetX%this.snapX)/
this.snapX)*this.snapX+this.snapOffsetX%this.snapX,this.sprite.cameraOffset.y=Math.round((this.sprite.cameraOffset.y-this.snapOffsetY%this.snapY)/this.snapY)*this.snapY+this.snapOffsetY%this.snapY):(this.sprite.x=Math.round((this.sprite.x-this.snapOffsetX%this.snapX)/this.snapX)*this.snapX+this.snapOffsetX%this.snapX,this.sprite.y=Math.round((this.sprite.y-this.snapOffsetY%this.snapY)/this.snapY)*this.snapY+this.snapOffsetY%this.snapY));this.sprite.events.onDragStop$dispatch(this.sprite,a);!1===this.checkPointerOver(a)&&
this._pointerOutHandler(a)},setDragLock:function(a,c){void 0===a&&(a=!0);void 0===c&&(c=!0);this.allowHorizontalDrag=a;this.allowVerticalDrag=c},enableSnap:function(a,c,b,e,k,m){void 0===b&&(b=!0);void 0===e&&(e=!1);void 0===k&&(k=0);void 0===m&&(m=0);this.snapX=a;this.snapY=c;this.snapOffsetX=k;this.snapOffsetY=m;this.snapOnDrag=b;this.snapOnRelease=e},disableSnap:function(){this.snapOnRelease=this.snapOnDrag=!1},checkBoundsRect:function(){this.sprite.fixedToCamera?(this.sprite.cameraOffset.x<this.boundsRect.left?
this.sprite.cameraOffset.x=this.boundsRect.left:this.sprite.cameraOffset.x+this.sprite.width>this.boundsRect.right&&(this.sprite.cameraOffset.x=this.boundsRect.right-this.sprite.width),this.sprite.cameraOffset.y<this.boundsRect.top?this.sprite.cameraOffset.y=this.boundsRect.top:this.sprite.cameraOffset.y+this.sprite.height>this.boundsRect.bottom&&(this.sprite.cameraOffset.y=this.boundsRect.bottom-this.sprite.height)):(this.sprite.left<this.boundsRect.left?this.sprite.x=this.boundsRect.x+this.sprite.offsetX:
this.sprite.right>this.boundsRect.right&&(this.sprite.x=this.boundsRect.right-(this.sprite.width-this.sprite.offsetX)),this.sprite.top<this.boundsRect.top?this.sprite.y=this.boundsRect.top+this.sprite.offsetY:this.sprite.bottom>this.boundsRect.bottom&&(this.sprite.y=this.boundsRect.bottom-(this.sprite.height-this.sprite.offsetY)))},checkBoundsSprite:function(){this.sprite.fixedToCamera&&this.boundsSprite.fixedToCamera?(this.sprite.cameraOffset.x<this.boundsSprite.cameraOffset.x?this.sprite.cameraOffset.x=
this.boundsSprite.cameraOffset.x:this.sprite.cameraOffset.x+this.sprite.width>this.boundsSprite.cameraOffset.x+this.boundsSprite.width&&(this.sprite.cameraOffset.x=this.boundsSprite.cameraOffset.x+this.boundsSprite.width-this.sprite.width),this.sprite.cameraOffset.y<this.boundsSprite.cameraOffset.y?this.sprite.cameraOffset.y=this.boundsSprite.cameraOffset.y:this.sprite.cameraOffset.y+this.sprite.height>this.boundsSprite.cameraOffset.y+this.boundsSprite.height&&(this.sprite.cameraOffset.y=this.boundsSprite.cameraOffset.y+
this.boundsSprite.height-this.sprite.height)):(this.sprite.left<this.boundsSprite.left?this.sprite.x=this.boundsSprite.left+this.sprite.offsetX:this.sprite.right>this.boundsSprite.right&&(this.sprite.x=this.boundsSprite.right-(this.sprite.width-this.sprite.offsetX)),this.sprite.top<this.boundsSprite.top?this.sprite.y=this.boundsSprite.top+this.sprite.offsetY:this.sprite.bottom>this.boundsSprite.bottom&&(this.sprite.y=this.boundsSprite.bottom-(this.sprite.height-this.sprite.offsetY)))}};b.InputHandler.prototype.constructor=
b.InputHandler;b.Gamepad=function(a){this.game=a;this._gamepadIndexMap={};this._rawPads=[];this._active=!1;this.enabled=!0;this._gamepadSupportAvailable=!!navigator.webkitGetGamepads||!!navigator.webkitGamepads||-1!==navigator.userAgent.indexOf("Firefox/")||!!navigator.getGamepads;this._prevRawGamepadTypes=[];this._prevTimestamps=[];this.callbackContext=this;this._gamepaddisconnected=this._ongamepadconnected=this.onFloatCallback=this.onAxisCallback=this.onUpCallback=this.onDownCallback=this.onDisconnectCallback=
this.onConnectCallback=null;this._gamepads=[new b.SinglePad(a,this),new b.SinglePad(a,this),new b.SinglePad(a,this),new b.SinglePad(a,this)]};b.Gamepad.prototype={addCallbacks:function(a,c){"undefined"!==typeof c&&(this.onConnectCallback="function"===typeof c.onConnect?c.onConnect:this.onConnectCallback,this.onDisconnectCallback="function"===typeof c.onDisconnect?c.onDisconnect:this.onDisconnectCallback,this.onDownCallback="function"===typeof c.onDown?c.onDown:this.onDownCallback,this.onUpCallback=
"function"===typeof c.onUp?c.onUp:this.onUpCallback,this.onAxisCallback="function"===typeof c.onAxis?c.onAxis:this.onAxisCallback,this.onFloatCallback="function"===typeof c.onFloat?c.onFloat:this.onFloatCallback,this.callbackContext=a)},start:function(){if(!this._active){this._active=!0;var a=this;this._onGamepadConnected=function(c){return a.onGamepadConnected(c)};this._onGamepadDisconnected=function(c){return a.onGamepadDisconnected(c)};window.addEventListener("gamepadconnected",this._onGamepadConnected,
!1);window.addEventListener("gamepaddisconnected",this._onGamepadDisconnected,!1)}},onGamepadConnected:function(a){a=a.gamepad;this._rawPads.push(a);this._gamepads[a.index].connect(a)},onGamepadDisconnected:function(a){a=a.gamepad;for(var c in this._rawPads)this._rawPads[c].index===a.index&&this._rawPads.splice(c,1);this._gamepads[a.index].disconnect()},update:function(){this._pollGamepads();this.pad1.pollStatus();this.pad2.pollStatus();this.pad3.pollStatus();this.pad4.pollStatus()},_pollGamepads:function(){if(this._active){if(navigator.getGamepads)var a=
navigator.getGamepads();else navigator.webkitGetGamepads?a=navigator.webkitGetGamepads():navigator.webkitGamepads&&(a=navigator.webkitGamepads());if(a){this._rawPads=[];for(var c=!1,b=0;b<a.length&&(typeof a[b]!==this._prevRawGamepadTypes[b]&&(c=!0,this._prevRawGamepadTypes[b]=typeof a[b]),a[b]&&this._rawPads.push(a[b]),3!==b);b++);for(a=0;a<this._gamepads.length;a++)this._gamepads[a]._rawPad=this._rawPads[a];if(c){c={};a={};for(var e=0;e<this._gamepads.length;e++)if(b=this._gamepads[e],b.connected)for(var k=
0;k<this._rawPads.length;k++)this._rawPads[k].index===b.index&&(c[b.index]=!0,a[e]=!0);for(e=0;e<this._gamepads.length;e++)if(b=this._gamepads[e],!a[e])for(1>this._rawPads.length&&b.disconnect(),k=0;k<this._rawPads.length&&!a[e];k++){var m=this._rawPads[k];m?c[m.index]?b.disconnect():(b.connect(m),c[m.index]=!0,a[e]=!0):b.disconnect()}}}}},setDeadZones:function(a){for(var c=0;c<this._gamepads.length;c++)this._gamepads[c].deadZone=a},stop:function(){this._active=!1;window.removeEventListener("gamepadconnected",
this._onGamepadConnected);window.removeEventListener("gamepaddisconnected",this._onGamepadDisconnected)},reset:function(){this.update();for(var a=0;a<this._gamepads.length;a++)this._gamepads[a].reset()},justPressed:function(a,c){for(var b=0;b<this._gamepads.length;b++)if(!0===this._gamepads[b].justPressed(a,c))return!0;return!1},justReleased:function(a,c){for(var b=0;b<this._gamepads.length;b++)if(!0===this._gamepads[b].justReleased(a,c))return!0;return!1},isDown:function(a){for(var c=0;c<this._gamepads.length;c++)if(!0===
this._gamepads[c].isDown(a))return!0;return!1},destroy:function(){this.stop();for(var a=0;a<this._gamepads.length;a++)this._gamepads[a].destroy()}};b.Gamepad.prototype.constructor=b.Gamepad;Object.defineProperty(b.Gamepad.prototype,"active",{get:function(){return this._active}});Object.defineProperty(b.Gamepad.prototype,"supported",{get:function(){return this._gamepadSupportAvailable}});Object.defineProperty(b.Gamepad.prototype,"padsConnected",{get:function(){return this._rawPads.length}});Object.defineProperty(b.Gamepad.prototype,
"pad1",{get:function(){return this._gamepads[0]}});Object.defineProperty(b.Gamepad.prototype,"pad2",{get:function(){return this._gamepads[1]}});Object.defineProperty(b.Gamepad.prototype,"pad3",{get:function(){return this._gamepads[2]}});Object.defineProperty(b.Gamepad.prototype,"pad4",{get:function(){return this._gamepads[3]}});b.Gamepad.BUTTON_0=0;b.Gamepad.BUTTON_1=1;b.Gamepad.BUTTON_2=2;b.Gamepad.BUTTON_3=3;b.Gamepad.BUTTON_4=4;b.Gamepad.BUTTON_5=5;b.Gamepad.BUTTON_6=6;b.Gamepad.BUTTON_7=7;b.Gamepad.BUTTON_8=
8;b.Gamepad.BUTTON_9=9;b.Gamepad.BUTTON_10=10;b.Gamepad.BUTTON_11=11;b.Gamepad.BUTTON_12=12;b.Gamepad.BUTTON_13=13;b.Gamepad.BUTTON_14=14;b.Gamepad.BUTTON_15=15;b.Gamepad.AXIS_0=0;b.Gamepad.AXIS_1=1;b.Gamepad.AXIS_2=2;b.Gamepad.AXIS_3=3;b.Gamepad.AXIS_4=4;b.Gamepad.AXIS_5=5;b.Gamepad.AXIS_6=6;b.Gamepad.AXIS_7=7;b.Gamepad.AXIS_8=8;b.Gamepad.AXIS_9=9;b.Gamepad.XBOX360_A=0;b.Gamepad.XBOX360_B=1;b.Gamepad.XBOX360_X=2;b.Gamepad.XBOX360_Y=3;b.Gamepad.XBOX360_LEFT_BUMPER=4;b.Gamepad.XBOX360_RIGHT_BUMPER=
5;b.Gamepad.XBOX360_LEFT_TRIGGER=6;b.Gamepad.XBOX360_RIGHT_TRIGGER=7;b.Gamepad.XBOX360_BACK=8;b.Gamepad.XBOX360_START=9;b.Gamepad.XBOX360_STICK_LEFT_BUTTON=10;b.Gamepad.XBOX360_STICK_RIGHT_BUTTON=11;b.Gamepad.XBOX360_DPAD_LEFT=14;b.Gamepad.XBOX360_DPAD_RIGHT=15;b.Gamepad.XBOX360_DPAD_UP=12;b.Gamepad.XBOX360_DPAD_DOWN=13;b.Gamepad.XBOX360_STICK_LEFT_X=0;b.Gamepad.XBOX360_STICK_LEFT_Y=1;b.Gamepad.XBOX360_STICK_RIGHT_X=2;b.Gamepad.XBOX360_STICK_RIGHT_Y=3;b.Gamepad.PS3XC_X=0;b.Gamepad.PS3XC_CIRCLE=1;
b.Gamepad.PS3XC_SQUARE=2;b.Gamepad.PS3XC_TRIANGLE=3;b.Gamepad.PS3XC_L1=4;b.Gamepad.PS3XC_R1=5;b.Gamepad.PS3XC_L2=6;b.Gamepad.PS3XC_R2=7;b.Gamepad.PS3XC_SELECT=8;b.Gamepad.PS3XC_START=9;b.Gamepad.PS3XC_STICK_LEFT_BUTTON=10;b.Gamepad.PS3XC_STICK_RIGHT_BUTTON=11;b.Gamepad.PS3XC_DPAD_UP=12;b.Gamepad.PS3XC_DPAD_DOWN=13;b.Gamepad.PS3XC_DPAD_LEFT=14;b.Gamepad.PS3XC_DPAD_RIGHT=15;b.Gamepad.PS3XC_STICK_LEFT_X=0;b.Gamepad.PS3XC_STICK_LEFT_Y=1;b.Gamepad.PS3XC_STICK_RIGHT_X=2;b.Gamepad.PS3XC_STICK_RIGHT_Y=3;
b.SinglePad=function(a,c){this.game=a;this.index=null;this.connected=!1;this.callbackContext=this;this.onFloatCallback=this.onAxisCallback=this.onUpCallback=this.onDownCallback=this.onDisconnectCallback=this.onConnectCallback=null;this.deadZone=.26;this._padParent=c;this._prevTimestamp=this._rawPad=null;this._buttons=[];this._buttonsLen=0;this._axes=[];this._axesLen=0};b.SinglePad.prototype={addCallbacks:function(a,c){"undefined"!==typeof c&&(this.onConnectCallback="function"===typeof c.onConnect?
c.onConnect:this.onConnectCallback,this.onDisconnectCallback="function"===typeof c.onDisconnect?c.onDisconnect:this.onDisconnectCallback,this.onDownCallback="function"===typeof c.onDown?c.onDown:this.onDownCallback,this.onUpCallback="function"===typeof c.onUp?c.onUp:this.onUpCallback,this.onAxisCallback="function"===typeof c.onAxis?c.onAxis:this.onAxisCallback,this.onFloatCallback="function"===typeof c.onFloat?c.onFloat:this.onFloatCallback,this.callbackContext=a)},getButton:function(a){return this._buttons[a]?
this._buttons[a]:null},pollStatus:function(){if(this.connected&&this.game.input.enabled&&this.game.input.gamepad.enabled&&(!this._rawPad.timestamp||this._rawPad.timestamp!==this._prevTimestamp)){for(var a=0;a<this._buttonsLen;a++){var c=isNaN(this._rawPad.buttons[a])?this._rawPad.buttons[a].value:this._rawPad.buttons[a];c!==this._buttons[a].value&&(1===c?this.processButtonDown(a,c):0===c?this.processButtonUp(a,c):this.processButtonFloat(a,c))}for(a=0;a<this._axesLen;a++)c=this._rawPad.axes[a],0<c&&
c>this.deadZone||0>c&&c<-this.deadZone?this.processAxisChange(a,c):this.processAxisChange(a,0);this._prevTimestamp=this._rawPad.timestamp}},connect:function(a){var c=!this.connected;this.connected=!0;this.index=a.index;this._rawPad=a;this._buttons=[];this._buttonsLen=a.buttons.length;this._axes=[];this._axesLen=a.axes.length;for(var d=0;d<this._axesLen;d++)this._axes[d]=a.axes[d];for(var e in a.buttons)e=parseInt(e,10),this._buttons[e]=new b.DeviceButton(this,e);c&&this._padParent.onConnectCallback&&
this._padParent.onConnectCallback.call(this._padParent.callbackContext,this.index);c&&this.onConnectCallback&&this.onConnectCallback.call(this.callbackContext)},disconnect:function(){var a=this.connected,c=this.index;this.connected=!1;this.index=null;this._rawPad=void 0;for(var b=0;b<this._buttonsLen;b++)this._buttons[b].destroy();this._buttons=[];this._buttonsLen=0;this._axes=[];this._axesLen=0;a&&this._padParent.onDisconnectCallback&&this._padParent.onDisconnectCallback.call(this._padParent.callbackContext,
c);a&&this.onDisconnectCallback&&this.onDisconnectCallback.call(this.callbackContext)},destroy:function(){this._rawPad=void 0;for(var a=0;a<this._buttonsLen;a++)this._buttons[a].destroy();this._buttons=[];this._buttonsLen=0;this._axes=[];this._axesLen=0;this.onFloatCallback=this.onAxisCallback=this.onUpCallback=this.onDownCallback=this.onDisconnectCallback=this.onConnectCallback=null},processAxisChange:function(a,c){this._axes[a]!==c&&(this._axes[a]=c,this._padParent.onAxisCallback&&this._padParent.onAxisCallback.call(this._padParent.callbackContext,
this,a,c),this.onAxisCallback&&this.onAxisCallback.call(this.callbackContext,this,a,c))},processButtonDown:function(a,c){this._buttons[a]&&this._buttons[a].start(null,c);this._padParent.onDownCallback&&this._padParent.onDownCallback.call(this._padParent.callbackContext,a,c,this.index);this.onDownCallback&&this.onDownCallback.call(this.callbackContext,a,c)},processButtonUp:function(a,c){this._padParent.onUpCallback&&this._padParent.onUpCallback.call(this._padParent.callbackContext,a,c,this.index);
this.onUpCallback&&this.onUpCallback.call(this.callbackContext,a,c);this._buttons[a]&&this._buttons[a].stop(null,c)},processButtonFloat:function(a,c){this._padParent.onFloatCallback&&this._padParent.onFloatCallback.call(this._padParent.callbackContext,a,c,this.index);this.onFloatCallback&&this.onFloatCallback.call(this.callbackContext,a,c);this._buttons[a]&&this._buttons[a].padFloat(c)},axis:function(a){return this._axes[a]?this._axes[a]:!1},isDown:function(a){return this._buttons[a]?this._buttons[a].isDown:
!1},isUp:function(a){return this._buttons[a]?this._buttons[a].isUp:!1},justReleased:function(a,c){if(this._buttons[a])return this._buttons[a].justReleased(c)},justPressed:function(a,c){if(this._buttons[a])return this._buttons[a].justPressed(c)},buttonValue:function(a){return this._buttons[a]?this._buttons[a].value:null},reset:function(){for(var a=0;a<this._axes.length;a++)this._axes[a]=0}};b.SinglePad.prototype.constructor=b.SinglePad;b.Key=function(a,c){this.game=a;this._enabled=!0;this.event=null;
this.isDown=!1;this.isUp=!0;this.shiftKey=this.ctrlKey=this.altKey=!1;this.duration=this.timeDown=0;this.timeUp=-2500;this.repeats=0;this.keyCode=c;this.onDown=new b.Signal;this.onHoldContext=this.onHoldCallback=null;this.onUp=new b.Signal;this._justUp=this._justDown=!1};b.Key.prototype={update:function(){this._enabled&&this.isDown&&(this.duration=this.game.time.time-this.timeDown,this.repeats++,this.onHoldCallback&&this.onHoldCallback.call(this.onHoldContext,this))},processKeyDown:function(a){this._enabled&&
(this.event=a,this.isDown||(this.altKey=a.altKey,this.ctrlKey=a.ctrlKey,this.shiftKey=a.shiftKey,this.isDown=!0,this.isUp=!1,this.timeDown=this.game.time.time,this.repeats=this.duration=0,this._justDown=!0,this.onDown.dispatch(this)))},processKeyUp:function(a){this._enabled&&(this.event=a,this.isUp||(this.isDown=!1,this.isUp=!0,this.timeUp=this.game.time.time,this.duration=this.game.time.time-this.timeDown,this._justUp=!0,this.onUp.dispatch(this)))},reset:function(a){void 0===a&&(a=!0);this.isDown=
!1;this.isUp=!0;this.timeUp=this.game.time.time;this.duration=0;this._enabled=!0;this._justUp=this._justDown=!1;a&&(this.onDown.removeAll(),this.onUp.removeAll(),this.onHoldContext=this.onHoldCallback=null)},downDuration:function(a){void 0===a&&(a=50);return this.isDown&&this.duration<a},upDuration:function(a){void 0===a&&(a=50);return!this.isDown&&this.game.time.time-this.timeUp<a}};Object.defineProperty(b.Key.prototype,"justDown",{get:function(){var a=this._justDown;this._justDown=!1;return a}});
Object.defineProperty(b.Key.prototype,"justUp",{get:function(){var a=this._justUp;this._justUp=!1;return a}});Object.defineProperty(b.Key.prototype,"enabled",{get:function(){return this._enabled},set:function(a){a=!!a;a!==this._enabled&&(a||this.reset(!1),this._enabled=a)}});b.Key.prototype.constructor=b.Key;b.Keyboard=function(a){this.game=a;this.enabled=!0;this.pressEvent=this.event=null;this.callbackContext=this;this.onUpCallback=this.onPressCallback=this.onDownCallback=null;this._keys=[];this._capture=
[];this._onKeyUp=this._onKeyPress=this._onKeyDown=null;this._k=this._i=0};b.Keyboard.prototype={addCallbacks:function(a,c,b,e){this.callbackContext=a;void 0!==c&&null!==c&&(this.onDownCallback=c);void 0!==b&&null!==b&&(this.onUpCallback=b);void 0!==e&&null!==e&&(this.onPressCallback=e)},addKey:function(a){this._keys[a]||(this._keys[a]=new b.Key(this.game,a),this.addKeyCapture(a));return this._keys[a]},addKeys:function(a){var c={},b;for(b in a)c[b]=this.addKey(a[b]);return c},removeKey:function(a){this._keys[a]&&
(this._keys[a]=null,this.removeKeyCapture(a))},createCursorKeys:function(){return this.addKeys({up:b.KeyCode.UP,down:b.KeyCode.DOWN,left:b.KeyCode.LEFT,right:b.KeyCode.RIGHT})},start:function(){if(!this.game.device.cocoonJS&&null===this._onKeyDown){var a=this;this._onKeyDown=function(c){return a.processKeyDown(c)};this._onKeyUp=function(c){return a.processKeyUp(c)};this._onKeyPress=function(c){return a.processKeyPress(c)};window.addEventListener("keydown",this._onKeyDown,!1);window.addEventListener("keyup",
this._onKeyUp,!1);window.addEventListener("keypress",this._onKeyPress,!1)}},stop:function(){window.removeEventListener("keydown",this._onKeyDown);window.removeEventListener("keyup",this._onKeyUp);window.removeEventListener("keypress",this._onKeyPress);this._onKeyPress=this._onKeyUp=this._onKeyDown=null},destroy:function(){this.stop();this.clearCaptures();this._i=this._keys.length=0},addKeyCapture:function(a){if("object"===typeof a)for(var c in a)this._capture[a[c]]=!0;else this._capture[a]=!0},removeKeyCapture:function(a){delete this._capture[a]},
clearCaptures:function(){this._capture={}},update:function(){for(this._i=this._keys.length;this._i--;)this._keys[this._i]&&this._keys[this._i].update()},processKeyDown:function(a){this.event=a;if(this.game.input.enabled&&this.enabled){var c=a.keyCode;this._capture[c]&&a.preventDefault();this._keys[c]||(this._keys[c]=new b.Key(this.game,c));this._keys[c].processKeyDown(a);this._k=c;this.onDownCallback&&this.onDownCallback.call(this.callbackContext,a)}},processKeyPress:function(a){this.pressEvent=a;
this.game.input.enabled&&this.enabled&&this.onPressCallback&&this.onPressCallback.call(this.callbackContext,String.fromCharCode(a.charCode),a)},processKeyUp:function(a){this.event=a;if(this.game.input.enabled&&this.enabled){var c=a.keyCode;this._capture[c]&&a.preventDefault();this._keys[c]||(this._keys[c]=new b.Key(this.game,c));this._keys[c].processKeyUp(a);this.onUpCallback&&this.onUpCallback.call(this.callbackContext,a)}},reset:function(a){void 0===a&&(a=!0);this.event=null;for(var c=this._keys.length;c--;)this._keys[c]&&
this._keys[c].reset(a)},downDuration:function(a,c){return this._keys[a]?this._keys[a].downDuration(c):null},upDuration:function(a,c){return this._keys[a]?this._keys[a].upDuration(c):null},isDown:function(a){return this._keys[a]?this._keys[a].isDown:null}};Object.defineProperty(b.Keyboard.prototype,"lastChar",{get:function(){return 32===this.event.charCode?"":String.fromCharCode(this.pressEvent.charCode)}});Object.defineProperty(b.Keyboard.prototype,"lastKey",{get:function(){return this._keys[this._k]}});
b.Keyboard.prototype.constructor=b.Keyboard;b.KeyCode={A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,ZERO:48,ONE:49,TWO:50,THREE:51,FOUR:52,FIVE:53,SIX:54,SEVEN:55,EIGHT:56,NINE:57,NUMPAD_0:96,NUMPAD_1:97,NUMPAD_2:98,NUMPAD_3:99,NUMPAD_4:100,NUMPAD_5:101,NUMPAD_6:102,NUMPAD_7:103,NUMPAD_8:104,NUMPAD_9:105,NUMPAD_MULTIPLY:106,NUMPAD_ADD:107,NUMPAD_ENTER:108,NUMPAD_SUBTRACT:109,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,F1:112,
F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,COLON:186,EQUALS:187,COMMA:188,UNDERSCORE:189,PERIOD:190,QUESTION_MARK:191,TILDE:192,OPEN_BRACKET:219,BACKWARD_SLASH:220,CLOSED_BRACKET:221,QUOTES:222,BACKSPACE:8,TAB:9,CLEAR:12,ENTER:13,SHIFT:16,CONTROL:17,ALT:18,CAPS_LOCK:20,ESC:27,SPACEBAR:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,PLUS:43,MINUS:44,INSERT:45,DELETE:46,HELP:47,NUM_LOCK:144};for(var h in b.KeyCode)b.KeyCode.hasOwnProperty(h)&&
!h.match(/[a-z]/)&&(b.Keyboard[h]=b.KeyCode[h]);b.Component=function(){};b.Component.Angle=function(){};b.Component.Angle.prototype={angle:{get:function(){return b.Math.wrapAngle(b.Math.radToDeg(this.rotation))},set:function(a){this.rotation=b.Math.degToRad(b.Math.wrapAngle(a))}}};b.Component.Animation=function(){};b.Component.Animation.prototype={play:function(a,c,b,e){if(this.animations)return this.animations.play(a,c,b,e)}};b.Component.AutoCull=function(){};b.Component.AutoCull.prototype={autoCull:!1,
inCamera:{get:function(){this.autoCull||this.checkWorldBounds||(this._bounds.copyFrom(this.getBounds()),this._bounds.x+=this.game.camera.view.x,this._bounds.y+=this.game.camera.view.y);return this.game.world.camera.view.intersects(this._bounds)}}};b.Component.Bounds=function(){};b.Component.Bounds.prototype={offsetX:{get:function(){return this.anchor.x*this.width}},offsetY:{get:function(){return this.anchor.y*this.height}},centerX:{get:function(){return this.x-this.offsetX+.5*this.width},set:function(a){this.x=
a+this.offsetX-.5*this.width}},centerY:{get:function(){return this.y-this.offsetY+.5*this.height},set:function(a){this.y=a+this.offsetY-.5*this.height}},left:{get:function(){return this.x-this.offsetX},set:function(a){this.x=a+this.offsetX}},right:{get:function(){return this.x+this.width-this.offsetX},set:function(a){this.x=a-this.width+this.offsetX}},top:{get:function(){return this.y-this.offsetY},set:function(a){this.y=a+this.offsetY}},bottom:{get:function(){return this.y+this.height-this.offsetY},
set:function(a){this.y=a-this.height+this.offsetY}},alignIn:function(a,c,d,e){void 0===d&&(d=0);void 0===e&&(e=0);switch(c){default:case b.TOP_LEFT:this.left=a.left-d;this.top=a.top-e;break;case b.TOP_CENTER:this.centerX=a.centerX+d;this.top=a.top-e;break;case b.TOP_RIGHT:this.right=a.right+d;this.top=a.top-e;break;case b.LEFT_CENTER:this.left=a.left-d;this.centerY=a.centerY+e;break;case b.CENTER:this.centerX=a.centerX+d;this.centerY=a.centerY+e;break;case b.RIGHT_CENTER:this.right=a.right+d;this.centerY=
a.centerY+e;break;case b.BOTTOM_LEFT:this.left=a.left-d;this.bottom=a.bottom+e;break;case b.BOTTOM_CENTER:this.centerX=a.centerX+d;this.bottom=a.bottom+e;break;case b.BOTTOM_RIGHT:this.right=a.right+d,this.bottom=a.bottom+e}return this},alignTo:function(a,c,d,e){void 0===d&&(d=0);void 0===e&&(e=0);switch(c){default:case b.TOP_LEFT:this.left=a.left-d;this.bottom=a.top-e;break;case b.TOP_CENTER:this.centerX=a.centerX+d;this.bottom=a.top-e;break;case b.TOP_RIGHT:this.right=a.right+d;this.bottom=a.top-
e;break;case b.LEFT_TOP:this.right=a.left-d;this.top=a.top-e;break;case b.LEFT_CENTER:this.right=a.left-d;this.centerY=a.centerY+e;break;case b.LEFT_BOTTOM:this.right=a.left-d;this.bottom=a.bottom+e;break;case b.RIGHT_TOP:this.left=a.right+d;this.top=a.top-e;break;case b.RIGHT_CENTER:this.left=a.right+d;this.centerY=a.centerY+e;break;case b.RIGHT_BOTTOM:this.left=a.right+d;this.bottom=a.bottom+e;break;case b.BOTTOM_LEFT:this.left=a.left-d;this.top=a.bottom+e;break;case b.BOTTOM_CENTER:this.centerX=
a.centerX+d;this.top=a.bottom+e;break;case b.BOTTOM_RIGHT:this.right=a.right+d,this.top=a.bottom+e}return this}};b.Group.prototype.alignIn=b.Component.Bounds.prototype.alignIn;b.Group.prototype.alignTo=b.Component.Bounds.prototype.alignTo;b.Component.BringToTop=function(){};b.Component.BringToTop.prototype.bringToTop=function(){this.parent&&this.parent.bringToTop(this);return this};b.Component.BringToTop.prototype.sendToBack=function(){this.parent&&this.parent.sendToBack(this);return this};b.Component.BringToTop.prototype.moveUp=
function(){this.parent&&this.parent.moveUp(this);return this};b.Component.BringToTop.prototype.moveDown=function(){this.parent&&this.parent.moveDown(this);return this};b.Component.Core=function(){};b.Component.Core.install=function(a){b.Utils.mixinPrototype(this,b.Component.Core.prototype);this.components={};for(var c=0;c<a.length;c++){var d=a[c],e=!1;"Destroy"===d&&(e=!0);b.Utils.mixinPrototype(this,b.Component[d].prototype,e);this.components[d]=!0}};b.Component.Core.init=function(a,c,d,e,k){this.game=
a;this.key=e;this.data={};this.position.set(c,d);this.world=new b.Point(c,d);this.previousPosition=new b.Point(c,d);this.events=new b.Events(this);this._bounds=new b.Rectangle;this.components.PhysicsBody&&(this.body=this.body);this.components.Animation&&(this.animations=new b.AnimationManager(this));this.components.LoadTexture&&null!==e&&this.loadTexture(e,k);this.components.FixedToCamera&&(this.cameraOffset=new b.Point(c,d))};b.Component.Core.preUpdate=function(){if(this.pendingDestroy)this.destroy();
else{this.previousPosition.set(this.world.x,this.world.y);this.previousRotation=this.rotation;if(!this.exists||!this.parent.exists)return this.renderOrderID=-1,!1;this.world.setTo(this.game.camera.x+this.worldTransform.tx,this.game.camera.y+this.worldTransform.ty);this.visible&&(this.renderOrderID=this.game.stage.currentRenderOrderID++);this.animations&&this.animations.update();this.body&&this.body.preUpdate();for(var a=0;a<this.children.length;a++)this.children[a].preUpdate();return!0}};b.Component.Core.prototype=
{game:null,name:"",data:{},components:{},z:0,events:void 0,animations:void 0,key:"",world:null,debug:!1,previousPosition:null,previousRotation:0,renderOrderID:0,fresh:!0,pendingDestroy:!1,_bounds:null,_exists:!0,exists:{get:function(){return this._exists},set:function(a){a?(this._exists=!0,this.body&&this.body.type===b.Physics.P2JS&&this.body.addToWorld(),this.visible=!0):(this._exists=!1,this.body&&this.body.type===b.Physics.P2JS&&this.body.removeFromWorld(),this.visible=!1)}},update:function(){},
postUpdate:function(){this.customRender&&this.key.render();this.components.PhysicsBody&&b.Component.PhysicsBody.postUpdate.call(this);this.components.FixedToCamera&&b.Component.FixedToCamera.postUpdate.call(this);for(var a=0;a<this.children.length;a++)this.children[a].postUpdate()}};b.Component.Crop=function(){};b.Component.Crop.prototype={cropRect:null,_crop:null,crop:function(a,c){void 0===c&&(c=!1);a?(c&&null!==this.cropRect?this.cropRect.setTo(a.x,a.y,a.width,a.height):this.cropRect=c&&null===
this.cropRect?new b.Rectangle(a.x,a.y,a.width,a.height):a,this.updateCrop()):(this.cropRect=this._crop=null,this.resetFrame())},updateCrop:function(){if(this.cropRect){var a=this.texture.crop.x,c=this.texture.crop.y,d=this.texture.crop.width,e=this.texture.crop.height;this._crop=b.Rectangle.clone(this.cropRect,this._crop);this._crop.x+=this._frame.x;this._crop.y+=this._frame.y;var k=Math.max(this._frame.x,this._crop.x),m=Math.max(this._frame.y,this._crop.y),f=Math.min(this._frame.right,this._crop.right)-
k,g=Math.min(this._frame.bottom,this._crop.bottom)-m;this.texture.crop.x=k;this.texture.crop.y=m;this.texture.crop.width=f;this.texture.crop.height=g;this.texture.frame.width=Math.min(f,this.cropRect.width);this.texture.frame.height=Math.min(g,this.cropRect.height);this.texture.width=this.texture.frame.width;this.texture.height=this.texture.frame.height;this.texture._updateUvs();16777215===this.tint||a===k&&c===m&&d===f&&e===g||(this.texture.requiresReTint=!0)}}};b.Component.Delta=function(){};b.Component.Delta.prototype=
{deltaX:{get:function(){return this.world.x-this.previousPosition.x}},deltaY:{get:function(){return this.world.y-this.previousPosition.y}},deltaZ:{get:function(){return this.rotation-this.previousRotation}}};b.Component.Destroy=function(){};b.Component.Destroy.prototype={destroyPhase:!1,destroy:function(a,c){if(null!==this.game&&!this.destroyPhase){void 0===a&&(a=!0);void 0===c&&(c=!1);this.destroyPhase=!0;if(this.events)this.events.onDestroy$dispatch(this);this.parent&&(this.parent instanceof b.Group?
this.parent.remove(this):this.parent.removeChild(this));this.input&&this.input.destroy();this.animations&&this.animations.destroy();this.body&&this.body.destroy();this.events&&this.events.destroy();this.game.tweens.removeFrom(this);var d=this.children.length;if(a)for(;d--;)this.children[d].destroy(a);else for(;d--;)this.removeChild(this.children[d]);this._crop&&(this.cropRect=this._crop=null);this._frame&&(this._frame=null);b.Video&&this.key instanceof b.Video&&this.key.onChangeSource.remove(this.resizeFrame,
this);b.BitmapText&&this._glyphs&&(this._glyphs=[]);this.visible=this.exists=this.alive=!1;this.game=this.mask=this.filters=null;this.data={};this.renderable=!1;this.transformCallback&&(this.transformCallbackContext=this.transformCallback=null);this._mask=this._currentBounds=this._bounds=this.filterArea=this.worldTransform=this.stage=this.parent=this.hitArea=null;this._destroyCachedSprite();c&&this.texture.destroy(!0);this.pendingDestroy=this.destroyPhase=!1}}};b.Events=function(a){this.parent=a};
b.Events.prototype={destroy:function(){this._parent=null;this._onDestroy&&this._onDestroy.dispose();this._onAddedToGroup&&this._onAddedToGroup.dispose();this._onRemovedFromGroup&&this._onRemovedFromGroup.dispose();this._onRemovedFromWorld&&this._onRemovedFromWorld.dispose();this._onKilled&&this._onKilled.dispose();this._onRevived&&this._onRevived.dispose();this._onEnterBounds&&this._onEnterBounds.dispose();this._onOutOfBounds&&this._onOutOfBounds.dispose();this._onInputOver&&this._onInputOver.dispose();
this._onInputOut&&this._onInputOut.dispose();this._onInputDown&&this._onInputDown.dispose();this._onInputUp&&this._onInputUp.dispose();this._onDragStart&&this._onDragStart.dispose();this._onDragUpdate&&this._onDragUpdate.dispose();this._onDragStop&&this._onDragStop.dispose();this._onAnimationStart&&this._onAnimationStart.dispose();this._onAnimationComplete&&this._onAnimationComplete.dispose();this._onAnimationLoop&&this._onAnimationLoop.dispose()},onAddedToGroup:null,onRemovedFromGroup:null,onRemovedFromWorld:null,
onDestroy:null,onKilled:null,onRevived:null,onOutOfBounds:null,onEnterBounds:null,onInputOver:null,onInputOut:null,onInputDown:null,onInputUp:null,onDragStart:null,onDragUpdate:null,onDragStop:null,onAnimationStart:null,onAnimationComplete:null,onAnimationLoop:null};b.Events.prototype.constructor=b.Events;for(var l in b.Events.prototype)b.Events.prototype.hasOwnProperty(l)&&0===l.indexOf("on")&&null===b.Events.prototype[l]&&function(a,c){Object.defineProperty(b.Events.prototype,a,{get:function(){return this[c]||
(this[c]=new b.Signal)}});b.Events.prototype[a+"$dispatch"]=function(){return this[c]?this[c].dispatch.apply(this[c],arguments):null}}(l,"_"+l);b.Component.FixedToCamera=function(){};b.Component.FixedToCamera.postUpdate=function(){this.fixedToCamera&&(this.position.x=(this.game.camera.view.x+this.cameraOffset.x)/this.game.camera.scale.x,this.position.y=(this.game.camera.view.y+this.cameraOffset.y)/this.game.camera.scale.y)};b.Component.FixedToCamera.prototype={_fixedToCamera:!1,fixedToCamera:{get:function(){return this._fixedToCamera},
set:function(a){a?(this._fixedToCamera=!0,this.cameraOffset.set(this.x,this.y)):this._fixedToCamera=!1}},cameraOffset:new b.Point};b.Component.Health=function(){};b.Component.Health.prototype={health:1,maxHealth:100,damage:function(a){this.alive&&(this.health-=a,0>=this.health&&this.kill());return this},setHealth:function(a){this.health=a;this.health>this.maxHealth&&(this.health=this.maxHealth);return this},heal:function(a){this.alive&&(this.health+=a,this.health>this.maxHealth&&(this.health=this.maxHealth));
return this}};b.Component.InCamera=function(){};b.Component.InCamera.prototype={inCamera:{get:function(){return this.game.world.camera.view.intersects(this._bounds)}}};b.Component.InputEnabled=function(){};b.Component.InputEnabled.prototype={input:null,inputEnabled:{get:function(){return this.input&&this.input.enabled},set:function(a){a?null===this.input?(this.input=new b.InputHandler(this),this.input.start()):this.input&&!this.input.enabled&&this.input.start():this.input&&this.input.enabled&&this.input.stop()}}};
b.Component.InWorld=function(){};b.Component.InWorld.preUpdate=function(){if(this.autoCull||this.checkWorldBounds){this._bounds.copyFrom(this.getBounds());this._bounds.x+=this.game.camera.view.x;this._bounds.y+=this.game.camera.view.y;if(this.autoCull)if(this.game.world.camera.view.intersects(this._bounds))this.renderable=!0,this.game.world.camera.totalInView++;else if(this.renderable=!1,this.outOfCameraBoundsKill)return this.kill(),!1;if(this.checkWorldBounds)if(this._outOfBoundsFired&&this.game.world.bounds.intersects(this._bounds))this._outOfBoundsFired=
!1,this.events.onEnterBounds$dispatch(this);else if(!this._outOfBoundsFired&&!this.game.world.bounds.intersects(this._bounds)&&(this._outOfBoundsFired=!0,this.events.onOutOfBounds$dispatch(this),this.outOfBoundsKill))return this.kill(),!1}return!0};b.Component.InWorld.prototype={checkWorldBounds:!1,outOfBoundsKill:!1,outOfCameraBoundsKill:!1,_outOfBoundsFired:!1,inWorld:{get:function(){return this.game.world.bounds.intersects(this.getBounds())}}};b.Component.LifeSpan=function(){};b.Component.LifeSpan.preUpdate=
function(){return 0<this.lifespan&&(this.lifespan-=this.game.time.physicsElapsedMS,0>=this.lifespan)?(this.kill(),!1):!0};b.Component.LifeSpan.prototype={alive:!0,lifespan:0,revive:function(a){void 0===a&&(a=100);this.visible=this.exists=this.alive=!0;"function"===typeof this.setHealth&&this.setHealth(a);if(this.events)this.events.onRevived$dispatch(this);return this},kill:function(){this.visible=this.exists=this.alive=!1;if(this.events)this.events.onKilled$dispatch(this);return this}};b.Component.LoadTexture=
function(){};b.Component.LoadTexture.prototype={customRender:!1,_frame:null,loadTexture:function(a,c,d){a===b.PENDING_ATLAS?(a=c,c=0):c=c||0;(d||void 0===d)&&this.animations&&this.animations.stop();this.key=a;this.customRender=!1;var e=this.game.cache,k=!0;d=!this.texture.baseTexture.scaleMode;b.RenderTexture&&a instanceof b.RenderTexture?(this.key=a.key,this.setTexture(a)):b.BitmapData&&a instanceof b.BitmapData?(this.customRender=!0,this.setTexture(a.texture),k=e.hasFrameData(a.key,b.Cache.BITMAPDATA)?
!this.animations.loadFrameData(e.getFrameData(a.key,b.Cache.BITMAPDATA),c):!this.animations.loadFrameData(a.frameData,0)):b.Video&&a instanceof b.Video?(this.customRender=!0,c=a.texture.valid,this.setTexture(a.texture),this.setFrame(a.texture.frame.clone()),a.onChangeSource.add(this.resizeFrame,this),this.texture.valid=c):b.Tilemap&&a instanceof b.TilemapLayer?this.setTexture(PIXI.Texture.fromCanvas(a.canvas)):a instanceof PIXI.Texture?this.setTexture(a):(k=e.getImage(a,!0),this.key=k.key,this.setTexture(new PIXI.Texture(k.base)),
this.texture.baseTexture.skipRender="__default"===a?!0:!1,k=!this.animations.loadFrameData(k.frameData,c));k&&(this._frame=b.Rectangle.clone(this.texture.frame));d||(this.texture.baseTexture.scaleMode=1)},setFrame:function(a){this._frame=a;this.texture.frame.x=a.x;this.texture.frame.y=a.y;this.texture.frame.width=a.width;this.texture.frame.height=a.height;this.texture.crop.x=a.x;this.texture.crop.y=a.y;this.texture.crop.width=a.width;this.texture.crop.height=a.height;a.trimmed?(this.texture.trim?
(this.texture.trim.x=a.spriteSourceSizeX,this.texture.trim.y=a.spriteSourceSizeY,this.texture.trim.width=a.sourceSizeW,this.texture.trim.height=a.sourceSizeH):this.texture.trim={x:a.spriteSourceSizeX,y:a.spriteSourceSizeY,width:a.sourceSizeW,height:a.sourceSizeH},this.texture.width=a.sourceSizeW,this.texture.height=a.sourceSizeH,this.texture.frame.width=a.sourceSizeW,this.texture.frame.height=a.sourceSizeH):!a.trimmed&&this.texture.trim&&(this.texture.trim=null);this.cropRect&&this.updateCrop();this.texture.requiresReTint=
!0;this.texture._updateUvs();this.tilingTexture&&(this.refreshTexture=!0)},resizeFrame:function(a,c,b){this.texture.frame.resize(c,b);this.texture.setFrame(this.texture.frame)},resetFrame:function(){this._frame&&this.setFrame(this._frame)},frame:{get:function(){return this.animations.frame},set:function(a){this.animations.frame=a}},frameName:{get:function(){return this.animations.frameName},set:function(a){this.animations.frameName=a}}};b.Component.Overlap=function(){};b.Component.Overlap.prototype=
{overlap:function(a){return b.Rectangle.intersects(this.getBounds(),a.getBounds())}};b.Component.PhysicsBody=function(){};b.Component.PhysicsBody.preUpdate=function(){if(this.fresh&&this.exists)return this.world.setTo(this.parent.position.x+this.position.x,this.parent.position.y+this.position.y),this.worldTransform.tx=this.world.x,this.worldTransform.ty=this.world.y,this.previousPosition.set(this.world.x,this.world.y),this.previousRotation=this.rotation,this.body&&this.body.preUpdate(),this.fresh=
!1;this.previousPosition.set(this.world.x,this.world.y);this.previousRotation=this.rotation;return this._exists&&this.parent.exists?!0:(this.renderOrderID=-1,!1)};b.Component.PhysicsBody.postUpdate=function(){this.exists&&this.body&&this.body.postUpdate()};b.Component.PhysicsBody.prototype={body:null,x:{get:function(){return this.position.x},set:function(a){this.position.x=a;this.body&&!this.body.dirty&&(this.body._reset=!0)}},y:{get:function(){return this.position.y},set:function(a){this.position.y=
a;this.body&&!this.body.dirty&&(this.body._reset=!0)}}};b.Component.Reset=function(){};b.Component.Reset.prototype.reset=function(a,c,b){void 0===b&&(b=1);this.world.set(a,c);this.position.set(a,c);this.renderable=this.visible=this.exists=this.fresh=!0;this.components.InWorld&&(this._outOfBoundsFired=!1);this.components.LifeSpan&&(this.alive=!0,this.health=b);this.components.PhysicsBody&&this.body&&this.body.reset(a,c,!1,!1);return this};b.Component.ScaleMinMax=function(){};b.Component.ScaleMinMax.prototype=
{transformCallback:null,transformCallbackContext:this,scaleMin:null,scaleMax:null,checkTransform:function(a){this.scaleMin&&(a.a<this.scaleMin.x&&(a.a=this.scaleMin.x),a.d<this.scaleMin.y&&(a.d=this.scaleMin.y));this.scaleMax&&(a.a>this.scaleMax.x&&(a.a=this.scaleMax.x),a.d>this.scaleMax.y&&(a.d=this.scaleMax.y))},setScaleMinMax:function(a,c,d,e){void 0===c?c=d=e=a:void 0===d&&(d=e=c,c=a);null===a?this.scaleMin=null:this.scaleMin?this.scaleMin.set(a,c):this.scaleMin=new b.Point(a,c);null===d?this.scaleMax=
null:this.scaleMax?this.scaleMax.set(d,e):this.scaleMax=new b.Point(d,e);null===this.scaleMin?this.transformCallback=null:(this.transformCallback=this.checkTransform,this.transformCallbackContext=this)}};b.Component.Smoothed=function(){};b.Component.Smoothed.prototype={smoothed:{get:function(){return!this.texture.baseTexture.scaleMode},set:function(a){a?this.texture&&(this.texture.baseTexture.scaleMode=0):this.texture&&(this.texture.baseTexture.scaleMode=1)}}};b.GameObjectFactory=function(a){this.game=
a;this.world=this.game.world};b.GameObjectFactory.prototype={existing:function(a){return this.world.add(a)},weapon:function(a,c,d,e){var k=this.game.plugins.add(b.Weapon);k.createBullets(a,c,d,e);return k},image:function(a,c,d,e,k){void 0===k&&(k=this.world);return k.add(new b.Image(this.game,a,c,d,e))},sprite:function(a,c,b,e,k){void 0===k&&(k=this.world);return k.create(a,c,b,e)},creature:function(a,c,d,e,k){void 0===k&&(k=this.world);a=new b.Creature(this.game,a,c,d,e);k.add(a);return a},tween:function(a){return this.game.tweens.create(a)},
group:function(a,c,d,e,k){return new b.Group(this.game,a,c,d,e,k)},physicsGroup:function(a,c,d,e){return new b.Group(this.game,c,d,e,!0,a)},spriteBatch:function(a,c,d){void 0===a&&(a=null);void 0===c&&(c="group");void 0===d&&(d=!1);return new b.SpriteBatch(this.game,a,c,d)},audio:function(a,c,b,e){return this.game.sound.add(a,c,b,e)},sound:function(a,c,b,e){return this.game.sound.add(a,c,b,e)},audioSprite:function(a){return this.game.sound.addSprite(a)},tileSprite:function(a,c,d,e,k,m,f){void 0===
f&&(f=this.world);return f.add(new b.TileSprite(this.game,a,c,d,e,k,m))},rope:function(a,c,d,e,k,m){void 0===m&&(m=this.world);return m.add(new b.Rope(this.game,a,c,d,e,k))},text:function(a,c,d,e,k){void 0===k&&(k=this.world);return k.add(new b.Text(this.game,a,c,d,e))},button:function(a,c,d,e,k,m,f,g,h,t){void 0===t&&(t=this.world);return t.add(new b.Button(this.game,a,c,d,e,k,m,f,g,h))},graphics:function(a,c,d){void 0===d&&(d=this.world);return d.add(new b.Graphics(this.game,a,c))},emitter:function(a,
c,d){return this.game.particles.add(new b.Particles.Arcade.Emitter(this.game,a,c,d))},retroFont:function(a,c,d,e,k,m,f,g,h){return new b.RetroFont(this.game,a,c,d,e,k,m,f,g,h)},bitmapText:function(a,c,d,e,k,m){void 0===m&&(m=this.world);return m.add(new b.BitmapText(this.game,a,c,d,e,k))},tilemap:function(a,c,d,e,k){return new b.Tilemap(this.game,a,c,d,e,k)},renderTexture:function(a,c,d,e){if(void 0===d||""===d)d=this.game.rnd.uuid();void 0===e&&(e=!1);a=new b.RenderTexture(this.game,a,c,d);e&&this.game.cache.addRenderTexture(d,
a);return a},video:function(a,c){return new b.Video(this.game,a,c)},bitmapData:function(a,c,d,e){void 0===e&&(e=!1);if(void 0===d||""===d)d=this.game.rnd.uuid();a=new b.BitmapData(this.game,d,a,c);e&&this.game.cache.addBitmapData(d,a);return a},filter:function(a){var c=Array.prototype.slice.call(arguments,1);a=new b.Filter[a](this.game);a.init.apply(a,c);return a},plugin:function(a){return this.game.plugins.add(a)}};b.GameObjectFactory.prototype.constructor=b.GameObjectFactory;b.GameObjectCreator=
function(a){this.game=a;this.world=this.game.world};b.GameObjectCreator.prototype={image:function(a,c,d,e){return new b.Image(this.game,a,c,d,e)},sprite:function(a,c,d,e){return new b.Sprite(this.game,a,c,d,e)},tween:function(a){return new b.Tween(a,this.game,this.game.tweens)},group:function(a,c,d,e,k){return new b.Group(this.game,a,c,d,e,k)},spriteBatch:function(a,c,d){void 0===c&&(c="group");void 0===d&&(d=!1);return new b.SpriteBatch(this.game,a,c,d)},audio:function(a,c,b,e){return this.game.sound.add(a,
c,b,e)},audioSprite:function(a){return this.game.sound.addSprite(a)},sound:function(a,c,b,e){return this.game.sound.add(a,c,b,e)},tileSprite:function(a,c,d,e,k,m){return new b.TileSprite(this.game,a,c,d,e,k,m)},rope:function(a,c,d,e,k){return new b.Rope(this.game,a,c,d,e,k)},text:function(a,c,d,e){return new b.Text(this.game,a,c,d,e)},button:function(a,c,d,e,k,m,f,g,h){return new b.Button(this.game,a,c,d,e,k,m,f,g,h)},graphics:function(a,c){return new b.Graphics(this.game,a,c)},emitter:function(a,
c,d){return new b.Particles.Arcade.Emitter(this.game,a,c,d)},retroFont:function(a,c,d,e,k,m,f,g,h){return new b.RetroFont(this.game,a,c,d,e,k,m,f,g,h)},bitmapText:function(a,c,d,e,k,m){return new b.BitmapText(this.game,a,c,d,e,k,m)},tilemap:function(a,c,d,e,k){return new b.Tilemap(this.game,a,c,d,e,k)},renderTexture:function(a,c,d,e){if(void 0===d||""===d)d=this.game.rnd.uuid();void 0===e&&(e=!1);a=new b.RenderTexture(this.game,a,c,d);e&&this.game.cache.addRenderTexture(d,a);return a},bitmapData:function(a,
c,d,e){void 0===e&&(e=!1);if(void 0===d||""===d)d=this.game.rnd.uuid();a=new b.BitmapData(this.game,d,a,c);e&&this.game.cache.addBitmapData(d,a);return a},filter:function(a){var c=Array.prototype.slice.call(arguments,1);a=new b.Filter[a](this.game);a.init.apply(a,c);return a}};b.GameObjectCreator.prototype.constructor=b.GameObjectCreator;b.Sprite=function(a,c,d,e,k){c=c||0;d=d||0;e=e||null;k=k||null;this.physicsType=this.type=b.SPRITE;PIXI.Sprite.call(this,b.Cache.DEFAULT);b.Component.Core.init.call(this,
a,c,d,e,k)};b.Sprite.prototype=Object.create(PIXI.Sprite.prototype);b.Sprite.prototype.constructor=b.Sprite;b.Component.Core.install.call(b.Sprite.prototype,"Angle Animation AutoCull Bounds BringToTop Crop Delta Destroy FixedToCamera Health InCamera InputEnabled InWorld LifeSpan LoadTexture Overlap PhysicsBody Reset ScaleMinMax Smoothed".split(" "));b.Sprite.prototype.preUpdatePhysics=b.Component.PhysicsBody.preUpdate;b.Sprite.prototype.preUpdateLifeSpan=b.Component.LifeSpan.preUpdate;b.Sprite.prototype.preUpdateInWorld=
b.Component.InWorld.preUpdate;b.Sprite.prototype.preUpdateCore=b.Component.Core.preUpdate;b.Sprite.prototype.preUpdate=function(){return this.preUpdatePhysics()&&this.preUpdateLifeSpan()&&this.preUpdateInWorld()?this.preUpdateCore():!1};b.Image=function(a,c,d,e,k){c=c||0;d=d||0;e=e||null;k=k||null;this.type=b.IMAGE;PIXI.Sprite.call(this,b.Cache.DEFAULT);b.Component.Core.init.call(this,a,c,d,e,k)};b.Image.prototype=Object.create(PIXI.Sprite.prototype);b.Image.prototype.constructor=b.Image;b.Component.Core.install.call(b.Image.prototype,
"Angle Animation AutoCull Bounds BringToTop Crop Destroy FixedToCamera InputEnabled LifeSpan LoadTexture Overlap Reset ScaleMinMax Smoothed".split(" "));b.Image.prototype.preUpdateInWorld=b.Component.InWorld.preUpdate;b.Image.prototype.preUpdateCore=b.Component.Core.preUpdate;b.Image.prototype.preUpdate=function(){return this.preUpdateInWorld()?this.preUpdateCore():!1};b.Button=function(a,c,d,e,k,m,f,g,h,t){k=k||null;m=m||this;b.Image.call(this,a,c||0,d||0,e||null,g);this.type=b.BUTTON;this.physicsType=
b.SPRITE;this.onUpSound=this.onDownSound=this.onOutSound=this.onOverSound=this._onUpFrame=this._onDownFrame=this._onOutFrame=this._onOverFrame=null;this.onUpSoundMarker=this.onDownSoundMarker=this.onOutSoundMarker=this.onOverSoundMarker="";this.onInputOver=new b.Signal;this.onInputOut=new b.Signal;this.onInputDown=new b.Signal;this.onInputUp=new b.Signal;this.onOverMouseOnly=!0;this.justReleasedPreventsOver=b.PointerMode.TOUCH;this.forceOut=this.freezeFrames=!1;this.inputEnabled=!0;this.input.start(0,
!0);this.input.useHandCursor=!0;this.setFrames(f,g,h,t);null!==k&&this.onInputUp.add(k,m);this.events.onInputOver.add(this.onInputOverHandler,this);this.events.onInputOut.add(this.onInputOutHandler,this);this.events.onInputDown.add(this.onInputDownHandler,this);this.events.onInputUp.add(this.onInputUpHandler,this);this.events.onRemovedFromWorld.add(this.removedFromWorld,this)};b.Button.prototype=Object.create(b.Image.prototype);b.Button.prototype.constructor=b.Button;b.Button.prototype.clearFrames=
function(){this.setFrames(null,null,null,null)};b.Button.prototype.removedFromWorld=function(){this.inputEnabled=!1};b.Button.prototype.setStateFrame=function(a,c,b){var d="_on"+a+"Frame";null!==c?(this[d]=c,b&&this.changeStateFrame(a)):this[d]=null};b.Button.prototype.changeStateFrame=function(a){if(this.freezeFrames)return!1;a=this["_on"+a+"Frame"];return"string"===typeof a?(this.frameName=a,!0):"number"===typeof a?(this.frame=a,!0):!1};b.Button.prototype.setFrames=function(a,c,b,e){this.setStateFrame("Over",
a,this.input.pointerOver());this.setStateFrame("Out",c,!this.input.pointerOver());this.setStateFrame("Down",b,this.input.pointerDown());this.setStateFrame("Up",e,this.input.pointerUp())};b.Button.prototype.setStateSound=function(a,c,d){var e="on"+a+"Sound";a="on"+a+"SoundMarker";c instanceof b.Sound||c instanceof b.AudioSprite?(this[e]=c,this[a]="string"===typeof d?d:""):(this[e]=null,this[a]="")};b.Button.prototype.playStateSound=function(a){var c=this["on"+a+"Sound"];return c?(c.play(this["on"+
a+"SoundMarker"]),!0):!1};b.Button.prototype.setSounds=function(a,c,b,e,k,m,f,g){this.setStateSound("Over",a,c);this.setStateSound("Out",k,m);this.setStateSound("Down",b,e);this.setStateSound("Up",f,g)};b.Button.prototype.setOverSound=function(a,c){this.setStateSound("Over",a,c)};b.Button.prototype.setOutSound=function(a,c){this.setStateSound("Out",a,c)};b.Button.prototype.setDownSound=function(a,c){this.setStateSound("Down",a,c)};b.Button.prototype.setUpSound=function(a,c){this.setStateSound("Up",
a,c)};b.Button.prototype.onInputOverHandler=function(a,c){if(!c.justReleased()||(this.justReleasedPreventsOver&c.pointerMode)!==c.pointerMode)if(this.changeStateFrame("Over"),!this.onOverMouseOnly||c.isMouse)this.playStateSound("Over"),this.onInputOver&&this.onInputOver.dispatch(this,c)};b.Button.prototype.onInputOutHandler=function(a,c){this.changeStateFrame("Out");this.playStateSound("Out");this.onInputOut&&this.onInputOut.dispatch(this,c)};b.Button.prototype.onInputDownHandler=function(a,c){this.changeStateFrame("Down");
this.playStateSound("Down");this.onInputDown&&this.onInputDown.dispatch(this,c)};b.Button.prototype.onInputUpHandler=function(a,c,b){this.playStateSound("Up");this.onInputUp&&this.onInputUp.dispatch(this,c,b);this.freezeFrames||(!0===this.forceOut||(this.forceOut&c.pointerMode)===c.pointerMode?this.changeStateFrame("Out"):this.changeStateFrame("Up")||(b?this.changeStateFrame("Over"):this.changeStateFrame("Out")))};b.SpriteBatch=function(a,c,d,e){if(void 0===c||null===c)c=a.world;PIXI.SpriteBatch.call(this);
b.Group.call(this,a,c,d,e);this.type=b.SPRITEBATCH};b.SpriteBatch.prototype=b.Utils.extend(!0,b.SpriteBatch.prototype,PIXI.SpriteBatch.prototype,b.Group.prototype);b.SpriteBatch.prototype.constructor=b.SpriteBatch;b.BitmapData=function(a,c,d,e,k){if(void 0===d||0===d)d=256;if(void 0===e||0===e)e=256;void 0===k&&(k=!1);this.game=a;this.key=c;this.width=d;this.height=e;this.canvas=b.Canvas.create(this,d,e,null,k);this.ctx=this.context=this.canvas.getContext("2d",{alpha:!0});this.smoothProperty=a.renderType===
b.CANVAS?a.renderer.renderSession.smoothProperty:b.Canvas.getSmoothingPrefix(this.context);this.imageData=this.context.getImageData(0,0,d,e);this.data=null;this.imageData&&(this.data=this.imageData.data);this.pixels=null;this.data&&(this.imageData.data.buffer?(this.buffer=this.imageData.data.buffer,this.pixels=new Uint32Array(this.buffer)):window.ArrayBuffer?(this.buffer=new ArrayBuffer(this.imageData.data.length),this.pixels=new Uint32Array(this.buffer)):this.pixels=this.imageData.data);this.baseTexture=
new PIXI.BaseTexture(this.canvas);this.texture=new PIXI.Texture(this.baseTexture);this.frameData=new b.FrameData;this.textureFrame=this.frameData.addFrame(new b.Frame(0,0,0,d,e,"bitmapData"));this.texture.frame=this.textureFrame;this.type=b.BITMAPDATA;this.dirty=this.disableTextureUpload=!1;this.cls=this.clear;this._image=null;this._pos=new b.Point;this._size=new b.Point;this._scale=new b.Point;this._rotate=0;this._alpha={prev:1,current:1};this._anchor=new b.Point;this._tempB=this._tempG=this._tempR=
0;this._circle=new b.Circle;this._swapCanvas=void 0};b.BitmapData.prototype={move:function(a,c,b){0!==a&&this.moveH(a,b);0!==c&&this.moveV(c,b);return this},moveH:function(a,c){void 0===c&&(c=!0);void 0===this._swapCanvas&&(this._swapCanvas=PIXI.CanvasPool.create(this,this.width,this.height));var b=this._swapCanvas.getContext("2d"),e=this.height,k=this.canvas;b.clearRect(0,0,this.width,this.height);if(0>a){a=Math.abs(a);var m=this.width-a;c&&b.drawImage(k,0,0,a,e,m,0,a,e);b.drawImage(k,a,0,m,e,0,
0,m,e)}else m=this.width-a,c&&b.drawImage(k,m,0,a,e,0,0,a,e),b.drawImage(k,0,0,m,e,a,0,m,e);this.clear();return this.copy(this._swapCanvas)},moveV:function(a,c){void 0===c&&(c=!0);void 0===this._swapCanvas&&(this._swapCanvas=PIXI.CanvasPool.create(this,this.width,this.height));var b=this._swapCanvas.getContext("2d"),e=this.width,k=this.canvas;b.clearRect(0,0,this.width,this.height);if(0>a){a=Math.abs(a);var m=this.height-a;c&&b.drawImage(k,0,0,e,a,0,m,e,a);b.drawImage(k,0,a,e,m,0,0,e,m)}else m=this.height-
a,c&&b.drawImage(k,0,m,e,a,0,0,e,a),b.drawImage(k,0,0,e,m,0,a,e,m);this.clear();return this.copy(this._swapCanvas)},add:function(a){if(Array.isArray(a))for(var c=0;c<a.length;c++)a[c].loadTexture&&a[c].loadTexture(this);else a.loadTexture(this);return this},load:function(a){"string"===typeof a&&(a=this.game.cache.getImage(a));if(a)return this.resize(a.width,a.height),this.cls(),this.draw(a),this.update(),this},clear:function(a,c,b,e){void 0===a&&(a=0);void 0===c&&(c=0);void 0===b&&(b=this.width);
void 0===e&&(e=this.height);this.context.clearRect(a,c,b,e);this.dirty=!0;return this},fill:function(a,c,b,e){void 0===e&&(e=1);this.context.fillStyle="rgba("+a+","+c+","+b+","+e+")";this.context.fillRect(0,0,this.width,this.height);this.dirty=!0;return this},generateTexture:function(a){var c=new Image;c.src=this.canvas.toDataURL("image/png");a=this.game.cache.addImage(a,"",c);return new PIXI.Texture(a.base)},resize:function(a,c){if(a!==this.width||c!==this.height)this.width=a,this.height=c,this.canvas.width=
a,this.canvas.height=c,void 0!==this._swapCanvas&&(this._swapCanvas.width=a,this._swapCanvas.height=c),this.baseTexture.width=a,this.baseTexture.height=c,this.textureFrame.width=a,this.textureFrame.height=c,this.texture.width=a,this.texture.height=c,this.texture.crop.width=a,this.texture.crop.height=c,this.update(),this.dirty=!0;return this},update:function(a,c,b,e){void 0===a&&(a=0);void 0===c&&(c=0);void 0===b&&(b=Math.max(1,this.width));void 0===e&&(e=Math.max(1,this.height));this.imageData=this.context.getImageData(a,
c,b,e);this.data=this.imageData.data;this.imageData.data.buffer?(this.buffer=this.imageData.data.buffer,this.pixels=new Uint32Array(this.buffer)):window.ArrayBuffer?(this.buffer=new ArrayBuffer(this.imageData.data.length),this.pixels=new Uint32Array(this.buffer)):this.pixels=this.imageData.data;return this},processPixelRGB:function(a,c,d,e,k,m){void 0===d&&(d=0);void 0===e&&(e=0);void 0===k&&(k=this.width);void 0===m&&(m=this.height);k=d+k;m=e+m;for(var f=b.Color.createColor(),g=!1,h=e;h<m;h++)for(var t=
d;t<k;t++)b.Color.unpackPixel(this.getPixel32(t,h),f),e=a.call(c,f,t,h),!1!==e&&null!==e&&void 0!==e&&(this.setPixel32(t,h,e.r,e.g,e.b,e.a,!1),g=!0);g&&(this.context.putImageData(this.imageData,0,0),this.dirty=!0);return this},processPixel:function(a,c,b,e,k,m){void 0===b&&(b=0);void 0===e&&(e=0);void 0===k&&(k=this.width);void 0===m&&(m=this.height);k=b+k;m=e+m;for(var d,f=!1,g=e;g<m;g++)for(var h=b;h<k;h++)e=this.getPixel32(h,g),d=a.call(c,e,h,g),d!==e&&(this.pixels[g*this.width+h]=d,f=!0);f&&(this.context.putImageData(this.imageData,
0,0),this.dirty=!0);return this},replaceRGB:function(a,c,d,e,k,m,f,g,h){var u=0,v=0,z=this.width,l=this.height;a=b.Color.packPixel(a,c,d,e);void 0!==h&&h instanceof b.Rectangle&&(u=h.x,v=h.y,z=h.width,l=h.height);for(h=0;h<l;h++)for(c=0;c<z;c++)this.getPixel32(u+c,v+h)===a&&this.setPixel32(u+c,v+h,k,m,f,g,!1);this.context.putImageData(this.imageData,0,0);this.dirty=!0;return this},setHSL:function(a,c,d,e){var k=a||0===a,m=c||0===c,f=d||0===d;if(k||m||f){void 0===e&&(e=new b.Rectangle(0,0,this.width,
this.height));for(var g=b.Color.createColor(),h=e.y;h<e.bottom;h++)for(var t=e.x;t<e.right;t++)b.Color.unpackPixel(this.getPixel32(t,h),g,!0),k&&(g.h=a),m&&(g.s=c),f&&(g.l=d),b.Color.HSLtoRGB(g.h,g.s,g.l,g),this.setPixel32(t,h,g.r,g.g,g.b,g.a,!1);this.context.putImageData(this.imageData,0,0);this.dirty=!0;return this}},shiftHSL:function(a,c,d,e){if(void 0===a||null===a)a=!1;if(void 0===c||null===c)c=!1;if(void 0===d||null===d)d=!1;if(a||c||d){void 0===e&&(e=new b.Rectangle(0,0,this.width,this.height));
for(var k=b.Color.createColor(),m=e.y;m<e.bottom;m++)for(var f=e.x;f<e.right;f++)b.Color.unpackPixel(this.getPixel32(f,m),k,!0),a&&(k.h=this.game.math.wrap(k.h+a,0,1)),c&&(k.s=this.game.math.clamp(k.s+c,0,1)),d&&(k.l=this.game.math.clamp(k.l+d,0,1)),b.Color.HSLtoRGB(k.h,k.s,k.l,k),this.setPixel32(f,m,k.r,k.g,k.b,k.a,!1);this.context.putImageData(this.imageData,0,0);this.dirty=!0;return this}},setPixel32:function(a,c,d,e,k,m,f){void 0===f&&(f=!0);0<=a&&a<=this.width&&0<=c&&c<=this.height&&(this.pixels[c*
this.width+a]=b.Device.LITTLE_ENDIAN?m<<24|k<<16|e<<8|d:d<<24|e<<16|k<<8|m,f&&(this.context.putImageData(this.imageData,0,0),this.dirty=!0));return this},setPixel:function(a,c,b,e,k,m){return this.setPixel32(a,c,b,e,k,255,m)},getPixel:function(a,c,d){d||(d=b.Color.createColor());a=~~(a+c*this.width);a*=4;d.r=this.data[a];d.g=this.data[++a];d.b=this.data[++a];d.a=this.data[++a];return d},getPixel32:function(a,c){if(0<=a&&a<=this.width&&0<=c&&c<=this.height)return this.pixels[c*this.width+a]},getPixelRGB:function(a,
c,d,e,k){return b.Color.unpackPixel(this.getPixel32(a,c),d,e,k)},getPixels:function(a){return this.context.getImageData(a.x,a.y,a.width,a.height)},getFirstPixel:function(a){void 0===a&&(a=0);var c=b.Color.createColor(),d=0,e=0,k=1,m=!1;1===a?(k=-1,e=this.height):3===a&&(k=-1,d=this.width);do if(b.Color.unpackPixel(this.getPixel32(d,e),c),0===a||1===a){if(d++,d===this.width&&(d=0,e+=k,e>=this.height||0>=e))m=!0}else if(2===a||3===a)if(e++,e===this.height&&(e=0,d+=k,d>=this.width||0>=d))m=!0;while(0===
c.a&&!m);c.x=d;c.y=e;return c},getBounds:function(a){void 0===a&&(a=new b.Rectangle);a.x=this.getFirstPixel(2).x;if(a.x===this.width)return a.setTo(0,0,0,0);a.y=this.getFirstPixel(0).y;a.width=this.getFirstPixel(3).x-a.x+1;a.height=this.getFirstPixel(1).y-a.y+1;return a},addToWorld:function(a,c,b,e,k,m){k=k||1;m=m||1;a=this.game.add.image(a,c,this);a.anchor.set(b,e);a.scale.set(k,m);return a},copy:function(a,c,d,e,k,m,f,g,h,t,l,n,p,x,y,E,C){if(void 0===a||null===a)a=this;if(a instanceof b.RenderTexture||
a instanceof PIXI.RenderTexture)a=a.getCanvas();this._image=a;if(a instanceof b.Sprite||a instanceof b.Image||a instanceof b.Text||a instanceof PIXI.Sprite){this._pos.set(a.texture.crop.x,a.texture.crop.y);this._size.set(a.texture.crop.width,a.texture.crop.height);this._scale.set(a.scale.x,a.scale.y);this._anchor.set(a.anchor.x,a.anchor.y);this._rotate=a.rotation;this._alpha.current=a.alpha;this._image=a.texture instanceof b.RenderTexture||a.texture instanceof PIXI.RenderTexture?a.texture.getCanvas():
a.texture.baseTexture.source;if(void 0===m||null===m)m=a.x;if(void 0===f||null===f)f=a.y;a.texture.trim&&(m+=a.texture.trim.x-a.anchor.x*a.texture.trim.width,f+=a.texture.trim.y-a.anchor.y*a.texture.trim.height);16777215!==a.tint&&(a.cachedTint!==a.tint&&(a.cachedTint=a.tint,a.tintedTexture=PIXI.CanvasTinter.getTintedTexture(a,a.tint)),this._image=a.tintedTexture,this._pos.set(0))}else{this._pos.set(0);this._scale.set(1);this._anchor.set(0);this._rotate=0;this._alpha.current=1;if(a instanceof b.BitmapData)this._image=
a.canvas;else if("string"===typeof a){a=this.game.cache.getImage(a);if(null===a)return;this._image=a}this._size.set(this._image.width,this._image.height)}if(void 0===c||null===c)c=0;if(void 0===d||null===d)d=0;e&&(this._size.x=e);k&&(this._size.y=k);if(void 0===m||null===m)m=c;if(void 0===f||null===f)f=d;if(void 0===g||null===g)g=this._size.x;if(void 0===h||null===h)h=this._size.y;"number"===typeof t&&(this._rotate=t);"number"===typeof l&&(this._anchor.x=l);"number"===typeof n&&(this._anchor.y=n);
"number"===typeof p&&(this._scale.x=p);"number"===typeof x&&(this._scale.y=x);"number"===typeof y&&(this._alpha.current=y);void 0===E&&(E=null);void 0===C&&(C=!1);if(!(0>=this._alpha.current||0===this._scale.x||0===this._scale.y||0===this._size.x||0===this._size.y))return a=this.context,this._alpha.prev=a.globalAlpha,a.save(),a.globalAlpha=this._alpha.current,E&&(this.op=E),C&&(m|=0,f|=0),a.translate(m,f),a.scale(this._scale.x,this._scale.y),a.rotate(this._rotate),a.drawImage(this._image,this._pos.x+
c,this._pos.y+d,this._size.x,this._size.y,-g*this._anchor.x,-h*this._anchor.y,g,h),a.restore(),a.globalAlpha=this._alpha.prev,this.dirty=!0,this},copyTransform:function(a,c,d){void 0===c&&(c=null);void 0===d&&(d=!1);if(!a.hasOwnProperty("worldTransform")||!a.worldVisible||0===a.worldAlpha)return this;var e=a.worldTransform;this._pos.set(a.texture.crop.x,a.texture.crop.y);this._size.set(a.texture.crop.width,a.texture.crop.height);if(0===e.a||0===e.d||0===this._size.x||0===this._size.y)return this;
this._image=a.texture instanceof b.RenderTexture||a.texture instanceof PIXI.RenderTexture?a.texture.getCanvas():a.texture.baseTexture.source;var k=e.tx,m=e.ty;a.texture.trim&&(k+=a.texture.trim.x-a.anchor.x*a.texture.trim.width,m+=a.texture.trim.y-a.anchor.y*a.texture.trim.height);16777215!==a.tint&&(a.cachedTint!==a.tint&&(a.cachedTint=a.tint,a.tintedTexture=PIXI.CanvasTinter.getTintedTexture(a,a.tint)),this._image=a.tintedTexture,this._pos.set(0));d&&(k|=0,m|=0);d=this.context;this._alpha.prev=
d.globalAlpha;d.save();d.globalAlpha=this._alpha.current;c&&(this.op=c);d[this.smoothProperty]=a.texture.baseTexture.scaleMode===PIXI.scaleModes.LINEAR;d.setTransform(e.a,e.b,e.c,e.d,k,m);d.drawImage(this._image,this._pos.x,this._pos.y,this._size.x,this._size.y,-this._size.x*a.anchor.x,-this._size.y*a.anchor.y,this._size.x,this._size.y);d.restore();d.globalAlpha=this._alpha.prev;this.dirty=!0;return this},copyRect:function(a,c,b,e,k,m,f){return this.copy(a,c.x,c.y,c.width,c.height,b,e,c.width,c.height,
0,0,0,1,1,k,m,f)},draw:function(a,c,b,e,k,m,f){return this.copy(a,null,null,null,null,c,b,e,k,null,null,null,null,null,null,m,f)},drawGroup:function(a,c,b){0<a.total&&a.forEachExists(this.drawGroupProxy,this,c,b);return this},drawGroupProxy:function(a,c,d){a.hasOwnProperty("texture")&&this.copyTransform(a,c,d);if(a.type===b.GROUP&&a.exists)this.drawGroup(a,c,d);else if(a.hasOwnProperty("children")&&0<a.children.length)for(var e=0;e<a.children.length;e++)a.children[e].exists&&this.copyTransform(a.children[e],
c,d)},drawFull:function(a,c,d){if(!1===a.worldVisible||0===a.worldAlpha||a.hasOwnProperty("exists")&&!1===a.exists)return this;if(a.type!==b.GROUP&&a.type!==b.EMITTER&&a.type!==b.BITMAPTEXT)if(a.type===b.GRAPHICS){var e=a.getBounds();this.ctx.save();this.ctx.translate(e.x,e.y);PIXI.CanvasGraphics.renderGraphics(a,this.ctx);this.ctx.restore()}else this.copy(a,null,null,null,null,a.worldPosition.x,a.worldPosition.y,null,null,a.worldRotation,null,null,a.worldScale.x,a.worldScale.y,a.worldAlpha,c,d);
if(a.children)for(e=0;e<a.children.length;e++)this.drawFull(a.children[e],c,d);return this},shadow:function(a,c,b,e){var d=this.context;void 0===a||null===a?d.shadowColor="rgba(0,0,0,0)":(d.shadowColor=a,d.shadowBlur=c||5,d.shadowOffsetX=b||10,d.shadowOffsetY=e||10);return this},alphaMask:function(a,c,b,e){void 0===e||null===e?this.draw(c).blendSourceAtop():this.draw(c,e.x,e.y,e.width,e.height).blendSourceAtop();void 0===b||null===b?this.draw(a).blendReset():this.draw(a,b.x,b.y,b.width,b.height).blendReset();
return this},extract:function(a,c,b,e,k,m,f,g,h){void 0===k&&(k=255);void 0===m&&(m=!1);void 0===f&&(f=c);void 0===g&&(g=b);void 0===h&&(h=e);m&&a.resize(this.width,this.height);this.processPixelRGB(function(d,m,u){d.r===c&&d.g===b&&d.b===e&&a.setPixel32(m,u,f,g,h,k,!1);return!1},this);a.context.putImageData(a.imageData,0,0);a.dirty=!0;return a},rect:function(a,c,b,e,k){"undefined"!==typeof k&&(this.context.fillStyle=k);this.context.fillRect(a,c,b,e);return this},text:function(a,c,b,e,k,m){void 0===
c&&(c=0);void 0===b&&(b=0);void 0===e&&(e="14px Courier");void 0===k&&(k="rgb(255,255,255)");void 0===m&&(m=!0);var d=this.context,f=d.font;d.font=e;m&&(d.fillStyle="rgb(0,0,0)",d.fillText(a,c+1,b+1));d.fillStyle=k;d.fillText(a,c,b);d.font=f;return this},circle:function(a,c,b,e){var d=this.context;void 0!==e&&(d.fillStyle=e);d.beginPath();d.arc(a,c,b,0,2*Math.PI,!1);d.closePath();d.fill();return this},line:function(a,c,b,e,k,m){void 0===k&&(k="#fff");void 0===m&&(m=1);var d=this.context;d.beginPath();
d.moveTo(a,c);d.lineTo(b,e);d.lineWidth=m;d.strokeStyle=k;d.stroke();d.closePath();return this},textureLine:function(a,c,d){void 0===d&&(d="repeat-x");if("string"===typeof c&&(c=this.game.cache.getImage(c),!c))return;var e=a.length;"no-repeat"===d&&e>c.width&&(e=c.width);var k=this.context;k.fillStyle=k.createPattern(c,d);this._circle=new b.Circle(a.start.x,a.start.y,c.height);this._circle.circumferencePoint(a.angle-1.5707963267948966,!1,this._pos);k.save();k.translate(this._pos.x,this._pos.y);k.rotate(a.angle);
k.fillRect(0,0,e,c.height);k.restore();this.dirty=!0;return this},render:function(){!this.disableTextureUpload&&this.dirty&&(this.baseTexture.dirty(),this.dirty=!1);return this},destroy:function(){this.frameData.destroy();this.texture.destroy(!0);PIXI.CanvasPool.remove(this)},blendReset:function(){this.op="source-over";return this},blendSourceOver:function(){this.op="source-over";return this},blendSourceIn:function(){this.op="source-in";return this},blendSourceOut:function(){this.op="source-out";
return this},blendSourceAtop:function(){this.op="source-atop";return this},blendDestinationOver:function(){this.op="destination-over";return this},blendDestinationIn:function(){this.op="destination-in";return this},blendDestinationOut:function(){this.op="destination-out";return this},blendDestinationAtop:function(){this.op="destination-atop";return this},blendXor:function(){this.op="xor";return this},blendAdd:function(){this.op="lighter";return this},blendMultiply:function(){this.op="multiply";return this},
blendScreen:function(){this.op="screen";return this},blendOverlay:function(){this.op="overlay";return this},blendDarken:function(){this.op="darken";return this},blendLighten:function(){this.op="lighten";return this},blendColorDodge:function(){this.op="color-dodge";return this},blendColorBurn:function(){this.op="color-burn";return this},blendHardLight:function(){this.op="hard-light";return this},blendSoftLight:function(){this.op="soft-light";return this},blendDifference:function(){this.op="difference";
return this},blendExclusion:function(){this.op="exclusion";return this},blendHue:function(){this.op="hue";return this},blendSaturation:function(){this.op="saturation";return this},blendColor:function(){this.op="color";return this},blendLuminosity:function(){this.op="luminosity";return this}};Object.defineProperty(b.BitmapData.prototype,"smoothed",{get:function(){b.Canvas.getSmoothingEnabled(this.context)},set:function(a){b.Canvas.setSmoothingEnabled(this.context,a)}});Object.defineProperty(b.BitmapData.prototype,
"op",{get:function(){return this.context.globalCompositeOperation},set:function(a){this.context.globalCompositeOperation=a}});b.BitmapData.getTransform=function(a,c,b,e,k,m){"number"!==typeof a&&(a=0);"number"!==typeof c&&(c=0);"number"!==typeof b&&(b=1);"number"!==typeof e&&(e=1);"number"!==typeof k&&(k=0);"number"!==typeof m&&(m=0);return{sx:b,sy:e,scaleX:b,scaleY:e,skewX:k,skewY:m,translateX:a,translateY:c,tx:a,ty:c}};b.BitmapData.prototype.constructor=b.BitmapData;PIXI.Graphics=function(){PIXI.DisplayObjectContainer.call(this);
this.renderable=!0;this.fillAlpha=1;this.lineColor=this.lineWidth=0;this.graphicsData=[];this.tint=16777215;this.blendMode=PIXI.blendModes.NORMAL;this.currentPath=null;this._webGL=[];this.isMask=!1;this.boundsPadding=0;this._localBounds=new PIXI.Rectangle(0,0,1,1);this.dirty=!0;this.cachedSpriteDirty=this.webGLDirty=this._boundsDirty=!1};PIXI.Graphics.prototype=Object.create(PIXI.DisplayObjectContainer.prototype);PIXI.Graphics.prototype.constructor=PIXI.Graphics;PIXI.Graphics.prototype.lineStyle=
function(a,c,b){this.lineWidth=a||0;this.lineColor=c||0;this.lineAlpha=void 0===b?1:b;this.currentPath&&(this.currentPath.shape.points.length?this.drawShape(new PIXI.Polygon(this.currentPath.shape.points.slice(-2))):(this.currentPath.lineWidth=this.lineWidth,this.currentPath.lineColor=this.lineColor,this.currentPath.lineAlpha=this.lineAlpha));return this};PIXI.Graphics.prototype.moveTo=function(a,c){this.drawShape(new PIXI.Polygon([a,c]));return this};PIXI.Graphics.prototype.lineTo=function(a,c){this.currentPath||
this.moveTo(0,0);this.currentPath.shape.points.push(a,c);this._boundsDirty=this.dirty=!0;return this};PIXI.Graphics.prototype.quadraticCurveTo=function(a,c,b,e){this.currentPath?0===this.currentPath.shape.points.length&&(this.currentPath.shape.points=[0,0]):this.moveTo(0,0);var d=this.currentPath.shape.points;0===d.length&&this.moveTo(0,0);for(var m=d[d.length-2],f=d[d.length-1],g,h=1;20>=h;++h){g=h/20;var l=m+(a-m)*g;var n=f+(c-f)*g;d.push(l+(a+(b-a)*g-l)*g,n+(c+(e-c)*g-n)*g)}this._boundsDirty=this.dirty=
!0;return this};PIXI.Graphics.prototype.bezierCurveTo=function(a,c,b,e,k,m){this.currentPath?0===this.currentPath.shape.points.length&&(this.currentPath.shape.points=[0,0]):this.moveTo(0,0);for(var d,f,g,h,l,n=this.currentPath.shape.points,p=n[n.length-2],x=n[n.length-1],y,E=1;20>=E;++E)y=E/20,d=1-y,f=d*d,g=f*d,h=y*y,l=h*y,n.push(g*p+3*f*y*a+3*d*h*b+l*k,g*x+3*f*y*c+3*d*h*e+l*m);this._boundsDirty=this.dirty=!0;return this};PIXI.Graphics.prototype.arcTo=function(a,c,b,e,k){this.currentPath?0===this.currentPath.shape.points.length&&
this.currentPath.shape.points.push(a,c):this.moveTo(a,c);var d=this.currentPath.shape.points,f=d[d.length-1]-c,g=d[d.length-2]-a;e-=c;b-=a;var h=Math.abs(f*b-g*e);if(1E-8>h||0===k)d[d.length-2]===a&&d[d.length-1]===c||d.push(a,c);else{var l=f*f+g*g,n=e*e+b*b,p=f*e+g*b;d=k*Math.sqrt(l)/h;h=k*Math.sqrt(n)/h;l=d*p/l;n=h*p/n;p=d*b+h*g;var r=d*e+h*f;this.arc(p+a,r+c,k,Math.atan2(f*(h+l)-r,g*(h+l)-p),Math.atan2(e*(d+n)-r,b*(d+n)-p),g*e>b*f)}this._boundsDirty=this.dirty=!0;return this};PIXI.Graphics.prototype.arc=
function(a,c,b,e,k,m,f){if(e===k)return this;void 0===m&&(m=!1);void 0===f&&(f=40);!m&&k<=e?k+=2*Math.PI:m&&e<=k&&(e+=2*Math.PI);k=m?-1*(e-k):k-e;var d=Math.ceil(Math.abs(k)/(2*Math.PI))*f;if(0===k)return this;f=a+Math.cos(e)*b;var g=c+Math.sin(e)*b;m&&this.filling?this.moveTo(a,c):this.moveTo(f,g);m=this.currentPath.shape.points;k/=2*d;f=2*k;g=Math.cos(k);var h=Math.sin(k);--d;for(var u=d%1/d,l=0;l<=d;l++){var n=k+e+f*(l+u*l),p=Math.cos(n);n=-Math.sin(n);m.push((g*p+h*n)*b+a,(g*-n+h*p)*b+c)}this._boundsDirty=
this.dirty=!0;return this};PIXI.Graphics.prototype.beginFill=function(a,c){this.filling=!0;this.fillColor=a||0;this.fillAlpha=void 0===c?1:c;this.currentPath&&2>=this.currentPath.shape.points.length&&(this.currentPath.fill=this.filling,this.currentPath.fillColor=this.fillColor,this.currentPath.fillAlpha=this.fillAlpha);return this};PIXI.Graphics.prototype.endFill=function(){this.filling=!1;this.fillColor=null;this.fillAlpha=1;return this};PIXI.Graphics.prototype.drawRect=function(a,c,b,e){this.drawShape(new PIXI.Rectangle(a,
c,b,e));return this};PIXI.Graphics.prototype.drawRoundedRect=function(a,c,b,e,k){this.drawShape(new PIXI.RoundedRectangle(a,c,b,e,k));return this};PIXI.Graphics.prototype.drawCircle=function(a,c,b){this.drawShape(new PIXI.Circle(a,c,b));return this};PIXI.Graphics.prototype.drawEllipse=function(a,c,b,e){this.drawShape(new PIXI.Ellipse(a,c,b,e));return this};PIXI.Graphics.prototype.drawPolygon=function(a){if(a instanceof b.Polygon||a instanceof PIXI.Polygon)a=a.points;var c=a;if(!Array.isArray(c)){c=
Array(arguments.length);for(var d=0;d<c.length;++d)c[d]=arguments[d]}this.drawShape(new b.Polygon(c));return this};PIXI.Graphics.prototype.clear=function(){this.lineWidth=0;this.filling=!1;this.clearDirty=this._boundsDirty=this.dirty=!0;this.graphicsData=[];this.updateLocalBounds();return this};PIXI.Graphics.prototype.generateTexture=function(a,c,b){void 0===a&&(a=1);void 0===c&&(c=PIXI.scaleModes.DEFAULT);void 0===b&&(b=0);var d=this.getBounds();d.width+=b;d.height+=b;b=new PIXI.CanvasBuffer(d.width*
a,d.height*a);c=PIXI.Texture.fromCanvas(b.canvas,c);c.baseTexture.resolution=a;b.context.scale(a,a);b.context.translate(-d.x,-d.y);PIXI.CanvasGraphics.renderGraphics(this,b.context);return c};PIXI.Graphics.prototype._renderWebGL=function(a){if(!1!==this.visible&&0!==this.alpha&&!0!==this.isMask)if(this._cacheAsBitmap){if(this.dirty||this.cachedSpriteDirty)this._generateCachedSprite(),this.updateCachedSpriteTexture(),this.dirty=this.cachedSpriteDirty=!1;this._cachedSprite.worldAlpha=this.worldAlpha;
PIXI.Sprite.prototype._renderWebGL.call(this._cachedSprite,a)}else{a.spriteBatch.stop();a.blendModeManager.setBlendMode(this.blendMode);this._mask&&a.maskManager.pushMask(this._mask,a);this._filters&&a.filterManager.pushFilter(this._filterBlock);if(this.blendMode!==a.spriteBatch.currentBlendMode){a.spriteBatch.currentBlendMode=this.blendMode;var c=PIXI.blendModesWebGL[a.spriteBatch.currentBlendMode];a.spriteBatch.gl.blendFunc(c[0],c[1])}this.webGLDirty&&(this.dirty=!0,this.webGLDirty=!1);PIXI.WebGLGraphics.renderGraphics(this,
a);if(this.children.length){a.spriteBatch.start();for(c=0;c<this.children.length;c++)this.children[c]._renderWebGL(a);a.spriteBatch.stop()}this._filters&&a.filterManager.popFilter();this._mask&&a.maskManager.popMask(this.mask,a);a.drawCount++;a.spriteBatch.start()}};PIXI.Graphics.prototype._renderCanvas=function(a){if(!1!==this.visible&&0!==this.alpha&&!0!==this.isMask)if(this._prevTint!==this.tint&&(this.dirty=!0,this._prevTint=this.tint),this._cacheAsBitmap){if(this.dirty||this.cachedSpriteDirty)this._generateCachedSprite(),
this.updateCachedSpriteTexture(),this.dirty=this.cachedSpriteDirty=!1;this._cachedSprite.alpha=this.alpha;PIXI.Sprite.prototype._renderCanvas.call(this._cachedSprite,a)}else{var c=a.context,b=this.worldTransform;this.blendMode!==a.currentBlendMode&&(a.currentBlendMode=this.blendMode,c.globalCompositeOperation=PIXI.blendModesCanvas[a.currentBlendMode]);this._mask&&a.maskManager.pushMask(this._mask,a);var e=a.resolution;c.setTransform(b.a*e,b.b*e,b.c*e,b.d*e,b.tx*a.resolution+a.shakeX,b.ty*a.resolution+
a.shakeY);PIXI.CanvasGraphics.renderGraphics(this,c);for(c=0;c<this.children.length;c++)this.children[c]._renderCanvas(a);this._mask&&a.maskManager.popMask(a)}};PIXI.Graphics.prototype.getBounds=function(a){if(!this._currentBounds){if(!this.renderable)return PIXI.EmptyRectangle;this.dirty&&(this.updateLocalBounds(),this.cachedSpriteDirty=this.webGLDirty=!0,this.dirty=!1);var c=this._localBounds,b=c.x,e=c.width+c.x,k=c.y,m=c.height+c.y;a=a||this.worldTransform;var f=a.a,g=a.b,h=a.c,l=a.d,n=a.tx,p=
a.ty,r=f*e+h*m+n;c=l*m+g*e+p;a=f*b+h*m+n;m=l*m+g*b+p;var x=f*b+h*k+n;b=l*k+g*b+p;f=f*e+h*k+n;e=l*k+g*e+p;k=r;g=c;r=a<r?a:r;r=x<r?x:r;r=f<r?f:r;c=m<c?m:c;c=b<c?b:c;c=e<c?e:c;k=a>k?a:k;k=x>k?x:k;g=m>g?m:g;g=b>g?b:g;this._bounds.x=r;this._bounds.width=(f>k?f:k)-r;this._bounds.y=c;this._bounds.height=(e>g?e:g)-c;this._currentBounds=this._bounds}return this._currentBounds};PIXI.Graphics.prototype.getLocalBounds=function(){var a=this.worldTransform;this.worldTransform=PIXI.identityMatrix;for(var c=0;c<
this.children.length;c++)this.children[c].updateTransform();var b=this.getBounds();this.worldTransform=a;for(c=0;c<this.children.length;c++)this.children[c].updateTransform();return b};PIXI.Graphics.prototype.containsPoint=function(a){this.worldTransform.applyInverse(a,tempPoint);a=this.graphicsData;for(var c=0;c<a.length;c++){var b=a[c];if(b.fill&&b.shape&&b.shape.contains(tempPoint.x,tempPoint.y))return!0}return!1};PIXI.Graphics.prototype.updateLocalBounds=function(){var a=Infinity,c=-Infinity,
d=Infinity,e=-Infinity;if(this.graphicsData.length)for(var k,m,f,g,h,l=0;l<this.graphicsData.length;l++)if(f=this.graphicsData[l],m=f.type,h=f.lineWidth,k=f.shape,m===PIXI.Graphics.RECT||m===PIXI.Graphics.RREC)m=k.x-h/2,f=k.y-h/2,g=k.width+h,h=k.height+h,a=m<a?m:a,c=m+g>c?m+g:c,d=f<d?f:d,e=f+h>e?f+h:e;else if(m===PIXI.Graphics.CIRC)m=k.x,f=k.y,g=k.radius+h/2,h=k.radius+h/2,a=m-g<a?m-g:a,c=m+g>c?m+g:c,d=f-h<d?f-h:d,e=f+h>e?f+h:e;else if(m===PIXI.Graphics.ELIP)m=k.x,f=k.y,g=k.width+h/2,h=k.height+h/
2,a=m-g<a?m-g:a,c=m+g>c?m+g:c,d=f-h<d?f-h:d,e=f+h>e?f+h:e;else for(k=k.points,g=0;g<k.length;g++)k[g]instanceof b.Point?(m=k[g].x,f=k[g].y):(m=k[g],f=k[g+1],g<k.length-1&&g++),a=m-h<a?m-h:a,c=m+h>c?m+h:c,d=f-h<d?f-h:d,e=f+h>e?f+h:e;else e=d=c=a=0;l=this.boundsPadding;this._localBounds.x=a-l;this._localBounds.width=c-a+2*l;this._localBounds.y=d-l;this._localBounds.height=e-d+2*l};PIXI.Graphics.prototype._generateCachedSprite=function(){var a=this.getLocalBounds();if(this._cachedSprite)this._cachedSprite.buffer.resize(a.width,
a.height);else{var c=new PIXI.CanvasBuffer(a.width,a.height),b=PIXI.Texture.fromCanvas(c.canvas);this._cachedSprite=new PIXI.Sprite(b);this._cachedSprite.buffer=c;this._cachedSprite.worldTransform=this.worldTransform}this._cachedSprite.anchor.x=-(a.x/a.width);this._cachedSprite.anchor.y=-(a.y/a.height);this._cachedSprite.buffer.context.translate(-a.x,-a.y);this.worldAlpha=1;PIXI.CanvasGraphics.renderGraphics(this,this._cachedSprite.buffer.context);this._cachedSprite.alpha=this.alpha};PIXI.Graphics.prototype.updateCachedSpriteTexture=
function(){var a=this._cachedSprite,c=a.texture,b=a.buffer.canvas;c.baseTexture.width=b.width;c.baseTexture.height=b.height;c.crop.width=c.frame.width=b.width;c.crop.height=c.frame.height=b.height;a._width=b.width;a._height=b.height;c.baseTexture.dirty()};PIXI.Graphics.prototype.destroyCachedSprite=function(){this._cachedSprite.texture.destroy(!0);this._cachedSprite=null};PIXI.Graphics.prototype.drawShape=function(a){this.currentPath&&2>=this.currentPath.shape.points.length&&this.graphicsData.pop();
this.currentPath=null;a instanceof b.Polygon&&(a=a.clone(),a.flatten());a=new PIXI.GraphicsData(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.filling,a);this.graphicsData.push(a);a.type===PIXI.Graphics.POLY&&(a.shape.closed=this.filling,this.currentPath=a);this._boundsDirty=this.dirty=!0;return a};Object.defineProperty(PIXI.Graphics.prototype,"cacheAsBitmap",{get:function(){return this._cacheAsBitmap},set:function(a){(this._cacheAsBitmap=a)?this._generateCachedSprite():
this.destroyCachedSprite();this.webGLDirty=this.dirty=!0}});PIXI.GraphicsData=function(a,c,b,e,k,m,f){this.lineWidth=a;this.lineColor=c;this.lineAlpha=b;this._lineTint=c;this.fillColor=e;this.fillAlpha=k;this._fillTint=e;this.fill=m;this.shape=f;this.type=f.type};PIXI.GraphicsData.prototype.constructor=PIXI.GraphicsData;PIXI.GraphicsData.prototype.clone=function(){return new GraphicsData(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.fill,this.shape)};PIXI.EarCut=
{};PIXI.EarCut.Triangulate=function(a,c,b){b=b||2;var d=c&&c.length,k=d?c[0]*b:a.length,m=PIXI.EarCut.linkedList(a,0,k,b,!0),f=[];if(!m)return f;d&&(m=PIXI.EarCut.eliminateHoles(a,c,m,b));if(a.length>80*b){var g=c=a[0];var h=d=a[1];for(var l=b;l<k;l+=b){var n=a[l];var p=a[l+1];n<g&&(g=n);p<h&&(h=p);n>c&&(c=n);p>d&&(d=p)}n=Math.max(c-g,d-h)}PIXI.EarCut.earcutLinked(m,f,b,g,h,n);return f};PIXI.EarCut.linkedList=function(a,c,b,e,k){var d=0,f;var g=c;for(f=b-e;g<b;g+=e)d+=(a[f]-a[g])*(a[g+1]+a[f+1]),
f=g;if(k===0<d)for(g=c;g<b;g+=e)var h=PIXI.EarCut.insertNode(g,a[g],a[g+1],h);else for(g=b-e;g>=c;g-=e)h=PIXI.EarCut.insertNode(g,a[g],a[g+1],h);return h};PIXI.EarCut.filterPoints=function(a,c){if(!a)return a;c||(c=a);var b=a;do{var e=!1;if(b.steiner||!PIXI.EarCut.equals(b,b.next)&&0!==PIXI.EarCut.area(b.prev,b,b.next))b=b.next;else{PIXI.EarCut.removeNode(b);b=c=b.prev;if(b===b.next)return null;e=!0}}while(e||b!==c);return c};PIXI.EarCut.earcutLinked=function(a,c,b,e,k,f,g){if(a){!g&&f&&PIXI.EarCut.indexCurve(a,
e,k,f);for(var d=a,m,h;a.prev!==a.next;)if(m=a.prev,h=a.next,f?PIXI.EarCut.isEarHashed(a,e,k,f):PIXI.EarCut.isEar(a))c.push(m.i/b),c.push(a.i/b),c.push(h.i/b),PIXI.EarCut.removeNode(a),d=a=h.next;else if(a=h,a===d){g?1===g?(a=PIXI.EarCut.cureLocalIntersections(a,c,b),PIXI.EarCut.earcutLinked(a,c,b,e,k,f,2)):2===g&&PIXI.EarCut.splitEarcut(a,c,b,e,k,f):PIXI.EarCut.earcutLinked(PIXI.EarCut.filterPoints(a),c,b,e,k,f,1);break}}};PIXI.EarCut.isEar=function(a){var c=a.prev,b=a.next;if(0<=PIXI.EarCut.area(c,
a,b))return!1;for(var e=a.next.next;e!==a.prev;){if(PIXI.EarCut.pointInTriangle(c.x,c.y,a.x,a.y,b.x,b.y,e.x,e.y)&&0<=PIXI.EarCut.area(e.prev,e,e.next))return!1;e=e.next}return!0};PIXI.EarCut.isEarHashed=function(a,c,b,e){var d=a.prev,f=a.next;if(0<=PIXI.EarCut.area(d,a,f))return!1;var g=d.x>a.x?d.x>f.x?d.x:f.x:a.x>f.x?a.x:f.x,h=d.y>a.y?d.y>f.y?d.y:f.y:a.y>f.y?a.y:f.y,l=PIXI.EarCut.zOrder(d.x<a.x?d.x<f.x?d.x:f.x:a.x<f.x?a.x:f.x,d.y<a.y?d.y<f.y?d.y:f.y:a.y<f.y?a.y:f.y,c,b,e);c=PIXI.EarCut.zOrder(g,
h,c,b,e);for(b=a.nextZ;b&&b.z<=c;){if(b!==a.prev&&b!==a.next&&PIXI.EarCut.pointInTriangle(d.x,d.y,a.x,a.y,f.x,f.y,b.x,b.y)&&0<=PIXI.EarCut.area(b.prev,b,b.next))return!1;b=b.nextZ}for(b=a.prevZ;b&&b.z>=l;){if(b!==a.prev&&b!==a.next&&PIXI.EarCut.pointInTriangle(d.x,d.y,a.x,a.y,f.x,f.y,b.x,b.y)&&0<=PIXI.EarCut.area(b.prev,b,b.next))return!1;b=b.prevZ}return!0};PIXI.EarCut.cureLocalIntersections=function(a,c,b){var d=a;do{var k=d.prev,f=d.next.next;PIXI.EarCut.intersects(k,d,d.next,f)&&PIXI.EarCut.locallyInside(k,
f)&&PIXI.EarCut.locallyInside(f,k)&&(c.push(k.i/b),c.push(d.i/b),c.push(f.i/b),PIXI.EarCut.removeNode(d),PIXI.EarCut.removeNode(d.next),d=a=f);d=d.next}while(d!==a);return d};PIXI.EarCut.splitEarcut=function(a,c,b,e,k,f){var d=a;do{for(var m=d.next.next;m!==d.prev;){if(d.i!==m.i&&PIXI.EarCut.isValidDiagonal(d,m)){a=PIXI.EarCut.splitPolygon(d,m);d=PIXI.EarCut.filterPoints(d,d.next);a=PIXI.EarCut.filterPoints(a,a.next);PIXI.EarCut.earcutLinked(d,c,b,e,k,f);PIXI.EarCut.earcutLinked(a,c,b,e,k,f);return}m=
m.next}d=d.next}while(d!==a)};PIXI.EarCut.eliminateHoles=function(a,c,b,e){var d=[],f;var g=0;for(f=c.length;g<f;g++){var h=c[g]*e;var l=g<f-1?c[g+1]*e:a.length;h=PIXI.EarCut.linkedList(a,h,l,e,!1);h===h.next&&(h.steiner=!0);d.push(PIXI.EarCut.getLeftmost(h))}d.sort(compareX);for(g=0;g<d.length;g++)PIXI.EarCut.eliminateHole(d[g],b),b=PIXI.EarCut.filterPoints(b,b.next);return b};PIXI.EarCut.compareX=function(a,c){return a.x-c.x};PIXI.EarCut.eliminateHole=function(a,c){if(c=PIXI.EarCut.findHoleBridge(a,
c)){var b=PIXI.EarCut.splitPolygon(c,a);PIXI.EarCut.filterPoints(b,b.next)}};PIXI.EarCut.findHoleBridge=function(a,c){var b=c,e=a.x,k=a.y,f=-Infinity;do{if(k<=b.y&&k>=b.next.y){var g=b.x+(k-b.y)*(b.next.x-b.x)/(b.next.y-b.y);if(g<=e&&g>f){f=g;var h=b.x<b.next.x?b:b.next}}b=b.next}while(b!==c);if(!h)return null;if(a.x===h.x)return h.prev;g=h;var l=Infinity;for(b=h.next;b!==g;){if(e>=b.x&&b.x>=h.x&&PIXI.EarCut.pointInTriangle(k<h.y?e:f,k,h.x,h.y,k<h.y?f:e,k,b.x,b.y)){var n=Math.abs(k-b.y)/(e-b.x);(n<
l||n===l&&b.x>h.x)&&PIXI.EarCut.locallyInside(b,a)&&(h=b,l=n)}b=b.next}return h};PIXI.EarCut.indexCurve=function(a,c,b,e){var d=a;do null===d.z&&(d.z=PIXI.EarCut.zOrder(d.x,d.y,c,b,e)),d.prevZ=d.prev,d=d.nextZ=d.next;while(d!==a);d.prevZ.nextZ=null;d.prevZ=null;PIXI.EarCut.sortLinked(d)};PIXI.EarCut.sortLinked=function(a){var c,b,e,k,f=1;do{var g=a;var h=a=null;for(b=0;g;){b++;var l=g;for(c=e=0;c<f&&(e++,l=l.nextZ,l);c++);for(k=f;0<e||0<k&&l;)0===e?(c=l,l=l.nextZ,k--):0!==k&&l?g.z<=l.z?(c=g,g=g.nextZ,
e--):(c=l,l=l.nextZ,k--):(c=g,g=g.nextZ,e--),h?h.nextZ=c:a=c,c.prevZ=h,h=c;g=l}h.nextZ=null;f*=2}while(1<b);return a};PIXI.EarCut.zOrder=function(a,c,b,e,k){a=32767*(a-b)/k;c=32767*(c-e)/k;a=(a|a<<8)&16711935;a=(a|a<<4)&252645135;a=(a|a<<2)&858993459;c=(c|c<<8)&16711935;c=(c|c<<4)&252645135;c=(c|c<<2)&858993459;return(a|a<<1)&1431655765|((c|c<<1)&1431655765)<<1};PIXI.EarCut.getLeftmost=function(a){var c=a,b=a;do c.x<b.x&&(b=c),c=c.next;while(c!==a);return b};PIXI.EarCut.pointInTriangle=function(a,
c,b,e,k,f,g,h){return 0<=(k-g)*(c-h)-(a-g)*(f-h)&&0<=(a-g)*(e-h)-(b-g)*(c-h)&&0<=(b-g)*(f-h)-(k-g)*(e-h)};PIXI.EarCut.isValidDiagonal=function(a,c){return PIXI.EarCut.equals(a,c)||a.next.i!==c.i&&a.prev.i!==c.i&&!PIXI.EarCut.intersectsPolygon(a,c)&&PIXI.EarCut.locallyInside(a,c)&&PIXI.EarCut.locallyInside(c,a)&&PIXI.EarCut.middleInside(a,c)};PIXI.EarCut.area=function(a,c,b){return(c.y-a.y)*(b.x-c.x)-(c.x-a.x)*(b.y-c.y)};PIXI.EarCut.equals=function(a,c){return a.x===c.x&&a.y===c.y};PIXI.EarCut.intersects=
function(a,c,b,e){return 0<PIXI.EarCut.area(a,c,b)!==0<PIXI.EarCut.area(a,c,e)&&0<PIXI.EarCut.area(b,e,a)!==0<PIXI.EarCut.area(b,e,c)};PIXI.EarCut.intersectsPolygon=function(a,c){var b=a;do{if(b.i!==a.i&&b.next.i!==a.i&&b.i!==c.i&&b.next.i!==c.i&&PIXI.EarCut.intersects(b,b.next,a,c))return!0;b=b.next}while(b!==a);return!1};PIXI.EarCut.locallyInside=function(a,c){return 0>PIXI.EarCut.area(a.prev,a,a.next)?0<=PIXI.EarCut.area(a,c,a.next)&&0<=PIXI.EarCut.area(a,a.prev,c):0>PIXI.EarCut.area(a,c,a.prev)||
0>PIXI.EarCut.area(a,a.next,c)};PIXI.EarCut.middleInside=function(a,c){var b=a,e=!1,k=(a.x+c.x)/2,f=(a.y+c.y)/2;do b.y>f!==b.next.y>f&&k<(b.next.x-b.x)*(f-b.y)/(b.next.y-b.y)+b.x&&(e=!e),b=b.next;while(b!==a);return e};PIXI.EarCut.splitPolygon=function(a,c){var b=new PIXI.EarCut.Node(a.i,a.x,a.y),e=new PIXI.EarCut.Node(c.i,c.x,c.y),k=a.next,f=c.prev;a.next=c;c.prev=a;b.next=k;k.prev=b;e.next=b;b.prev=e;f.next=e;e.prev=f;return e};PIXI.EarCut.insertNode=function(a,c,b,e){a=new PIXI.EarCut.Node(a,c,
b);e?(a.next=e.next,a.prev=e,e.next.prev=a,e.next=a):(a.prev=a,a.next=a);return a};PIXI.EarCut.removeNode=function(a){a.next.prev=a.prev;a.prev.next=a.next;a.prevZ&&(a.prevZ.nextZ=a.nextZ);a.nextZ&&(a.nextZ.prevZ=a.prevZ)};PIXI.EarCut.Node=function(a,c,b){this.i=a;this.x=c;this.y=b;this.nextZ=this.prevZ=this.z=this.next=this.prev=null;this.steiner=!1};PIXI.WebGLGraphics=function(){};PIXI.WebGLGraphics.stencilBufferLimit=6;PIXI.WebGLGraphics.renderGraphics=function(a,c){var b=c.gl,e=c.projection,k=
c.offset,f=c.shaderManager.primitiveShader;a.dirty&&PIXI.WebGLGraphics.updateGraphics(a,b);for(var g=a._webGL[b.id],h=0;h<g.data.length;h++)if(1===g.data[h].mode){var l=g.data[h];c.stencilManager.pushStencil(a,l,c);b.drawElements(b.TRIANGLE_FAN,4,b.UNSIGNED_SHORT,2*(l.indices.length-4));c.stencilManager.popStencil(a,l,c)}else l=g.data[h],c.shaderManager.setShader(f),f=c.shaderManager.primitiveShader,b.uniformMatrix3fv(f.translationMatrix,!1,a.worldTransform.toArray(!0)),b.uniform1f(f.flipY,1),b.uniform2f(f.projectionVector,
e.x,-e.y),b.uniform2f(f.offsetVector,-k.x,-k.y),b.uniform3fv(f.tintColor,PIXI.hex2rgb(a.tint)),b.uniform1f(f.alpha,a.worldAlpha),b.bindBuffer(b.ARRAY_BUFFER,l.buffer),b.vertexAttribPointer(f.aVertexPosition,2,b.FLOAT,!1,24,0),b.vertexAttribPointer(f.colorAttribute,4,b.FLOAT,!1,24,8),b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,l.indexBuffer),b.drawElements(b.TRIANGLE_STRIP,l.indices.length,b.UNSIGNED_SHORT,0)};PIXI.WebGLGraphics.updateGraphics=function(a,c){var b=a._webGL[c.id];b||(b=a._webGL[c.id]={lastIndex:0,
data:[],gl:c});a.dirty=!1;var e;if(a.clearDirty){a.clearDirty=!1;for(e=0;e<b.data.length;e++){var k=b.data[e];k.reset();PIXI.WebGLGraphics.graphicsDataPool.push(k)}b.data=[];b.lastIndex=0}for(e=b.lastIndex;e<a.graphicsData.length;e++){var f=a.graphicsData[e];f.type===PIXI.Graphics.POLY?(f.points=f.shape.points.slice(),f.shape.closed&&(f.points[0]!==f.points[f.points.length-2]||f.points[1]!==f.points[f.points.length-1])&&f.points.push(f.points[0],f.points[1]),f.fill&&f.points.length>=PIXI.WebGLGraphics.stencilBufferLimit&&
(f.points.length<2*PIXI.WebGLGraphics.stencilBufferLimit?(k=PIXI.WebGLGraphics.switchMode(b,0),PIXI.WebGLGraphics.buildPoly(f,k)||(k=PIXI.WebGLGraphics.switchMode(b,1),PIXI.WebGLGraphics.buildComplexPoly(f,k))):(k=PIXI.WebGLGraphics.switchMode(b,1),PIXI.WebGLGraphics.buildComplexPoly(f,k))),0<f.lineWidth&&(k=PIXI.WebGLGraphics.switchMode(b,0),PIXI.WebGLGraphics.buildLine(f,k))):(k=PIXI.WebGLGraphics.switchMode(b,0),f.type===PIXI.Graphics.RECT?PIXI.WebGLGraphics.buildRectangle(f,k):f.type===PIXI.Graphics.CIRC||
f.type===PIXI.Graphics.ELIP?PIXI.WebGLGraphics.buildCircle(f,k):f.type===PIXI.Graphics.RREC&&PIXI.WebGLGraphics.buildRoundedRectangle(f,k));b.lastIndex++}for(e=0;e<b.data.length;e++)k=b.data[e],k.dirty&&k.upload()};PIXI.WebGLGraphics.switchMode=function(a,c){if(a.data.length){var b=a.data[a.data.length-1];if(b.mode!==c||1===c)b=PIXI.WebGLGraphics.graphicsDataPool.pop()||new PIXI.WebGLGraphicsData(a.gl),b.mode=c,a.data.push(b)}else b=PIXI.WebGLGraphics.graphicsDataPool.pop()||new PIXI.WebGLGraphicsData(a.gl),
b.mode=c,a.data.push(b);b.dirty=!0;return b};PIXI.WebGLGraphics.buildRectangle=function(a,c){var b=a.shape,e=b.x,k=b.y,f=b.width;b=b.height;if(a.fill){var g=PIXI.hex2rgb(a.fillColor),h=a.fillAlpha,l=g[0]*h,n=g[1]*h;g=g[2]*h;var p=c.points,q=c.indices,r=p.length/6;p.push(e,k);p.push(l,n,g,h);p.push(e+f,k);p.push(l,n,g,h);p.push(e,k+b);p.push(l,n,g,h);p.push(e+f,k+b);p.push(l,n,g,h);q.push(r,r,r+1,r+2,r+3,r+3)}a.lineWidth&&(h=a.points,a.points=[e,k,e+f,k,e+f,k+b,e,k+b,e,k],PIXI.WebGLGraphics.buildLine(a,
c),a.points=h)};PIXI.WebGLGraphics.buildRoundedRectangle=function(a,b){var c=a.shape,e=c.x,k=c.y,f=c.width,g=c.height,h=c.radius;c=[];c.push(e,k+h);c=c.concat(PIXI.WebGLGraphics.quadraticBezierCurve(e,k+g-h,e,k+g,e+h,k+g));c=c.concat(PIXI.WebGLGraphics.quadraticBezierCurve(e+f-h,k+g,e+f,k+g,e+f,k+g-h));c=c.concat(PIXI.WebGLGraphics.quadraticBezierCurve(e+f,k+h,e+f,k,e+f-h,k));c=c.concat(PIXI.WebGLGraphics.quadraticBezierCurve(e+h,k,e,k,e,k+h));if(a.fill){g=PIXI.hex2rgb(a.fillColor);e=a.fillAlpha;
k=g[0]*e;f=g[1]*e;g=g[2]*e;h=b.points;var l=b.indices,n=h.length/6,p=PIXI.EarCut.Triangulate(c,null,2),q;for(q=0;q<p.length;q+=3)l.push(p[q]+n),l.push(p[q]+n),l.push(p[q+1]+n),l.push(p[q+2]+n),l.push(p[q+2]+n);for(q=0;q<c.length;q++)h.push(c[q],c[++q],k,f,g,e)}a.lineWidth&&(e=a.points,a.points=c,PIXI.WebGLGraphics.buildLine(a,b),a.points=e)};PIXI.WebGLGraphics.quadraticBezierCurve=function(a,c,b,e,k,f){for(var d,g,m,h,l=[],n,p=0;20>=p;p++)n=p/20,d=a+(b-a)*n,g=c+(e-c)*n,m=b+(k-b)*n,h=e+(f-e)*n,d+=
(m-d)*n,g+=(h-g)*n,l.push(d,g);return l};PIXI.WebGLGraphics.buildCircle=function(a,c){var b=a.shape,e=b.x,k=b.y,f;a.type===PIXI.Graphics.CIRC?b=f=b.radius:(f=b.width,b=b.height);var g=2*Math.PI/40;if(a.fill){var h=PIXI.hex2rgb(a.fillColor);var l=a.fillAlpha,n=h[0]*l,p=h[1]*l,q=h[2]*l,r=c.points,x=c.indices,y=r.length/6;x.push(y);for(h=0;41>h;h++)r.push(e,k,n,p,q,l),r.push(e+Math.sin(g*h)*f,k+Math.cos(g*h)*b,n,p,q,l),x.push(y++,y++);x.push(y-1)}if(a.lineWidth){l=a.points;a.points=[];for(h=0;41>h;h++)a.points.push(e+
Math.sin(g*h)*f,k+Math.cos(g*h)*b);PIXI.WebGLGraphics.buildLine(a,c);a.points=l}};PIXI.WebGLGraphics.buildLine=function(a,b){var c,e=a.points;if(0!==e.length){if(a.lineWidth%2)for(c=0;c<e.length;c++)e[c]+=.5;var k=new PIXI.Point(e[0],e[1]),f=new PIXI.Point(e[e.length-2],e[e.length-1]);if(k.x===f.x&&k.y===f.y){e=e.slice();e.pop();e.pop();f=new PIXI.Point(e[e.length-2],e[e.length-1]);var g=f.x+.5*(k.x-f.x);k=f.y+.5*(k.y-f.y);e.unshift(g,k);e.push(g,k)}g=b.points;k=b.indices;f=e.length/2;var h=e.length,
l=g.length/6,n=a.lineWidth/2;c=PIXI.hex2rgb(a.lineColor);var p=a.lineAlpha,q=c[0]*p,r=c[1]*p,x=c[2]*p;var y=e[0];var E=e[1];var C=e[2];var F=e[3];var A=-(E-F);var B=y-C;var D=Math.sqrt(A*A+B*B);A=A/D*n;B=B/D*n;g.push(y-A,E-B,q,r,x,p);g.push(y+A,E+B,q,r,x,p);for(c=1;c<f-1;c++){y=e[2*(c-1)];E=e[2*(c-1)+1];C=e[2*c];F=e[2*c+1];var I=e[2*(c+1)];var J=e[2*(c+1)+1];A=-(E-F);B=y-C;D=Math.sqrt(A*A+B*B);A/=D;B/=D;A*=n;B*=n;var G=-(F-J);var H=C-I;D=Math.sqrt(G*G+H*H);G/=D;H/=D;G*=n;H*=n;D=-B+E-(-B+F);var K=
-A+C-(-A+y);y=(-A+y)*(-B+F)-(-A+C)*(-B+E);E=-H+J-(-H+F);var L=-G+C-(-G+I);I=(-G+I)*(-H+F)-(-G+C)*(-H+J);J=D*L-E*K;.1>Math.abs(J)?(g.push(C-A,F-B,q,r,x,p),g.push(C+A,F+B,q,r,x,p)):(K=(K*I-L*y)/J,D=(E*y-D*I)/J,I=(K-C)*(K-C)+(D-F)+(D-F),19600<I?(A-=G,B-=H,D=Math.sqrt(A*A+B*B),A/=D,B/=D,A*=n,B*=n,g.push(C-A,F-B),g.push(q,r,x,p),g.push(C+A,F+B),g.push(q,r,x,p),g.push(C-A,F-B),g.push(q,r,x,p),h++):(g.push(K,D),g.push(q,r,x,p),g.push(C-(K-C),F-(D-F)),g.push(q,r,x,p)))}y=e[2*(f-2)];E=e[2*(f-2)+1];C=e[2*(f-
1)];F=e[2*(f-1)+1];A=-(E-F);B=y-C;D=Math.sqrt(A*A+B*B);A=A/D*n;B=B/D*n;g.push(C-A,F-B);g.push(q,r,x,p);g.push(C+A,F+B);g.push(q,r,x,p);k.push(l);for(c=0;c<h;c++)k.push(l++);k.push(l-1)}};PIXI.WebGLGraphics.buildComplexPoly=function(a,c){var b=a.points.slice();if(!(6>b.length)){var e=c.indices;c.points=b;c.alpha=a.fillAlpha;c.color=PIXI.hex2rgb(a.fillColor);for(var k=Infinity,f=-Infinity,g=Infinity,h=-Infinity,l,n,p=0;p<b.length;p+=2)l=b[p],n=b[p+1],k=l<k?l:k,f=l>f?l:f,g=n<g?n:g,h=n>h?n:h;b.push(k,
g,f,g,f,h,k,h);b=b.length/2;for(p=0;p<b;p++)e.push(p)}};PIXI.WebGLGraphics.buildPoly=function(a,c){var b=a.points;if(!(6>b.length)){var e=c.points,k=c.indices,f=b.length/2,g=PIXI.hex2rgb(a.fillColor),h=a.fillAlpha,l=g[0]*h,n=g[1]*h;g=g[2]*h;var p=PIXI.EarCut.Triangulate(b,null,2);if(!p)return!1;var q=e.length/6,r;for(r=0;r<p.length;r+=3)k.push(p[r]+q),k.push(p[r]+q),k.push(p[r+1]+q),k.push(p[r+2]+q),k.push(p[r+2]+q);for(r=0;r<f;r++)e.push(b[2*r],b[2*r+1],l,n,g,h);return!0}};PIXI.WebGLGraphics.graphicsDataPool=
[];PIXI.WebGLGraphicsData=function(a){this.gl=a;this.color=[0,0,0];this.points=[];this.indices=[];this.buffer=a.createBuffer();this.indexBuffer=a.createBuffer();this.alpha=this.mode=1;this.dirty=!0};PIXI.WebGLGraphicsData.prototype.reset=function(){this.points=[];this.indices=[]};PIXI.WebGLGraphicsData.prototype.upload=function(){var a=this.gl;this.glPoints=new PIXI.Float32Array(this.points);a.bindBuffer(a.ARRAY_BUFFER,this.buffer);a.bufferData(a.ARRAY_BUFFER,this.glPoints,a.STATIC_DRAW);this.glIndicies=
new PIXI.Uint16Array(this.indices);a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,this.indexBuffer);a.bufferData(a.ELEMENT_ARRAY_BUFFER,this.glIndicies,a.STATIC_DRAW);this.dirty=!1};PIXI.CanvasGraphics=function(){};PIXI.CanvasGraphics.renderGraphics=function(a,b){var c=a.worldAlpha;a.dirty&&(this.updateGraphicsTint(a),a.dirty=!1);for(var e=0;e<a.graphicsData.length;e++){var k=a.graphicsData[e],f=k.shape,g=k._fillTint,h=k._lineTint;b.lineWidth=k.lineWidth;if(k.type===PIXI.Graphics.POLY){b.beginPath();var l=f.points;
b.moveTo(l[0],l[1]);for(var n=1;n<l.length/2;n++)b.lineTo(l[2*n],l[2*n+1]);f.closed&&b.lineTo(l[0],l[1]);l[0]===l[l.length-2]&&l[1]===l[l.length-1]&&b.closePath();k.fill&&(b.globalAlpha=k.fillAlpha*c,b.fillStyle="#"+("00000"+(g|0).toString(16)).substr(-6),b.fill());k.lineWidth&&(b.globalAlpha=k.lineAlpha*c,b.strokeStyle="#"+("00000"+(h|0).toString(16)).substr(-6),b.stroke())}else if(k.type===PIXI.Graphics.RECT){if(k.fillColor||0===k.fillColor)b.globalAlpha=k.fillAlpha*c,b.fillStyle="#"+("00000"+(g|
0).toString(16)).substr(-6),b.fillRect(f.x,f.y,f.width,f.height);k.lineWidth&&(b.globalAlpha=k.lineAlpha*c,b.strokeStyle="#"+("00000"+(h|0).toString(16)).substr(-6),b.strokeRect(f.x,f.y,f.width,f.height))}else if(k.type===PIXI.Graphics.CIRC)b.beginPath(),b.arc(f.x,f.y,f.radius,0,2*Math.PI),b.closePath(),k.fill&&(b.globalAlpha=k.fillAlpha*c,b.fillStyle="#"+("00000"+(g|0).toString(16)).substr(-6),b.fill()),k.lineWidth&&(b.globalAlpha=k.lineAlpha*c,b.strokeStyle="#"+("00000"+(h|0).toString(16)).substr(-6),
b.stroke());else if(k.type===PIXI.Graphics.ELIP){var p=2*f.width;n=2*f.height;l=f.x-p/2;f=f.y-n/2;b.beginPath();var q=p/2*.5522848,r=n/2*.5522848,x=l+p,y=f+n;p=l+p/2;n=f+n/2;b.moveTo(l,n);b.bezierCurveTo(l,n-r,p-q,f,p,f);b.bezierCurveTo(p+q,f,x,n-r,x,n);b.bezierCurveTo(x,n+r,p+q,y,p,y);b.bezierCurveTo(p-q,y,l,n+r,l,n);b.closePath();k.fill&&(b.globalAlpha=k.fillAlpha*c,b.fillStyle="#"+("00000"+(g|0).toString(16)).substr(-6),b.fill());k.lineWidth&&(b.globalAlpha=k.lineAlpha*c,b.strokeStyle="#"+("00000"+
(h|0).toString(16)).substr(-6),b.stroke())}else if(k.type===PIXI.Graphics.RREC){l=f.x;n=f.y;q=f.width;r=f.height;f=f.radius;x=Math.min(q,r)/2|0;f=f>x?x:f;b.beginPath();b.moveTo(l,n+f);b.lineTo(l,n+r-f);b.quadraticCurveTo(l,n+r,l+f,n+r);b.lineTo(l+q-f,n+r);b.quadraticCurveTo(l+q,n+r,l+q,n+r-f);b.lineTo(l+q,n+f);b.quadraticCurveTo(l+q,n,l+q-f,n);b.lineTo(l+f,n);b.quadraticCurveTo(l,n,l,n+f);b.closePath();if(k.fillColor||0===k.fillColor)b.globalAlpha=k.fillAlpha*c,b.fillStyle="#"+("00000"+(g|0).toString(16)).substr(-6),
b.fill();k.lineWidth&&(b.globalAlpha=k.lineAlpha*c,b.strokeStyle="#"+("00000"+(h|0).toString(16)).substr(-6),b.stroke())}}};PIXI.CanvasGraphics.renderGraphicsMask=function(a,b){var c=a.graphicsData.length;if(0!==c){b.beginPath();for(var e=0;e<c;e++){var k=a.graphicsData[e],f=k.shape;if(k.type===PIXI.Graphics.POLY){k=f.points;b.moveTo(k[0],k[1]);for(var g=1;g<k.length/2;g++)b.lineTo(k[2*g],k[2*g+1]);k[0]===k[k.length-2]&&k[1]===k[k.length-1]&&b.closePath()}else if(k.type===PIXI.Graphics.RECT)b.rect(f.x,
f.y,f.width,f.height),b.closePath();else if(k.type===PIXI.Graphics.CIRC)b.arc(f.x,f.y,f.radius,0,2*Math.PI),b.closePath();else if(k.type===PIXI.Graphics.ELIP){var h=2*f.width;g=2*f.height;k=f.x-h/2;f=f.y-g/2;var l=h/2*.5522848,n=g/2*.5522848,p=k+h,q=f+g;h=k+h/2;g=f+g/2;b.moveTo(k,g);b.bezierCurveTo(k,g-n,h-l,f,h,f);b.bezierCurveTo(h+l,f,p,g-n,p,g);b.bezierCurveTo(p,g+n,h+l,q,h,q);b.bezierCurveTo(h-l,q,k,g+n,k,g);b.closePath()}else k.type===PIXI.Graphics.RREC&&(k=f.x,g=f.y,l=f.width,n=f.height,f=f.radius,
p=Math.min(l,n)/2|0,f=f>p?p:f,b.moveTo(k,g+f),b.lineTo(k,g+n-f),b.quadraticCurveTo(k,g+n,k+f,g+n),b.lineTo(k+l-f,g+n),b.quadraticCurveTo(k+l,g+n,k+l,g+n-f),b.lineTo(k+l,g+f),b.quadraticCurveTo(k+l,g,k+l-f,g),b.lineTo(k+f,g),b.quadraticCurveTo(k,g,k,g+f),b.closePath())}}};PIXI.CanvasGraphics.updateGraphicsTint=function(a){if(16777215!==a.tint)for(var b=(a.tint>>16&255)/255,d=(a.tint>>8&255)/255,e=(a.tint&255)/255,f=0;f<a.graphicsData.length;f++){var g=a.graphicsData[f],h=g.fillColor|0,l=g.lineColor|
0;g._fillTint=((h>>16&255)/255*b*255<<16)+((h>>8&255)/255*d*255<<8)+(h&255)/255*e*255;g._lineTint=((l>>16&255)/255*b*255<<16)+((l>>8&255)/255*d*255<<8)+(l&255)/255*e*255}};b.Graphics=function(a,c,d){void 0===c&&(c=0);void 0===d&&(d=0);this.type=b.GRAPHICS;this.physicsType=b.SPRITE;this.anchor=new b.Point;PIXI.Graphics.call(this);b.Component.Core.init.call(this,a,c,d,"",null)};b.Graphics.prototype=Object.create(PIXI.Graphics.prototype);b.Graphics.prototype.constructor=b.Graphics;b.Component.Core.install.call(b.Graphics.prototype,
"Angle AutoCull Bounds Destroy FixedToCamera InputEnabled InWorld LifeSpan PhysicsBody Reset".split(" "));b.Graphics.prototype.preUpdatePhysics=b.Component.PhysicsBody.preUpdate;b.Graphics.prototype.preUpdateLifeSpan=b.Component.LifeSpan.preUpdate;b.Graphics.prototype.preUpdateInWorld=b.Component.InWorld.preUpdate;b.Graphics.prototype.preUpdateCore=b.Component.Core.preUpdate;b.Graphics.prototype.preUpdate=function(){return this.preUpdatePhysics()&&this.preUpdateLifeSpan()&&this.preUpdateInWorld()?
this.preUpdateCore():!1};b.Graphics.prototype.postUpdate=function(){b.Component.PhysicsBody.postUpdate.call(this);b.Component.FixedToCamera.postUpdate.call(this);this._boundsDirty&&(this.updateLocalBounds(),this._boundsDirty=!1);for(var a=0;a<this.children.length;a++)this.children[a].postUpdate()};b.Graphics.prototype.destroy=function(a){this.clear();b.Component.Destroy.prototype.destroy.call(this,a)};b.Graphics.prototype.drawTriangle=function(a,c){void 0===c&&(c=!1);var d=new b.Polygon(a);if(c){var e=
new b.Point(this.game.camera.x-a[0].x,this.game.camera.y-a[0].y),f=new b.Point(a[1].x-a[0].x,a[1].y-a[0].y);f=(new b.Point(a[1].x-a[2].x,a[1].y-a[2].y)).cross(f);0<e.dot(f)&&this.drawPolygon(d)}else this.drawPolygon(d)};b.Graphics.prototype.drawTriangles=function(a,c,d){void 0===d&&(d=!1);var e=new b.Point,f=new b.Point,g=new b.Point,h=[],l;if(c)if(a[0]instanceof b.Point)for(l=0;l<c.length/3;l++)h.push(a[c[3*l]]),h.push(a[c[3*l+1]]),h.push(a[c[3*l+2]]),3===h.length&&(this.drawTriangle(h,d),h=[]);
else for(l=0;l<c.length;l++)e.x=a[2*c[l]],e.y=a[2*c[l]+1],h.push(e.copyTo({})),3===h.length&&(this.drawTriangle(h,d),h=[]);else if(a[0]instanceof b.Point)for(l=0;l<a.length/3;l++)this.drawTriangle([a[3*l],a[3*l+1],a[3*l+2]],d);else for(l=0;l<a.length/6;l++)e.x=a[6*l],e.y=a[6*l+1],f.x=a[6*l+2],f.y=a[6*l+3],g.x=a[6*l+4],g.y=a[6*l+5],this.drawTriangle([e,f,g],d)};b.RenderTexture=function(a,c,d,e,f,g){void 0===e&&(e="");void 0===f&&(f=b.scaleModes.DEFAULT);void 0===g&&(g=1);this.game=a;this.key=e;this.type=
b.RENDERTEXTURE;this._tempMatrix=new PIXI.Matrix;PIXI.RenderTexture.call(this,c,d,this.game.renderer,f,g);this.render=b.RenderTexture.prototype.render};b.RenderTexture.prototype=Object.create(PIXI.RenderTexture.prototype);b.RenderTexture.prototype.constructor=b.RenderTexture;b.RenderTexture.prototype.renderXY=function(a,b,d,e){a.updateTransform();this._tempMatrix.copyFrom(a.worldTransform);this._tempMatrix.tx=b;this._tempMatrix.ty=d;this.renderer.type===PIXI.WEBGL_RENDERER?this.renderWebGL(a,this._tempMatrix,
e):this.renderCanvas(a,this._tempMatrix,e)};b.RenderTexture.prototype.renderRawXY=function(a,b,d,e){this._tempMatrix.identity().translate(b,d);this.renderer.type===PIXI.WEBGL_RENDERER?this.renderWebGL(a,this._tempMatrix,e):this.renderCanvas(a,this._tempMatrix,e)};b.RenderTexture.prototype.render=function(a,b,d){void 0===b||null===b?this._tempMatrix.copyFrom(a.worldTransform):this._tempMatrix.copyFrom(b);this.renderer.type===PIXI.WEBGL_RENDERER?this.renderWebGL(a,this._tempMatrix,d):this.renderCanvas(a,
this._tempMatrix,d)};b.Text=function(a,c,d,e,f){c=c||0;d=d||0;e=void 0===e||null===e?"":e.toString();f=b.Utils.extend({},f);this.type=b.TEXT;this.physicsType=b.SPRITE;this.padding=new b.Point;this.textBounds=null;this.canvas=PIXI.CanvasPool.create(this);this.context=this.canvas.getContext("2d");this.colors=[];this.strokeColors=[];this.fontStyles=[];this.fontWeights=[];this.useAdvancedWrap=this.autoRound=!1;this._res=a.renderer.resolution;this._text=e;this._fontComponents=null;this._height=this._width=
this._charCount=this._lineSpacing=0;b.Sprite.call(this,a,c,d,PIXI.Texture.fromCanvas(this.canvas));this.setStyle(f);""!==e&&this.updateText()};b.Text.prototype=Object.create(b.Sprite.prototype);b.Text.prototype.constructor=b.Text;b.Text.prototype.preUpdate=function(){return this.preUpdatePhysics()&&this.preUpdateLifeSpan()&&this.preUpdateInWorld()?this.preUpdateCore():!1};b.Text.prototype.update=function(){};b.Text.prototype.destroy=function(a){this.texture.destroy(!0);b.Component.Destroy.prototype.destroy.call(this,
a)};b.Text.prototype.setShadow=function(a,b,d,e,f,g){void 0===a&&(a=0);void 0===b&&(b=0);void 0===d&&(d="rgba(0, 0, 0, 1)");void 0===e&&(e=0);void 0===f&&(f=!0);void 0===g&&(g=!0);this.style.shadowOffsetX=a;this.style.shadowOffsetY=b;this.style.shadowColor=d;this.style.shadowBlur=e;this.style.shadowStroke=f;this.style.shadowFill=g;this.dirty=!0;return this};b.Text.prototype.setStyle=function(a,b){void 0===b&&(b=!1);a=a||{};a.font=a.font||"bold 20pt Arial";a.backgroundColor=a.backgroundColor||null;
a.fill=a.fill||"black";a.align=a.align||"left";a.boundsAlignH=a.boundsAlignH||"left";a.boundsAlignV=a.boundsAlignV||"top";a.stroke=a.stroke||"black";a.strokeThickness=a.strokeThickness||0;a.wordWrap=a.wordWrap||!1;a.wordWrapWidth=a.wordWrapWidth||100;a.maxLines=a.maxLines||0;a.shadowOffsetX=a.shadowOffsetX||0;a.shadowOffsetY=a.shadowOffsetY||0;a.shadowColor=a.shadowColor||"rgba(0,0,0,0)";a.shadowBlur=a.shadowBlur||0;a.tabs=a.tabs||0;var c=this.fontToComponents(a.font);a.fontStyle&&(c.fontStyle=a.fontStyle);
a.fontVariant&&(c.fontVariant=a.fontVariant);a.fontWeight&&(c.fontWeight=a.fontWeight);a.fontSize&&("number"===typeof a.fontSize&&(a.fontSize+="px"),c.fontSize=a.fontSize);this._fontComponents=c;a.font=this.componentsToFont(this._fontComponents);this.style=a;this.dirty=!0;b&&this.updateText();return this};b.Text.prototype.updateText=function(){this.texture.baseTexture.resolution=this._res;this.context.font=this.style.font;var a=this.text;this.style.wordWrap&&(a=this.runWordWrap(this.text));a=a.split(/(?:\r\n|\r|\n)/);
var b=this.style.tabs,d=[],e=0,f=this.determineFontProperties(this.style.font),g=a.length;0<this.style.maxLines&&this.style.maxLines<a.length&&(g=this.style.maxLines);for(var h=this._charCount=0;h<g;h++){if(0===b){var l=this.style.strokeThickness+this.padding.x;l=0<this.colors.length||0<this.strokeColors.length||0<this.fontWeights.length||0<this.fontStyles.length?l+this.measureLine(a[h]):l+this.context.measureText(a[h]).width;this.style.wordWrap&&(l-=this.context.measureText(" ").width)}else{var n=
a[h].split(/(?:\t)/);l=this.padding.x+this.style.strokeThickness;if(Array.isArray(b))for(var p=0,w=0;w<n.length;w++)l=0<this.colors.length||0<this.strokeColors.length||0<this.fontWeights.length||0<this.fontStyles.length?this.measureLine(n[w]):Math.ceil(this.context.measureText(n[w]).width),0<w&&(p+=b[w-1]),l=p+l;else for(w=0;w<n.length;w++)l=0<this.colors.length||0<this.strokeColors.length||0<this.fontWeights.length||0<this.fontStyles.length?l+this.measureLine(n[w]):l+Math.ceil(this.context.measureText(n[w]).width),
p=this.game.math.snapToCeil(l,b)-l,l+=p}d[h]=Math.ceil(l);e=Math.max(e,d[h])}this.canvas.width=e*this._res;n=f.fontSize+this.style.strokeThickness+this.padding.y;h=n*g;w=this._lineSpacing;0>w&&Math.abs(w)>n&&(w=-n);0!==w&&(h+=0<w?w*a.length:w*(a.length-1));this.canvas.height=h*this._res;this.context.scale(this._res,this._res);navigator.isCocoonJS&&this.context.clearRect(0,0,this.canvas.width,this.canvas.height);this.style.backgroundColor&&(this.context.fillStyle=this.style.backgroundColor,this.context.fillRect(0,
0,this.canvas.width,this.canvas.height));this.context.fillStyle=this.style.fill;this.context.font=this.style.font;this.context.strokeStyle=this.style.stroke;this.context.textBaseline="alphabetic";this.context.lineWidth=this.style.strokeThickness;this.context.lineCap="round";this.context.lineJoin="round";for(h=this._charCount=0;h<g;h++)l=this.style.strokeThickness/2,p=this.style.strokeThickness/2+h*n+f.ascent,0<h&&(p+=w*h),"right"===this.style.align?l+=e-d[h]:"center"===this.style.align&&(l+=(e-d[h])/
2),this.autoRound&&(l=Math.round(l),p=Math.round(p)),0<this.colors.length||0<this.strokeColors.length||0<this.fontWeights.length||0<this.fontStyles.length?this.updateLine(a[h],l,p):(this.style.stroke&&this.style.strokeThickness&&(this.updateShadow(this.style.shadowStroke),0===b?this.context.strokeText(a[h],l,p):this.renderTabLine(a[h],l,p,!1)),this.style.fill&&(this.updateShadow(this.style.shadowFill),0===b?this.context.fillText(a[h],l,p):this.renderTabLine(a[h],l,p,!0)));this.updateTexture();this.dirty=
!1};b.Text.prototype.renderTabLine=function(a,b,d,e){a=a.split(/(?:\t)/);var c=this.style.tabs;if(Array.isArray(c))for(var f=0,g=0;g<a.length;g++){0<g&&(f+=c[g-1]);var h=b+f;e?this.context.fillText(a[g],h,d):this.context.strokeText(a[g],h,d)}else for(g=0;g<a.length;g++)f=Math.ceil(this.context.measureText(a[g]).width),h=this.game.math.snapToCeil(b,c),e?this.context.fillText(a[g],h,d):this.context.strokeText(a[g],h,d),b=h+f};b.Text.prototype.updateShadow=function(a){a?(this.context.shadowOffsetX=this.style.shadowOffsetX,
this.context.shadowOffsetY=this.style.shadowOffsetY,this.context.shadowColor=this.style.shadowColor,this.context.shadowBlur=this.style.shadowBlur):(this.context.shadowOffsetX=0,this.context.shadowOffsetY=0,this.context.shadowColor=0,this.context.shadowBlur=0)};b.Text.prototype.measureLine=function(a){for(var b=0,d=0;d<a.length;d++){var e=a[d];if(0<this.fontWeights.length||0<this.fontStyles.length){var f=this.fontToComponents(this.context.font);this.fontStyles[this._charCount]&&(f.fontStyle=this.fontStyles[this._charCount]);
this.fontWeights[this._charCount]&&(f.fontWeight=this.fontWeights[this._charCount]);this.context.font=this.componentsToFont(f)}this.style.stroke&&this.style.strokeThickness&&(this.strokeColors[this._charCount]&&(this.context.strokeStyle=this.strokeColors[this._charCount]),this.updateShadow(this.style.shadowStroke));this.style.fill&&(this.colors[this._charCount]&&(this.context.fillStyle=this.colors[this._charCount]),this.updateShadow(this.style.shadowFill));b+=this.context.measureText(e).width;this._charCount++}return Math.ceil(b)};
b.Text.prototype.updateLine=function(a,b,d){for(var c=0;c<a.length;c++){var f=a[c];if(0<this.fontWeights.length||0<this.fontStyles.length){var g=this.fontToComponents(this.context.font);this.fontStyles[this._charCount]&&(g.fontStyle=this.fontStyles[this._charCount]);this.fontWeights[this._charCount]&&(g.fontWeight=this.fontWeights[this._charCount]);this.context.font=this.componentsToFont(g)}this.style.stroke&&this.style.strokeThickness&&(this.strokeColors[this._charCount]&&(this.context.strokeStyle=
this.strokeColors[this._charCount]),this.updateShadow(this.style.shadowStroke),this.context.strokeText(f,b,d));this.style.fill&&(this.colors[this._charCount]&&(this.context.fillStyle=this.colors[this._charCount]),this.updateShadow(this.style.shadowFill),this.context.fillText(f,b,d));b+=this.context.measureText(f).width;this._charCount++}};b.Text.prototype.clearColors=function(){this.colors=[];this.strokeColors=[];this.dirty=!0;return this};b.Text.prototype.clearFontValues=function(){this.fontStyles=
[];this.fontWeights=[];this.dirty=!0;return this};b.Text.prototype.addColor=function(a,b){this.colors[b]=a;this.dirty=!0;return this};b.Text.prototype.addStrokeColor=function(a,b){this.strokeColors[b]=a;this.dirty=!0;return this};b.Text.prototype.addFontStyle=function(a,b){this.fontStyles[b]=a;this.dirty=!0;return this};b.Text.prototype.addFontWeight=function(a,b){this.fontWeights[b]=a;this.dirty=!0;return this};b.Text.prototype.precalculateWordWrap=function(a){this.texture.baseTexture.resolution=
this._res;this.context.font=this.style.font;return this.runWordWrap(a).split(/(?:\r\n|\r|\n)/)};b.Text.prototype.runWordWrap=function(a){return this.useAdvancedWrap?this.advancedWordWrap(a):this.basicWordWrap(a)};b.Text.prototype.advancedWordWrap=function(a){var b=this.context,d=this.style.wordWrapWidth,e="";a=a.replace(/ +/gi," ").split(/\r?\n/gi);for(var f=a.length,g=0;g<f;g++){var h=a[g],l="";h=h.replace(/^ *|\s*$/gi,"");if(b.measureText(h).width<d)e+=h+"\n";else{var n=d;h=h.split(" ");for(var p=
0;p<h.length;p++){var w=h[p],q=w+" ",r=b.measureText(q).width;if(r>n){if(0===p){for(f=q;f.length&&!(f=f.slice(0,-1),r=b.measureText(f).width,r<=n););if(!f.length)throw Error("This text's wordWrapWidth setting is less than a single character!");n=w.substr(f.length);h[p]=n;l+=f}n=h.slice(h[p].length?p:p+1).join(" ").replace(/[ \n]*$/gi,"");a[g+1]=n+" "+(a[g+1]||"");f=a.length;break}else l+=q,n-=r}e+=l.replace(/[ \n]*$/gi,"")+"\n"}}return e=e.replace(/[\s|\n]*$/gi,"")};b.Text.prototype.basicWordWrap=
function(a){var b="";a=a.split("\n");for(var d=0;d<a.length;d++){for(var e=this.style.wordWrapWidth,f=a[d].split(" "),g=0;g<f.length;g++){var h=this.context.measureText(f[g]).width,l=h+this.context.measureText(" ").width;l>e?(0<g&&(b+="\n"),b+=f[g]+" ",e=this.style.wordWrapWidth-h):(e-=l,b+=f[g]+" ")}d<a.length-1&&(b+="\n")}return b};b.Text.prototype.updateFont=function(a){a=this.componentsToFont(a);this.style.font!==a&&(this.style.font=a,this.dirty=!0,this.parent&&this.updateTransform())};b.Text.prototype.fontToComponents=
function(a){var b=a.match(/^\s*(?:\b(normal|italic|oblique|inherit)?\b)\s*(?:\b(normal|small-caps|inherit)?\b)\s*(?:\b(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900|inherit)?\b)\s*(?:\b(xx-small|x-small|small|medium|large|x-large|xx-large|larger|smaller|0|\d*(?:[.]\d*)?(?:%|[a-z]{2,5}))?\b)\s*(.*)\s*$/);if(b){var d=b[5].trim();/^(?:inherit|serif|sans-serif|cursive|fantasy|monospace)$/.exec(d)||/['",]/.exec(d)||(d="'"+d+"'");return{font:a,fontStyle:b[1]||"normal",fontVariant:b[2]||
"normal",fontWeight:b[3]||"normal",fontSize:b[4]||"medium",fontFamily:d}}console.warn("Phaser.Text - unparsable CSS font: "+a);return{font:a}};b.Text.prototype.componentsToFont=function(a){var b=[],d;(d=a.fontStyle)&&"normal"!==d&&b.push(d);(d=a.fontVariant)&&"normal"!==d&&b.push(d);(d=a.fontWeight)&&"normal"!==d&&b.push(d);(d=a.fontSize)&&"medium"!==d&&b.push(d);(d=a.fontFamily)&&b.push(d);b.length||b.push(a.font);return b.join(" ")};b.Text.prototype.setText=function(a,b){void 0===b&&(b=!1);this.text=
a.toString()||"";b?this.updateText():this.dirty=!0;return this};b.Text.prototype.parseList=function(a){if(Array.isArray(a))for(var b="",d=0;d<a.length;d++)Array.isArray(a[d])?(b+=a[d].join("\t"),d<a.length-1&&(b+="\n")):(b+=a[d],d<a.length-1&&(b+="\t"));else return this;this.text=b;this.dirty=!0;return this};b.Text.prototype.setTextBounds=function(a,c,d,e){void 0===a?this.textBounds=null:(this.textBounds?this.textBounds.setTo(a,c,d,e):this.textBounds=new b.Rectangle(a,c,d,e),this.style.wordWrapWidth>
d&&(this.style.wordWrapWidth=d));this.updateTexture();return this};b.Text.prototype.updateTexture=function(){var a=this.texture.baseTexture,b=this.texture.crop,d=this.texture.frame,e=this.canvas.width,f=this.canvas.height;a.width=e;a.height=f;b.width=e;b.height=f;d.width=e;d.height=f;this.texture.width=e;this.texture.height=f;this._width=e;this._height=f;this.textBounds&&(a=this.textBounds.x,b=this.textBounds.y,"right"===this.style.boundsAlignH?a+=this.textBounds.width-this.canvas.width/this.resolution:
"center"===this.style.boundsAlignH&&(a+=this.textBounds.halfWidth-this.canvas.width/this.resolution/2),"bottom"===this.style.boundsAlignV?b+=this.textBounds.height-this.canvas.height/this.resolution:"middle"===this.style.boundsAlignV&&(b+=this.textBounds.halfHeight-this.canvas.height/this.resolution/2),this.pivot.x=-a,this.pivot.y=-b);this.renderable=0!==e&&0!==f;this.texture.requiresReTint=!0;this.texture.baseTexture.dirty()};b.Text.prototype._renderWebGL=function(a){this.dirty&&(this.updateText(),
this.dirty=!1);PIXI.Sprite.prototype._renderWebGL.call(this,a)};b.Text.prototype._renderCanvas=function(a){this.dirty&&(this.updateText(),this.dirty=!1);PIXI.Sprite.prototype._renderCanvas.call(this,a)};b.Text.prototype.determineFontProperties=function(a){var c=b.Text.fontPropertiesCache[a];if(!c){c={};var d=b.Text.fontPropertiesCanvas,e=b.Text.fontPropertiesContext;e.font=a;var f=Math.ceil(e.measureText("|M\u00c9q").width),g=Math.ceil(e.measureText("|M\u00c9q").width),h=2*g;g=1.4*g|0;d.width=f;d.height=
h;e.fillStyle="#f00";e.fillRect(0,0,f,h);e.font=a;e.textBaseline="alphabetic";e.fillStyle="#000";e.fillText("|M\u00c9q",0,g);if(!e.getImageData(0,0,f,h))return c.ascent=g,c.descent=g+6,c.fontSize=c.ascent+c.descent,b.Text.fontPropertiesCache[a]=c;d=e.getImageData(0,0,f,h).data;e=d.length;f*=4;var l,n,p=0,w=!1;for(l=0;l<g;l++){for(n=0;n<f;n+=4)if(255!==d[p+n]){w=!0;break}if(w)break;else p+=f}c.ascent=g-l;p=e-f;w=!1;for(l=h;l>g;l--){for(n=0;n<f;n+=4)if(255!==d[p+n]){w=!0;break}if(w)break;else p-=f}c.descent=
l-g;c.descent+=6;c.fontSize=c.ascent+c.descent;b.Text.fontPropertiesCache[a]=c}return c};b.Text.prototype.getBounds=function(a){this.dirty&&(this.updateText(),this.dirty=!1);return PIXI.Sprite.prototype.getBounds.call(this,a)};Object.defineProperty(b.Text.prototype,"text",{get:function(){return this._text},set:function(a){a!==this._text&&(this._text=a.toString()||"",this.dirty=!0,this.parent&&this.updateTransform())}});Object.defineProperty(b.Text.prototype,"cssFont",{get:function(){return this.componentsToFont(this._fontComponents)},
set:function(a){this._fontComponents=this.fontToComponents(a||"bold 20pt Arial");this.updateFont(this._fontComponents)}});Object.defineProperty(b.Text.prototype,"font",{get:function(){return this._fontComponents.fontFamily},set:function(a){a=(a||"Arial").trim();/^(?:inherit|serif|sans-serif|cursive|fantasy|monospace)$/.exec(a)||/['",]/.exec(a)||(a="'"+a+"'");this._fontComponents.fontFamily=a;this.updateFont(this._fontComponents)}});Object.defineProperty(b.Text.prototype,"fontSize",{get:function(){var a=
this._fontComponents.fontSize;return a&&/(?:^0$|px$)/.exec(a)?parseInt(a,10):a},set:function(a){a=a||"0";"number"===typeof a&&(a+="px");this._fontComponents.fontSize=a;this.updateFont(this._fontComponents)}});Object.defineProperty(b.Text.prototype,"fontWeight",{get:function(){return this._fontComponents.fontWeight||"normal"},set:function(a){this._fontComponents.fontWeight=a||"normal";this.updateFont(this._fontComponents)}});Object.defineProperty(b.Text.prototype,"fontStyle",{get:function(){return this._fontComponents.fontStyle||
"normal"},set:function(a){this._fontComponents.fontStyle=a||"normal";this.updateFont(this._fontComponents)}});Object.defineProperty(b.Text.prototype,"fontVariant",{get:function(){return this._fontComponents.fontVariant||"normal"},set:function(a){this._fontComponents.fontVariant=a||"normal";this.updateFont(this._fontComponents)}});Object.defineProperty(b.Text.prototype,"fill",{get:function(){return this.style.fill},set:function(a){a!==this.style.fill&&(this.style.fill=a,this.dirty=!0)}});Object.defineProperty(b.Text.prototype,
"align",{get:function(){return this.style.align},set:function(a){a!==this.style.align&&(this.style.align=a,this.dirty=!0)}});Object.defineProperty(b.Text.prototype,"resolution",{get:function(){return this._res},set:function(a){a!==this._res&&(this._res=a,this.dirty=!0)}});Object.defineProperty(b.Text.prototype,"tabs",{get:function(){return this.style.tabs},set:function(a){a!==this.style.tabs&&(this.style.tabs=a,this.dirty=!0)}});Object.defineProperty(b.Text.prototype,"boundsAlignH",{get:function(){return this.style.boundsAlignH},
set:function(a){a!==this.style.boundsAlignH&&(this.style.boundsAlignH=a,this.dirty=!0)}});Object.defineProperty(b.Text.prototype,"boundsAlignV",{get:function(){return this.style.boundsAlignV},set:function(a){a!==this.style.boundsAlignV&&(this.style.boundsAlignV=a,this.dirty=!0)}});Object.defineProperty(b.Text.prototype,"stroke",{get:function(){return this.style.stroke},set:function(a){a!==this.style.stroke&&(this.style.stroke=a,this.dirty=!0)}});Object.defineProperty(b.Text.prototype,"strokeThickness",
{get:function(){return this.style.strokeThickness},set:function(a){a!==this.style.strokeThickness&&(this.style.strokeThickness=a,this.dirty=!0)}});Object.defineProperty(b.Text.prototype,"wordWrap",{get:function(){return this.style.wordWrap},set:function(a){a!==this.style.wordWrap&&(this.style.wordWrap=a,this.dirty=!0)}});Object.defineProperty(b.Text.prototype,"wordWrapWidth",{get:function(){return this.style.wordWrapWidth},set:function(a){a!==this.style.wordWrapWidth&&(this.style.wordWrapWidth=a,
this.dirty=!0)}});Object.defineProperty(b.Text.prototype,"lineSpacing",{get:function(){return this._lineSpacing},set:function(a){a!==this._lineSpacing&&(this._lineSpacing=parseFloat(a),this.dirty=!0,this.parent&&this.updateTransform())}});Object.defineProperty(b.Text.prototype,"shadowOffsetX",{get:function(){return this.style.shadowOffsetX},set:function(a){a!==this.style.shadowOffsetX&&(this.style.shadowOffsetX=a,this.dirty=!0)}});Object.defineProperty(b.Text.prototype,"shadowOffsetY",{get:function(){return this.style.shadowOffsetY},
set:function(a){a!==this.style.shadowOffsetY&&(this.style.shadowOffsetY=a,this.dirty=!0)}});Object.defineProperty(b.Text.prototype,"shadowColor",{get:function(){return this.style.shadowColor},set:function(a){a!==this.style.shadowColor&&(this.style.shadowColor=a,this.dirty=!0)}});Object.defineProperty(b.Text.prototype,"shadowBlur",{get:function(){return this.style.shadowBlur},set:function(a){a!==this.style.shadowBlur&&(this.style.shadowBlur=a,this.dirty=!0)}});Object.defineProperty(b.Text.prototype,
"shadowStroke",{get:function(){return this.style.shadowStroke},set:function(a){a!==this.style.shadowStroke&&(this.style.shadowStroke=a,this.dirty=!0)}});Object.defineProperty(b.Text.prototype,"shadowFill",{get:function(){return this.style.shadowFill},set:function(a){a!==this.style.shadowFill&&(this.style.shadowFill=a,this.dirty=!0)}});Object.defineProperty(b.Text.prototype,"width",{get:function(){this.dirty&&(this.updateText(),this.dirty=!1);return this.scale.x*this.texture.frame.width},set:function(a){this.scale.x=
a/this.texture.frame.width;this._width=a}});Object.defineProperty(b.Text.prototype,"height",{get:function(){this.dirty&&(this.updateText(),this.dirty=!1);return this.scale.y*this.texture.frame.height},set:function(a){this.scale.y=a/this.texture.frame.height;this._height=a}});b.Text.fontPropertiesCache={};b.Text.fontPropertiesCanvas=document.createElement("canvas");b.Text.fontPropertiesContext=b.Text.fontPropertiesCanvas.getContext("2d");b.BitmapText=function(a,c,d,e,f,g,h){c=c||0;d=d||0;e=e||"";f=
f||"";g=g||32;h=h||"left";PIXI.DisplayObjectContainer.call(this);this.type=b.BITMAPTEXT;this.physicsType=b.SPRITE;this.textHeight=this.textWidth=0;this.anchor=new b.Point;this._prevAnchor=new b.Point;this._glyphs=[];this._maxWidth=0;this._text=f.toString()||"";this._data=a.cache.getBitmapFont(e);this._font=e;this._fontSize=g;this._align=h;this._tint=16777215;this.updateText();this.dirty=!1;b.Component.Core.init.call(this,a,c,d,"",null)};b.BitmapText.prototype=Object.create(PIXI.DisplayObjectContainer.prototype);
b.BitmapText.prototype.constructor=b.BitmapText;b.Component.Core.install.call(b.BitmapText.prototype,"Angle AutoCull Bounds Destroy FixedToCamera InputEnabled InWorld LifeSpan PhysicsBody Reset".split(" "));b.BitmapText.prototype.preUpdatePhysics=b.Component.PhysicsBody.preUpdate;b.BitmapText.prototype.preUpdateLifeSpan=b.Component.LifeSpan.preUpdate;b.BitmapText.prototype.preUpdateInWorld=b.Component.InWorld.preUpdate;b.BitmapText.prototype.preUpdateCore=b.Component.Core.preUpdate;b.BitmapText.prototype.preUpdate=
function(){return this.preUpdatePhysics()&&this.preUpdateLifeSpan()&&this.preUpdateInWorld()?this.preUpdateCore():!1};b.BitmapText.prototype.postUpdate=function(){b.Component.PhysicsBody.postUpdate.call(this);b.Component.FixedToCamera.postUpdate.call(this);this.body&&this.body.type===b.Physics.ARCADE&&(this.textWidth!==this.body.sourceWidth||this.textHeight!==this.body.sourceHeight)&&this.body.setSize(this.textWidth,this.textHeight)};b.BitmapText.prototype.setText=function(a){this.text=a};b.BitmapText.prototype.scanLine=
function(a,b,d){for(var c=0,f=0,g=-1,h=0,l=null,n=0<this._maxWidth?this._maxWidth:null,p=[],w=0;w<d.length;w++){var q=w===d.length-1?!0:!1;if(/(?:\r\n|\r|\n)/.test(d.charAt(w)))return{width:f,text:d.substr(0,w),end:q,chars:p};var r=d.charCodeAt(w),x=a.chars[r];void 0===x&&(r=32,x=a.chars[r]);var y=l&&x.kerning[l]?x.kerning[l]:0;/(\s)/.test(d.charAt(w))&&(g=w,h=f);l=(y+x.texture.width+x.xOffset)*b;if(n&&f+l>=n&&-1<g)return{width:h||f,text:d.substr(0,w-(w-g)),end:q,chars:p};f+=(x.xAdvance+y)*b;p.push(c+
(x.xOffset+y)*b);c+=(x.xAdvance+y)*b;l=r}return{width:f,text:d,end:q,chars:p}};b.BitmapText.prototype.cleanText=function(a,b){void 0===b&&(b="");var c=this._data.font;if(!c)return"";for(var e=a.replace(/\r\n|\n\r|\n|\r/g,"\n").split("\n"),f=0;f<e.length;f++){for(var g="",h=e[f],l=0;l<h.length;l++)g=c.chars[h.charCodeAt(l)]?g.concat(h[l]):g.concat(b);e[f]=g}return e.join("\n")};b.BitmapText.prototype.updateText=function(){var a=this._data.font;if(a){var b=this.text,d=this._fontSize/a.size,e=[],f=0;
this.textWidth=0;do{var g=this.scanLine(a,d,b);g.y=f;e.push(g);g.width>this.textWidth&&(this.textWidth=g.width);f+=a.lineHeight*d;b=b.substr(g.text.length+1)}while(!1===g.end);this.textHeight=f;f=b=0;for(var h=this.textWidth*this.anchor.x,l=this.textHeight*this.anchor.y,n=0;n<e.length;n++){g=e[n];"right"===this._align?f=this.textWidth-g.width:"center"===this._align&&(f=(this.textWidth-g.width)/2);for(var p=0;p<g.text.length;p++){var w=g.text.charCodeAt(p);w=a.chars[w];void 0===w&&(w=32,w=a.chars[w]);
var q=this._glyphs[b];q?q.texture=w.texture:(q=new PIXI.Sprite(w.texture),q.name=g.text[p],this._glyphs.push(q));q.position.x=g.chars[p]+f-h;q.position.y=g.y+w.yOffset*d-l;q.scale.set(d);q.tint=this.tint;q.texture.requiresReTint=!0;q.parent||this.addChild(q);b++}}for(n=b;n<this._glyphs.length;n++)this.removeChild(this._glyphs[n])}};b.BitmapText.prototype.purgeGlyphs=function(){for(var a=this._glyphs.length,b=[],d=0;d<this._glyphs.length;d++)this._glyphs[d].parent!==this?this._glyphs[d].destroy():
b.push(this._glyphs[d]);this._glyphs=[];this._glyphs=b;this.updateText();return a-b.length};b.BitmapText.prototype.updateTransform=function(){if(this.dirty||!this.anchor.equals(this._prevAnchor))this.updateText(),this.dirty=!1,this._prevAnchor.copyFrom(this.anchor);PIXI.DisplayObjectContainer.prototype.updateTransform.call(this)};Object.defineProperty(b.BitmapText.prototype,"align",{get:function(){return this._align},set:function(a){a===this._align||"left"!==a&&"center"!==a&&"right"!==a||(this._align=
a,this.updateText())}});Object.defineProperty(b.BitmapText.prototype,"tint",{get:function(){return this._tint},set:function(a){a!==this._tint&&(this._tint=a,this.updateText())}});Object.defineProperty(b.BitmapText.prototype,"font",{get:function(){return this._font},set:function(a){a!==this._font&&(this._font=a.trim(),this._data=this.game.cache.getBitmapFont(this._font),this.updateText())}});Object.defineProperty(b.BitmapText.prototype,"fontSize",{get:function(){return this._fontSize},set:function(a){a=
parseInt(a,10);a!==this._fontSize&&0<a&&(this._fontSize=a,this.updateText())}});Object.defineProperty(b.BitmapText.prototype,"text",{get:function(){return this._text},set:function(a){a!==this._text&&(this._text=a.toString()||"",this.updateText())}});Object.defineProperty(b.BitmapText.prototype,"maxWidth",{get:function(){return this._maxWidth},set:function(a){a!==this._maxWidth&&(this._maxWidth=a,this.updateText())}});Object.defineProperty(b.BitmapText.prototype,"smoothed",{get:function(){return!this._data.base.scaleMode},
set:function(a){this._data.base.scaleMode=a?0:1}});b.RetroFont=function(a,c,d,e,f,g,h,l,n,p){if(!a.cache.checkImageKey(c))return!1;if(void 0===g||null===g)g=a.cache.getImage(c).width/d;this.characterWidth=d;this.characterHeight=e;this.characterSpacingX=h||0;this.characterSpacingY=l||0;this.characterPerRow=g;this.offsetX=n||0;this.offsetY=p||0;this.align="left";this.multiLine=!1;this.autoUpperCase=!0;this.fixedWidth=this.customSpacingY=this.customSpacingX=0;this.fontSet=a.cache.getImage(c);this._text=
"";this.grabData=[];this.frameData=new b.FrameData;d=this.offsetX;e=this.offsetY;for(h=g=0;h<f.length;h++)l=this.frameData.addFrame(new b.Frame(h,d,e,this.characterWidth,this.characterHeight)),this.grabData[f.charCodeAt(h)]=l.index,g++,g===this.characterPerRow?(g=0,d=this.offsetX,e+=this.characterHeight+this.characterSpacingY):d+=this.characterWidth+this.characterSpacingX;a.cache.updateFrameData(c,this.frameData);this.stamp=new b.Image(a,0,0,c,0);b.RenderTexture.call(this,a,100,100,"",b.scaleModes.NEAREST);
this.type=b.RETROFONT};b.RetroFont.prototype=Object.create(b.RenderTexture.prototype);b.RetroFont.prototype.constructor=b.RetroFont;b.RetroFont.ALIGN_LEFT="left";b.RetroFont.ALIGN_RIGHT="right";b.RetroFont.ALIGN_CENTER="center";b.RetroFont.TEXT_SET1=" !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~";b.RetroFont.TEXT_SET2=" !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ";b.RetroFont.TEXT_SET3="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789 ";b.RetroFont.TEXT_SET4=
"ABCDEFGHIJKLMNOPQRSTUVWXYZ 0123456789";b.RetroFont.TEXT_SET5="ABCDEFGHIJKLMNOPQRSTUVWXYZ.,/() '!?-*:0123456789";b.RetroFont.TEXT_SET6="ABCDEFGHIJKLMNOPQRSTUVWXYZ!?:;0123456789\"(),-.' ";b.RetroFont.TEXT_SET7="AGMSY+:4BHNTZ!;5CIOU.?06DJPV,(17EKQW\")28FLRX-'39";b.RetroFont.TEXT_SET8="0123456789 .ABCDEFGHIJKLMNOPQRSTUVWXYZ";b.RetroFont.TEXT_SET9="ABCDEFGHIJKLMNOPQRSTUVWXYZ()-0123456789.:,'\"?!";b.RetroFont.TEXT_SET10="ABCDEFGHIJKLMNOPQRSTUVWXYZ";b.RetroFont.TEXT_SET11="ABCDEFGHIJKLMNOPQRSTUVWXYZ.,\"-+!?()':;0123456789";
b.RetroFont.prototype.setFixedWidth=function(a,b){void 0===b&&(b="left");this.fixedWidth=a;this.align=b};b.RetroFont.prototype.setText=function(a,b,d,e,f,g){this.multiLine=b||!1;this.customSpacingX=d||0;this.customSpacingY=e||0;this.align=f||"left";this.autoUpperCase=g?!1:!0;0<a.length&&(this.text=a)};b.RetroFont.prototype.buildRetroFontText=function(){var a=0;this.clear();if(this.multiLine){var c=this._text.split("\n");0<this.fixedWidth?this.resize(this.fixedWidth,c.length*(this.characterHeight+
this.customSpacingY)-this.customSpacingY,!0):this.resize(this.getLongestLine()*(this.characterWidth+this.customSpacingX),c.length*(this.characterHeight+this.customSpacingY)-this.customSpacingY,!0);for(var d=0;d<c.length;d++){var e=0;this.align===b.RetroFont.ALIGN_RIGHT?e=this.width-c[d].length*(this.characterWidth+this.customSpacingX):this.align===b.RetroFont.ALIGN_CENTER&&(e=this.width/2-c[d].length*(this.characterWidth+this.customSpacingX)/2,e+=this.customSpacingX/2);0>e&&(e=0);this.pasteLine(c[d],
e,a,this.customSpacingX);a+=this.characterHeight+this.customSpacingY}}else 0<this.fixedWidth?this.resize(this.fixedWidth,this.characterHeight,!0):this.resize(this._text.length*(this.characterWidth+this.customSpacingX),this.characterHeight,!0),e=0,this.align===b.RetroFont.ALIGN_RIGHT?e=this.width-this._text.length*(this.characterWidth+this.customSpacingX):this.align===b.RetroFont.ALIGN_CENTER&&(e=this.width/2-this._text.length*(this.characterWidth+this.customSpacingX)/2,e+=this.customSpacingX/2),0>
e&&(e=0),this.pasteLine(this._text,e,0,this.customSpacingX);this.requiresReTint=!0};b.RetroFont.prototype.pasteLine=function(a,b,d,e){for(var c=0;c<a.length;c++)if(" "===a.charAt(c))b+=this.characterWidth+e;else if(0<=this.grabData[a.charCodeAt(c)]&&(this.stamp.frame=this.grabData[a.charCodeAt(c)],this.renderXY(this.stamp,b,d,!1),b+=this.characterWidth+e,b>this.width))break};b.RetroFont.prototype.getLongestLine=function(){var a=0;if(0<this._text.length)for(var b=this._text.split("\n"),d=0;d<b.length;d++)b[d].length>
a&&(a=b[d].length);return a};b.RetroFont.prototype.removeUnsupportedCharacters=function(a){for(var b="",d=0;d<this._text.length;d++){var e=this._text[d],f=e.charCodeAt(0);if(0<=this.grabData[f]||!a&&"\n"===e)b=b.concat(e)}return b};b.RetroFont.prototype.updateOffset=function(a,b){if(this.offsetX!==a||this.offsetY!==b){for(var c=a-this.offsetX,e=b-this.offsetY,f=this.game.cache.getFrameData(this.stamp.key).getFrames(),g=f.length;g--;)f[g].x+=c,f[g].y+=e;this.buildRetroFontText()}};Object.defineProperty(b.RetroFont.prototype,
"text",{get:function(){return this._text},set:function(a){a=this.autoUpperCase?a.toUpperCase():a;a!==this._text&&(this._text=a,this.removeUnsupportedCharacters(this.multiLine),this.buildRetroFontText())}});Object.defineProperty(b.RetroFont.prototype,"smoothed",{get:function(){return this.stamp.smoothed},set:function(a){this.stamp.smoothed=a;this.buildRetroFontText()}});b.Rope=function(a,c,d,e,f,g){this.points=[];this.points=g;this._hasUpdateAnimation=!1;this._updateAnimationCallback=null;c=c||0;d=
d||0;e=e||null;f=f||null;this.type=b.ROPE;PIXI.Rope.call(this,b.Cache.DEFAULT,this.points);b.Component.Core.init.call(this,a,c,d,e,f)};b.Rope.prototype=Object.create(PIXI.Rope.prototype);b.Rope.prototype.constructor=b.Rope;b.Component.Core.install.call(b.Rope.prototype,"Angle Animation AutoCull Bounds BringToTop Crop Delta Destroy FixedToCamera InWorld LifeSpan LoadTexture Overlap PhysicsBody Reset ScaleMinMax Smoothed".split(" "));b.Rope.prototype.preUpdatePhysics=b.Component.PhysicsBody.preUpdate;
b.Rope.prototype.preUpdateLifeSpan=b.Component.LifeSpan.preUpdate;b.Rope.prototype.preUpdateInWorld=b.Component.InWorld.preUpdate;b.Rope.prototype.preUpdateCore=b.Component.Core.preUpdate;b.Rope.prototype.preUpdate=function(){return this.preUpdatePhysics()&&this.preUpdateLifeSpan()&&this.preUpdateInWorld()?this.preUpdateCore():!1};b.Rope.prototype.update=function(){this._hasUpdateAnimation&&this.updateAnimation.call(this)};b.Rope.prototype.reset=function(a,c){b.Component.Reset.prototype.reset.call(this,
a,c);return this};Object.defineProperty(b.Rope.prototype,"updateAnimation",{get:function(){return this._updateAnimation},set:function(a){a&&"function"===typeof a?(this._hasUpdateAnimation=!0,this._updateAnimation=a):(this._hasUpdateAnimation=!1,this._updateAnimation=null)}});Object.defineProperty(b.Rope.prototype,"segments",{get:function(){for(var a=[],c,d,e,f,g=0;g<this.points.length;g++)c=4*g,d=this.vertices[c]*this.scale.x,e=this.vertices[c+1]*this.scale.y,f=this.vertices[c+4]*this.scale.x,c=this.vertices[c+
3]*this.scale.y,f=b.Math.difference(d,f),c=b.Math.difference(e,c),d+=this.world.x,e+=this.world.y,d=new b.Rectangle(d,e,f,c),a.push(d);return a}});b.TileSprite=function(a,c,d,e,f,g,h){c=c||0;d=d||0;e=e||256;f=f||256;g=g||null;h=h||null;this.type=b.TILESPRITE;this.physicsType=b.SPRITE;this._scroll=new b.Point;var k=a.cache.getImage("__default",!0);PIXI.TilingSprite.call(this,new PIXI.Texture(k.base),e,f);b.Component.Core.init.call(this,a,c,d,g,h)};b.TileSprite.prototype=Object.create(PIXI.TilingSprite.prototype);
b.TileSprite.prototype.constructor=b.TileSprite;b.Component.Core.install.call(b.TileSprite.prototype,"Angle Animation AutoCull Bounds BringToTop Destroy FixedToCamera Health InCamera InputEnabled InWorld LifeSpan LoadTexture Overlap PhysicsBody Reset Smoothed".split(" "));b.TileSprite.prototype.preUpdatePhysics=b.Component.PhysicsBody.preUpdate;b.TileSprite.prototype.preUpdateLifeSpan=b.Component.LifeSpan.preUpdate;b.TileSprite.prototype.preUpdateInWorld=b.Component.InWorld.preUpdate;b.TileSprite.prototype.preUpdateCore=
b.Component.Core.preUpdate;b.TileSprite.prototype.preUpdate=function(){0!==this._scroll.x&&(this.tilePosition.x+=this._scroll.x*this.game.time.physicsElapsed);0!==this._scroll.y&&(this.tilePosition.y+=this._scroll.y*this.game.time.physicsElapsed);return this.preUpdatePhysics()&&this.preUpdateLifeSpan()&&this.preUpdateInWorld()?this.preUpdateCore():!1};b.TileSprite.prototype.autoScroll=function(a,b){this._scroll.set(a,b)};b.TileSprite.prototype.stopScroll=function(){this._scroll.set(0,0)};b.TileSprite.prototype.destroy=
function(a){b.Component.Destroy.prototype.destroy.call(this,a);PIXI.TilingSprite.prototype.destroy.call(this)};b.TileSprite.prototype.reset=function(a,c){b.Component.Reset.prototype.reset.call(this,a,c);this.tilePosition.x=0;this.tilePosition.y=0;return this};b.Device=function(){this.deviceReadyAt=0;this.iOS=this.desktop=this.initialized=!1;this.iOSVersion=0;this.canvas=this.windowsPhone=this.windows=this.macOS=this.linux=this.chromeOS=this.android=this.crosswalk=this.ejecta=this.electron=this.nodeWebkit=
this.node=this.cordova=this.cocoonJSApp=this.cocoonJS=!1;this.canvasBitBltShift=null;this.vibration=this.typedArray=this.pointerLock=this.css3D=this.worker=this.localStorage=this.fileSystem=this.file=this.webGL=!1;this.getUserMedia=!0;this.mspointer=this.touch=this.quirksMode=!1;this.wheelEvent=null;this.chrome=this.arora=!1;this.chromeVersion=0;this.firefox=this.epiphany=!1;this.firefoxVersion=0;this.ie=!1;this.ieVersion=0;this.trident=!1;this.tridentVersion=0;this.safari=this.opera=this.midori=
this.mobileSafari=this.edge=!1;this.safariVersion=0;this.iPad=this.iPhone4=this.iPhone=this.hlsVideo=this.vp9Video=this.webmVideo=this.mp4Video=this.h264Video=this.oggVideo=this.dolby=this.webm=this.m4a=this.wav=this.mp3=this.opus=this.ogg=this.webAudio=this.audioData=this.silk=this.webApp=!1;this.pixelRatio=0;this.fullscreen=this.support32bit=this.LITTLE_ENDIAN=this.littleEndian=!1;this.cancelFullscreen=this.requestFullscreen="";this.fullscreenKeyboard=!1};b.Device=new b.Device;b.Device.onInitialized=
new b.Signal;b.Device.whenReady=function(a,b,d){var c=this._readyCheck;this.deviceReadyAt||!c?a.call(b,this):c._monitor||d?(c._queue=c._queue||[],c._queue.push([a,b])):(c._monitor=c.bind(this),c._queue=c._queue||[],c._queue.push([a,b]),a="undefined"!==typeof window.cordova,b=navigator.isCocoonJS,"complete"===document.readyState||"interactive"===document.readyState?window.setTimeout(c._monitor,0):a&&!b?document.addEventListener("deviceready",c._monitor,!1):(document.addEventListener("DOMContentLoaded",
c._monitor,!1),window.addEventListener("load",c._monitor,!1)))};b.Device._readyCheck=function(){var a=this._readyCheck;if(!document.body)window.setTimeout(a._monitor,20);else if(!this.deviceReadyAt){this.deviceReadyAt=Date.now();document.removeEventListener("deviceready",a._monitor);document.removeEventListener("DOMContentLoaded",a._monitor);window.removeEventListener("load",a._monitor);this._initialize();this.initialized=!0;this.onInitialized.dispatch(this);for(var b;b=a._queue.shift();)b[0].call(b[1],
this);this.onInitialized=this._initialize=this._readyCheck=null}};b.Device._initialize=function(){function a(){var a=new ArrayBuffer(4),b=new Uint8Array(a);a=new Uint32Array(a);b[0]=161;b[1]=178;b[2]=195;b[3]=212;return 3569595041===a[0]?!0:2712847316===a[0]?!1:null}function b(){if(void 0===Uint8ClampedArray)return!1;var a=PIXI.CanvasPool.create(this,1,1).getContext("2d");if(!a)return!1;a=a.createImageData(1,1);PIXI.CanvasPool.remove(this);return a.data instanceof Uint8ClampedArray}var d=this;(function(){var a=
navigator.userAgent;/Playstation Vita/.test(a)?d.vita=!0:/Kindle/.test(a)||/\bKF[A-Z][A-Z]+/.test(a)||/Silk.*Mobile Safari/.test(a)?d.kindle=!0:/Android/.test(a)?d.android=!0:/CrOS/.test(a)?d.chromeOS=!0:/iP[ao]d|iPhone/i.test(a)?(d.iOS=!0,navigator.appVersion.match(/OS (\d+)/),d.iOSVersion=parseInt(RegExp.$1,10)):/Linux/.test(a)?d.linux=!0:/Mac OS/.test(a)?d.macOS=!0:/Windows/.test(a)&&(d.windows=!0);if(/Windows Phone/i.test(a)||/IEMobile/i.test(a))d.android=!1,d.iOS=!1,d.macOS=!1,d.windows=!0,d.windowsPhone=
!0;var b=/Silk/.test(a);if(d.windows||d.macOS||d.linux&&!b||d.chromeOS)d.desktop=!0;if(d.windowsPhone||/Windows NT/i.test(a)&&/Touch/i.test(a))d.desktop=!1})();(function(){var a=navigator.userAgent;/Arora/.test(a)?d.arora=!0:/Edge\/\d+/.test(a)?d.edge=!0:/Chrome\/(\d+)/.test(a)&&!d.windowsPhone?(d.chrome=!0,d.chromeVersion=parseInt(RegExp.$1,10)):/Epiphany/.test(a)?d.epiphany=!0:/Firefox\D+(\d+)/.test(a)?(d.firefox=!0,d.firefoxVersion=parseInt(RegExp.$1,10)):/AppleWebKit/.test(a)&&d.iOS?d.mobileSafari=
!0:/MSIE (\d+\.\d+);/.test(a)?(d.ie=!0,d.ieVersion=parseInt(RegExp.$1,10)):/Midori/.test(a)?d.midori=!0:/Opera/.test(a)?d.opera=!0:/Safari\/(\d+)/.test(a)&&!d.windowsPhone?(d.safari=!0,/Version\/(\d+)\./.test(a)&&(d.safariVersion=parseInt(RegExp.$1,10))):/Trident\/(\d+\.\d+)(.*)rv:(\d+\.\d+)/.test(a)&&(d.ie=!0,d.trident=!0,d.tridentVersion=parseInt(RegExp.$1,10),d.ieVersion=parseInt(RegExp.$3,10));/Silk/.test(a)&&(d.silk=!0);navigator.standalone&&(d.webApp=!0);"undefined"!==typeof window.cordova&&
(d.cordova=!0);"undefined"!==typeof process&&"undefined"!==typeof require&&(d.node=!0);d.node&&"object"===typeof process.versions&&(d.nodeWebkit=!!process.versions["node-webkit"],d.electron=!!process.versions.electron);navigator.isCocoonJS&&(d.cocoonJS=!0);if(d.cocoonJS)try{d.cocoonJSApp="undefined"!==typeof CocoonJS}catch(k){d.cocoonJSApp=!1}"undefined"!==typeof window.ejecta&&(d.ejecta=!0);/Crosswalk/.test(a)&&(d.crosswalk=!0)})();(function(){d.audioData=!!window.Audio;d.webAudio=!(!window.AudioContext&&
!window.webkitAudioContext);var a=document.createElement("audio");try{if(a.canPlayType){a.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,"")&&(d.ogg=!0);if(a.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,"")||a.canPlayType("audio/opus;").replace(/^no$/,""))d.opus=!0;a.canPlayType("audio/mpeg;").replace(/^no$/,"")&&(d.mp3=!0);a.canPlayType('audio/wav; codecs="1"').replace(/^no$/,"")&&(d.wav=!0);if(a.canPlayType("audio/x-m4a;")||a.canPlayType("audio/aac;").replace(/^no$/,""))d.m4a=
!0;a.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")&&(d.webm=!0);if(""!==a.canPlayType('audio/mp4;codecs="ec-3"'))if(d.edge)d.dolby=!0;else if(d.safari&&9<=d.safariVersion&&/Mac OS X (\d+)_(\d+)/.test(navigator.userAgent)){var b=parseInt(RegExp.$1,10),c=parseInt(RegExp.$2,10);if(10===b&&11<=c||10<b)d.dolby=!0}}}catch(u){}})();(function(){var a=document.createElement("video");try{a.canPlayType&&(a.canPlayType('video/ogg; codecs="theora"').replace(/^no$/,"")&&(d.oggVideo=!0),a.canPlayType('video/mp4; codecs="avc1.42E01E"').replace(/^no$/,
"")&&(d.h264Video=!0,d.mp4Video=!0),a.canPlayType('video/webm; codecs="vp8, vorbis"').replace(/^no$/,"")&&(d.webmVideo=!0),a.canPlayType('video/webm; codecs="vp9"').replace(/^no$/,"")&&(d.vp9Video=!0),a.canPlayType('application/x-mpegURL; codecs="avc1.42E01E"').replace(/^no$/,"")&&(d.hlsVideo=!0))}catch(k){}})();(function(){var a=document.createElement("p"),b={webkitTransform:"-webkit-transform",OTransform:"-o-transform",msTransform:"-ms-transform",MozTransform:"-moz-transform",transform:"transform"};
document.body.insertBefore(a,null);for(var c in b)if(void 0!==a.style[c]){a.style[c]="translate3d(1px,1px,1px)";var f=window.getComputedStyle(a).getPropertyValue(b[c])}document.body.removeChild(a);d.css3D=void 0!==f&&0<f.length&&"none"!==f})();d.pixelRatio=window.devicePixelRatio||1;d.iPhone=-1!==navigator.userAgent.toLowerCase().indexOf("iphone");d.iPhone4=2===d.pixelRatio&&d.iPhone;d.iPad=-1!==navigator.userAgent.toLowerCase().indexOf("ipad");d.typedArray="undefined"!==typeof Int8Array?!0:!1;"undefined"!==
typeof ArrayBuffer&&"undefined"!==typeof Uint8Array&&"undefined"!==typeof Uint32Array&&(d.littleEndian=a(),d.LITTLE_ENDIAN=d.littleEndian);d.support32bit="undefined"!==typeof ArrayBuffer&&"undefined"!==typeof Uint8ClampedArray&&"undefined"!==typeof Int32Array&&null!==d.littleEndian&&b();navigator.vibrate=navigator.vibrate||navigator.webkitVibrate||navigator.mozVibrate||navigator.msVibrate;navigator.vibrate&&(d.vibration=!0);(function(){d.canvas=!!window.CanvasRenderingContext2D||d.cocoonJS;try{d.localStorage=
!!localStorage.getItem}catch(m){d.localStorage=!1}d.file=!!window.File&&!!window.FileReader&&!!window.FileList&&!!window.Blob;d.fileSystem=!!window.requestFileSystem;try{var a=document.createElement("canvas");a.screencanvas=!1;var b=!!window.WebGLRenderingContext&&(a.getContext("webgl")||a.getContext("experimental-webgl"))}catch(m){b=!1}d.webGL=b;d.webGL=!!d.webGL;d.worker=!!window.Worker;d.pointerLock="pointerLockElement"in document||"mozPointerLockElement"in document||"webkitPointerLockElement"in
document;d.quirksMode="CSS1Compat"===document.compatMode?!1:!0;navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia||navigator.oGetUserMedia;window.URL=window.URL||window.webkitURL||window.mozURL||window.msURL;d.getUserMedia=d.getUserMedia&&!!navigator.getUserMedia&&!!window.URL;d.firefox&&21>d.firefoxVersion&&(d.getUserMedia=!1);!d.iOS&&(d.ie||d.firefox||d.chrome)&&(d.canvasBitBltShift=!0);if(d.safari||d.mobileSafari)d.canvasBitBltShift=
!1})();(function(){for(var a="requestFullscreen requestFullScreen webkitRequestFullscreen webkitRequestFullScreen msRequestFullscreen msRequestFullScreen mozRequestFullScreen mozRequestFullscreen".split(" "),b=document.createElement("div"),c=0;c<a.length;c++)if(b[a[c]]){d.fullscreen=!0;d.requestFullscreen=a[c];break}a="cancelFullScreen exitFullscreen webkitCancelFullScreen webkitExitFullscreen msCancelFullScreen msExitFullscreen mozCancelFullScreen mozExitFullscreen".split(" ");if(d.fullscreen)for(c=
0;c<a.length;c++)if(document[a[c]]){d.cancelFullscreen=a[c];break}window.Element&&Element.ALLOW_KEYBOARD_INPUT&&(d.fullscreenKeyboard=!0)})();if("ontouchstart"in document.documentElement||window.navigator.maxTouchPoints&&1<=window.navigator.maxTouchPoints)d.touch=!0;if(window.navigator.msPointerEnabled||window.navigator.pointerEnabled)d.mspointer=!0;d.cocoonJS||("onwheel"in window||d.ie&&"WheelEvent"in window?d.wheelEvent="wheel":"onmousewheel"in window?d.wheelEvent="mousewheel":d.firefox&&"MouseScrollEvent"in
window&&(d.wheelEvent="DOMMouseScroll"))};b.Device.canPlayAudio=function(a){return"mp3"===a&&this.mp3||"ogg"===a&&(this.ogg||this.opus)||"m4a"===a&&this.m4a||"opus"===a&&this.opus||"wav"===a&&this.wav||"webm"===a&&this.webm||"mp4"===a&&this.dolby?!0:!1};b.Device.canPlayVideo=function(a){return"webm"===a&&(this.webmVideo||this.vp9Video)||"mp4"===a&&(this.mp4Video||this.h264Video)||("ogg"===a||"ogv"===a)&&this.oggVideo||"mpeg"===a&&this.hlsVideo?!0:!1};b.Device.isConsoleOpen=function(){return window.console&&
window.console.firebug?!0:window.console&&(console.profile(),console.profileEnd(),console.clear&&console.clear(),console.profiles)?0<console.profiles.length:!1};b.Device.isAndroidStockBrowser=function(){var a=window.navigator.userAgent.match(/Android.*AppleWebKit\/([\d.]+)/);return a&&537>a[1]};b.Canvas={create:function(a,b,d,e,f){b=b||256;d=d||256;a=f?document.createElement("canvas"):PIXI.CanvasPool.create(a,b,d);"string"===typeof e&&""!==e&&(a.id=e);a.width=b;a.height=d;a.style.display="block";
return a},setBackgroundColor:function(a,b){a.style.backgroundColor=b||"rgb(0,0,0)";return a},setTouchAction:function(a,b){b=b||"none";a.style.msTouchAction=b;a.style["ms-touch-action"]=b;a.style["touch-action"]=b;return a},setUserSelect:function(a,b){b=b||"none";a.style["-webkit-touch-callout"]=b;a.style["-webkit-user-select"]=b;a.style["-khtml-user-select"]=b;a.style["-moz-user-select"]=b;a.style["-ms-user-select"]=b;a.style["user-select"]=b;a.style["-webkit-tap-highlight-color"]="rgba(0, 0, 0, 0)";
return a},addToDOM:function(a,b,d){var c;void 0===d&&(d=!0);b&&("string"===typeof b?c=document.getElementById(b):"object"===typeof b&&1===b.nodeType&&(c=b));c||(c=document.body);d&&c.style&&(c.style.overflow="hidden");c.appendChild(a);return a},removeFromDOM:function(a){a.parentNode&&a.parentNode.removeChild(a)},setTransform:function(a,b,d,e,f,g,h){a.setTransform(e,g,h,f,b,d);return a},setSmoothingEnabled:function(a,c){var d=b.Canvas.getSmoothingPrefix(a);d&&(a[d]=c);return a},getSmoothingPrefix:function(a){var b=
["i","webkitI","msI","mozI","oI"],d;for(d in b){var e=b[d]+"mageSmoothingEnabled";if(e in a)return e}return null},getSmoothingEnabled:function(a){var c=b.Canvas.getSmoothingPrefix(a);if(c)return a[c]},setImageRenderingCrisp:function(a){for(var b="optimizeSpeed crisp-edges -moz-crisp-edges -webkit-optimize-contrast optimize-contrast pixelated".split(" "),d=0;d<b.length;d++)a.style["image-rendering"]=b[d];a.style.msInterpolationMode="nearest-neighbor";return a},setImageRenderingBicubic:function(a){a.style["image-rendering"]=
"auto";a.style.msInterpolationMode="bicubic";return a}};b.RequestAnimationFrame=function(a,b){void 0===b&&(b=!1);this.game=a;this.isRunning=!1;this.forceSetTimeOut=b;for(var c=["ms","moz","webkit","o"],e=0;e<c.length&&!window.requestAnimationFrame;e++)window.requestAnimationFrame=window[c[e]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[c[e]+"CancelAnimationFrame"];this._isSetTimeOut=!1;this._timeOutID=this._onLoop=null};b.RequestAnimationFrame.prototype={start:function(){this.isRunning=
!0;var a=this;!window.requestAnimationFrame||this.forceSetTimeOut?(this._isSetTimeOut=!0,this._onLoop=function(){return a.updateSetTimeout()},this._timeOutID=window.setTimeout(this._onLoop,0)):(this._isSetTimeOut=!1,this._onLoop=function(b){return a.updateRAF(b)},this._timeOutID=window.requestAnimationFrame(this._onLoop))},updateRAF:function(a){this.isRunning&&(this.game.update(Math.floor(a)),this._timeOutID=window.requestAnimationFrame(this._onLoop))},updateSetTimeout:function(){this.isRunning&&
(this.game.update(Date.now()),this._timeOutID=window.setTimeout(this._onLoop,this.game.time.timeToCall))},stop:function(){this._isSetTimeOut?clearTimeout(this._timeOutID):window.cancelAnimationFrame(this._timeOutID);this.isRunning=!1},isSetTimeOut:function(){return this._isSetTimeOut},isRAF:function(){return!1===this._isSetTimeOut}};b.RequestAnimationFrame.prototype.constructor=b.RequestAnimationFrame;b.Math={PI2:2*Math.PI,between:function(a,b){return Math.floor(Math.random()*(b-a+1)+a)},fuzzyEqual:function(a,
b,d){void 0===d&&(d=1E-4);return Math.abs(a-b)<d},fuzzyLessThan:function(a,b,d){void 0===d&&(d=1E-4);return a<b+d},fuzzyGreaterThan:function(a,b,d){void 0===d&&(d=1E-4);return a>b-d},fuzzyCeil:function(a,b){void 0===b&&(b=1E-4);return Math.ceil(a-b)},fuzzyFloor:function(a,b){void 0===b&&(b=1E-4);return Math.floor(a+b)},average:function(){for(var a=0,b=arguments.length,d=0;d<b;d++)a+=+arguments[d];return a/b},shear:function(a){return a%1},snapTo:function(a,b,d){void 0===d&&(d=0);if(0===b)return a;
a=b*Math.round((a-d)/b);return d+a},snapToFloor:function(a,b,d){void 0===d&&(d=0);if(0===b)return a;a=b*Math.floor((a-d)/b);return d+a},snapToCeil:function(a,b,d){void 0===d&&(d=0);if(0===b)return a;a=b*Math.ceil((a-d)/b);return d+a},roundTo:function(a,b,d){void 0===b&&(b=0);void 0===d&&(d=10);b=Math.pow(d,-b);return Math.round(a*b)/b},floorTo:function(a,b,d){void 0===b&&(b=0);void 0===d&&(d=10);b=Math.pow(d,-b);return Math.floor(a*b)/b},ceilTo:function(a,b,d){void 0===b&&(b=0);void 0===d&&(d=10);
b=Math.pow(d,-b);return Math.ceil(a*b)/b},rotateToAngle:function(a,c,d){void 0===d&&(d=.05);if(a===c)return a;Math.abs(c-a)<=d||Math.abs(c-a)>=b.Math.PI2-d?a=c:(Math.abs(c-a)>Math.PI&&(c=c<a?c+b.Math.PI2:c-b.Math.PI2),c>a?a+=d:c<a&&(a-=d));return a},getShortestAngle:function(a,b){var c=b-a;return 0===c?0:c-360*Math.floor((c- -180)/360)},angleBetween:function(a,b,d,e){return Math.atan2(e-b,d-a)},angleBetweenY:function(a,b,d,e){return Math.atan2(d-a,e-b)},angleBetweenPoints:function(a,b){return Math.atan2(b.y-
a.y,b.x-a.x)},angleBetweenPointsY:function(a,b){return Math.atan2(b.x-a.x,b.y-a.y)},reverseAngle:function(a){return this.normalizeAngle(a+Math.PI,!0)},normalizeAngle:function(a){a%=2*Math.PI;return 0<=a?a:a+2*Math.PI},maxAdd:function(a,b,d){return Math.min(a+b,d)},minSub:function(a,b,d){return Math.max(a-b,d)},wrap:function(a,b,d){d-=b;if(0>=d)return 0;a=(a-b)%d;0>a&&(a+=d);return a+b},wrapValue:function(a,b,d){a=Math.abs(a);b=Math.abs(b);d=Math.abs(d);return(a+b)%d},isOdd:function(a){return!!(a&
1)},isEven:function(a){return!(a&1)},min:function(){for(var a=1===arguments.length&&"object"===typeof arguments[0]?arguments[0]:arguments,b=1,d=0,e=a.length;b<e;b++)a[b]<a[d]&&(d=b);return a[d]},max:function(){for(var a=1===arguments.length&&"object"===typeof arguments[0]?arguments[0]:arguments,b=1,d=0,e=a.length;b<e;b++)a[b]>a[d]&&(d=b);return a[d]},minProperty:function(a){for(var b=2===arguments.length&&"object"===typeof arguments[1]?arguments[1]:arguments.slice(1),d=1,e=0,f=b.length;d<f;d++)b[d][a]<
b[e][a]&&(e=d);return b[e][a]},maxProperty:function(a){for(var b=2===arguments.length&&"object"===typeof arguments[1]?arguments[1]:arguments.slice(1),d=1,e=0,f=b.length;d<f;d++)b[d][a]>b[e][a]&&(e=d);return b[e][a]},wrapAngle:function(a,b){return b?this.wrap(a,-Math.PI,Math.PI):this.wrap(a,-180,180)},linearInterpolation:function(a,b){var c=a.length-1,e=c*b,f=Math.floor(e);return 0>b?this.linear(a[0],a[1],e):1<b?this.linear(a[c],a[c-1],c-e):this.linear(a[f],a[f+1>c?c:f+1],e-f)},bezierInterpolation:function(a,
b){for(var c=0,e=a.length-1,f=0;f<=e;f++)c+=Math.pow(1-b,e-f)*Math.pow(b,f)*a[f]*this.bernstein(e,f);return c},catmullRomInterpolation:function(a,b){var c=a.length-1,e=c*b,f=Math.floor(e);return a[0]===a[c]?(0>b&&(f=Math.floor(e=c*(1+b))),this.catmullRom(a[(f-1+c)%c],a[f],a[(f+1)%c],a[(f+2)%c],e-f)):0>b?a[0]-(this.catmullRom(a[0],a[0],a[1],a[1],-e)-a[0]):1<b?a[c]-(this.catmullRom(a[c],a[c],a[c-1],a[c-1],e-c)-a[c]):this.catmullRom(a[f?f-1:0],a[f],a[c<f+1?c:f+1],a[c<f+2?c:f+2],e-f)},linear:function(a,
b,d){return(b-a)*d+a},bernstein:function(a,b){return this.factorial(a)/this.factorial(b)/this.factorial(a-b)},factorial:function(a){if(0===a)return 1;for(var b=a;--a;)b*=a;return b},catmullRom:function(a,b,d,e,f){a=.5*(d-a);e=.5*(e-b);var c=f*f;return(2*b-2*d+a+e)*f*c+(-3*b+3*d-2*a-e)*c+a*f+b},difference:function(a,b){return Math.abs(a-b)},roundAwayFromZero:function(a){return 0<a?Math.ceil(a):Math.floor(a)},sinCosGenerator:function(a,b,d,e){void 0===b&&(b=1);void 0===d&&(d=1);void 0===e&&(e=1);e=
e*Math.PI/a;for(var c=[],f=[],g=0;g<a;g++)d-=b*e,b+=d*e,c[g]=d,f[g]=b;return{sin:f,cos:c,length:a}},distance:function(a,b,d,e){a-=d;b-=e;return Math.sqrt(a*a+b*b)},distanceSq:function(a,b,d,e){a-=d;b-=e;return a*a+b*b},distancePow:function(a,b,d,e,f){void 0===f&&(f=2);return Math.sqrt(Math.pow(d-a,f)+Math.pow(e-b,f))},clamp:function(a,b,d){return a<b?b:d<a?d:a},clampBottom:function(a,b){return a<b?b:a},within:function(a,b,d){return Math.abs(a-b)<=d},mapLinear:function(a,b,d,e,f){return e+(a-b)*(f-
e)/(d-b)},smoothstep:function(a,b,d){a=Math.max(0,Math.min(1,(a-b)/(d-b)));return a*a*(3-2*a)},smootherstep:function(a,b,d){a=Math.max(0,Math.min(1,(a-b)/(d-b)));return a*a*a*(a*(6*a-15)+10)},sign:function(a){return 0>a?-1:0<a?1:0},percent:function(a,b,d){void 0===d&&(d=0);return a>b||d>b?1:a<d||d>a?0:(a-d)/b}};var n=Math.PI/180,p=180/Math.PI;b.Math.degToRad=function(a){return a*n};b.Math.radToDeg=function(a){return a*p};b.RandomDataGenerator=function(a){void 0===a&&(a=[]);this.c=1;this.s2=this.s1=
this.s0=0;"string"===typeof a?this.state(a):this.sow(a)};b.RandomDataGenerator.prototype={rnd:function(){var a=2091639*this.s0+2.3283064365386963E-10*this.c;this.c=a|0;this.s0=this.s1;this.s1=this.s2;return this.s2=a-this.c},sow:function(a){this.s0=this.hash(" ");this.s1=this.hash(this.s0);this.s2=this.hash(this.s1);this.c=1;if(a)for(var b=0;b<a.length&&null!=a[b];b++){var d=a[b];this.s0-=this.hash(d);this.s0+=~~(0>this.s0);this.s1-=this.hash(d);this.s1+=~~(0>this.s1);this.s2-=this.hash(d);this.s2+=
~~(0>this.s2)}},hash:function(a){var b;var d=4022871197;a=a.toString();for(b=0;b<a.length;b++){d+=a.charCodeAt(b);var e=.02519603282416938*d;d=e>>>0;e-=d;e*=d;d=e>>>0;e-=d;d+=4294967296*e}return 2.3283064365386963E-10*(d>>>0)},integer:function(){return 4294967296*this.rnd.apply(this)},frac:function(){return this.rnd.apply(this)+1.1102230246251565E-16*(2097152*this.rnd.apply(this)|0)},real:function(){return this.integer()+this.frac()},integerInRange:function(a,b){return Math.floor(this.realInRange(0,
b-a+1)+a)},between:function(a,b){return this.integerInRange(a,b)},realInRange:function(a,b){return this.frac()*(b-a)+a},normal:function(){return 1-2*this.frac()},uuid:function(){var a,b;for(b=a="";36>a++;b+=~a%5|3*a&4?(a^15?8^this.frac()*(a^20?16:4):4).toString(16):"-");return b},pick:function(a){return a[this.integerInRange(0,a.length-1)]},sign:function(){return this.pick([-1,1])},weightedPick:function(a){return a[~~(Math.pow(this.frac(),2)*(a.length-1)+.5)]},timestamp:function(a,b){return this.realInRange(a||
9466848E5,b||1577862E6)},angle:function(){return this.integerInRange(-180,180)},state:function(a){"string"===typeof a&&a.match(/^!rnd/)&&(a=a.split(","),this.c=parseFloat(a[1]),this.s0=parseFloat(a[2]),this.s1=parseFloat(a[3]),this.s2=parseFloat(a[4]));return["!rnd",this.c,this.s0,this.s1,this.s2].join()}};b.RandomDataGenerator.prototype.constructor=b.RandomDataGenerator;b.QuadTree=function(a,b,d,e,f,g,h){this.maxObjects=10;this.maxLevels=4;this.level=0;this.bounds={};this.objects=[];this.nodes=[];
this._empty=[];this.reset(a,b,d,e,f,g,h)};b.QuadTree.prototype={reset:function(a,b,d,e,f,g,h){this.maxObjects=f||10;this.maxLevels=g||4;this.level=h||0;this.bounds={x:Math.round(a),y:Math.round(b),width:d,height:e,subWidth:Math.floor(d/2),subHeight:Math.floor(e/2),right:Math.round(a)+Math.floor(d/2),bottom:Math.round(b)+Math.floor(e/2)};this.objects.length=0;this.nodes.length=0},populate:function(a){a.forEach(this.populateHandler,this,!0)},populateHandler:function(a){a.body&&a.exists&&this.insert(a.body)},
split:function(){this.nodes[0]=new b.QuadTree(this.bounds.right,this.bounds.y,this.bounds.subWidth,this.bounds.subHeight,this.maxObjects,this.maxLevels,this.level+1);this.nodes[1]=new b.QuadTree(this.bounds.x,this.bounds.y,this.bounds.subWidth,this.bounds.subHeight,this.maxObjects,this.maxLevels,this.level+1);this.nodes[2]=new b.QuadTree(this.bounds.x,this.bounds.bottom,this.bounds.subWidth,this.bounds.subHeight,this.maxObjects,this.maxLevels,this.level+1);this.nodes[3]=new b.QuadTree(this.bounds.right,
this.bounds.bottom,this.bounds.subWidth,this.bounds.subHeight,this.maxObjects,this.maxLevels,this.level+1)},insert:function(a){var b=0;if(null!=this.nodes[0]){var d=this.getIndex(a);if(-1!==d){this.nodes[d].insert(a);return}}this.objects.push(a);if(this.objects.length>this.maxObjects&&this.level<this.maxLevels)for(null==this.nodes[0]&&this.split();b<this.objects.length;)d=this.getIndex(this.objects[b]),-1!==d?this.nodes[d].insert(this.objects.splice(b,1)[0]):b++},getIndex:function(a){var b=-1;a.x<
this.bounds.right&&a.right<this.bounds.right?a.y<this.bounds.bottom&&a.bottom<this.bounds.bottom?b=1:a.y>this.bounds.bottom&&(b=2):a.x>this.bounds.right&&(a.y<this.bounds.bottom&&a.bottom<this.bounds.bottom?b=0:a.y>this.bounds.bottom&&(b=3));return b},retrieve:function(a){if(a instanceof b.Rectangle)var c=this.objects,d=this.getIndex(a);else{if(!a.body)return this._empty;c=this.objects;d=this.getIndex(a.body)}this.nodes[0]&&(-1!==d?c=c.concat(this.nodes[d].retrieve(a)):(c=c.concat(this.nodes[0].retrieve(a)),
c=c.concat(this.nodes[1].retrieve(a)),c=c.concat(this.nodes[2].retrieve(a)),c=c.concat(this.nodes[3].retrieve(a))));return c},clear:function(){this.objects.length=0;for(var a=this.nodes.length;a--;)this.nodes[a].clear(),this.nodes.splice(a,1);this.nodes.length=0}};b.QuadTree.prototype.constructor=b.QuadTree;b.Net=function(a){this.game=a};b.Net.prototype={getHostName:function(){return window.location&&window.location.hostname?window.location.hostname:null},checkDomainName:function(a){return-1!==window.location.hostname.indexOf(a)},
updateQueryString:function(a,b,d,e){void 0===d&&(d=!1);if(void 0===e||""===e)e=window.location.href;var c=new RegExp("([?|&])"+a+"=.*?(&|#|$)(.*)","gi");if(c.test(e))a="undefined"!==typeof b&&null!==b?e.replace(c,"$1"+a+"="+b+"$2$3"):e.replace(c,"$1$3").replace(/(&|\?)$/,"");else{if("undefined"!==typeof b&&null!==b){c=-1!==e.indexOf("?")?"&":"?";var f=e.split("#");e=f[0]+c+a+"="+b;f[1]&&(e+="#"+f[1])}a=e}if(d)window.location.href=a;else return a},getQueryString:function(a){void 0===a&&(a="");var b=
{},d=location.search.substring(1).split("&"),e;for(e in d){var f=d[e].split("=");if(1<f.length){if(a&&a===this.decodeURI(f[0]))return this.decodeURI(f[1]);b[this.decodeURI(f[0])]=this.decodeURI(f[1])}}return b},decodeURI:function(a){return decodeURIComponent(a.replace(/\+/g," "))}};b.Net.prototype.constructor=b.Net;b.TweenManager=function(a){this.game=a;this.frameBased=!1;this._tweens=[];this._add=[];this.easeMap={Power0:b.Easing.Power0,Power1:b.Easing.Power1,Power2:b.Easing.Power2,Power3:b.Easing.Power3,
Power4:b.Easing.Power4,Linear:b.Easing.Linear.None,Quad:b.Easing.Quadratic.Out,Cubic:b.Easing.Cubic.Out,Quart:b.Easing.Quartic.Out,Quint:b.Easing.Quintic.Out,Sine:b.Easing.Sinusoidal.Out,Expo:b.Easing.Exponential.Out,Circ:b.Easing.Circular.Out,Elastic:b.Easing.Elastic.Out,Back:b.Easing.Back.Out,Bounce:b.Easing.Bounce.Out,"Quad.easeIn":b.Easing.Quadratic.In,"Cubic.easeIn":b.Easing.Cubic.In,"Quart.easeIn":b.Easing.Quartic.In,"Quint.easeIn":b.Easing.Quintic.In,"Sine.easeIn":b.Easing.Sinusoidal.In,"Expo.easeIn":b.Easing.Exponential.In,
"Circ.easeIn":b.Easing.Circular.In,"Elastic.easeIn":b.Easing.Elastic.In,"Back.easeIn":b.Easing.Back.In,"Bounce.easeIn":b.Easing.Bounce.In,"Quad.easeOut":b.Easing.Quadratic.Out,"Cubic.easeOut":b.Easing.Cubic.Out,"Quart.easeOut":b.Easing.Quartic.Out,"Quint.easeOut":b.Easing.Quintic.Out,"Sine.easeOut":b.Easing.Sinusoidal.Out,"Expo.easeOut":b.Easing.Exponential.Out,"Circ.easeOut":b.Easing.Circular.Out,"Elastic.easeOut":b.Easing.Elastic.Out,"Back.easeOut":b.Easing.Back.Out,"Bounce.easeOut":b.Easing.Bounce.Out,
"Quad.easeInOut":b.Easing.Quadratic.InOut,"Cubic.easeInOut":b.Easing.Cubic.InOut,"Quart.easeInOut":b.Easing.Quartic.InOut,"Quint.easeInOut":b.Easing.Quintic.InOut,"Sine.easeInOut":b.Easing.Sinusoidal.InOut,"Expo.easeInOut":b.Easing.Exponential.InOut,"Circ.easeInOut":b.Easing.Circular.InOut,"Elastic.easeInOut":b.Easing.Elastic.InOut,"Back.easeInOut":b.Easing.Back.InOut,"Bounce.easeInOut":b.Easing.Bounce.InOut};this.game.onPause.add(this._pauseAll,this);this.game.onResume.add(this._resumeAll,this)};
b.TweenManager.prototype={getAll:function(){return this._tweens},removeAll:function(){for(var a=0;a<this._tweens.length;a++)this._tweens[a].pendingDelete=!0;this._add=[]},removeFrom:function(a,c){void 0===c&&(c=!0);var d;if(Array.isArray(a)){var e=0;for(d=a.length;e<d;e++)this.removeFrom(a[e])}else if(a.type===b.GROUP&&c)for(e=0,d=a.children.length;e<d;e++)this.removeFrom(a.children[e]);else{e=0;for(d=this._tweens.length;e<d;e++)a===this._tweens[e].target&&this.remove(this._tweens[e]);e=0;for(d=this._add.length;e<
d;e++)a===this._add[e].target&&this.remove(this._add[e])}},add:function(a){a._manager=this;this._add.push(a)},create:function(a){return new b.Tween(a,this.game,this)},remove:function(a){var b=this._tweens.indexOf(a);-1!==b?this._tweens[b].pendingDelete=!0:(b=this._add.indexOf(a),-1!==b&&(this._add[b].pendingDelete=!0))},update:function(){var a=this._add.length,b=this._tweens.length;if(0===b&&0===a)return!1;for(var d=0;d<b;)this._tweens[d].update(this.game.time.time)?d++:(this._tweens.splice(d,1),
b--);0<a&&(this._tweens=this._tweens.concat(this._add),this._add.length=0);return!0},isTweening:function(a){return this._tweens.some(function(b){return b.target===a})},_pauseAll:function(){for(var a=this._tweens.length-1;0<=a;a--)this._tweens[a]._pause()},_resumeAll:function(){for(var a=this._tweens.length-1;0<=a;a--)this._tweens[a]._resume()},pauseAll:function(){for(var a=this._tweens.length-1;0<=a;a--)this._tweens[a].pause()},resumeAll:function(){for(var a=this._tweens.length-1;0<=a;a--)this._tweens[a].resume(!0)}};
b.TweenManager.prototype.constructor=b.TweenManager;b.Tween=function(a,c,d){this.game=c;this.target=a;this.manager=d;this.timeline=[];this.reverse=!1;this.timeScale=1;this.repeatCounter=0;this.pendingDelete=!1;this.onStart=new b.Signal;this.onLoop=new b.Signal;this.onRepeat=new b.Signal;this.onChildComplete=new b.Signal;this.onComplete=new b.Signal;this.isRunning=!1;this.current=0;this.properties={};this.chainedTween=null;this.isPaused=!1;this.frameBased=d.frameBased;this._onUpdateCallbackContext=
this._onUpdateCallback=null;this._pausedTime=0;this._hasStarted=this._codePaused=!1};b.Tween.prototype={to:function(a,c,d,e,f,g,h){if(void 0===c||0>=c)c=1E3;if(void 0===d||null===d)d=b.Easing.Default;void 0===e&&(e=!1);void 0===f&&(f=0);void 0===g&&(g=0);void 0===h&&(h=!1);"string"===typeof d&&this.manager.easeMap[d]&&(d=this.manager.easeMap[d]);if(this.isRunning)return console.warn("Phaser.Tween.to cannot be called after Tween.start"),this;this.timeline.push((new b.TweenData(this)).to(a,c,d,f,g,
h));e&&this.start();return this},from:function(a,c,d,e,f,g,h){void 0===c&&(c=1E3);if(void 0===d||null===d)d=b.Easing.Default;void 0===e&&(e=!1);void 0===f&&(f=0);void 0===g&&(g=0);void 0===h&&(h=!1);"string"===typeof d&&this.manager.easeMap[d]&&(d=this.manager.easeMap[d]);if(this.isRunning)return console.warn("Phaser.Tween.from cannot be called after Tween.start"),this;this.timeline.push((new b.TweenData(this)).from(a,c,d,f,g,h));e&&this.start();return this},start:function(a){void 0===a&&(a=0);if(null===
this.game||null===this.target||0===this.timeline.length||this.isRunning)return this;for(var b=0;b<this.timeline.length;b++)for(var d in this.timeline[b].vEnd)this.properties[d]=this.target[d]||0,Array.isArray(this.properties[d])||(this.properties[d]*=1);for(b=0;b<this.timeline.length;b++)this.timeline[b].loadValues();this.manager.add(this);this.isRunning=!0;if(0>a||a>this.timeline.length-1)a=0;this.current=a;this.timeline[this.current].start();return this},stop:function(a){void 0===a&&(a=!1);this.isRunning=
!1;this._onUpdateCallbackContext=this._onUpdateCallback=null;a&&(this.onComplete.dispatch(this.target,this),this._hasStarted=!1,this.chainedTween&&this.chainedTween.start());this.manager.remove(this);return this},updateTweenData:function(a,b,d){if(0===this.timeline.length)return this;void 0===d&&(d=0);if(-1===d)for(d=0;d<this.timeline.length;d++)this.timeline[d][a]=b;else this.timeline[d][a]=b;return this},delay:function(a,b){return this.updateTweenData("delay",a,b)},repeat:function(a,b,d){void 0===
b&&(b=0);this.updateTweenData("repeatCounter",a,d);return this.updateTweenData("repeatDelay",b,d)},repeatDelay:function(a,b){return this.updateTweenData("repeatDelay",a,b)},yoyo:function(a,b,d){void 0===b&&(b=0);this.updateTweenData("yoyo",a,d);return this.updateTweenData("yoyoDelay",b,d)},yoyoDelay:function(a,b){return this.updateTweenData("yoyoDelay",a,b)},easing:function(a,b){"string"===typeof a&&this.manager.easeMap[a]&&(a=this.manager.easeMap[a]);return this.updateTweenData("easingFunction",
a,b)},interpolation:function(a,c,d){void 0===c&&(c=b.Math);this.updateTweenData("interpolationFunction",a,d);return this.updateTweenData("interpolationContext",c,d)},repeatAll:function(a){void 0===a&&(a=0);this.repeatCounter=a;return this},chain:function(){for(var a=arguments.length;a--;)0<a?arguments[a-1].chainedTween=arguments[a]:this.chainedTween=arguments[a];return this},loop:function(a){void 0===a&&(a=!0);this.repeatCounter=a?-1:0;return this},onUpdateCallback:function(a,b){this._onUpdateCallback=
a;this._onUpdateCallbackContext=b;return this},pause:function(){this._codePaused=this.isPaused=!0;this._pausedTime=this.game.time.time},_pause:function(){this._codePaused||(this.isPaused=!0,this._pausedTime=this.game.time.time)},resume:function(){if(this.isPaused){this._codePaused=this.isPaused=!1;for(var a=0;a<this.timeline.length;a++)this.timeline[a].isRunning||(this.timeline[a].startTime+=this.game.time.time-this._pausedTime)}},_resume:function(){this._codePaused||this.resume()},update:function(a){if(this.pendingDelete||
!this.target)return!1;if(this.isPaused)return!0;a=this.timeline[this.current].update(a);if(a===b.TweenData.PENDING)return!0;if(a===b.TweenData.RUNNING)return this._hasStarted||(this.onStart.dispatch(this.target,this),this._hasStarted=!0),null!==this._onUpdateCallback&&this._onUpdateCallback.call(this._onUpdateCallbackContext,this,this.timeline[this.current].value,this.timeline[this.current]),this.isRunning;if(a===b.TweenData.LOOPED)return-1===this.timeline[this.current].repeatCounter?this.onLoop.dispatch(this.target,
this):this.onRepeat.dispatch(this.target,this),!0;if(a===b.TweenData.COMPLETE){a=!1;this.reverse?(this.current--,0>this.current&&(this.current=this.timeline.length-1,a=!0)):(this.current++,this.current===this.timeline.length&&(this.current=0,a=!0));if(a){if(-1===this.repeatCounter)return this.timeline[this.current].start(),this.onLoop.dispatch(this.target,this),!0;if(0<this.repeatCounter)return this.repeatCounter--,this.timeline[this.current].start(),this.onRepeat.dispatch(this.target,this),!0;this.isRunning=
!1;this.onComplete.dispatch(this.target,this);this._hasStarted=!1;this.chainedTween&&this.chainedTween.start();return!1}this.onChildComplete.dispatch(this.target,this);this.timeline[this.current].start();return!0}},generateData:function(a,b){if(null===this.game||null===this.target)return null;void 0===a&&(a=60);void 0===b&&(b=[]);for(var c=0;c<this.timeline.length;c++)for(var e in this.timeline[c].vEnd)this.properties[e]=this.target[e]||0,Array.isArray(this.properties[e])||(this.properties[e]*=1);
for(c=0;c<this.timeline.length;c++)this.timeline[c].loadValues();for(c=0;c<this.timeline.length;c++)b=b.concat(this.timeline[c].generateData(a));return b}};Object.defineProperty(b.Tween.prototype,"totalDuration",{get:function(){for(var a=0,b=0;b<this.timeline.length;b++)a+=this.timeline[b].duration;return a}});b.Tween.prototype.constructor=b.Tween;b.TweenData=function(a){this.parent=a;this.game=a.game;this.vStart={};this.vStartCache={};this.vEnd={};this.vEndCache={};this.duration=1E3;this.repeatTotal=
this.repeatDelay=this.repeatCounter=this.value=this.percent=0;this.yoyo=this.interpolate=!1;this.yoyoDelay=0;this.inReverse=!1;this.dt=this.delay=0;this.startTime=null;this.easingFunction=b.Easing.Default;this.interpolationFunction=b.Math.linearInterpolation;this.interpolationContext=b.Math;this.isFrom=this.isRunning=!1};b.TweenData.PENDING=0;b.TweenData.RUNNING=1;b.TweenData.LOOPED=2;b.TweenData.COMPLETE=3;b.TweenData.prototype={to:function(a,b,d,e,f,g){this.vEnd=a;this.duration=b;this.easingFunction=
d;this.delay=e;this.repeatTotal=f;this.yoyo=g;this.isFrom=!1;return this},from:function(a,b,d,e,f,g){this.vEnd=a;this.duration=b;this.easingFunction=d;this.delay=e;this.repeatTotal=f;this.yoyo=g;this.isFrom=!0;return this},start:function(){this.startTime=this.game.time.time+this.delay;this.dt=this.parent.reverse?this.duration:0;this.isRunning=0<this.delay?!1:!0;if(this.isFrom)for(var a in this.vStartCache)this.vStart[a]=this.vEndCache[a],this.vEnd[a]=this.vStartCache[a],this.parent.target[a]=this.vStart[a];
this.yoyoCounter=this.value=0;this.repeatCounter=this.repeatTotal;return this},loadValues:function(){for(var a in this.parent.properties){this.vStart[a]=this.parent.properties[a];if(Array.isArray(this.vEnd[a])){if(0===this.vEnd[a].length)continue;0===this.percent&&(this.vEnd[a]=[this.vStart[a]].concat(this.vEnd[a]))}"undefined"!==typeof this.vEnd[a]?("string"===typeof this.vEnd[a]&&(this.vEnd[a]=this.vStart[a]+parseFloat(this.vEnd[a],10)),this.parent.properties[a]=this.vEnd[a]):this.vEnd[a]=this.vStart[a];
this.vStartCache[a]=this.vStart[a];this.vEndCache[a]=this.vEnd[a]}return this},update:function(a){if(!this.isRunning)if(a>=this.startTime)this.isRunning=!0;else return b.TweenData.PENDING;else if(a<this.startTime)return b.TweenData.RUNNING;a=this.parent.frameBased?this.game.time.physicsElapsedMS:this.game.time.elapsedMS;this.parent.reverse?(this.dt-=a*this.parent.timeScale,this.dt=Math.max(this.dt,0)):(this.dt+=a*this.parent.timeScale,this.dt=Math.min(this.dt,this.duration));this.percent=this.dt/
this.duration;this.value=this.easingFunction(this.percent);for(var c in this.vEnd){a=this.vStart[c];var d=this.vEnd[c];Array.isArray(d)?this.parent.target[c]=this.interpolationFunction.call(this.interpolationContext,d,this.value):this.parent.target[c]=a+(d-a)*this.value}return!this.parent.reverse&&1===this.percent||this.parent.reverse&&0===this.percent?this.repeat():b.TweenData.RUNNING},generateData:function(a){this.dt=this.parent.reverse?this.duration:0;var b=[],d=!1;a=1/a*1E3;do{this.parent.reverse?
(this.dt-=a,this.dt=Math.max(this.dt,0)):(this.dt+=a,this.dt=Math.min(this.dt,this.duration));this.percent=this.dt/this.duration;this.value=this.easingFunction(this.percent);var e={},f;for(f in this.vEnd){var g=this.vStart[f],h=this.vEnd[f];Array.isArray(h)?e[f]=this.interpolationFunction(h,this.value):e[f]=g+(h-g)*this.value}b.push(e);if(!this.parent.reverse&&1===this.percent||this.parent.reverse&&0===this.percent)d=!0}while(!d);this.yoyo&&(d=b.slice(),d.reverse(),b=b.concat(d));return b},repeat:function(){if(this.yoyo){if(this.inReverse&&
0===this.repeatCounter){for(var a in this.vStartCache)this.vStart[a]=this.vStartCache[a],this.vEnd[a]=this.vEndCache[a];this.inReverse=!1;return b.TweenData.COMPLETE}this.inReverse=!this.inReverse}else if(0===this.repeatCounter)return b.TweenData.COMPLETE;if(this.inReverse)for(a in this.vStartCache)this.vStart[a]=this.vEndCache[a],this.vEnd[a]=this.vStartCache[a];else{for(a in this.vStartCache)this.vStart[a]=this.vStartCache[a],this.vEnd[a]=this.vEndCache[a];0<this.repeatCounter&&this.repeatCounter--}this.startTime=
this.game.time.time;this.yoyo&&this.inReverse?this.startTime+=this.yoyoDelay:this.inReverse||(this.startTime+=this.repeatDelay);this.dt=this.parent.reverse?this.duration:0;return b.TweenData.LOOPED}};b.TweenData.prototype.constructor=b.TweenData;b.Easing={Linear:{None:function(a){return a}},Quadratic:{In:function(a){return a*a},Out:function(a){return a*(2-a)},InOut:function(a){return 1>(a*=2)?.5*a*a:-.5*(--a*(a-2)-1)}},Cubic:{In:function(a){return a*a*a},Out:function(a){return--a*a*a+1},InOut:function(a){return 1>
(a*=2)?.5*a*a*a:.5*((a-=2)*a*a+2)}},Quartic:{In:function(a){return a*a*a*a},Out:function(a){return 1- --a*a*a*a},InOut:function(a){return 1>(a*=2)?.5*a*a*a*a:-.5*((a-=2)*a*a*a-2)}},Quintic:{In:function(a){return a*a*a*a*a},Out:function(a){return--a*a*a*a*a+1},InOut:function(a){return 1>(a*=2)?.5*a*a*a*a*a:.5*((a-=2)*a*a*a*a+2)}},Sinusoidal:{In:function(a){return 0===a?0:1===a?1:1-Math.cos(a*Math.PI/2)},Out:function(a){return 0===a?0:1===a?1:Math.sin(a*Math.PI/2)},InOut:function(a){return 0===a?0:
1===a?1:.5*(1-Math.cos(Math.PI*a))}},Exponential:{In:function(a){return 0===a?0:Math.pow(1024,a-1)},Out:function(a){return 1===a?1:1-Math.pow(2,-10*a)},InOut:function(a){return 0===a?0:1===a?1:1>(a*=2)?.5*Math.pow(1024,a-1):.5*(-Math.pow(2,-10*(a-1))+2)}},Circular:{In:function(a){return 1-Math.sqrt(1-a*a)},Out:function(a){return Math.sqrt(1- --a*a)},InOut:function(a){return 1>(a*=2)?-.5*(Math.sqrt(1-a*a)-1):.5*(Math.sqrt(1-(a-=2)*a)+1)}},Elastic:{In:function(a){var b=.1;if(0===a)return 0;if(1===a)return 1;
if(!b||1>b){b=1;var d=.1}else d=.4*Math.asin(1/b)/(2*Math.PI);return-(b*Math.pow(2,10*--a)*Math.sin(2*(a-d)*Math.PI/.4))},Out:function(a){var b=.1;if(0===a)return 0;if(1===a)return 1;if(!b||1>b){b=1;var d=.1}else d=.4*Math.asin(1/b)/(2*Math.PI);return b*Math.pow(2,-10*a)*Math.sin(2*(a-d)*Math.PI/.4)+1},InOut:function(a){var b=.1;if(0===a)return 0;if(1===a)return 1;if(!b||1>b){b=1;var d=.1}else d=.4*Math.asin(1/b)/(2*Math.PI);return 1>(a*=2)?-.5*b*Math.pow(2,10*--a)*Math.sin(2*(a-d)*Math.PI/.4):b*
Math.pow(2,-10*--a)*Math.sin(2*(a-d)*Math.PI/.4)*.5+1}},Back:{In:function(a){return a*a*(2.70158*a-1.70158)},Out:function(a){return--a*a*(2.70158*a+1.70158)+1},InOut:function(a){return 1>(a*=2)?.5*a*a*(3.5949095*a-2.5949095):.5*((a-=2)*a*(3.5949095*a+2.5949095)+2)}},Bounce:{In:function(a){return 1-b.Easing.Bounce.Out(1-a)},Out:function(a){return a<1/2.75?7.5625*a*a:a<2/2.75?7.5625*(a-=1.5/2.75)*a+.75:a<2.5/2.75?7.5625*(a-=2.25/2.75)*a+.9375:7.5625*(a-=2.625/2.75)*a+.984375},InOut:function(a){return.5>
a?.5*b.Easing.Bounce.In(2*a):.5*b.Easing.Bounce.Out(2*a-1)+.5}}};b.Easing.Default=b.Easing.Linear.None;b.Easing.Power0=b.Easing.Linear.None;b.Easing.Power1=b.Easing.Quadratic.Out;b.Easing.Power2=b.Easing.Cubic.Out;b.Easing.Power3=b.Easing.Quartic.Out;b.Easing.Power4=b.Easing.Quintic.Out;b.Time=function(a){this.game=a;this.elapsedMS=this.elapsed=this.now=this.prevTime=this.time=0;this.physicsElapsed=1/60;this.physicsElapsedMS=1/60*1E3;this.desiredFpsMult=1/60;this._desiredFps=60;this.suggestedFps=
this.desiredFps;this.slowMotion=1;this.advancedTiming=!1;this.fps=this.frames=0;this.fpsMin=1E3;this.fpsMax=0;this.msMin=1E3;this.timeExpected=this.timeToCall=this.pauseDuration=this.msMax=0;this.events=new b.Timer(this.game,!1);this._pauseStarted=this._timeLastSecond=this._started=this._elapsedAccumulator=this._frameCount=0;this._justResumed=!1;this._timers=[]};b.Time.prototype={boot:function(){this._started=Date.now();this.time=Date.now();this.events.start();this.timeExpected=this.time},add:function(a){this._timers.push(a);
return a},create:function(a){void 0===a&&(a=!0);a=new b.Timer(this.game,a);this._timers.push(a);return a},removeAll:function(){for(var a=0;a<this._timers.length;a++)this._timers[a].destroy();this._timers=[];this.events.removeAll()},refresh:function(){var a=this.time;this.time=Date.now();this.elapsedMS=this.time-a},update:function(a){var b=this.time;this.time=Date.now();this.elapsedMS=this.time-b;this.prevTime=this.now;this.now=a;this.elapsed=this.now-this.prevTime;this.game.raf._isSetTimeOut&&(this.timeToCall=
Math.floor(Math.max(0,1E3/this._desiredFps-(this.timeExpected-a))),this.timeExpected=a+this.timeToCall);this.advancedTiming&&this.updateAdvancedTiming();this.game.paused||(this.events.update(this.time),this._timers.length&&this.updateTimers())},updateTimers:function(){for(var a=0,b=this._timers.length;a<b;)this._timers[a].update(this.time)?a++:(this._timers.splice(a,1),b--)},updateAdvancedTiming:function(){this._frameCount++;this._elapsedAccumulator+=this.elapsed;this._frameCount>=2*this._desiredFps&&
(this.suggestedFps=5*Math.floor(200/(this._elapsedAccumulator/this._frameCount)),this._elapsedAccumulator=this._frameCount=0);this.msMin=Math.min(this.msMin,this.elapsed);this.msMax=Math.max(this.msMax,this.elapsed);this.frames++;this.now>this._timeLastSecond+1E3&&(this.fps=Math.round(1E3*this.frames/(this.now-this._timeLastSecond)),this.fpsMin=Math.min(this.fpsMin,this.fps),this.fpsMax=Math.max(this.fpsMax,this.fps),this._timeLastSecond=this.now,this.frames=0)},gamePaused:function(){this._pauseStarted=
Date.now();this.events.pause();for(var a=this._timers.length;a--;)this._timers[a]._pause()},gameResumed:function(){this.time=Date.now();this.pauseDuration=this.time-this._pauseStarted;this.events.resume();for(var a=this._timers.length;a--;)this._timers[a]._resume()},totalElapsedSeconds:function(){return.001*(this.time-this._started)},elapsedSince:function(a){return this.time-a},elapsedSecondsSince:function(a){return.001*(this.time-a)},reset:function(){this._started=this.time;this.removeAll()}};Object.defineProperty(b.Time.prototype,
"desiredFps",{get:function(){return this._desiredFps},set:function(a){this._desiredFps=a;this.physicsElapsed=1/a;this.physicsElapsedMS=1E3*this.physicsElapsed;this.desiredFpsMult=1/a}});b.Time.prototype.constructor=b.Time;b.Timer=function(a,c){void 0===c&&(c=!0);this.game=a;this.running=!1;this.autoDestroy=c;this.expired=!1;this.elapsed=0;this.events=[];this.onComplete=new b.Signal;this.nextTick=0;this.timeCap=1E3;this._codePaused=this.paused=!1;this._pauseTotal=this._pauseStarted=this._started=0;
this._now=Date.now();this._newTick=this._diff=this._i=this._marked=this._len=0};b.Timer.MINUTE=6E4;b.Timer.SECOND=1E3;b.Timer.HALF=500;b.Timer.QUARTER=250;b.Timer.prototype={create:function(a,c,d,e,f,g){var k=a=Math.round(a);k=0===this._now?k+this.game.time.time:k+this._now;a=new b.TimerEvent(this,a,k,d,c,e,f,g);this.events.push(a);this.order();this.expired=!1;return a},add:function(a,b,d){return this.create(a,!1,0,b,d,Array.prototype.slice.call(arguments,3))},repeat:function(a,b,d,e){return this.create(a,
!1,b,d,e,Array.prototype.slice.call(arguments,4))},loop:function(a,b,d){return this.create(a,!0,0,b,d,Array.prototype.slice.call(arguments,3))},start:function(a){if(!this.running)for(this._started=this.game.time.time+(a||0),this.running=!0,a=0;a<this.events.length;a++)this.events[a].tick=this.events[a].delay+this._started},stop:function(a){this.running=!1;void 0===a&&(a=!0);a&&(this.events.length=0)},remove:function(a){for(var b=0;b<this.events.length;b++)if(this.events[b]===a)return this.events[b].pendingDelete=
!0;return!1},order:function(){0<this.events.length&&(this.events.sort(this.sortHandler),this.nextTick=this.events[0].tick)},sortHandler:function(a,b){return a.tick<b.tick?-1:a.tick>b.tick?1:0},clearPendingEvents:function(){for(this._i=this.events.length;this._i--;)this.events[this._i].pendingDelete&&this.events.splice(this._i,1);this._len=this.events.length;this._i=0},update:function(a){if(this.paused)return!0;this.elapsed=a-this._now;this._now=a;this.elapsed>this.timeCap&&this.adjustEvents(a-this.elapsed);
this._marked=0;this.clearPendingEvents();if(this.running&&this._now>=this.nextTick&&0<this._len){for(;this._i<this._len&&this.running;)if(this._now>=this.events[this._i].tick&&!this.events[this._i].pendingDelete)this._newTick=this._now+this.events[this._i].delay-(this._now-this.events[this._i].tick),0>this._newTick&&(this._newTick=this._now+this.events[this._i].delay),!0===this.events[this._i].loop?this.events[this._i].tick=this._newTick:0<this.events[this._i].repeatCount?(this.events[this._i].repeatCount--,
this.events[this._i].tick=this._newTick):(this._marked++,this.events[this._i].pendingDelete=!0),this.events[this._i].callback.apply(this.events[this._i].callbackContext,this.events[this._i].args),this._i++;else break;this.events.length>this._marked?this.order():(this.expired=!0,this.onComplete.dispatch(this))}return this.expired&&this.autoDestroy?!1:!0},pause:function(){this.running&&(this._codePaused=!0,this.paused||(this._pauseStarted=this.game.time.time,this.paused=!0))},_pause:function(){!this.paused&&
this.running&&(this._pauseStarted=this.game.time.time,this.paused=!0)},adjustEvents:function(a){for(var b=0;b<this.events.length;b++)if(!this.events[b].pendingDelete){var d=this.events[b].tick-a;0>d&&(d=0);this.events[b].tick=this._now+d}a=this.nextTick-a;this.nextTick=0>a?this._now:this._now+a},resume:function(){if(this.paused){var a=this.game.time.time;this._pauseTotal+=a-this._now;this._now=a;this.adjustEvents(this._pauseStarted);this._codePaused=this.paused=!1}},_resume:function(){this._codePaused||
this.resume()},removeAll:function(){this.onComplete.removeAll();this._i=this._len=this.events.length=0},destroy:function(){this.onComplete.removeAll();this.running=!1;this.events=[];this._i=this._len=0}};Object.defineProperty(b.Timer.prototype,"next",{get:function(){return this.nextTick}});Object.defineProperty(b.Timer.prototype,"duration",{get:function(){return this.running&&this.nextTick>this._now?this.nextTick-this._now:0}});Object.defineProperty(b.Timer.prototype,"length",{get:function(){return this.events.length}});
Object.defineProperty(b.Timer.prototype,"ms",{get:function(){return this.running?this._now-this._started-this._pauseTotal:0}});Object.defineProperty(b.Timer.prototype,"seconds",{get:function(){return this.running?.001*this.ms:0}});b.Timer.prototype.constructor=b.Timer;b.TimerEvent=function(a,b,d,e,f,g,h,l){this.timer=a;this.delay=b;this.tick=d;this.repeatCount=e-1;this.loop=f;this.callback=g;this.callbackContext=h;this.args=l;this.pendingDelete=!1};b.TimerEvent.prototype.constructor=b.TimerEvent;
b.AnimationManager=function(a){this.sprite=a;this.game=a.game;this.currentAnim=this.currentFrame=null;this.updateIfVisible=!0;this.isLoaded=!1;this._frameData=null;this._anims={};this._outputFrames=[]};b.AnimationManager.prototype={loadFrameData:function(a,b){if(void 0===a)return!1;if(this.isLoaded)for(var c in this._anims)this._anims[c].updateFrameData(a);this._frameData=a;void 0===b||null===b?this.frame=0:"string"===typeof b?this.frameName=b:this.frame=b;return this.isLoaded=!0},copyFrameData:function(a,
b){this._frameData=a.clone();if(this.isLoaded)for(var c in this._anims)this._anims[c].updateFrameData(this._frameData);void 0===b||null===b?this.frame=0:"string"===typeof b?this.frameName=b:this.frame=b;return this.isLoaded=!0},add:function(a,c,d,e,f){c=c||[];d=d||60;void 0===e&&(e=!1);void 0===f&&(f=c&&"number"===typeof c[0]?!0:!1);this._outputFrames=[];this._frameData.getFrameIndexes(c,f,this._outputFrames);this._anims[a]=new b.Animation(this.game,this.sprite,a,this._frameData,this._outputFrames,
d,e);this.currentAnim=this._anims[a];this.sprite.tilingTexture&&(this.sprite.refreshTexture=!0);return this._anims[a]},validateFrames:function(a,b){void 0===b&&(b=!0);for(var c=0;c<a.length;c++)if(!0===b){if(a[c]>this._frameData.total)return!1}else if(!1===this._frameData.checkFrameName(a[c]))return!1;return!0},play:function(a,b,d,e){if(this._anims[a]){if(this.currentAnim===this._anims[a])return!1===this.currentAnim.isPlaying?(this.currentAnim.paused=!1,this.currentAnim.play(b,d,e)):this.currentAnim;
this.currentAnim&&this.currentAnim.isPlaying&&this.currentAnim.stop();this.currentAnim=this._anims[a];this.currentAnim.paused=!1;this.currentFrame=this.currentAnim.currentFrame;return this.currentAnim.play(b,d,e)}},stop:function(a,b){void 0===b&&(b=!1);!this.currentAnim||"string"===typeof a&&a!==this.currentAnim.name||this.currentAnim.stop(b)},update:function(){return this.updateIfVisible&&!this.sprite.visible?!1:this.currentAnim&&this.currentAnim.update()?(this.currentFrame=this.currentAnim.currentFrame,
!0):!1},next:function(a){this.currentAnim&&(this.currentAnim.next(a),this.currentFrame=this.currentAnim.currentFrame)},previous:function(a){this.currentAnim&&(this.currentAnim.previous(a),this.currentFrame=this.currentAnim.currentFrame)},getAnimation:function(a){return"string"===typeof a&&this._anims[a]?this._anims[a]:null},refreshFrame:function(){},destroy:function(){var a=null;for(a in this._anims)this._anims.hasOwnProperty(a)&&this._anims[a].destroy();this._anims={};this._outputFrames=[];this.game=
this.sprite=this.currentFrame=this.currentAnim=this._frameData=null}};b.AnimationManager.prototype.constructor=b.AnimationManager;Object.defineProperty(b.AnimationManager.prototype,"frameData",{get:function(){return this._frameData}});Object.defineProperty(b.AnimationManager.prototype,"frameTotal",{get:function(){return this._frameData.total}});Object.defineProperty(b.AnimationManager.prototype,"paused",{get:function(){return this.currentAnim.isPaused},set:function(a){this.currentAnim.paused=a}});
Object.defineProperty(b.AnimationManager.prototype,"name",{get:function(){if(this.currentAnim)return this.currentAnim.name}});Object.defineProperty(b.AnimationManager.prototype,"frame",{get:function(){if(this.currentFrame)return this.currentFrame.index},set:function(a){"number"===typeof a&&this._frameData&&null!==this._frameData.getFrame(a)&&(this.currentFrame=this._frameData.getFrame(a))&&this.sprite.setFrame(this.currentFrame)}});Object.defineProperty(b.AnimationManager.prototype,"frameName",{get:function(){if(this.currentFrame)return this.currentFrame.name},
set:function(a){if("string"===typeof a&&this._frameData&&null!==this._frameData.getFrameByName(a)){if(this.currentFrame=this._frameData.getFrameByName(a))this._frameIndex=this.currentFrame.index,this.sprite.setFrame(this.currentFrame)}else console.warn("Cannot set frameName: "+a)}});b.Animation=function(a,c,d,e,f,g,h){void 0===h&&(h=!1);this.game=a;this._parent=c;this._frameData=e;this.name=d;this._frames=[];this._frames=this._frames.concat(f);this.delay=1E3/g;this.loop=h;this.loopCount=0;this.isPaused=
this.isPlaying=this.isFinished=this.killOnComplete=!1;this._frameDiff=this._frameIndex=this._pauseStartTime=0;this._frameSkip=1;this.currentFrame=this._frameData.getFrame(this._frames[this._frameIndex]);this.onStart=new b.Signal;this.onUpdate=null;this.onComplete=new b.Signal;this.onLoop=new b.Signal;this.isReversed=!1;this.game.onPause.add(this.onPause,this);this.game.onResume.add(this.onResume,this)};b.Animation.prototype={play:function(a,b,d){"number"===typeof a&&(this.delay=1E3/a);"boolean"===
typeof b&&(this.loop=b);"undefined"!==typeof d&&(this.killOnComplete=d);this.isPlaying=!0;this.paused=this.isFinished=!1;this.loopCount=0;this._timeLastFrame=this.game.time.time;this._timeNextFrame=this.game.time.time+this.delay;this._frameIndex=this.isReversed?this._frames.length-1:0;this.updateCurrentFrame(!1,!0);this._parent.events.onAnimationStart$dispatch(this._parent,this);this.onStart.dispatch(this._parent,this);this._parent.animations.currentAnim=this;this._parent.animations.currentFrame=
this.currentFrame;return this},restart:function(){this.isPlaying=!0;this.paused=this.isFinished=!1;this.loopCount=0;this._timeLastFrame=this.game.time.time;this._timeNextFrame=this.game.time.time+this.delay;this._frameIndex=0;this.currentFrame=this._frameData.getFrame(this._frames[this._frameIndex]);this._parent.setFrame(this.currentFrame);this._parent.animations.currentAnim=this;this._parent.animations.currentFrame=this.currentFrame;this.onStart.dispatch(this._parent,this)},reverse:function(){this.reversed=
!this.reversed;return this},reverseOnce:function(){this.onComplete.addOnce(this.reverse,this);return this.reverse()},setFrame:function(a,b){var c;void 0===b&&(b=!1);if("string"===typeof a)for(var e=0;e<this._frames.length;e++)this._frameData.getFrame(this._frames[e]).name===a&&(c=e);else if("number"===typeof a)if(b)c=a;else for(e=0;e<this._frames.length;e++)this._frames[e]===a&&(c=e);c&&(this._frameIndex=c-1,this._timeNextFrame=this.game.time.time,this.update())},stop:function(a,b){void 0===a&&(a=
!1);void 0===b&&(b=!1);this.isPlaying=!1;this.isFinished=!0;this.paused=!1;a&&(this.currentFrame=this._frameData.getFrame(this._frames[0]),this._parent.setFrame(this.currentFrame));b&&(this._parent.events.onAnimationComplete$dispatch(this._parent,this),this.onComplete.dispatch(this._parent,this))},onPause:function(){this.isPlaying&&(this._frameDiff=this._timeNextFrame-this.game.time.time)},onResume:function(){this.isPlaying&&(this._timeNextFrame=this.game.time.time+this._frameDiff)},update:function(){if(this.isPaused)return!1;
if(this.isPlaying&&this.game.time.time>=this._timeNextFrame)if(this._frameSkip=1,this._frameDiff=this.game.time.time-this._timeNextFrame,this._timeLastFrame=this.game.time.time,this._frameDiff>this.delay&&(this._frameSkip=Math.floor(this._frameDiff/this.delay),this._frameDiff-=this._frameSkip*this.delay),this._timeNextFrame=this.game.time.time+(this.delay-this._frameDiff),this._frameIndex=this.isReversed?this._frameIndex-this._frameSkip:this._frameIndex+this._frameSkip,!this.isReversed&&this._frameIndex>=
this._frames.length||this.isReversed&&-1>=this._frameIndex){if(this.loop)return this._frameIndex=Math.abs(this._frameIndex)%this._frames.length,this.isReversed&&(this._frameIndex=this._frames.length-1-this._frameIndex),(this.currentFrame=this._frameData.getFrame(this._frames[this._frameIndex]))&&this._parent.setFrame(this.currentFrame),this.loopCount++,this._parent.events.onAnimationLoop$dispatch(this._parent,this),this.onLoop.dispatch(this._parent,this),this.onUpdate?(this.onUpdate.dispatch(this,
this.currentFrame),!!this._frameData):!0;this.complete()}else return this.updateCurrentFrame(!0);return!1},updateCurrentFrame:function(a,b){void 0===b&&(b=!1);if(!this._frameData)return!1;var c=this.currentFrame.index;(this.currentFrame=this._frameData.getFrame(this._frames[this._frameIndex]))&&(b||!b&&c!==this.currentFrame.index)&&this._parent.setFrame(this.currentFrame);return this.onUpdate&&a?(this.onUpdate.dispatch(this,this.currentFrame),!!this._frameData):!0},next:function(a){void 0===a&&(a=
1);a=this._frameIndex+a;a>=this._frames.length&&(a=this.loop?a%this._frames.length:this._frames.length-1);a!==this._frameIndex&&(this._frameIndex=a,this.updateCurrentFrame(!0))},previous:function(a){void 0===a&&(a=1);a=this._frameIndex-a;0>a&&(this.loop?a=this._frames.length+a:a++);a!==this._frameIndex&&(this._frameIndex=a,this.updateCurrentFrame(!0))},updateFrameData:function(a){this.currentFrame=(this._frameData=a)?this._frameData.getFrame(this._frames[this._frameIndex%this._frames.length]):null},
destroy:function(){this._frameData&&(this.game.onPause.remove(this.onPause,this),this.game.onResume.remove(this.onResume,this),this.currentFrame=this._frameData=this._frames=this._parent=this.game=null,this.isPlaying=!1,this.onStart.dispose(),this.onLoop.dispose(),this.onComplete.dispose(),this.onUpdate&&this.onUpdate.dispose())},complete:function(){this._frameIndex=this._frames.length-1;this.currentFrame=this._frameData.getFrame(this._frames[this._frameIndex]);this.isPlaying=!1;this.isFinished=!0;
this.paused=!1;this._parent.events.onAnimationComplete$dispatch(this._parent,this);this.onComplete.dispatch(this._parent,this);this.killOnComplete&&this._parent.kill()}};b.Animation.prototype.constructor=b.Animation;Object.defineProperty(b.Animation.prototype,"paused",{get:function(){return this.isPaused},set:function(a){(this.isPaused=a)?this._pauseStartTime=this.game.time.time:this.isPlaying&&(this._timeNextFrame=this.game.time.time+this.delay)}});Object.defineProperty(b.Animation.prototype,"reversed",
{get:function(){return this.isReversed},set:function(a){this.isReversed=a}});Object.defineProperty(b.Animation.prototype,"frameTotal",{get:function(){return this._frames.length}});Object.defineProperty(b.Animation.prototype,"frame",{get:function(){return null!==this.currentFrame?this.currentFrame.index:this._frameIndex},set:function(a){this.currentFrame=this._frameData.getFrame(this._frames[a]);null!==this.currentFrame&&(this._frameIndex=a,this._parent.setFrame(this.currentFrame),this.onUpdate&&this.onUpdate.dispatch(this,
this.currentFrame))}});Object.defineProperty(b.Animation.prototype,"speed",{get:function(){return 1E3/this.delay},set:function(a){0<a&&(this.delay=1E3/a)}});Object.defineProperty(b.Animation.prototype,"enableUpdate",{get:function(){return null!==this.onUpdate},set:function(a){a&&null===this.onUpdate?this.onUpdate=new b.Signal:a||null===this.onUpdate||(this.onUpdate.dispose(),this.onUpdate=null)}});b.Animation.generateFrameNames=function(a,c,d,e,f){void 0===e&&(e="");var g=[];if(c<d)for(var k=c;k<=
d;k++)c="number"===typeof f?b.Utils.pad(k.toString(),f,"0",1):k.toString(),c=a+c+e,g.push(c);else for(k=c;k>=d;k--)c="number"===typeof f?b.Utils.pad(k.toString(),f,"0",1):k.toString(),c=a+c+e,g.push(c);return g};b.Frame=function(a,c,d,e,f,g){this.index=a;this.x=c;this.y=d;this.width=e;this.height=f;this.name=g;this.centerX=Math.floor(e/2);this.centerY=Math.floor(f/2);this.distance=b.Math.distance(0,0,e,f);this.rotated=!1;this.rotationDirection="cw";this.trimmed=!1;this.sourceSizeW=e;this.sourceSizeH=
f;this.spriteSourceSizeH=this.spriteSourceSizeW=this.spriteSourceSizeY=this.spriteSourceSizeX=0;this.right=this.x+this.width;this.bottom=this.y+this.height};b.Frame.prototype={resize:function(a,c){this.width=a;this.height=c;this.centerX=Math.floor(a/2);this.centerY=Math.floor(c/2);this.distance=b.Math.distance(0,0,a,c);this.sourceSizeW=a;this.sourceSizeH=c;this.right=this.x+a;this.bottom=this.y+c},setTrim:function(a,b,d,e,f,g,h){if(this.trimmed=a)this.sourceSizeW=b,this.sourceSizeH=d,this.centerX=
Math.floor(b/2),this.centerY=Math.floor(d/2),this.spriteSourceSizeX=e,this.spriteSourceSizeY=f,this.spriteSourceSizeW=g,this.spriteSourceSizeH=h},clone:function(){var a=new b.Frame(this.index,this.x,this.y,this.width,this.height,this.name),c;for(c in this)this.hasOwnProperty(c)&&(a[c]=this[c]);return a},getRect:function(a){void 0===a?a=new b.Rectangle(this.x,this.y,this.width,this.height):a.setTo(this.x,this.y,this.width,this.height);return a}};b.Frame.prototype.constructor=b.Frame;b.FrameData=function(){this._frames=
[];this._frameNames=[]};b.FrameData.prototype={addFrame:function(a){a.index=this._frames.length;this._frames.push(a);""!==a.name&&(this._frameNames[a.name]=a.index);return a},getFrame:function(a){a>=this._frames.length&&(a=0);return this._frames[a]},getFrameByName:function(a){return"number"===typeof this._frameNames[a]?this._frames[this._frameNames[a]]:null},checkFrameName:function(a){return null==this._frameNames[a]?!1:!0},clone:function(){for(var a=new b.FrameData,c=0;c<this._frames.length;c++)a._frames.push(this._frames[c].clone());
for(var d in this._frameNames)this._frameNames.hasOwnProperty(d)&&a._frameNames.push(this._frameNames[d]);return a},getFrameRange:function(a,b,d){for(void 0===d&&(d=[]);a<=b;a++)d.push(this._frames[a]);return d},getFrames:function(a,b,d){void 0===b&&(b=!0);void 0===d&&(d=[]);if(void 0===a||0===a.length)for(var c=0;c<this._frames.length;c++)d.push(this._frames[c]);else for(c=0;c<a.length;c++)b?d.push(this.getFrame(a[c])):d.push(this.getFrameByName(a[c]));return d},getFrameIndexes:function(a,b,d){void 0===
b&&(b=!0);void 0===d&&(d=[]);if(void 0===a||0===a.length)for(var c=0;c<this._frames.length;c++)d.push(this._frames[c].index);else for(c=0;c<a.length;c++)b&&this._frames[a[c]]?d.push(this._frames[a[c]].index):this.getFrameByName(a[c])&&d.push(this.getFrameByName(a[c]).index);return d},destroy:function(){this._frameNames=this._frames=null}};b.FrameData.prototype.constructor=b.FrameData;Object.defineProperty(b.FrameData.prototype,"total",{get:function(){return this._frames.length}});b.AnimationParser=
{spriteSheet:function(a,c,d,e,f,g,h){var k=c;"string"===typeof c&&(k=a.cache.getImage(c));if(null===k)return null;a=k.width;var m=k.height;0>=d&&(d=Math.floor(-a/Math.min(-1,d)));0>=e&&(e=Math.floor(-m/Math.min(-1,e)));k=Math.floor((a-g)/(d+h))*Math.floor((m-g)/(e+h));-1!==f&&(k=f);if(0===a||0===m||a<d||m<e||0===k)return console.warn("Phaser.AnimationParser.spriteSheet: '"+c+"'s width/height zero or width/height < given frameWidth/frameHeight"),null;c=new b.FrameData;m=f=g;for(var l=0;l<k;l++)c.addFrame(new b.Frame(l,
f,m,d,e,"")),f+=d+h,f+d>a&&(f=g,m+=e+h);return c},JSONData:function(a,c){if(c.frames){for(var d=new b.FrameData,e=c.frames,f,g=0;g<e.length;g++)f=d.addFrame(new b.Frame(g,e[g].frame.x,e[g].frame.y,e[g].frame.w,e[g].frame.h,e[g].filename)),e[g].trimmed&&f.setTrim(e[g].trimmed,e[g].sourceSize.w,e[g].sourceSize.h,e[g].spriteSourceSize.x,e[g].spriteSourceSize.y,e[g].spriteSourceSize.w,e[g].spriteSourceSize.h);return d}console.warn("Phaser.AnimationParser.JSONData: Invalid Texture Atlas JSON given, missing 'frames' array");
console.log(c)},JSONDataPyxel:function(a,c){["layers","tilewidth","tileheight","tileswide","tileshigh"].forEach(function(a){c[a]||(console.warn('Phaser.AnimationParser.JSONDataPyxel: Invalid Pyxel Tilemap JSON given, missing "'+a+'" key.'),console.log(c))});if(1!==c.layers.length)console.warn("Phaser.AnimationParser.JSONDataPyxel: Too many layers, this parser only supports flat Tilemaps."),console.log(c);else{for(var d=new b.FrameData,e=c.tileheight,f=c.tilewidth,g=c.layers[0].tiles,h,l=0;l<g.length;l++)h=
d.addFrame(new b.Frame(l,g[l].x,g[l].y,f,e,"frame_"+l)),h.setTrim(!1);return d}},JSONDataHash:function(a,c){if(c.frames){var d=new b.FrameData,e=c.frames,f=0,g;for(g in e){var h=d.addFrame(new b.Frame(f,e[g].frame.x,e[g].frame.y,e[g].frame.w,e[g].frame.h,g));e[g].trimmed&&h.setTrim(e[g].trimmed,e[g].sourceSize.w,e[g].sourceSize.h,e[g].spriteSourceSize.x,e[g].spriteSourceSize.y,e[g].spriteSourceSize.w,e[g].spriteSourceSize.h);f++}return d}console.warn("Phaser.AnimationParser.JSONDataHash: Invalid Texture Atlas JSON given, missing 'frames' object");
console.log(c)},XMLData:function(a,c){if(c.getElementsByTagName("TextureAtlas")){for(var d=new b.FrameData,e=c.getElementsByTagName("SubTexture"),f,g,h,l,n,p,w,q,r,x,y=0;y<e.length;y++)g=e[y].attributes,f=g.name.value,h=parseInt(g.x.value,10),l=parseInt(g.y.value,10),n=parseInt(g.width.value,10),p=parseInt(g.height.value,10),q=w=null,g.frameX&&(w=Math.abs(parseInt(g.frameX.value,10)),q=Math.abs(parseInt(g.frameY.value,10)),r=parseInt(g.frameWidth.value,10),x=parseInt(g.frameHeight.value,10)),f=d.addFrame(new b.Frame(y,
h,l,n,p,f)),null===w&&null===q||f.setTrim(!0,n,p,w,q,r,x);return d}console.warn("Phaser.AnimationParser.XMLData: Invalid Texture Atlas XML given, missing <TextureAtlas> tag")}};b.Cache=function(a){this.game=a;this.autoResolveURL=!1;this._cache={canvas:{},image:{},texture:{},sound:{},video:{},text:{},json:{},xml:{},physics:{},tilemap:{},binary:{},bitmapData:{},bitmapFont:{},shader:{},renderTexture:{}};this._urlMap={};this._urlResolver=new Image;this._urlTemp=null;this.onSoundUnlock=new b.Signal;this._cacheMap=
[];this._cacheMap[b.Cache.CANVAS]=this._cache.canvas;this._cacheMap[b.Cache.IMAGE]=this._cache.image;this._cacheMap[b.Cache.TEXTURE]=this._cache.texture;this._cacheMap[b.Cache.SOUND]=this._cache.sound;this._cacheMap[b.Cache.TEXT]=this._cache.text;this._cacheMap[b.Cache.PHYSICS]=this._cache.physics;this._cacheMap[b.Cache.TILEMAP]=this._cache.tilemap;this._cacheMap[b.Cache.BINARY]=this._cache.binary;this._cacheMap[b.Cache.BITMAPDATA]=this._cache.bitmapData;this._cacheMap[b.Cache.BITMAPFONT]=this._cache.bitmapFont;
this._cacheMap[b.Cache.JSON]=this._cache.json;this._cacheMap[b.Cache.XML]=this._cache.xml;this._cacheMap[b.Cache.VIDEO]=this._cache.video;this._cacheMap[b.Cache.SHADER]=this._cache.shader;this._cacheMap[b.Cache.RENDER_TEXTURE]=this._cache.renderTexture;this.addDefaultImage();this.addMissingImage()};b.Cache.CANVAS=1;b.Cache.IMAGE=2;b.Cache.TEXTURE=3;b.Cache.SOUND=4;b.Cache.TEXT=5;b.Cache.PHYSICS=6;b.Cache.TILEMAP=7;b.Cache.BINARY=8;b.Cache.BITMAPDATA=9;b.Cache.BITMAPFONT=10;b.Cache.JSON=11;b.Cache.XML=
12;b.Cache.VIDEO=13;b.Cache.SHADER=14;b.Cache.RENDER_TEXTURE=15;b.Cache.DEFAULT=null;b.Cache.MISSING=null;b.Cache.prototype={addCanvas:function(a,b,d){void 0===d&&(d=b.getContext("2d"));this._cache.canvas[a]={canvas:b,context:d}},addImage:function(a,c,d){this.checkImageKey(a)&&this.removeImage(a);var e={key:a,url:c,data:d,base:new PIXI.BaseTexture(d),frame:new b.Frame(0,0,0,d.width,d.height,a),frameData:new b.FrameData};e.frameData.addFrame(new b.Frame(0,0,0,d.width,d.height,c));this._cache.image[a]=
e;this._resolveURL(c,e);"__default"===a?b.Cache.DEFAULT=new PIXI.Texture(e.base):"__missing"===a&&(b.Cache.MISSING=new PIXI.Texture(e.base));return e},addDefaultImage:function(){var a=new Image;a.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgAQMAAABJtOi3AAAAA1BMVEX///+nxBvIAAAAAXRSTlMAQObYZgAAABVJREFUeF7NwIEAAAAAgKD9qdeocAMAoAABm3DkcAAAAABJRU5ErkJggg==";a=this.addImage("__default",null,a);a.base.skipRender=!0;b.Cache.DEFAULT=new PIXI.Texture(a.base)},addMissingImage:function(){var a=
new Image;a.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAIAAAD8GO2jAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAJ9JREFUeNq01ssOwyAMRFG46v//Mt1ESmgh+DFmE2GPOBARKb2NVjo+17PXLD8a1+pl5+A+wSgFygymWYHBb0FtsKhJDdZlncG2IzJ4ayoMDv20wTmSMzClEgbWYNTAkQ0Z+OJ+A/eWnAaR9+oxCF4Os0H8htsMUp+pwcgBBiMNnAwF8GqIgL2hAzaGFFgZauDPKABmowZ4GL369/0rwACp2yA/ttmvsQAAAABJRU5ErkJggg==";a=this.addImage("__missing",null,a);b.Cache.MISSING=new PIXI.Texture(a.base)},addSound:function(a,b,d,e,f){void 0===e&&(e=
!0,f=!1);void 0===f&&(e=!1,f=!0);var c=!1;f&&(c=!0);this._cache.sound[a]={url:b,data:d,isDecoding:!1,decoded:c,webAudio:e,audioTag:f,locked:this.game.sound.touchLocked};this._resolveURL(b,this._cache.sound[a])},addText:function(a,b,d){this._cache.text[a]={url:b,data:d};this._resolveURL(b,this._cache.text[a])},addPhysicsData:function(a,b,d,e){this._cache.physics[a]={url:b,data:d,format:e};this._resolveURL(b,this._cache.physics[a])},addTilemap:function(a,b,d,e){this._cache.tilemap[a]={url:b,data:d,
format:e};this._resolveURL(b,this._cache.tilemap[a])},addBinary:function(a,b){this._cache.binary[a]=b},addBitmapData:function(a,c,d){c.key=a;void 0===d&&(d=new b.FrameData,d.addFrame(c.textureFrame));this._cache.bitmapData[a]={data:c,frameData:d};return c},addBitmapFont:function(a,c,d,e,f,g,h){d={url:c,data:d,font:null,base:new PIXI.BaseTexture(d)};void 0===g&&(g=0);void 0===h&&(h=0);d.font="json"===f?b.LoaderParser.jsonBitmapFont(e,d.base,g,h):b.LoaderParser.xmlBitmapFont(e,d.base,g,h);this._cache.bitmapFont[a]=
d;this._resolveURL(c,d)},addJSON:function(a,b,d){this._cache.json[a]={url:b,data:d};this._resolveURL(b,this._cache.json[a])},addXML:function(a,b,d){this._cache.xml[a]={url:b,data:d};this._resolveURL(b,this._cache.xml[a])},addVideo:function(a,b,d,e){this._cache.video[a]={url:b,data:d,isBlob:e,locked:!0};this._resolveURL(b,this._cache.video[a])},addShader:function(a,b,d){this._cache.shader[a]={url:b,data:d};this._resolveURL(b,this._cache.shader[a])},addRenderTexture:function(a,c){this._cache.renderTexture[a]=
{texture:c,frame:new b.Frame(0,0,0,c.width,c.height,"","")}},addSpriteSheet:function(a,c,d,e,f,g,h,l){void 0===g&&(g=-1);void 0===h&&(h=0);void 0===l&&(l=0);d={key:a,url:c,data:d,frameWidth:e,frameHeight:f,margin:h,spacing:l,base:new PIXI.BaseTexture(d),frameData:b.AnimationParser.spriteSheet(this.game,d,e,f,g,h,l)};this._cache.image[a]=d;this._resolveURL(c,d)},addTextureAtlas:function(a,c,d,e,f){d={key:a,url:c,data:d,base:new PIXI.BaseTexture(d)};f===b.Loader.TEXTURE_ATLAS_XML_STARLING?d.frameData=
b.AnimationParser.XMLData(this.game,e,a):f===b.Loader.TEXTURE_ATLAS_JSON_PYXEL?d.frameData=b.AnimationParser.JSONDataPyxel(this.game,e,a):Array.isArray(e.frames)?d.frameData=b.AnimationParser.JSONData(this.game,e,a):d.frameData=b.AnimationParser.JSONDataHash(this.game,e,a);this._cache.image[a]=d;this._resolveURL(c,d)},reloadSound:function(a){var b=this,d=this.getSound(a);d&&(d.data.src=d.url,d.data.addEventListener("canplaythrough",function(){return b.reloadSoundComplete(a)},!1),d.data.load())},reloadSoundComplete:function(a){var b=
this.getSound(a);b&&(b.locked=!1,this.onSoundUnlock.dispatch(a))},updateSound:function(a,b,d){(a=this.getSound(a))&&(a[b]=d)},decodedSound:function(a,b){var c=this.getSound(a);c.data=b;c.decoded=!0;c.isDecoding=!1},isSoundDecoded:function(a){if(a=this.getItem(a,b.Cache.SOUND,"isSoundDecoded"))return a.decoded},isSoundReady:function(a){if(a=this.getItem(a,b.Cache.SOUND,"isSoundDecoded"))return a.decoded&&!this.game.sound.touchLocked},checkKey:function(a,b){return this._cacheMap[a][b]?!0:!1},checkURL:function(a){return this._urlMap[this._resolveURL(a)]?
!0:!1},checkCanvasKey:function(a){return this.checkKey(b.Cache.CANVAS,a)},checkImageKey:function(a){return this.checkKey(b.Cache.IMAGE,a)},checkTextureKey:function(a){return this.checkKey(b.Cache.TEXTURE,a)},checkSoundKey:function(a){return this.checkKey(b.Cache.SOUND,a)},checkTextKey:function(a){return this.checkKey(b.Cache.TEXT,a)},checkPhysicsKey:function(a){return this.checkKey(b.Cache.PHYSICS,a)},checkTilemapKey:function(a){return this.checkKey(b.Cache.TILEMAP,a)},checkBinaryKey:function(a){return this.checkKey(b.Cache.BINARY,
a)},checkBitmapDataKey:function(a){return this.checkKey(b.Cache.BITMAPDATA,a)},checkBitmapFontKey:function(a){return this.checkKey(b.Cache.BITMAPFONT,a)},checkJSONKey:function(a){return this.checkKey(b.Cache.JSON,a)},checkXMLKey:function(a){return this.checkKey(b.Cache.XML,a)},checkVideoKey:function(a){return this.checkKey(b.Cache.VIDEO,a)},checkShaderKey:function(a){return this.checkKey(b.Cache.SHADER,a)},checkRenderTextureKey:function(a){return this.checkKey(b.Cache.RENDER_TEXTURE,a)},getItem:function(a,
b,d,e){if(this.checkKey(b,a))return void 0===e?this._cacheMap[b][a]:this._cacheMap[b][a][e];d&&console.warn("Phaser.Cache."+d+': Key "'+a+'" not found in Cache.');return null},getCanvas:function(a){return this.getItem(a,b.Cache.CANVAS,"getCanvas","canvas")},getImage:function(a,c){if(void 0===a||null===a)a="__default";void 0===c&&(c=!1);var d=this.getItem(a,b.Cache.IMAGE,"getImage");null===d&&(d=this.getItem("__missing",b.Cache.IMAGE,"getImage"));return c?d:d.data},getTextureFrame:function(a){return this.getItem(a,
b.Cache.TEXTURE,"getTextureFrame","frame")},getSound:function(a){return this.getItem(a,b.Cache.SOUND,"getSound")},getSoundData:function(a){return this.getItem(a,b.Cache.SOUND,"getSoundData","data")},getText:function(a){return this.getItem(a,b.Cache.TEXT,"getText","data")},getPhysicsData:function(a,c,d){var e=this.getItem(a,b.Cache.PHYSICS,"getPhysicsData","data");if(null===e||void 0===c||null===c)return e;if(e[c])if((c=e[c])&&d){for(var f in c)if(f=c[f],f.fixtureKey===d)return f;console.warn('Phaser.Cache.getPhysicsData: Could not find given fixtureKey: "'+
d+" in "+a+'"')}else return c;else console.warn('Phaser.Cache.getPhysicsData: Invalid key/object: "'+a+" / "+c+'"');return null},getTilemapData:function(a){return this.getItem(a,b.Cache.TILEMAP,"getTilemapData")},getBinary:function(a){return this.getItem(a,b.Cache.BINARY,"getBinary")},getBitmapData:function(a){return this.getItem(a,b.Cache.BITMAPDATA,"getBitmapData","data")},getBitmapFont:function(a){return this.getItem(a,b.Cache.BITMAPFONT,"getBitmapFont")},getJSON:function(a,c){var d=this.getItem(a,
b.Cache.JSON,"getJSON","data");return d?c?b.Utils.extend(!0,Array.isArray(d)?[]:{},d):d:null},getXML:function(a){return this.getItem(a,b.Cache.XML,"getXML","data")},getVideo:function(a){return this.getItem(a,b.Cache.VIDEO,"getVideo")},getShader:function(a){return this.getItem(a,b.Cache.SHADER,"getShader","data")},getRenderTexture:function(a){return this.getItem(a,b.Cache.RENDER_TEXTURE,"getRenderTexture")},getBaseTexture:function(a,c){void 0===c&&(c=b.Cache.IMAGE);return this.getItem(a,c,"getBaseTexture",
"base")},getFrame:function(a,c){void 0===c&&(c=b.Cache.IMAGE);return this.getItem(a,c,"getFrame","frame")},getFrameCount:function(a,b){var c=this.getFrameData(a,b);return c?c.total:0},getFrameData:function(a,c){void 0===c&&(c=b.Cache.IMAGE);return this.getItem(a,c,"getFrameData","frameData")},hasFrameData:function(a,c){void 0===c&&(c=b.Cache.IMAGE);return null!==this.getItem(a,c,"","frameData")},updateFrameData:function(a,c,d){void 0===d&&(d=b.Cache.IMAGE);this._cacheMap[d][a]&&(this._cacheMap[d][a].frameData=
c)},getFrameByIndex:function(a,b,d){return(a=this.getFrameData(a,d))?a.getFrame(b):null},getFrameByName:function(a,b,d){return(a=this.getFrameData(a,d))?a.getFrameByName(b):null},getURL:function(a){if(a=this._resolveURL(a))return this._urlMap[a];console.warn('Phaser.Cache.getUrl: Invalid url: "'+a+'" or Cache.autoResolveURL was false');return null},getKeys:function(a){void 0===a&&(a=b.Cache.IMAGE);var c=[];if(this._cacheMap[a])for(var d in this._cacheMap[a])"__default"!==d&&"__missing"!==d&&c.push(d);
return c},removeCanvas:function(a){delete this._cache.canvas[a]},removeImage:function(a,b){void 0===b&&(b=!0);var c=this.getImage(a,!0);b&&c.base&&c.base.destroy();delete this._cache.image[a]},removeSound:function(a){delete this._cache.sound[a]},removeText:function(a){delete this._cache.text[a]},removePhysics:function(a){delete this._cache.physics[a]},removeTilemap:function(a){delete this._cache.tilemap[a]},removeBinary:function(a){delete this._cache.binary[a]},removeBitmapData:function(a){delete this._cache.bitmapData[a]},
removeBitmapFont:function(a){delete this._cache.bitmapFont[a]},removeJSON:function(a){delete this._cache.json[a]},removeXML:function(a){delete this._cache.xml[a]},removeVideo:function(a){delete this._cache.video[a]},removeShader:function(a){delete this._cache.shader[a]},removeRenderTexture:function(a){delete this._cache.renderTexture[a]},removeSpriteSheet:function(a){delete this._cache.spriteSheet[a]},removeTextureAtlas:function(a){delete this._cache.atlas[a]},clearGLTextures:function(){for(var a in this._cache.image)this._cache.image[a].base._glTextures=
[]},_resolveURL:function(a,b){if(!this.autoResolveURL)return null;this._urlResolver.src=this.game.load.baseURL+a;this._urlTemp=this._urlResolver.src;this._urlResolver.src="";b&&(this._urlMap[this._urlTemp]=b);return this._urlTemp},destroy:function(){for(var a=0;a<this._cacheMap.length;a++){var b=this._cacheMap[a],d;for(d in b)"__default"!==d&&"__missing"!==d&&(b[d].destroy&&b[d].destroy(),delete b[d])}this._urlTemp=this._urlResolver=this._urlMap=null}};b.Cache.prototype.constructor=b.Cache;b.Loader=
function(a){this.game=a;this.cache=a.cache;this.hasLoaded=this.isLoading=this.resetLocked=!1;this.preloadSprite=null;this.crossOrigin=!1;this.path=this.baseURL="";this.headers={requestedWith:!1,json:"application/json",xml:"application/xml"};this.onLoadStart=new b.Signal;this.onLoadComplete=new b.Signal;this.onPackComplete=new b.Signal;this.onFileStart=new b.Signal;this.onFileComplete=new b.Signal;this.onFileError=new b.Signal;this._warnedAboutXDomainRequest=this.useXDomainRequest=!1;this.enableParallel=
!0;this.maxParallelDownloads=4;this._withSyncPointDepth=0;this._fileList=[];this._flightQueue=[];this._processingHead=0;this._fileLoadStarted=!1;this._loadedFileCount=this._loadedPackCount=this._totalFileCount=this._totalPackCount=0};b.Loader.TEXTURE_ATLAS_JSON_ARRAY=0;b.Loader.TEXTURE_ATLAS_JSON_HASH=1;b.Loader.TEXTURE_ATLAS_XML_STARLING=2;b.Loader.PHYSICS_LIME_CORONA_JSON=3;b.Loader.PHYSICS_PHASER_JSON=4;b.Loader.TEXTURE_ATLAS_JSON_PYXEL=5;b.Loader.prototype={setPreloadSprite:function(a,c){c=c||
0;this.preloadSprite={sprite:a,direction:c,width:a.width,height:a.height,rect:null};this.preloadSprite.rect=0===c?new b.Rectangle(0,0,1,a.height):new b.Rectangle(0,0,a.width,1);a.crop(this.preloadSprite.rect);a.visible=!0},resize:function(){this.preloadSprite&&this.preloadSprite.height!==this.preloadSprite.sprite.height&&(this.preloadSprite.rect.height=this.preloadSprite.sprite.height)},checkKeyExists:function(a,b){return-1<this.getAssetIndex(a,b)},getAssetIndex:function(a,b){for(var c=-1,e=0;e<this._fileList.length;e++){var f=
this._fileList[e];if(f.type===a&&f.key===b&&(c=e,!f.loaded&&!f.loading))break}return c},getAsset:function(a,b){var c=this.getAssetIndex(a,b);return-1<c?{index:c,file:this._fileList[c]}:!1},reset:function(a,b){void 0===b&&(b=!1);this.resetLocked||(a&&(this.preloadSprite=null),this.isLoading=!1,this._processingHead=0,this._fileList.length=0,this._flightQueue.length=0,this._fileLoadStarted=!1,this._loadedFileCount=this._loadedPackCount=this._totalPackCount=this._totalFileCount=0,b&&(this.onLoadStart.removeAll(),
this.onLoadComplete.removeAll(),this.onPackComplete.removeAll(),this.onFileStart.removeAll(),this.onFileComplete.removeAll(),this.onFileError.removeAll()))},addToFileList:function(a,b,d,e,f,g){void 0===f&&(f=!1);if(void 0===b||""===b)return console.warn("Phaser.Loader: Invalid or no key given of type "+a),this;if(void 0===d||null===d)if(g)d=b+g;else return console.warn("Phaser.Loader: No URL given for file type: "+a+" key: "+b),this;d={type:a,key:b,path:this.path,url:d,syncPoint:0<this._withSyncPointDepth,
data:null,loading:!1,loaded:!1,error:!1};if(e)for(var c in e)d[c]=e[c];a=this.getAssetIndex(a,b);f&&-1<a?(f=this._fileList[a],f.loading||f.loaded?(this._fileList.push(d),this._totalFileCount++):this._fileList[a]=d):-1===a&&(this._fileList.push(d),this._totalFileCount++);return this},replaceInFileList:function(a,b,d,e){return this.addToFileList(a,b,d,e,!0)},pack:function(a,b,d,e){void 0===b&&(b=null);void 0===d&&(d=null);void 0===e&&(e=null);if(!b&&!d)return console.warn("Phaser.Loader.pack - Both url and data are null. One must be set."),
this;a={type:"packfile",key:a,url:b,path:this.path,syncPoint:!0,data:null,loading:!1,loaded:!1,error:!1,callbackContext:e};d&&("string"===typeof d&&(d=JSON.parse(d)),a.data=d||{},a.loaded=!0);for(d=0;d<this._fileList.length+1;d++)if(b=this._fileList[d],!b||!b.loaded&&!b.loading&&"packfile"!==b.type){this._fileList.splice(d,0,a);this._totalPackCount++;break}return this},image:function(a,b,d){return this.addToFileList("image",a,b,void 0,d,".png")},images:function(a,b){if(Array.isArray(b))for(var c=
0;c<a.length;c++)this.image(a[c],b[c]);else for(c=0;c<a.length;c++)this.image(a[c]);return this},text:function(a,b,d){return this.addToFileList("text",a,b,void 0,d,".txt")},json:function(a,b,d){return this.addToFileList("json",a,b,void 0,d,".json")},shader:function(a,b,d){return this.addToFileList("shader",a,b,void 0,d,".frag")},xml:function(a,b,d){return this.addToFileList("xml",a,b,void 0,d,".xml")},script:function(a,b,d,e){void 0===d&&(d=!1);!1!==d&&void 0===e&&(e=this);return this.addToFileList("script",
a,b,{syncPoint:!0,callback:d,callbackContext:e},!1,".js")},binary:function(a,b,d,e){void 0===d&&(d=!1);!1!==d&&void 0===e&&(e=d);return this.addToFileList("binary",a,b,{callback:d,callbackContext:e},!1,".bin")},spritesheet:function(a,b,d,e,f,g,h){void 0===f&&(f=-1);void 0===g&&(g=0);void 0===h&&(h=0);return this.addToFileList("spritesheet",a,b,{frameWidth:d,frameHeight:e,frameMax:f,margin:g,spacing:h},!1,".png")},audio:function(a,b,d){if(this.game.sound.noAudio)return this;void 0===d&&(d=!0);"string"===
typeof b&&(b=[b]);return this.addToFileList("audio",a,b,{buffer:null,autoDecode:d})},audioSprite:function(a,b,d,e,f){if(this.game.sound.noAudio)return this;void 0===d&&(d=null);void 0===e&&(e=null);void 0===f&&(f=!0);this.audio(a,b,f);d?this.json(a+"-audioatlas",d):e?("string"===typeof e&&(e=JSON.parse(e)),this.cache.addJSON(a+"-audioatlas","",e)):console.warn("Phaser.Loader.audiosprite - You must specify either a jsonURL or provide a jsonData object");return this},audiosprite:function(a,b,d,e,f){return this.audioSprite(a,
b,d,e,f)},video:function(a,b,d,e){void 0===d&&(d=this.game.device.firefox?"loadeddata":"canplaythrough");void 0===e&&(e=!1);"string"===typeof b&&(b=[b]);return this.addToFileList("video",a,b,{buffer:null,asBlob:e,loadEvent:d})},tilemap:function(a,c,d,e){void 0===c&&(c=null);void 0===d&&(d=null);void 0===e&&(e=b.Tilemap.CSV);c||d||(c=e===b.Tilemap.CSV?a+".csv":a+".json");if(d){switch(e){case b.Tilemap.TILED_JSON:"string"===typeof d&&(d=JSON.parse(d))}this.cache.addTilemap(a,null,d,e)}else this.addToFileList("tilemap",
a,c,{format:e});return this},physics:function(a,c,d,e){void 0===c&&(c=null);void 0===d&&(d=null);void 0===e&&(e=b.Physics.LIME_CORONA_JSON);c||d||(c=a+".json");d?("string"===typeof d&&(d=JSON.parse(d)),this.cache.addPhysicsData(a,null,d,e)):this.addToFileList("physics",a,c,{format:e});return this},bitmapFont:function(a,b,d,e,f,g){if(void 0===b||null===b)b=a+".png";void 0===d&&(d=null);void 0===e&&(e=null);null===d&&null===e&&(d=a+".xml");void 0===f&&(f=0);void 0===g&&(g=0);if(d)this.addToFileList("bitmapfont",
a,b,{atlasURL:d,xSpacing:f,ySpacing:g});else if("string"===typeof e){try{var c=JSON.parse(e)}catch(z){var k=this.parseXml(e)}if(!k&&!c)throw Error("Phaser.Loader. Invalid Bitmap Font atlas given");this.addToFileList("bitmapfont",a,b,{atlasURL:null,atlasData:c||k,atlasType:c?"json":"xml",xSpacing:f,ySpacing:g})}return this},atlasJSONArray:function(a,c,d,e){return this.atlas(a,c,d,e,b.Loader.TEXTURE_ATLAS_JSON_ARRAY)},atlasJSONHash:function(a,c,d,e){return this.atlas(a,c,d,e,b.Loader.TEXTURE_ATLAS_JSON_HASH)},
atlasXML:function(a,c,d,e){void 0===d&&(d=null);void 0===e&&(e=null);d||e||(d=a+".xml");return this.atlas(a,c,d,e,b.Loader.TEXTURE_ATLAS_XML_STARLING)},atlas:function(a,c,d,e,f){if(void 0===c||null===c)c=a+".png";void 0===d&&(d=null);void 0===e&&(e=null);void 0===f&&(f=b.Loader.TEXTURE_ATLAS_JSON_ARRAY);d||e||(d=f===b.Loader.TEXTURE_ATLAS_XML_STARLING?a+".xml":a+".json");if(d)this.addToFileList("textureatlas",a,c,{atlasURL:d,format:f});else{switch(f){case b.Loader.TEXTURE_ATLAS_JSON_ARRAY:"string"===
typeof e&&(e=JSON.parse(e));break;case b.Loader.TEXTURE_ATLAS_XML_STARLING:if("string"===typeof e){d=this.parseXml(e);if(!d)throw Error("Phaser.Loader. Invalid Texture Atlas XML given");e=d}}this.addToFileList("textureatlas",a,c,{atlasURL:null,atlasData:e,format:f})}return this},withSyncPoint:function(a,b){this._withSyncPointDepth++;try{a.call(b||this,this)}finally{this._withSyncPointDepth--}return this},addSyncPoint:function(a,b){var c=this.getAsset(a,b);c&&(c.file.syncPoint=!0);return this},removeFile:function(a,
b){var c=this.getAsset(a,b);c&&(c.loaded||c.loading||this._fileList.splice(c.index,1))},removeAll:function(){this._fileList.length=0;this._flightQueue.length=0},start:function(){this.isLoading||(this.hasLoaded=!1,this.isLoading=!0,this.updateProgress(),this.processLoadQueue())},processLoadQueue:function(){if(this.isLoading){for(var a=0;a<this._flightQueue.length;a++){var c=this._flightQueue[a];if(c.loaded||c.error)this._flightQueue.splice(a,1),a--,c.loading=!1,c.requestUrl=null,c.requestObject=null,
c.error&&this.onFileError.dispatch(c.key,c),"packfile"!==c.type?(this._loadedFileCount++,this.onFileComplete.dispatch(this.progress,c.key,!c.error,this._loadedFileCount,this._totalFileCount)):"packfile"===c.type&&c.error&&(this._loadedPackCount++,this.onPackComplete.dispatch(c.key,!c.error,this._loadedPackCount,this._totalPackCount))}var d=!1,e=this.enableParallel?b.Math.clamp(this.maxParallelDownloads,1,12):1;for(a=this._processingHead;a<this._fileList.length&&!(c=this._fileList[a],"packfile"===
c.type&&!c.error&&c.loaded&&a===this._processingHead&&(this.processPack(c),this._loadedPackCount++,this.onPackComplete.dispatch(c.key,!c.error,this._loadedPackCount,this._totalPackCount)),c.loaded||c.error?a===this._processingHead&&(this._processingHead=a+1):!c.loading&&this._flightQueue.length<e&&("packfile"!==c.type||c.data?d||(this._fileLoadStarted||(this._fileLoadStarted=!0,this.onLoadStart.dispatch()),this._flightQueue.push(c),c.loading=!0,this.onFileStart.dispatch(this.progress,c.key,c.url),
this.loadFile(c)):(this._flightQueue.push(c),c.loading=!0,this.loadFile(c))),!c.loaded&&c.syncPoint&&(d=!0),this._flightQueue.length>=e||d&&this._loadedPackCount===this._totalPackCount);a++);this.updateProgress();if(this._processingHead>=this._fileList.length)this.finishedLoading();else if(!this._flightQueue.length){console.warn("Phaser.Loader - aborting: processing queue empty, loading may have stalled");var f=this;setTimeout(function(){f.finishedLoading(!0)},2E3)}}else console.warn("Phaser.Loader - active loading canceled / reset"),
this.finishedLoading(!0)},finishedLoading:function(a){this.hasLoaded||(this.hasLoaded=!0,this.isLoading=!1,a||this._fileLoadStarted||(this._fileLoadStarted=!0,this.onLoadStart.dispatch()),this.onLoadComplete.dispatch(),this.game.state.loadComplete(),this.reset())},asyncComplete:function(a,b){void 0===b&&(b="");a.loaded=!0;a.error=!!b;b&&(a.errorMessage=b,console.warn("Phaser.Loader - "+a.type+"["+a.key+"]: "+b));this.processLoadQueue()},processPack:function(a){var c=a.data[a.key];if(c)for(var d=0;d<
c.length;d++){var e=c[d];switch(e.type){case "image":this.image(e.key,e.url,e.overwrite);break;case "text":this.text(e.key,e.url,e.overwrite);break;case "json":this.json(e.key,e.url,e.overwrite);break;case "xml":this.xml(e.key,e.url,e.overwrite);break;case "script":this.script(e.key,e.url,e.callback,a.callbackContext||this);break;case "binary":this.binary(e.key,e.url,e.callback,a.callbackContext||this);break;case "spritesheet":this.spritesheet(e.key,e.url,e.frameWidth,e.frameHeight,e.frameMax,e.margin,
e.spacing);break;case "video":this.video(e.key,e.urls);break;case "audio":this.audio(e.key,e.urls,e.autoDecode);break;case "audiosprite":this.audiosprite(e.key,e.urls,e.jsonURL,e.jsonData,e.autoDecode);break;case "tilemap":this.tilemap(e.key,e.url,e.data,b.Tilemap[e.format]);break;case "physics":this.physics(e.key,e.url,e.data,b.Loader[e.format]);break;case "bitmapFont":this.bitmapFont(e.key,e.textureURL,e.atlasURL,e.atlasData,e.xSpacing,e.ySpacing);break;case "atlasJSONArray":this.atlasJSONArray(e.key,
e.textureURL,e.atlasURL,e.atlasData);break;case "atlasJSONHash":this.atlasJSONHash(e.key,e.textureURL,e.atlasURL,e.atlasData);break;case "atlasXML":this.atlasXML(e.key,e.textureURL,e.atlasURL,e.atlasData);break;case "atlas":this.atlas(e.key,e.textureURL,e.atlasURL,e.atlasData,b.Loader[e.format]);break;case "shader":this.shader(e.key,e.url,e.overwrite)}}else console.warn("Phaser.Loader - "+a.key+": pack has data, but not for pack key")},transformUrl:function(a,b){return a?a.match(/^(?:blob:|data:|http:\/\/|https:\/\/|\/\/)/)?
a:this.baseURL+b.path+a:!1},loadFile:function(a){switch(a.type){case "packfile":this.xhrLoad(a,this.transformUrl(a.url,a),"text",this.fileComplete);break;case "image":case "spritesheet":case "textureatlas":case "bitmapfont":this.loadImageTag(a);break;case "audio":a.url=this.getAudioURL(a.url);a.url?this.game.sound.usingWebAudio?this.xhrLoad(a,this.transformUrl(a.url,a),"arraybuffer",this.fileComplete):this.game.sound.usingAudioTag&&this.loadAudioTag(a):this.fileError(a,null,"No supported audio URL specified or device does not have audio playback support");
break;case "video":a.url=this.getVideoURL(a.url);a.url?a.asBlob?this.xhrLoad(a,this.transformUrl(a.url,a),"blob",this.fileComplete):this.loadVideoTag(a):this.fileError(a,null,"No supported video URL specified or device does not have video playback support");break;case "json":this.xhrLoad(a,this.transformUrl(a.url,a),"text",this.jsonLoadComplete);break;case "xml":this.xhrLoad(a,this.transformUrl(a.url,a),"text",this.xmlLoadComplete);break;case "tilemap":a.format===b.Tilemap.TILED_JSON?this.xhrLoad(a,
this.transformUrl(a.url,a),"text",this.jsonLoadComplete):a.format===b.Tilemap.CSV?this.xhrLoad(a,this.transformUrl(a.url,a),"text",this.csvLoadComplete):this.asyncComplete(a,"invalid Tilemap format: "+a.format);break;case "text":case "script":case "shader":case "physics":this.xhrLoad(a,this.transformUrl(a.url,a),"text",this.fileComplete);break;case "binary":this.xhrLoad(a,this.transformUrl(a.url,a),"arraybuffer",this.fileComplete)}},loadImageTag:function(a){var b=this;a.data=new Image;a.data.name=
a.key;this.crossOrigin&&(a.data.crossOrigin=this.crossOrigin);a.data.onload=function(){a.data.onload&&(a.data.onload=null,a.data.onerror=null,b.fileComplete(a))};a.data.onerror=function(){a.data.onload&&(a.data.onload=null,a.data.onerror=null,b.fileError(a))};a.data.src=this.transformUrl(a.url,a);a.data.complete&&a.data.width&&a.data.height&&(a.data.onload=null,a.data.onerror=null,this.fileComplete(a))},loadVideoTag:function(a){var c=this;a.data=document.createElement("video");a.data.name=a.key;a.data.controls=
!1;a.data.autoplay=!1;var d=function(){a.data.removeEventListener(a.loadEvent,d,!1);a.data.onerror=null;a.data.canplay=!0;b.GAMES[c.game.id].load.fileComplete(a)};a.data.onerror=function(){a.data.removeEventListener(a.loadEvent,d,!1);a.data.onerror=null;a.data.canplay=!1;c.fileError(a)};a.data.addEventListener(a.loadEvent,d,!1);a.data.src=this.transformUrl(a.url,a);a.data.load()},loadAudioTag:function(a){var b=this;if(this.game.sound.touchLocked)a.data=new Audio,a.data.name=a.key,a.data.preload="auto",
a.data.src=this.transformUrl(a.url,a),this.fileComplete(a);else{a.data=new Audio;a.data.name=a.key;var d=function(){a.data.removeEventListener("canplaythrough",d,!1);a.data.onerror=null;b.fileComplete(a)};a.data.onerror=function(){a.data.removeEventListener("canplaythrough",d,!1);a.data.onerror=null;b.fileError(a)};a.data.preload="auto";a.data.src=this.transformUrl(a.url,a);a.data.addEventListener("canplaythrough",d,!1);a.data.load()}},xhrLoad:function(a,b,d,e,f){if(this.useXDomainRequest&&window.XDomainRequest)this.xhrLoadWithXDR(a,
b,d,e,f);else{var c=new XMLHttpRequest;c.open("GET",b,!0);c.responseType=d;!1!==this.headers.requestedWith&&c.setRequestHeader("X-Requested-With",this.headers.requestedWith);this.headers[a.type]&&c.setRequestHeader("Accept",this.headers[a.type]);f=f||this.fileError;var g=this;c.onload=function(){try{return 4===c.readyState&&400<=c.status&&599>=c.status?f.call(g,a,c):e.call(g,a,c)}catch(v){g.hasLoaded?window.console&&console.error(v):g.asyncComplete(a,v.message||"Exception")}};c.onerror=function(){try{return f.call(g,
a,c)}catch(v){g.hasLoaded?window.console&&console.error(v):g.asyncComplete(a,v.message||"Exception")}};a.requestObject=c;a.requestUrl=b;c.send()}},xhrLoadWithXDR:function(a,b,d,e,f){this._warnedAboutXDomainRequest||this.game.device.ie&&!(10<=this.game.device.ieVersion)||(this._warnedAboutXDomainRequest=!0,console.warn("Phaser.Loader - using XDomainRequest outside of IE 9"));var c=new window.XDomainRequest;c.open("GET",b,!0);c.responseType=d;c.timeout=3E3;f=f||this.fileError;var g=this;c.onerror=function(){try{return f.call(g,
a,c)}catch(v){g.asyncComplete(a,v.message||"Exception")}};c.ontimeout=function(){try{return f.call(g,a,c)}catch(v){g.asyncComplete(a,v.message||"Exception")}};c.onprogress=function(){};c.onload=function(){try{return 4===c.readyState&&400<=c.status&&599>=c.status?f.call(g,a,c):e.call(g,a,c)}catch(v){g.asyncComplete(a,v.message||"Exception")}};a.requestObject=c;a.requestUrl=b;setTimeout(function(){c.send()},0)},getVideoURL:function(a){for(var b=0;b<a.length;b++){var d=a[b];if(d.uri){var e=d.type;d=
d.uri;if(this.game.device.canPlayVideo(e))return d}else{if(0===d.indexOf("blob:")||0===d.indexOf("data:"))return d;0<=d.indexOf("?")&&(d=d.substr(0,d.indexOf("?")));e=d.substr((Math.max(0,d.lastIndexOf("."))||Infinity)+1).toLowerCase();if(this.game.device.canPlayVideo(e))return a[b]}}return null},getAudioURL:function(a){if(this.game.sound.noAudio)return null;for(var b=0;b<a.length;b++){var d=a[b];if(d.uri){var e=d.type;d=d.uri;if(this.game.device.canPlayAudio(e))return d}else{if(0===d.indexOf("blob:")||
0===d.indexOf("data:"))return d;0<=d.indexOf("?")&&(d=d.substr(0,d.indexOf("?")));e=d.substr((Math.max(0,d.lastIndexOf("."))||Infinity)+1).toLowerCase();if(this.game.device.canPlayAudio(e))return a[b]}}return null},fileError:function(a,b,d){var c="error loading asset from URL "+(a.requestUrl||this.transformUrl(a.url,a));!d&&b&&(d=b.status);d&&(c=c+" ("+d+")");this.asyncComplete(a,c)},fileComplete:function(a,c){var d=!0;switch(a.type){case "packfile":var e=JSON.parse(c.responseText);a.data=e||{};break;
case "image":this.cache.addImage(a.key,a.url,a.data);break;case "spritesheet":this.cache.addSpriteSheet(a.key,a.url,a.data,a.frameWidth,a.frameHeight,a.frameMax,a.margin,a.spacing);break;case "textureatlas":if(null==a.atlasURL)this.cache.addTextureAtlas(a.key,a.url,a.data,a.atlasData,a.format);else if(d=!1,a.format===b.Loader.TEXTURE_ATLAS_JSON_ARRAY||a.format===b.Loader.TEXTURE_ATLAS_JSON_HASH||a.format===b.Loader.TEXTURE_ATLAS_JSON_PYXEL)this.xhrLoad(a,this.transformUrl(a.atlasURL,a),"text",this.jsonLoadComplete);
else if(a.format===b.Loader.TEXTURE_ATLAS_XML_STARLING)this.xhrLoad(a,this.transformUrl(a.atlasURL,a),"text",this.xmlLoadComplete);else throw Error("Phaser.Loader. Invalid Texture Atlas format: "+a.format);break;case "bitmapfont":a.atlasURL?(d=!1,this.xhrLoad(a,this.transformUrl(a.atlasURL,a),"text",function(a,b){try{var c=JSON.parse(b.responseText)}catch(v){}c?(a.atlasType="json",this.jsonLoadComplete(a,b)):(a.atlasType="xml",this.xmlLoadComplete(a,b))})):this.cache.addBitmapFont(a.key,a.url,a.data,
a.atlasData,a.atlasType,a.xSpacing,a.ySpacing);break;case "video":if(a.asBlob)try{a.data=c.response}catch(k){throw Error("Phaser.Loader. Unable to parse video file as Blob: "+a.key);}this.cache.addVideo(a.key,a.url,a.data,a.asBlob);break;case "audio":this.game.sound.usingWebAudio?(a.data=c.response,this.cache.addSound(a.key,a.url,a.data,!0,!1),a.autoDecode&&this.game.sound.decode(a.key)):this.cache.addSound(a.key,a.url,a.data,!1,!0);break;case "text":a.data=c.responseText;this.cache.addText(a.key,
a.url,a.data);break;case "shader":a.data=c.responseText;this.cache.addShader(a.key,a.url,a.data);break;case "physics":e=JSON.parse(c.responseText);this.cache.addPhysicsData(a.key,a.url,e,a.format);break;case "script":a.data=document.createElement("script");a.data.language="javascript";a.data.type="text/javascript";a.data.defer=!1;a.data.text=c.responseText;document.head.appendChild(a.data);a.callback&&(a.data=a.callback.call(a.callbackContext,a.key,c.responseText));break;case "binary":a.data=a.callback?
a.callback.call(a.callbackContext,a.key,c.response):c.response,this.cache.addBinary(a.key,a.data)}d&&this.asyncComplete(a)},jsonLoadComplete:function(a,b){var c=JSON.parse(b.responseText);"tilemap"===a.type?this.cache.addTilemap(a.key,a.url,c,a.format):"bitmapfont"===a.type?this.cache.addBitmapFont(a.key,a.url,a.data,c,a.atlasType,a.xSpacing,a.ySpacing):"json"===a.type?this.cache.addJSON(a.key,a.url,c):this.cache.addTextureAtlas(a.key,a.url,a.data,c,a.format);this.asyncComplete(a)},csvLoadComplete:function(a,
b){this.cache.addTilemap(a.key,a.url,b.responseText,a.format);this.asyncComplete(a)},xmlLoadComplete:function(a,b){var c=this.parseXml(b.responseText);c?("bitmapfont"===a.type?this.cache.addBitmapFont(a.key,a.url,a.data,c,a.atlasType,a.xSpacing,a.ySpacing):"textureatlas"===a.type?this.cache.addTextureAtlas(a.key,a.url,a.data,c,a.format):"xml"===a.type&&this.cache.addXML(a.key,a.url,c),this.asyncComplete(a)):(console.warn("Phaser.Loader - "+a.key+": invalid XML ("+(b.responseType||b.contentType)+")"),
this.asyncComplete(a,"invalid XML"))},parseXml:function(a){try{if(window.DOMParser)var b=(new DOMParser).parseFromString(a,"text/xml");else b=new ActiveXObject("Microsoft.XMLDOM"),b.async="false",b.loadXML(a)}catch(d){b=null}return b&&b.documentElement&&!b.getElementsByTagName("parsererror").length?b:null},updateProgress:function(){this.preloadSprite&&(0===this.preloadSprite.direction?this.preloadSprite.rect.width=Math.floor(this.preloadSprite.width/100*this.progress):this.preloadSprite.rect.height=
Math.floor(this.preloadSprite.height/100*this.progress),this.preloadSprite.sprite?this.preloadSprite.sprite.updateCrop():this.preloadSprite=null)},totalLoadedFiles:function(){return this._loadedFileCount},totalQueuedFiles:function(){return this._totalFileCount-this._loadedFileCount},totalLoadedPacks:function(){return this._totalPackCount},totalQueuedPacks:function(){return this._totalPackCount-this._loadedPackCount}};Object.defineProperty(b.Loader.prototype,"progressFloat",{get:function(){return b.Math.clamp(this._loadedFileCount/
this._totalFileCount*100||0,0,100)}});Object.defineProperty(b.Loader.prototype,"progress",{get:function(){return Math.round(this.progressFloat)}});b.Loader.prototype.constructor=b.Loader;b.LoaderParser={bitmapFont:function(a,b,d,e){return this.xmlBitmapFont(a,b,d,e)},xmlBitmapFont:function(a,b,d,e){var c={},f=a.getElementsByTagName("info")[0],g=a.getElementsByTagName("common")[0];c.font=f.getAttribute("face");c.size=parseInt(f.getAttribute("size"),10);c.lineHeight=parseInt(g.getAttribute("lineHeight"),
10)+e;c.chars={};f=a.getElementsByTagName("char");for(e=0;e<f.length;e++)g=parseInt(f[e].getAttribute("id"),10),c.chars[g]={x:parseInt(f[e].getAttribute("x"),10),y:parseInt(f[e].getAttribute("y"),10),width:parseInt(f[e].getAttribute("width"),10),height:parseInt(f[e].getAttribute("height"),10),xOffset:parseInt(f[e].getAttribute("xoffset"),10),yOffset:parseInt(f[e].getAttribute("yoffset"),10),xAdvance:parseInt(f[e].getAttribute("xadvance"),10)+d,kerning:{}};a=a.getElementsByTagName("kerning");for(e=
0;e<a.length;e++)d=parseInt(a[e].getAttribute("first"),10),f=parseInt(a[e].getAttribute("second"),10),g=parseInt(a[e].getAttribute("amount"),10),c.chars[f].kerning[d]=g;return this.finalizeBitmapFont(b,c)},jsonBitmapFont:function(a,b,d,e){var c={font:a.font.info._face,size:parseInt(a.font.info._size,10),lineHeight:parseInt(a.font.common._lineHeight,10)+e,chars:{}};a.font.chars["char"].forEach(function(a){var b=parseInt(a._id,10);c.chars[b]={x:parseInt(a._x,10),y:parseInt(a._y,10),width:parseInt(a._width,
10),height:parseInt(a._height,10),xOffset:parseInt(a._xoffset,10),yOffset:parseInt(a._yoffset,10),xAdvance:parseInt(a._xadvance,10)+d,kerning:{}}});a.font.kernings&&a.font.kernings.kerning&&a.font.kernings.kerning.forEach(function(a){c.chars[a._second].kerning[a._first]=parseInt(a._amount,10)});return this.finalizeBitmapFont(b,c)},finalizeBitmapFont:function(a,c){Object.keys(c.chars).forEach(function(d){d=c.chars[d];d.texture=new PIXI.Texture(a,new b.Rectangle(d.x,d.y,d.width,d.height))});return c}};
b.AudioSprite=function(a,b){this.game=a;this.key=b;this.config=this.game.cache.getJSON(b+"-audioatlas");this.autoplayKey=null;this.autoplay=!1;this.sounds={};for(var c in this.config.spritemap){var e=this.config.spritemap[c],f=this.game.add.sound(this.key);f.addMarker(c,e.start,e.end-e.start,null,e.loop);this.sounds[c]=f}this.config.autoplay&&(this.autoplayKey=this.config.autoplay,this.play(this.autoplayKey),this.autoplay=this.sounds[this.autoplayKey])};b.AudioSprite.prototype={play:function(a,b){void 0===
b&&(b=1);return this.sounds[a].play(a,null,b)},stop:function(a){if(a)this.sounds[a].stop();else for(var b in this.sounds)this.sounds[b].stop()},get:function(a){return this.sounds[a]}};b.AudioSprite.prototype.constructor=b.AudioSprite;b.Sound=function(a,c,d,e,f){void 0===d&&(d=1);void 0===e&&(e=!1);void 0===f&&(f=a.sound.connectToMaster);this.game=a;this.key=this.name=c;this.loop=e;this.markers={};this.context=null;this.autoplay=!1;this.stopTime=this.position=this.durationMS=this.duration=this.currentTime=
this.startTime=this.totalDuration=0;this.paused=!1;this.pausedTime=this.pausedPosition=0;this.isPlaying=!1;this.currentMarker="";this.fadeTween=null;this.allowMultiple=this.override=this.pendingPlayback=!1;this.usingWebAudio=this.game.sound.usingWebAudio;this.usingAudioTag=this.game.sound.usingAudioTag;this._sound=this.gainNode=this.masterGainNode=this.externalNode=null;this.usingWebAudio?(this.context=this.game.sound.context,this.masterGainNode=this.game.sound.masterGain,this.gainNode=void 0===this.context.createGain?
this.context.createGainNode():this.context.createGain(),this.gainNode.gain.value=d*this.game.sound.volume,f&&this.gainNode.connect(this.masterGainNode)):this.usingAudioTag&&(this.game.cache.getSound(c)&&this.game.cache.isSoundReady(c)?(this._sound=this.game.cache.getSoundData(c),this.totalDuration=0,this._sound.duration&&(this.totalDuration=this._sound.duration)):this.game.cache.onSoundUnlock.add(this.soundHasUnlocked,this));this.onDecoded=new b.Signal;this.onPlay=new b.Signal;this.onPause=new b.Signal;
this.onResume=new b.Signal;this.onLoop=new b.Signal;this.onStop=new b.Signal;this.onMute=new b.Signal;this.onMarkerComplete=new b.Signal;this.onFadeComplete=new b.Signal;this._volume=d;this._buffer=null;this._muted=!1;this._tempLoop=this._muteVolume=this._tempPause=this._tempVolume=this._tempPosition=this._tempMarker=0;this._onDecodedEventDispatched=this._paused=!1};b.Sound.prototype={soundHasUnlocked:function(a){a===this.key&&(this._sound=this.game.cache.getSoundData(this.key),this.totalDuration=
this._sound.duration)},addMarker:function(a,b,d,e,f){if(void 0===d||null===d)d=1;if(void 0===e||null===e)e=1;void 0===f&&(f=!1);this.markers[a]={name:a,start:b,stop:b+d,volume:e,duration:d,durationMS:1E3*d,loop:f}},removeMarker:function(a){delete this.markers[a]},onEndedHandler:function(){this._sound.onended=null;this.isPlaying=!1;this.currentTime=this.durationMS;this.stop()},update:function(){this.game.cache.checkSoundKey(this.key)?(this.isDecoded&&!this._onDecodedEventDispatched&&(this.onDecoded.dispatch(this),
this._onDecodedEventDispatched=!0),this.pendingPlayback&&this.game.cache.isSoundReady(this.key)&&(this.pendingPlayback=!1,this.play(this._tempMarker,this._tempPosition,this._tempVolume,this._tempLoop)),this.isPlaying&&(this.currentTime=this.game.time.time-this.startTime,this.currentTime>=this.durationMS&&(this.usingWebAudio?this.loop?(this.onLoop.dispatch(this),this.isPlaying=!1,""===this.currentMarker?(this.currentTime=0,this.startTime=this.game.time.time,this.isPlaying=!0):(this.onMarkerComplete.dispatch(this.currentMarker,
this),this.play(this.currentMarker,0,this.volume,!0,!0))):""!==this.currentMarker&&this.stop():this.loop?(this.onLoop.dispatch(this),""===this.currentMarker&&(this.currentTime=0,this.startTime=this.game.time.time),this.isPlaying=!1,this.play(this.currentMarker,0,this.volume,!0,!0)):this.stop()))):this.destroy()},loopFull:function(a){return this.play(null,0,a,!0)},play:function(a,b,d,e,f){if(void 0===a||!1===a||null===a)a="";void 0===f&&(f=!0);if(this.isPlaying&&!this.allowMultiple&&!f&&!this.override)return this;
if(this._sound&&this.isPlaying&&!this.allowMultiple&&(this.override||f)){if(this.usingWebAudio){if(void 0===this._sound.stop)this._sound.noteOff(0);else try{this._sound.stop(0)}catch(m){}this.externalNode?this._sound.disconnect(this.externalNode):this.gainNode&&this._sound.disconnect(this.gainNode)}else this.usingAudioTag&&(this._sound.pause(),this._sound.currentTime=0);this.isPlaying=!1}if(""===a&&0<Object.keys(this.markers).length)return this;if(""!==a)if(this.markers[a])this.currentMarker=a,this.position=
this.markers[a].start,this.volume=this.markers[a].volume,this.loop=this.markers[a].loop,this.duration=this.markers[a].duration,this.durationMS=this.markers[a].durationMS,"undefined"!==typeof d&&(this.volume=d),"undefined"!==typeof e&&(this.loop=e),this._tempMarker=a,this._tempPosition=this.position,this._tempVolume=this.volume,this._tempLoop=this.loop;else return console.warn("Phaser.Sound.play: audio marker "+a+" doesn't exist"),this;else b=b||0,void 0===d&&(d=this._volume),void 0===e&&(e=this.loop),
this.position=Math.max(0,b),this.volume=d,this.loop=e,this.durationMS=this.duration=0,this._tempMarker=a,this._tempPosition=b,this._tempVolume=d,this._tempLoop=e;this.usingWebAudio?this.game.cache.isSoundDecoded(this.key)?(this._sound=this.context.createBufferSource(),this.externalNode?this._sound.connect(this.externalNode):this._sound.connect(this.gainNode),this._buffer=this.game.cache.getSoundData(this.key),this._sound.buffer=this._buffer,this.loop&&""===a&&(this._sound.loop=!0),this.loop||""!==
a||(this._sound.onended=this.onEndedHandler.bind(this)),this.totalDuration=this._sound.buffer.duration,0===this.duration&&(this.duration=this.totalDuration,this.durationMS=Math.ceil(1E3*this.totalDuration)),void 0===this._sound.start?this._sound.noteGrainOn(0,this.position,this.duration):this.loop&&""===a?this._sound.start(0,0):this._sound.start(0,this.position,this.duration),this.isPlaying=!0,this.startTime=this.game.time.time,this.currentTime=0,this.stopTime=this.startTime+this.durationMS,this.onPlay.dispatch(this)):
(this.pendingPlayback=!0,this.game.cache.getSound(this.key)&&!1===this.game.cache.getSound(this.key).isDecoding&&this.game.sound.decode(this.key,this)):this.game.cache.getSound(this.key)&&this.game.cache.getSound(this.key).locked?(this.game.cache.reloadSound(this.key),this.pendingPlayback=!0):this._sound&&(this.game.device.cocoonJS||4===this._sound.readyState)?(this._sound.play(),this.totalDuration=this._sound.duration,0===this.duration&&(this.duration=this.totalDuration,this.durationMS=1E3*this.totalDuration),
this._sound.currentTime=this.position,this._sound.muted=this._muted,this._sound.volume=this._muted||this.game.sound.mute?0:this._volume,this.isPlaying=!0,this.startTime=this.game.time.time,this.currentTime=0,this.stopTime=this.startTime+this.durationMS,this.onPlay.dispatch(this)):this.pendingPlayback=!0;return this},restart:function(a,b,d,e){void 0===e&&(e=!1);this.play(a||"",b||0,d||1,e,!0)},pause:function(){this.isPlaying&&this._sound&&(this.paused=!0,this.pausedPosition=this.currentTime,this.pausedTime=
this.game.time.time,this._tempPause=this._sound.currentTime,this.onPause.dispatch(this),this.stop())},resume:function(){if(this.paused&&this._sound){if(this.usingWebAudio){var a=Math.max(0,this.position+this.pausedPosition/1E3);this._sound=this.context.createBufferSource();this._sound.buffer=this._buffer;this.externalNode?this._sound.connect(this.externalNode):this._sound.connect(this.gainNode);this.loop&&(this._sound.loop=!0);this.loop||""!==this.currentMarker||(this._sound.onended=this.onEndedHandler.bind(this));
var b=this.duration-this.pausedPosition/1E3;void 0===this._sound.start?this._sound.noteGrainOn(0,a,b):this.loop&&this.game.device.chrome?42===this.game.device.chromeVersion?this._sound.start(0):this._sound.start(0,a):this._sound.start(0,a,b)}else this._sound.currentTime=this._tempPause,this._sound.play();this.isPlaying=!0;this.paused=!1;this.startTime+=this.game.time.time-this.pausedTime;this.onResume.dispatch(this)}},stop:function(){if(this.isPlaying&&this._sound)if(this.usingWebAudio){if(void 0===
this._sound.stop)this._sound.noteOff(0);else try{this._sound.stop(0)}catch(c){}this.externalNode?this._sound.disconnect(this.externalNode):this.gainNode&&this._sound.disconnect(this.gainNode)}else this.usingAudioTag&&(this._sound.pause(),this._sound.currentTime=0);this.isPlaying=this.pendingPlayback=!1;if(!this.paused){var a=this.currentMarker;""!==this.currentMarker&&this.onMarkerComplete.dispatch(this.currentMarker,this);this.currentMarker="";null!==this.fadeTween&&this.fadeTween.stop();this.onStop.dispatch(this,
a)}},fadeIn:function(a,b,d){void 0===b&&(b=!1);void 0===d&&(d=this.currentMarker);this.paused||(this.play(d,0,0,b),this.fadeTo(a,1))},fadeOut:function(a){this.fadeTo(a,0)},fadeTo:function(a,c){this.isPlaying&&!this.paused&&c!==this.volume&&(void 0===a&&(a=1E3),void 0===c?console.warn("Phaser.Sound.fadeTo: No Volume Specified."):(this.fadeTween=this.game.add.tween(this).to({volume:c},a,b.Easing.Linear.None,!0),this.fadeTween.onComplete.add(this.fadeComplete,this)))},fadeComplete:function(){this.onFadeComplete.dispatch(this,
this.volume);0===this.volume&&this.stop()},updateGlobalVolume:function(a){this.usingAudioTag&&this._sound&&(this._sound.volume=a*this._volume)},destroy:function(a){void 0===a&&(a=!0);this.stop();a?this.game.sound.remove(this):(this.markers={},this.externalNode=this._buffer=this.context=null,this.onDecoded.dispose(),this.onPlay.dispose(),this.onPause.dispose(),this.onResume.dispose(),this.onLoop.dispose(),this.onStop.dispose(),this.onMute.dispose(),this.onMarkerComplete.dispose())}};b.Sound.prototype.constructor=
b.Sound;Object.defineProperty(b.Sound.prototype,"isDecoding",{get:function(){return this.game.cache.getSound(this.key).isDecoding}});Object.defineProperty(b.Sound.prototype,"isDecoded",{get:function(){return this.game.cache.isSoundDecoded(this.key)}});Object.defineProperty(b.Sound.prototype,"mute",{get:function(){return this._muted||this.game.sound.mute},set:function(a){a=a||!1;a!==this._muted&&(a?(this._muted=!0,this._muteVolume=this._tempVolume,this.usingWebAudio?this.gainNode.gain.value=0:this.usingAudioTag&&
this._sound&&(this._sound.volume=0)):(this._muted=!1,this.usingWebAudio?this.gainNode.gain.value=this._muteVolume:this.usingAudioTag&&this._sound&&(this._sound.volume=this._muteVolume)),this.onMute.dispatch(this))}});Object.defineProperty(b.Sound.prototype,"volume",{get:function(){return this._volume},set:function(a){this.game.device.firefox&&this.usingAudioTag&&(a=this.game.math.clamp(a,0,1));this._muted?this._muteVolume=a:(this._volume=this._tempVolume=a,this.usingWebAudio?this.gainNode.gain.value=
a:this.usingAudioTag&&this._sound&&(this._sound.volume=a))}});b.SoundManager=function(a){this.game=a;this.onSoundDecode=new b.Signal;this.onVolumeChange=new b.Signal;this.onMute=new b.Signal;this.onUnMute=new b.Signal;this.context=null;this.noAudio=this.usingAudioTag=this.usingWebAudio=!1;this.connectToMaster=!0;this.touchLocked=!1;this.channels=32;this.muteOnPause=!0;this._muted=this._codeMuted=!1;this._unlockSource=null;this._volume=1;this._sounds=[];this._watchList=new b.ArraySet;this._watching=
!1;this._watchContext=this._watchCallback=null};b.SoundManager.prototype={boot:function(){this.game.device.iOS&&!1===this.game.device.webAudio&&(this.channels=1);if(window.PhaserGlobal){if(!0===window.PhaserGlobal.disableAudio){this.noAudio=!0;this.touchLocked=!1;return}if(!0===window.PhaserGlobal.disableWebAudio){this.usingAudioTag=!0;this.touchLocked=!1;return}}if(window.PhaserGlobal&&window.PhaserGlobal.audioContext)this.context=window.PhaserGlobal.audioContext;else if(window.AudioContext)try{this.context=
new window.AudioContext}catch(a){this.context=null,this.touchLocked=this.usingWebAudio=!1}else if(window.webkitAudioContext)try{this.context=new window.webkitAudioContext}catch(a){this.context=null,this.touchLocked=this.usingWebAudio=!1}if(null===this.context){if(void 0===window.Audio){this.noAudio=!0;return}this.usingAudioTag=!0}else this.usingWebAudio=!0,this.masterGain=void 0===this.context.createGain?this.context.createGainNode():this.context.createGain(),this.masterGain.gain.value=1,this.masterGain.connect(this.context.destination);
this.noAudio||(!this.game.device.cocoonJS&&this.game.device.iOS||window.PhaserGlobal&&window.PhaserGlobal.fakeiOSTouchLock)&&this.setTouchLock()},setTouchLock:function(){this.noAudio||window.PhaserGlobal&&!0===window.PhaserGlobal.disableAudio||(8<this.game.device.iOSVersion?this.game.input.touch.addTouchLockCallback(this.unlock,this,!0):this.game.input.touch.addTouchLockCallback(this.unlock,this),this.touchLocked=!0)},unlock:function(){if(this.noAudio||!this.touchLocked||null!==this._unlockSource)return!0;
if(this.usingAudioTag)this.touchLocked=!1,this._unlockSource=null;else if(this.usingWebAudio){var a=this.context.createBuffer(1,1,22050);this._unlockSource=this.context.createBufferSource();this._unlockSource.buffer=a;this._unlockSource.connect(this.context.destination);void 0===this._unlockSource.start?this._unlockSource.noteOn(0):this._unlockSource.start(0)}return!0},stopAll:function(){if(!this.noAudio)for(var a=0;a<this._sounds.length;a++)this._sounds[a]&&this._sounds[a].stop()},pauseAll:function(){if(!this.noAudio)for(var a=
0;a<this._sounds.length;a++)this._sounds[a]&&this._sounds[a].pause()},resumeAll:function(){if(!this.noAudio)for(var a=0;a<this._sounds.length;a++)this._sounds[a]&&this._sounds[a].resume()},decode:function(a,b){b=b||null;var c=this.game.cache.getSoundData(a);if(c&&!1===this.game.cache.isSoundDecoded(a)){this.game.cache.updateSound(a,"isDecoding",!0);var e=this;try{this.context.decodeAudioData(c,function(c){c&&(e.game.cache.decodedSound(a,c),e.onSoundDecode.dispatch(a,b))})}catch(k){}}},setDecodedCallback:function(a,
c,d){"string"===typeof a&&(a=[a]);this._watchList.reset();for(var e=0;e<a.length;e++)a[e]instanceof b.Sound?this.game.cache.isSoundDecoded(a[e].key)||this._watchList.add(a[e].key):this.game.cache.isSoundDecoded(a[e])||this._watchList.add(a[e]);0===this._watchList.total?(this._watching=!1,c.call(d)):(this._watching=!0,this._watchCallback=c,this._watchContext=d)},update:function(){if(!this.noAudio){!this.touchLocked||null===this._unlockSource||this._unlockSource.playbackState!==this._unlockSource.PLAYING_STATE&&
this._unlockSource.playbackState!==this._unlockSource.FINISHED_STATE||(this.touchLocked=!1,this._unlockSource=null);for(var a=0;a<this._sounds.length;a++)this._sounds[a].update();if(this._watching){for(a=this._watchList.first;a;)this.game.cache.isSoundDecoded(a)&&this._watchList.remove(a),a=this._watchList.next;0===this._watchList.total&&(this._watching=!1,this._watchCallback.call(this._watchContext))}}},add:function(a,c,d,e){void 0===c&&(c=1);void 0===d&&(d=!1);void 0===e&&(e=this.connectToMaster);
a=new b.Sound(this.game,a,c,d,e);this._sounds.push(a);return a},addSprite:function(a){return new b.AudioSprite(this.game,a)},remove:function(a){for(var b=this._sounds.length;b--;)if(this._sounds[b]===a)return this._sounds[b].destroy(!1),this._sounds.splice(b,1),!0;return!1},removeByKey:function(a){for(var b=this._sounds.length,d=0;b--;)this._sounds[b].key===a&&(this._sounds[b].destroy(!1),this._sounds.splice(b,1),d++);return d},play:function(a,b,d){if(!this.noAudio)return a=this.add(a,b,d),a.play(),
a},setMute:function(){if(!this._muted){this._muted=!0;this.usingWebAudio&&(this._muteVolume=this.masterGain.gain.value,this.masterGain.gain.value=0);for(var a=0;a<this._sounds.length;a++)this._sounds[a].usingAudioTag&&(this._sounds[a].mute=!0);this.onMute.dispatch()}},unsetMute:function(){if(this._muted&&!this._codeMuted){this._muted=!1;this.usingWebAudio&&(this.masterGain.gain.value=this._muteVolume);for(var a=0;a<this._sounds.length;a++)this._sounds[a].usingAudioTag&&(this._sounds[a].mute=!1);this.onUnMute.dispatch()}},
destroy:function(){this.stopAll();for(var a=0;a<this._sounds.length;a++)this._sounds[a]&&this._sounds[a].destroy();this._sounds=[];this.onSoundDecode.dispose();this.context&&(window.PhaserGlobal?window.PhaserGlobal.audioContext=this.context:this.context.close&&this.context.close())}};b.SoundManager.prototype.constructor=b.SoundManager;Object.defineProperty(b.SoundManager.prototype,"mute",{get:function(){return this._muted},set:function(a){a?this._muted||(this._codeMuted=!0,this.setMute()):this._muted&&
(this._codeMuted=!1,this.unsetMute())}});Object.defineProperty(b.SoundManager.prototype,"volume",{get:function(){return this._volume},set:function(a){0>a?a=0:1<a&&(a=1);if(this._volume!==a){this._volume=a;if(this.usingWebAudio)this.masterGain.gain.value=a;else for(var b=0;b<this._sounds.length;b++)this._sounds[b].usingAudioTag&&this._sounds[b].updateGlobalVolume(a);this.onVolumeChange.dispatch(a)}}});b.ScaleManager=function(a,c,d){this.MargExtRight=this.MargExtLeft=this.MargExtBottom=this.MargExtTop=
0;this.game=a;this.dom=b.DOM;this.grid=null;this.height=this.width=0;this.maxHeight=this.minHeight=this.maxWidth=this.minWidth=null;this.offset=new b.Point;this._pageAlignVertically=this._pageAlignHorizontally=this.incorrectOrientation=this.forcePortrait=this.forceLandscape=!1;this.onOrientationChange=new b.Signal;this.enterIncorrectOrientation=new b.Signal;this.leaveIncorrectOrientation=new b.Signal;this.hasPhaserSetFullScreen=!1;this._createdFullScreenTarget=this.fullScreenTarget=null;this.onFullScreenInit=
new b.Signal;this.onFullScreenChange=new b.Signal;this.onFullScreenError=new b.Signal;this.screenOrientation=this.dom.getScreenOrientation();this.scaleFactor=new b.Point(1,1);this.scaleFactorInversed=new b.Point(1,1);this.margin={left:0,top:0,right:0,bottom:0,x:0,y:0};this.bounds=new b.Rectangle;this.sourceAspectRatio=this.aspectRatio=0;this.event=null;this.windowConstraints={right:"layout",bottom:""};this.compatibility={supportsFullScreen:!1,orientationFallback:null,noMargins:!1,scrollTo:null,forceMinimumDocumentHeight:!1,
canExpandParent:!0,clickTrampoline:""};this._fullScreenScaleMode=this._scaleMode=b.ScaleManager.NO_SCALE;this.parentIsWindow=!1;this.parentNode=null;this.parentScaleFactor=new b.Point(1,1);this.trackParentInterval=2E3;this.onSizeChange=new b.Signal;this._fullScreenRestore=this._pendingScaleMode=this.onResizeContext=this.onResize=null;this._gameSize=new b.Rectangle;this._userScaleFactor=new b.Point(1,1);this._userScaleTrim=new b.Point(0,0);this._updateThrottle=this._lastUpdate=0;this._updateThrottleReset=
100;this._parentBounds=new b.Rectangle;this._tempBounds=new b.Rectangle;this._lastReportedCanvasSize=new b.Rectangle;this._lastReportedGameSize=new b.Rectangle;this._booted=!1;a.config&&this.parseConfig(a.config);this.setupScale(c,d)};b.ScaleManager.EXACT_FIT=0;b.ScaleManager.NO_SCALE=1;b.ScaleManager.SHOW_ALL=2;b.ScaleManager.RESIZE=3;b.ScaleManager.USER_SCALE=4;b.ScaleManager.prototype={boot:function(){var a=this.compatibility;a.supportsFullScreen=this.game.device.fullscreen&&!this.game.device.cocoonJS;
this.game.device.iPad||this.game.device.webApp||this.game.device.desktop||(a.scrollTo=this.game.device.android&&!this.game.device.chrome?new b.Point(0,1):new b.Point(0,0));this.game.device.desktop?(a.orientationFallback="screen",a.clickTrampoline="when-not-mouse"):(a.orientationFallback="",a.clickTrampoline="");var c=this;this._orientationChange=function(a){return c.orientationChange(a)};this._windowResize=function(a){return c.windowResize(a)};window.addEventListener("orientationchange",this._orientationChange,
!1);window.addEventListener("resize",this._windowResize,!1);this.compatibility.supportsFullScreen&&(this._fullScreenChange=function(a){return c.fullScreenChange(a)},this._fullScreenError=function(a){return c.fullScreenError(a)},document.addEventListener("webkitfullscreenchange",this._fullScreenChange,!1),document.addEventListener("mozfullscreenchange",this._fullScreenChange,!1),document.addEventListener("MSFullscreenChange",this._fullScreenChange,!1),document.addEventListener("fullscreenchange",this._fullScreenChange,
!1),document.addEventListener("webkitfullscreenerror",this._fullScreenError,!1),document.addEventListener("mozfullscreenerror",this._fullScreenError,!1),document.addEventListener("MSFullscreenError",this._fullScreenError,!1),document.addEventListener("fullscreenerror",this._fullScreenError,!1));this.game.onResume.add(this._gameResumed,this);this.dom.getOffset(this.game.canvas,this.offset);this.bounds.setTo(this.offset.x,this.offset.y,this.width,this.height);this.setGameSize(this.game.width,this.game.height);
this.screenOrientation=this.dom.getScreenOrientation(this.compatibility.orientationFallback);b.FlexGrid&&(this.grid=new b.FlexGrid(this,this.width,this.height));this._booted=!0;null!==this._pendingScaleMode&&(this.scaleMode=this._pendingScaleMode,this._pendingScaleMode=null)},parseConfig:function(a){void 0!==a.scaleMode&&(this._booted?this.scaleMode=a.scaleMode:this._pendingScaleMode=a.scaleMode);void 0!==a.fullScreenScaleMode&&(this.fullScreenScaleMode=a.fullScreenScaleMode);a.fullScreenTarget&&
(this.fullScreenTarget=a.fullScreenTarget)},setupScale:function(a,c){var d=new b.Rectangle;if(""!==this.game.parent)if("string"===typeof this.game.parent)var e=document.getElementById(this.game.parent);else this.game.parent&&1===this.game.parent.nodeType&&(e=this.game.parent);e?(this.parentNode=e,this.parentIsWindow=!1,this.getParentBounds(this._parentBounds),d.width=this._parentBounds.width,d.height=this._parentBounds.height,this.offset.set(this._parentBounds.x,this._parentBounds.y)):(this.parentNode=
null,this.parentIsWindow=!0,d.width=this.dom.visualBounds.width,d.height=this.dom.visualBounds.height,this.offset.set(0,0));"number"===typeof a?e=a:(this.parentScaleFactor.x=parseInt(a,10)/100,e=d.width*this.parentScaleFactor.x);"number"===typeof c?d=c:(this.parentScaleFactor.y=parseInt(c,10)/100,d=d.height*this.parentScaleFactor.y);e=Math.floor(e);d=Math.floor(d);this._gameSize.setTo(0,0,e,d);this.updateDimensions(e,d,!1)},_gameResumed:function(){this.queueUpdate(!0)},setGameSize:function(a,c){this._gameSize.setTo(0,
0,a,c);this.currentScaleMode!==b.ScaleManager.RESIZE&&this.updateDimensions(a,c,!0);this.queueUpdate(!0)},setUserScale:function(a,b,d,e){this._userScaleFactor.setTo(a,b);this._userScaleTrim.setTo(d|0,e|0);this.queueUpdate(!0)},setResizeCallback:function(a,b){this.onResize=a;this.onResizeContext=b},signalSizeChange:function(){if(!b.Rectangle.sameDimensions(this,this._lastReportedCanvasSize)||!b.Rectangle.sameDimensions(this.game,this._lastReportedGameSize)){var a=this.width,c=this.height;this._lastReportedCanvasSize.setTo(0,
0,a,c);this._lastReportedGameSize.setTo(0,0,this.game.width,this.game.height);if(this.grid)this.grid.onResize(a,c);this.onSizeChange.dispatch(this,a,c);this.currentScaleMode===b.ScaleManager.RESIZE&&(this.game.state.resize(a,c),this.game.load.resize(a,c))}},setMinMax:function(a,b,d,e){this.minWidth=a;this.minHeight=b;"undefined"!==typeof d&&(this.maxWidth=d);"undefined"!==typeof e&&(this.maxHeight=e)},preUpdate:function(){if(!(this.game.time.time<this._lastUpdate+this._updateThrottle)){var a=this._updateThrottle;
this._updateThrottleReset=400<=a?0:100;this.dom.getOffset(this.game.canvas,this.offset);var c=this._parentBounds.width,d=this._parentBounds.height,e=this.getParentBounds(this._parentBounds);c=e.width!==c||e.height!==d;d=this.updateOrientationState();if(c||d)this.onResize&&this.onResize.call(this.onResizeContext,this,e),this.updateLayout(),this.signalSizeChange();e=2*this._updateThrottle;this._updateThrottle<a&&(e=Math.min(a,this._updateThrottleReset));this._updateThrottle=b.Math.clamp(e,25,this.trackParentInterval);
this._lastUpdate=this.game.time.time}},pauseUpdate:function(){this.preUpdate();this._updateThrottle=this.trackParentInterval},updateDimensions:function(a,b,d){this.width=a*this.parentScaleFactor.x;this.height=b*this.parentScaleFactor.y;this.game.width=this.width;this.game.height=this.height;this.sourceAspectRatio=this.width/this.height;this.updateScalingAndBounds();d&&(this.game.renderer.resize(this.width,this.height),this.game.camera.setSize(this.width,this.height),this.game.world.resize(this.width,
this.height))},updateScalingAndBounds:function(){this.scaleFactor.x=this.game.width/this.width;this.scaleFactor.y=this.game.height/this.height;this.scaleFactorInversed.x=this.width/this.game.width;this.scaleFactorInversed.y=this.height/this.game.height;this.aspectRatio=this.width/this.height;this.game.canvas&&this.dom.getOffset(this.game.canvas,this.offset);this.bounds.setTo(this.offset.x,this.offset.y,this.width,this.height);this.game.input&&this.game.input.scale&&this.game.input.scale.setTo(this.scaleFactor.x,
this.scaleFactor.y)},forceOrientation:function(a,b){void 0===b&&(b=!1);this.forceLandscape=a;this.forcePortrait=b;this.queueUpdate(!0)},classifyOrientation:function(a){return"portrait-primary"===a||"portrait-secondary"===a?"portrait":"landscape-primary"===a||"landscape-secondary"===a?"landscape":null},updateOrientationState:function(){var a=this.screenOrientation,b=this.incorrectOrientation;this.screenOrientation=this.dom.getScreenOrientation(this.compatibility.orientationFallback);this.incorrectOrientation=
this.forceLandscape&&!this.isLandscape||this.forcePortrait&&!this.isPortrait;var d=a!==this.screenOrientation,e=b!==this.incorrectOrientation;e&&(this.incorrectOrientation?this.enterIncorrectOrientation.dispatch():this.leaveIncorrectOrientation.dispatch());(d||e)&&this.onOrientationChange.dispatch(this,a,b);return d||e},orientationChange:function(a){this.event=a;this.queueUpdate(!0)},windowResize:function(a){this.event=a;this.queueUpdate(!0)},scrollTop:function(){var a=this.compatibility.scrollTo;
a&&window.scrollTo(a.x,a.y)},refresh:function(){this.scrollTop();this.queueUpdate(!0)},updateLayout:function(){var a=this.currentScaleMode;a===b.ScaleManager.RESIZE?this.reflowGame():(this.scrollTop(),this.compatibility.forceMinimumDocumentHeight&&(document.documentElement.style.minHeight=window.innerHeight+"px"),this.incorrectOrientation?this.setMaximum():a===b.ScaleManager.EXACT_FIT?this.setExactFit():a===b.ScaleManager.SHOW_ALL?(!this.isFullScreen&&this.boundingParent&&this.compatibility.canExpandParent&&
(this.setShowAll(!0),this.resetCanvas()),this.setShowAll()):a===b.ScaleManager.NO_SCALE?(this.width=this.game.width,this.height=this.game.height):a===b.ScaleManager.USER_SCALE&&(this.width=this.game.width*this._userScaleFactor.x-this._userScaleTrim.x,this.height=this.game.height*this._userScaleFactor.y-this._userScaleTrim.y),this.compatibility.canExpandParent||a!==b.ScaleManager.SHOW_ALL&&a!==b.ScaleManager.USER_SCALE||(a=this.getParentBounds(this._tempBounds),this.width=Math.min(this.width,a.width),
this.height=Math.min(this.height,a.height)),this.width|=0,this.height|=0,this.reflowCanvas())},getParentBounds:function(a){a=a||new b.Rectangle;var c=this.boundingParent,d=this.dom.visualBounds,e=this.dom.layoutBounds;if(c){var f=c.getBoundingClientRect();c=c.offsetParent?c.offsetParent.getBoundingClientRect():c.getBoundingClientRect();a.setTo(f.left-c.left,f.top-c.top,f.width,f.height);f=this.windowConstraints;f.right&&(c="layout"===f.right?e:d,a.right=Math.min(a.right,c.width));f.bottom&&(c="layout"===
f.bottom?e:d,a.bottom=Math.min(a.bottom,c.height))}else a.setTo(0,0,d.width,d.height);a.setTo(Math.round(a.x),Math.round(a.y),Math.round(a.width),Math.round(a.height));return a},setHorizMargins:function(a,b){this.MargExtLeft=a;this.MargExtRight=b},setVertMargins:function(a,b){this.MargExtTop=a;this.MargExtBottom=b},alignCanvas:function(a,b){this.getParentBounds(this._tempBounds);var c=this.game.canvas,e=this.margin;a&&(e.left=this.MargExtLeft,e.right=this.MargExtRight,c.style.marginLeft=e.left+"px",
c.style.marginRight=e.right+"px");b&&(e.top=this.MargExtTop,e.bottom=this.MargExtBottom,c.style.marginTop=e.top+"px",c.style.marginBottom=e.bottom+"px");e.x=e.left;e.y=e.top},reflowGame:function(){this.resetCanvas("","");var a=this.getParentBounds(this._tempBounds);this.updateDimensions(a.width,a.height,!0)},reflowCanvas:function(){this.incorrectOrientation||(this.width=b.Math.clamp(this.width,this.minWidth||0,this.maxWidth||this.width),this.height=b.Math.clamp(this.height,this.minHeight||0,this.maxHeight||
this.height));this.resetCanvas();this.compatibility.noMargins||(this.isFullScreen&&this._createdFullScreenTarget?this.alignCanvas(!0,!0):this.alignCanvas(this.pageAlignHorizontally,this.pageAlignVertically));this.updateScalingAndBounds()},resetCanvas:function(a,b){void 0===a&&(a=this.width+"px");void 0===b&&(b=this.height+"px");var c=this.game.canvas;this.compatibility.noMargins||(c.style.marginLeft="",c.style.marginTop="",c.style.marginRight="",c.style.marginBottom="");c.style.width=a;c.style.height=
b},queueUpdate:function(a){a&&(this._parentBounds.width=0,this._parentBounds.height=0);this._updateThrottle=this._updateThrottleReset},reset:function(a){a&&this.grid&&this.grid.reset()},setMaximum:function(){this.width=this.dom.visualBounds.width;this.height=this.dom.visualBounds.height},setShowAll:function(a){var b=this.getParentBounds(this._tempBounds),d=b.width;b=b.height;a=a?Math.max(b/this.game.height,d/this.game.width):Math.min(b/this.game.height,d/this.game.width);this.width=Math.round(this.game.width*
a);this.height=Math.round(this.game.height*a)},setExactFit:function(){var a=this.getParentBounds(this._tempBounds);this.width=a.width;this.height=a.height;this.isFullScreen||(this.maxWidth&&(this.width=Math.min(this.width,this.maxWidth)),this.maxHeight&&(this.height=Math.min(this.height,this.maxHeight)))},createFullScreenTarget:function(){var a=document.createElement("div");a.style.margin="0";a.style.padding="0";a.style.background="#000";return a},startFullScreen:function(a,c){if(this.isFullScreen)return!1;
if(this.compatibility.supportsFullScreen){if("when-not-mouse"===this.compatibility.clickTrampoline){var d=this.game.input;if(d.activePointer&&d.activePointer!==d.mousePointer&&(c||!1!==c)){d.activePointer.addClickTrampoline("startFullScreen",this.startFullScreen,this,[a,!1]);return}}void 0!==a&&this.game.renderType===b.CANVAS&&(this.game.stage.smoothed=a);d=this.fullScreenTarget;d||(this.cleanupCreatedTarget(),d=this._createdFullScreenTarget=this.createFullScreenTarget());var e={targetElement:d};
this.hasPhaserSetFullScreen=!0;this.onFullScreenInit.dispatch(this,e);this._createdFullScreenTarget&&(e=this.game.canvas,e.parentNode.insertBefore(d,e),d.appendChild(e));if(this.game.device.fullscreenKeyboard)d[this.game.device.requestFullscreen](Element.ALLOW_KEYBOARD_INPUT);else d[this.game.device.requestFullscreen]();return!0}var f=this;setTimeout(function(){f.fullScreenError()},10)},stopFullScreen:function(){if(!this.isFullScreen||!this.compatibility.supportsFullScreen)return!1;this.hasPhaserSetFullScreen=
!1;document[this.game.device.cancelFullscreen]();return!0},cleanupCreatedTarget:function(){var a=this._createdFullScreenTarget;if(a&&a.parentNode){var b=a.parentNode;b.insertBefore(this.game.canvas,a);b.removeChild(a)}this._createdFullScreenTarget=null},prepScreenMode:function(a){var c=!!this._createdFullScreenTarget,d=this._createdFullScreenTarget||this.fullScreenTarget;a?!c&&this.fullScreenScaleMode!==b.ScaleManager.EXACT_FIT||d===this.game.canvas||(this._fullScreenRestore={targetWidth:d.style.width,
targetHeight:d.style.height},d.style.width="100%",d.style.height="100%"):(this._fullScreenRestore&&(d.style.width=this._fullScreenRestore.targetWidth,d.style.height=this._fullScreenRestore.targetHeight,this._fullScreenRestore=null),this.updateDimensions(this._gameSize.width,this._gameSize.height,!0),this.resetCanvas())},fullScreenChange:function(a){this.event=a;this.isFullScreen?this.prepScreenMode(!0):(this.prepScreenMode(!1),this.cleanupCreatedTarget());this.updateLayout();this.queueUpdate(!0);
this.onFullScreenChange.dispatch(this,this.width,this.height)},fullScreenError:function(a){this.event=a;this.cleanupCreatedTarget();console.warn("Phaser.ScaleManager: requestFullscreen failed or device does not support the Fullscreen API");this.onFullScreenError.dispatch(this)},scaleSprite:function(a,b,d,e){void 0===b&&(b=this.width);void 0===d&&(d=this.height);void 0===e&&(e=!1);if(!a||!a.scale)return a;a.scale.x=1;a.scale.y=1;if(0>=a.width||0>=a.height||0>=b||0>=d)return a;var c=a.height*b/a.width,
f=a.width*d/a.height;(f>b?e:!e)?(a.width=Math.floor(b),a.height=Math.floor(c)):(a.width=Math.floor(f),a.height=Math.floor(d));return a},destroy:function(){this.game.onResume.remove(this._gameResumed,this);window.removeEventListener("orientationchange",this._orientationChange,!1);window.removeEventListener("resize",this._windowResize,!1);this.compatibility.supportsFullScreen&&(document.removeEventListener("webkitfullscreenchange",this._fullScreenChange,!1),document.removeEventListener("mozfullscreenchange",
this._fullScreenChange,!1),document.removeEventListener("MSFullscreenChange",this._fullScreenChange,!1),document.removeEventListener("fullscreenchange",this._fullScreenChange,!1),document.removeEventListener("webkitfullscreenerror",this._fullScreenError,!1),document.removeEventListener("mozfullscreenerror",this._fullScreenError,!1),document.removeEventListener("MSFullscreenError",this._fullScreenError,!1),document.removeEventListener("fullscreenerror",this._fullScreenError,!1))}};b.ScaleManager.prototype.constructor=
b.ScaleManager;Object.defineProperty(b.ScaleManager.prototype,"boundingParent",{get:function(){return this.parentIsWindow||this.isFullScreen&&this.hasPhaserSetFullScreen&&!this._createdFullScreenTarget?null:this.game.canvas&&this.game.canvas.parentNode||null}});Object.defineProperty(b.ScaleManager.prototype,"scaleMode",{get:function(){return this._scaleMode},set:function(a){a!==this._scaleMode&&(this.isFullScreen||(this.updateDimensions(this._gameSize.width,this._gameSize.height,!0),this.queueUpdate(!0)),
this._scaleMode=a);return this._scaleMode}});Object.defineProperty(b.ScaleManager.prototype,"fullScreenScaleMode",{get:function(){return this._fullScreenScaleMode},set:function(a){a!==this._fullScreenScaleMode&&(this.isFullScreen?(this.prepScreenMode(!1),this._fullScreenScaleMode=a,this.prepScreenMode(!0),this.queueUpdate(!0)):this._fullScreenScaleMode=a);return this._fullScreenScaleMode}});Object.defineProperty(b.ScaleManager.prototype,"currentScaleMode",{get:function(){return this.isFullScreen?
this._fullScreenScaleMode:this._scaleMode}});Object.defineProperty(b.ScaleManager.prototype,"pageAlignHorizontally",{get:function(){return this._pageAlignHorizontally},set:function(a){a!==this._pageAlignHorizontally&&(this._pageAlignHorizontally=a,this.queueUpdate(!0))}});Object.defineProperty(b.ScaleManager.prototype,"pageAlignVertically",{get:function(){return this._pageAlignVertically},set:function(a){a!==this._pageAlignVertically&&(this._pageAlignVertically=a,this.queueUpdate(!0))}});Object.defineProperty(b.ScaleManager.prototype,
"isFullScreen",{get:function(){return!!(document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement)}});Object.defineProperty(b.ScaleManager.prototype,"isPortrait",{get:function(){return"portrait"===this.classifyOrientation(this.screenOrientation)}});Object.defineProperty(b.ScaleManager.prototype,"isLandscape",{get:function(){return"landscape"===this.classifyOrientation(this.screenOrientation)}});Object.defineProperty(b.ScaleManager.prototype,
"isGamePortrait",{get:function(){return this.height>this.width}});Object.defineProperty(b.ScaleManager.prototype,"isGameLandscape",{get:function(){return this.width>this.height}});b.Utils.Debug=function(a){this.game=a;this.context=this.canvas=this.bmd=this.sprite=null;this.font="14px Courier";this.columnWidth=100;this.lineHeight=16;this.renderShadow=!0;this.currentY=this.currentX=0;this.currentAlpha=1;this.dirty=!1};b.Utils.Debug.prototype={boot:function(){this.game.renderType===b.CANVAS?this.context=
this.game.context:(this.bmd=new b.BitmapData(this.game,"__DEBUG",this.game.width,this.game.height,!0),this.sprite=this.game.make.image(0,0,this.bmd),this.game.stage.addChild(this.sprite),this.game.scale.onSizeChange.add(this.resize,this),this.canvas=PIXI.CanvasPool.create(this,this.game.width,this.game.height),this.context=this.canvas.getContext("2d"))},resize:function(a,b,d){this.bmd.resize(b,d);this.canvas.width=b;this.canvas.height=d},preUpdate:function(){this.dirty&&this.sprite&&(this.bmd.clear(),
this.bmd.draw(this.canvas,0,0),this.context.clearRect(0,0,this.game.width,this.game.height),this.dirty=!1)},reset:function(){this.context&&this.context.clearRect(0,0,this.game.width,this.game.height);this.sprite&&this.bmd.clear()},start:function(a,b,d,e){"number"!==typeof a&&(a=0);"number"!==typeof b&&(b=0);d=d||"rgb(255,255,255)";void 0===e&&(e=0);this.currentX=a;this.currentY=b;this.currentColor=d;this.columnWidth=e;this.dirty=!0;this.context.save();this.context.setTransform(1,0,0,1,0,0);this.context.strokeStyle=
d;this.context.fillStyle=d;this.context.font=this.font;this.context.globalAlpha=this.currentAlpha},stop:function(){this.context.restore()},line:function(){for(var a=this.currentX,b=0;b<arguments.length;b++)this.renderShadow&&(this.context.fillStyle="rgb(0,0,0)",this.context.fillText(arguments[b],a+1,this.currentY+1),this.context.fillStyle=this.currentColor),this.context.fillText(arguments[b],a,this.currentY),a+=this.columnWidth;this.currentY+=this.lineHeight},soundInfo:function(a,b,d,e){this.start(b,
d,e);this.line("Sound: "+a.key+" Locked: "+a.game.sound.touchLocked);this.line("Is Ready?: "+this.game.cache.isSoundReady(a.key)+" Pending Playback: "+a.pendingPlayback);this.line("Decoded: "+a.isDecoded+" Decoding: "+a.isDecoding);this.line("Total Duration: "+a.totalDuration+" Playing: "+a.isPlaying);this.line("Time: "+a.currentTime);this.line("Volume: "+a.volume+" Muted: "+a.mute);this.line("WebAudio: "+a.usingWebAudio+" Audio: "+a.usingAudioTag);""!==a.currentMarker&&(this.line("Marker: "+a.currentMarker+
" Duration: "+a.duration+" (ms: "+a.durationMS+")"),this.line("Start: "+a.markers[a.currentMarker].start+" Stop: "+a.markers[a.currentMarker].stop),this.line("Position: "+a.position));this.stop()},cameraInfo:function(a,b,d,e){this.start(b,d,e);this.line("Camera ("+a.width+" x "+a.height+")");this.line("X: "+a.x+" Y: "+a.y);a.bounds&&this.line("Bounds x: "+a.bounds.x+" Y: "+a.bounds.y+" w: "+a.bounds.width+" h: "+a.bounds.height);this.line("View x: "+a.view.x+" Y: "+a.view.y+" w: "+a.view.width+" h: "+
a.view.height);this.line("Total in view: "+a.totalInView);this.stop()},timer:function(a,b,d,e){this.start(b,d,e);this.line("Timer (running: "+a.running+" expired: "+a.expired+")");this.line("Next Tick: "+a.next+" Duration: "+a.duration);this.line("Paused: "+a.paused+" Length: "+a.length);this.stop()},pointer:function(a,b,d,e,f){null!=a&&(void 0===b&&(b=!1),d=d||"rgba(0,255,0,0.5)",e=e||"rgba(255,0,0,0.5)",!0!==b||!0!==a.isUp)&&(this.start(a.x,a.y-100,f),this.context.beginPath(),this.context.arc(a.x,
a.y,a.circle.radius,0,2*Math.PI),this.context.fillStyle=a.active?d:e,this.context.fill(),this.context.closePath(),this.context.beginPath(),this.context.moveTo(a.positionDown.x,a.positionDown.y),this.context.lineTo(a.position.x,a.position.y),this.context.lineWidth=2,this.context.stroke(),this.context.closePath(),this.line("ID: "+a.id+" Active: "+a.active),this.line("World X: "+a.worldX+" World Y: "+a.worldY),this.line("Screen X: "+a.x+" Screen Y: "+a.y+" In: "+a.withinGame),this.line("Duration: "+
a.duration+" ms"),this.line("is Down: "+a.isDown+" is Up: "+a.isUp),this.stop())},spriteInputInfo:function(a,b,d,e){this.start(b,d,e);this.line("Sprite Input: ("+a.width+" x "+a.height+")");this.line("x: "+a.input.pointerX().toFixed(1)+" y: "+a.input.pointerY().toFixed(1));this.line("over: "+a.input.pointerOver()+" duration: "+a.input.overDuration().toFixed(0));this.line("down: "+a.input.pointerDown()+" duration: "+a.input.downDuration().toFixed(0));this.line("just over: "+a.input.justOver()+" just out: "+
a.input.justOut());this.stop()},key:function(a,b,d,e){this.start(b,d,e,150);this.line("Key:",a.keyCode,"isDown:",a.isDown);this.line("justDown:",a.justDown,"justUp:",a.justUp);this.line("Time Down:",a.timeDown.toFixed(0),"duration:",a.duration.toFixed(0));this.stop()},inputInfo:function(a,b,d){this.start(a,b,d);this.line("Input");this.line("X: "+this.game.input.x+" Y: "+this.game.input.y);this.line("World X: "+this.game.input.worldX+" World Y: "+this.game.input.worldY);this.line("Scale X: "+this.game.input.scale.x.toFixed(1)+
" Scale Y: "+this.game.input.scale.x.toFixed(1));this.line("Screen X: "+this.game.input.activePointer.screenX+" Screen Y: "+this.game.input.activePointer.screenY);this.stop()},spriteBounds:function(a,b,d){a=a.getBounds();a.x+=this.game.camera.x;a.y+=this.game.camera.y;this.rectangle(a,b,d)},ropeSegments:function(a,b,d){var c=this;a.segments.forEach(function(a){c.rectangle(a,b,d)},this)},spriteInfo:function(a,b,d,e){this.start(b,d,e);this.line("Sprite:  ("+a.width+" x "+a.height+") anchor: "+a.anchor.x+
" x "+a.anchor.y);this.line("x: "+a.x.toFixed(1)+" y: "+a.y.toFixed(1));this.line("angle: "+a.angle.toFixed(1)+" rotation: "+a.rotation.toFixed(1));this.line("visible: "+a.visible+" in camera: "+a.inCamera);this.line("bounds x: "+a._bounds.x.toFixed(1)+" y: "+a._bounds.y.toFixed(1)+" w: "+a._bounds.width.toFixed(1)+" h: "+a._bounds.height.toFixed(1));this.stop()},spriteCoords:function(a,b,d,e){this.start(b,d,e,100);a.name&&this.line(a.name);this.line("x:",a.x.toFixed(2),"y:",a.y.toFixed(2));this.line("pos x:",
a.position.x.toFixed(2),"pos y:",a.position.y.toFixed(2));this.line("world x:",a.world.x.toFixed(2),"world y:",a.world.y.toFixed(2));this.stop()},lineInfo:function(a,b,d,e){this.start(b,d,e,80);this.line("start.x:",a.start.x.toFixed(2),"start.y:",a.start.y.toFixed(2));this.line("end.x:",a.end.x.toFixed(2),"end.y:",a.end.y.toFixed(2));this.line("length:",a.length.toFixed(2),"angle:",a.angle);this.stop()},pixel:function(a,b,d,e){e=e||2;this.start();this.context.fillStyle=d;this.context.fillRect(a,b,
e,e);this.stop()},geom:function(a,c,d,e){void 0===d&&(d=!0);void 0===e&&(e=0);c=c||"rgba(0,255,0,0.4)";this.start();this.context.fillStyle=c;this.context.strokeStyle=c;if(a instanceof b.Rectangle||1===e)d?this.context.fillRect(a.x-this.game.camera.x,a.y-this.game.camera.y,a.width,a.height):this.context.strokeRect(a.x-this.game.camera.x,a.y-this.game.camera.y,a.width,a.height);else if(a instanceof b.Circle||2===e)this.context.beginPath(),this.context.arc(a.x-this.game.camera.x,a.y-this.game.camera.y,
a.radius,0,2*Math.PI,!1),this.context.closePath(),d?this.context.fill():this.context.stroke();else if(a instanceof b.Point||3===e)this.context.fillRect(a.x-this.game.camera.x,a.y-this.game.camera.y,4,4);else if(a instanceof b.Line||4===e)this.context.lineWidth=1,this.context.beginPath(),this.context.moveTo(a.start.x+.5-this.game.camera.x,a.start.y+.5-this.game.camera.y),this.context.lineTo(a.end.x+.5-this.game.camera.x,a.end.y+.5-this.game.camera.y),this.context.closePath(),this.context.stroke();
this.stop()},rectangle:function(a,b,d){void 0===d&&(d=!0);b=b||"rgba(0, 255, 0, 0.4)";this.start();d?(this.context.fillStyle=b,this.context.fillRect(a.x-this.game.camera.x,a.y-this.game.camera.y,a.width,a.height)):(this.context.strokeStyle=b,this.context.strokeRect(a.x-this.game.camera.x,a.y-this.game.camera.y,a.width,a.height));this.stop()},text:function(a,b,d,e,f){e=e||"rgb(255,255,255)";f=f||"16px Courier";this.start();this.context.font=f;this.renderShadow&&(this.context.fillStyle="rgb(0,0,0)",
this.context.fillText(a,b+1,d+1));this.context.fillStyle=e;this.context.fillText(a,b,d);this.stop()},quadTree:function(a,b){b=b||"rgba(255,0,0,0.3)";this.start();var c=a.bounds;if(0===a.nodes.length)for(this.context.strokeStyle=b,this.context.strokeRect(c.x,c.y,c.width,c.height),this.text("size: "+a.objects.length,c.x+4,c.y+16,"rgb(0,200,0)","12px Courier"),this.context.strokeStyle="rgb(0,255,0)",c=0;c<a.objects.length;c++)this.context.strokeRect(a.objects[c].x,a.objects[c].y,a.objects[c].width,a.objects[c].height);
else for(c=0;c<a.nodes.length;c++)this.quadTree(a.nodes[c]);this.stop()},body:function(a,c,d){a.body&&(this.start(),a.body.type===b.Physics.ARCADE?b.Physics.Arcade.Body.render(this.context,a.body,c,d):a.body.type===b.Physics.NINJA?b.Physics.Ninja.Body.render(this.context,a.body,c,d):a.body.type===b.Physics.BOX2D&&b.Physics.Box2D.renderBody(this.context,a.body,c),this.stop())},bodyInfo:function(a,c,d,e){a.body&&(this.start(c,d,e,210),a.body.type===b.Physics.ARCADE?b.Physics.Arcade.Body.renderBodyInfo(this,
a.body):a.body.type===b.Physics.BOX2D&&this.game.physics.box2d.renderBodyInfo(this,a.body),this.stop())},box2dWorld:function(){this.start();this.context.translate(-this.game.camera.view.x,-this.game.camera.view.y,0);this.game.physics.box2d.renderDebugDraw(this.context);this.stop()},box2dBody:function(a,c){this.start();b.Physics.Box2D.renderBody(this.context,a,c);this.stop()},displayList:function(a){void 0===a&&(a=this.game.world);a.hasOwnProperty("renderOrderID")?console.log("["+a.renderOrderID+"]",
a):console.log("[]",a);if(a.children&&0<a.children.length)for(var b=0;b<a.children.length;b++)this.game.debug.displayList(a.children[b])},destroy:function(){PIXI.CanvasPool.remove(this)}};b.Utils.Debug.prototype.constructor=b.Utils.Debug;b.DOM={getOffset:function(a,c){c=c||new b.Point;var d=a.getBoundingClientRect(),e=b.DOM.scrollY,f=document.documentElement.clientTop;c.x=d.left+b.DOM.scrollX-document.documentElement.clientLeft;c.y=d.top+e-f;return c},getBounds:function(a,b){void 0===b&&(b=0);return(a=
a&&!a.nodeType?a[0]:a)&&1===a.nodeType?this.calibrate(a.getBoundingClientRect(),b):!1},calibrate:function(a,b){b=+b||0;var c={width:0,height:0,left:0,right:0,top:0,bottom:0};c.width=(c.right=a.right+b)-(c.left=a.left-b);c.height=(c.bottom=a.bottom+b)-(c.top=a.top-b);return c},getAspectRatio:function(a){a=null==a?this.visualBounds:1===a.nodeType?this.getBounds(a):a;var b=a.width,d=a.height;"function"===typeof b&&(b=b.call(a));"function"===typeof d&&(d=d.call(a));return b/d},inLayoutViewport:function(a,
b){var c=this.getBounds(a,b);return!!c&&0<=c.bottom&&0<=c.right&&c.top<=this.layoutBounds.width&&c.left<=this.layoutBounds.height},getScreenOrientation:function(a){var b=window.screen,d=b.orientation||b.mozOrientation||b.msOrientation;if(d&&"string"===typeof d.type)return d.type;if("string"===typeof d)return d;if("screen"===a)return b.height>b.width?"portrait-primary":"landscape-primary";if("viewport"!==a){if("window.orientation"===a&&"number"===typeof window.orientation)return 0===window.orientation||
180===window.orientation?"portrait-primary":"landscape-primary";if(window.matchMedia){if(window.matchMedia("(orientation: portrait)").matches)return"portrait-primary";if(window.matchMedia("(orientation: landscape)").matches)return"landscape-primary"}}return this.visualBounds.height>this.visualBounds.width?"portrait-primary":"landscape-primary"},visualBounds:new b.Rectangle,layoutBounds:new b.Rectangle,documentBounds:new b.Rectangle};b.Device.whenReady(function(a){var c=window&&"pageXOffset"in window?
function(){return window.pageXOffset}:function(){return document.documentElement.scrollLeft},d=window&&"pageYOffset"in window?function(){return window.pageYOffset}:function(){return document.documentElement.scrollTop};Object.defineProperty(b.DOM,"scrollX",{get:c});Object.defineProperty(b.DOM,"scrollY",{get:d});Object.defineProperty(b.DOM.visualBounds,"x",{get:c});Object.defineProperty(b.DOM.visualBounds,"y",{get:d});Object.defineProperty(b.DOM.layoutBounds,"x",{value:0});Object.defineProperty(b.DOM.layoutBounds,
"y",{value:0});a.desktop&&document.documentElement.clientWidth<=window.innerWidth&&document.documentElement.clientHeight<=window.innerHeight?(a=function(){return Math.max(window.innerWidth,document.documentElement.clientWidth)},c=function(){return Math.max(window.innerHeight,document.documentElement.clientHeight)},Object.defineProperty(b.DOM.visualBounds,"width",{get:a}),Object.defineProperty(b.DOM.visualBounds,"height",{get:c}),Object.defineProperty(b.DOM.layoutBounds,"width",{get:a}),Object.defineProperty(b.DOM.layoutBounds,
"height",{get:c})):(Object.defineProperty(b.DOM.visualBounds,"width",{get:function(){return window.innerWidth}}),Object.defineProperty(b.DOM.visualBounds,"height",{get:function(){return window.innerHeight}}),Object.defineProperty(b.DOM.layoutBounds,"width",{get:function(){var a=document.documentElement.clientWidth,b=window.innerWidth;return a<b?b:a}}),Object.defineProperty(b.DOM.layoutBounds,"height",{get:function(){var a=document.documentElement.clientHeight,b=window.innerHeight;return a<b?b:a}}));
Object.defineProperty(b.DOM.documentBounds,"x",{value:0});Object.defineProperty(b.DOM.documentBounds,"y",{value:0});Object.defineProperty(b.DOM.documentBounds,"width",{get:function(){var a=document.documentElement;return Math.max(a.clientWidth,a.offsetWidth,a.scrollWidth)}});Object.defineProperty(b.DOM.documentBounds,"height",{get:function(){var a=document.documentElement;return Math.max(a.clientHeight,a.offsetHeight,a.scrollHeight)}})},null,!0);b.ArraySet=function(a){this.position=0;this.list=a||
[]};b.ArraySet.prototype={add:function(a){this.exists(a)||this.list.push(a);return a},getIndex:function(a){return this.list.indexOf(a)},getByKey:function(a,b){for(var c=this.list.length;c--;)if(this.list[c][a]===b)return this.list[c];return null},exists:function(a){return-1<this.list.indexOf(a)},reset:function(){this.list.length=0},remove:function(a){var b=this.list.indexOf(a);if(-1<b)return this.list.splice(b,1),a},setAll:function(a,b){for(var c=this.list.length;c--;)this.list[c]&&(this.list[c][a]=
b)},callAll:function(a){for(var b=Array.prototype.slice.call(arguments,1),d=this.list.length;d--;)this.list[d]&&this.list[d][a]&&this.list[d][a].apply(this.list[d],b)},removeAll:function(a){void 0===a&&(a=!1);for(var b=this.list.length;b--;)if(this.list[b]){var d=this.remove(this.list[b]);a&&d.destroy()}this.position=0;this.list=[]}};Object.defineProperty(b.ArraySet.prototype,"total",{get:function(){return this.list.length}});Object.defineProperty(b.ArraySet.prototype,"first",{get:function(){this.position=
0;return 0<this.list.length?this.list[0]:null}});Object.defineProperty(b.ArraySet.prototype,"next",{get:function(){return this.position<this.list.length?(this.position++,this.list[this.position]):null}});b.ArraySet.prototype.constructor=b.ArraySet;b.ArrayUtils={getRandomItem:function(a,b,d){if(null===a)return null;void 0===b&&(b=0);void 0===d&&(d=a.length);b+=Math.floor(Math.random()*d);return void 0===a[b]?null:a[b]},removeRandomItem:function(a,b,d){if(null==a)return null;void 0===b&&(b=0);void 0===
d&&(d=a.length);b+=Math.floor(Math.random()*d);return b<a.length?(a=a.splice(b,1),void 0===a[0]?null:a[0]):null},shuffle:function(a){for(var b=a.length-1;0<b;b--){var d=Math.floor(Math.random()*(b+1)),e=a[b];a[b]=a[d];a[d]=e}return a},transposeMatrix:function(a){for(var b=a.length,d=a[0].length,e=Array(d),f=0;f<d;f++){e[f]=Array(b);for(var g=b-1;-1<g;g--)e[f][g]=a[g][f]}return e},rotateMatrix:function(a,c){"string"!==typeof c&&(c=(c%360+360)%360);if(90===c||-270===c||"rotateLeft"===c)a=b.ArrayUtils.transposeMatrix(a),
a=a.reverse();else if(-90===c||270===c||"rotateRight"===c)a=a.reverse(),a=b.ArrayUtils.transposeMatrix(a);else if(180===Math.abs(c)||"rotate180"===c){for(var d=0;d<a.length;d++)a[d].reverse();a=a.reverse()}return a},findClosest:function(a,b){if(!b.length)return NaN;if(1===b.length||a<b[0])return b[0];for(var c=1;b[c]<a;)c++;var e=b[c-1];c=c<b.length?b[c]:Number.POSITIVE_INFINITY;return c-a<=a-e?c:e},rotateRight:function(a){var b=a.pop();a.unshift(b);return b},rotateLeft:function(a){var b=a.shift();
a.push(b);return b},rotate:function(a){var b=a.shift();a.push(b);return b},numberArray:function(a,b){for(var c=[],e=a;e<=b;e++)c.push(e);return c},numberArrayStep:function(a,c,d){if(void 0===a||null===a)a=0;if(void 0===c||null===c)c=a,a=0;void 0===d&&(d=1);var e=[];c=Math.max(b.Math.roundAwayFromZero((c-a)/(d||1)),0);for(var f=0;f<c;f++)e.push(a),a+=d;return e}};b.LinkedList=function(){this.last=this.first=this.prev=this.next=null;this.total=0};b.LinkedList.prototype={add:function(a){if(0===this.total&&
null===this.first&&null===this.last)return this.next=this.last=this.first=a,a.prev=this,this.total++,a;this.last.next=a;a.prev=this.last;this.last=a;this.total++;return a},reset:function(){this.prev=this.next=this.last=this.first=null;this.total=0},remove:function(a){1===this.total?(this.reset(),a.next=a.prev=null):(a===this.first?this.first=this.first.next:a===this.last&&(this.last=this.last.prev),a.prev&&(a.prev.next=a.next),a.next&&(a.next.prev=a.prev),a.next=a.prev=null,null===this.first&&(this.last=
null),this.total--)},callAll:function(a){if(this.first&&this.last){var b=this.first;do b&&b[a]&&b[a].call(b),b=b.next;while(b!==this.last.next)}}};b.LinkedList.prototype.constructor=b.LinkedList;b.Create=function(a){this.game=a;this.ctx=this.canvas=this.bmd=null;this.palettes=[{0:"#000",1:"#9D9D9D",2:"#FFF",3:"#BE2633",4:"#E06F8B",5:"#493C2B",6:"#A46422",7:"#EB8931",8:"#F7E26B",9:"#2F484E",A:"#44891A",B:"#A3CE27",C:"#1B2632",D:"#005784",E:"#31A2F2",F:"#B2DCEF"},{0:"#000",1:"#191028",2:"#46af45",3:"#a1d685",
4:"#453e78",5:"#7664fe",6:"#833129",7:"#9ec2e8",8:"#dc534b",9:"#e18d79",A:"#d6b97b",B:"#e9d8a1",C:"#216c4b",D:"#d365c8",E:"#afaab9",F:"#f5f4eb"},{0:"#000",1:"#2234d1",2:"#0c7e45",3:"#44aacc",4:"#8a3622",5:"#5c2e78",6:"#aa5c3d",7:"#b5b5b5",8:"#5e606e",9:"#4c81fb",A:"#6cd947",B:"#7be2f9",C:"#eb8a60",D:"#e23d69",E:"#ffd93f",F:"#fff"},{0:"#000",1:"#fff",2:"#8b4131",3:"#7bbdc5",4:"#8b41ac",5:"#6aac41",6:"#3931a4",7:"#d5de73",8:"#945a20",9:"#5a4100",A:"#bd736a",B:"#525252",C:"#838383",D:"#acee8b",E:"#7b73de",
F:"#acacac"},{0:"#000",1:"#191028",2:"#46af45",3:"#a1d685",4:"#453e78",5:"#7664fe",6:"#833129",7:"#9ec2e8",8:"#dc534b",9:"#e18d79",A:"#d6b97b",B:"#e9d8a1",C:"#216c4b",D:"#d365c8",E:"#afaab9",F:"#fff"}]};b.Create.PALETTE_ARNE=0;b.Create.PALETTE_JMP=1;b.Create.PALETTE_CGA=2;b.Create.PALETTE_C64=3;b.Create.PALETTE_JAPANESE_MACHINE=4;b.Create.prototype={texture:function(a,b,d,e,f){void 0===d&&(d=8);void 0===e&&(e=d);void 0===f&&(f=0);var c=b[0].length*d,g=b.length*e;null===this.bmd&&(this.bmd=this.game.make.bitmapData(),
this.canvas=this.bmd.canvas,this.ctx=this.bmd.context);this.bmd.resize(c,g);this.bmd.clear();for(c=0;c<b.length;c++){g=b[c];for(var h=0;h<g.length;h++){var k=g[h];"."!==k&&" "!==k&&(this.ctx.fillStyle=this.palettes[f][k],this.ctx.fillRect(h*d,c*e,d,e))}}return this.bmd.generateTexture(a)},grid:function(a,b,d,e,f,g){null===this.bmd&&(this.bmd=this.game.make.bitmapData(),this.canvas=this.bmd.canvas,this.ctx=this.bmd.context);this.bmd.resize(b,d);this.ctx.fillStyle=g;for(g=0;g<d;g+=f)this.ctx.fillRect(0,
g,b,1);for(f=0;f<b;f+=e)this.ctx.fillRect(f,0,1,d);return this.bmd.generateTexture(a)}};b.Create.prototype.constructor=b.Create;b.FlexGrid=function(a,c,d){this.game=a.game;this.manager=a;this.width=c;this.height=d;this.boundsCustom=new b.Rectangle(0,0,c,d);this.boundsFluid=new b.Rectangle(0,0,c,d);this.boundsFull=new b.Rectangle(0,0,c,d);this.boundsNone=new b.Rectangle(0,0,c,d);this.positionCustom=new b.Point(0,0);this.positionFluid=new b.Point(0,0);this.positionFull=new b.Point(0,0);this.positionNone=
new b.Point(0,0);this.scaleCustom=new b.Point(1,1);this.scaleFluid=new b.Point(1,1);this.scaleFluidInversed=new b.Point(1,1);this.scaleFull=new b.Point(1,1);this.scaleNone=new b.Point(1,1);this.customOffsetY=this.customOffsetX=this.customHeight=this.customWidth=0;this.ratioH=c/d;this.ratioV=d/c;this.multiplier=0;this.layers=[]};b.FlexGrid.prototype={setSize:function(a,c){this.width=a;this.height=c;this.ratioH=a/c;this.ratioV=c/a;this.scaleNone=new b.Point(1,1);this.boundsNone.width=this.width;this.boundsNone.height=
this.height;this.refresh()},createCustomLayer:function(a,c,d,e){void 0===e&&(e=!0);this.customWidth=a;this.customHeight=c;this.boundsCustom.width=a;this.boundsCustom.height=c;a=new b.FlexLayer(this,this.positionCustom,this.boundsCustom,this.scaleCustom);e&&this.game.world.add(a);this.layers.push(a);"undefined"!==typeof d&&a.addMultiple(d);return a},createFluidLayer:function(a,c){void 0===c&&(c=!0);var d=new b.FlexLayer(this,this.positionFluid,this.boundsFluid,this.scaleFluid);c&&this.game.world.add(d);
this.layers.push(d);"undefined"!==typeof a&&d.addMultiple(a);return d},createFullLayer:function(a){var c=new b.FlexLayer(this,this.positionFull,this.boundsFull,this.scaleFluid);this.game.world.add(c);this.layers.push(c);"undefined"!==typeof a&&c.addMultiple(a);return c},createFixedLayer:function(a){var c=new b.FlexLayer(this,this.positionNone,this.boundsNone,this.scaleNone);this.game.world.add(c);this.layers.push(c);"undefined"!==typeof a&&c.addMultiple(a);return c},reset:function(){for(var a=this.layers.length;a--;)this.layers[a].persist||
(this.layers[a].position=null,this.layers[a].scale=null,this.layers.slice(a,1))},onResize:function(a,b){this.ratioH=a/b;this.ratioV=b/a;this.refresh(a,b)},refresh:function(){this.multiplier=Math.min(this.manager.height/this.height,this.manager.width/this.width);this.boundsFluid.width=Math.round(this.width*this.multiplier);this.boundsFluid.height=Math.round(this.height*this.multiplier);this.scaleFluid.set(this.boundsFluid.width/this.width,this.boundsFluid.height/this.height);this.scaleFluidInversed.set(this.width/
this.boundsFluid.width,this.height/this.boundsFluid.height);this.scaleFull.set(this.boundsFull.width/this.width,this.boundsFull.height/this.height);this.boundsFull.width=Math.round(this.manager.width*this.scaleFluidInversed.x);this.boundsFull.height=Math.round(this.manager.height*this.scaleFluidInversed.y);this.boundsFluid.centerOn(this.manager.bounds.centerX,this.manager.bounds.centerY);this.boundsNone.centerOn(this.manager.bounds.centerX,this.manager.bounds.centerY);this.positionFluid.set(this.boundsFluid.x,
this.boundsFluid.y);this.positionNone.set(this.boundsNone.x,this.boundsNone.y)},fitSprite:function(a){this.manager.scaleSprite(a);a.x=this.manager.bounds.centerX;a.y=this.manager.bounds.centerY},debug:function(){this.game.debug.text(this.boundsFluid.width+" x "+this.boundsFluid.height,this.boundsFluid.x+4,this.boundsFluid.y+16);this.game.debug.geom(this.boundsFluid,"rgba(255,0,0,0.9",!1)}};b.FlexGrid.prototype.constructor=b.FlexGrid;b.FlexLayer=function(a,c,d,e){b.Group.call(this,a.game,null,"__flexLayer"+
a.game.rnd.uuid(),!1);this.manager=a.manager;this.grid=a;this.persist=!1;this.position=c;this.bounds=d;this.scale=e;this.topLeft=d.topLeft;this.topMiddle=new b.Point(d.halfWidth,0);this.topRight=d.topRight;this.bottomLeft=d.bottomLeft;this.bottomMiddle=new b.Point(d.halfWidth,d.bottom);this.bottomRight=d.bottomRight};b.FlexLayer.prototype=Object.create(b.Group.prototype);b.FlexLayer.prototype.constructor=b.FlexLayer;b.FlexLayer.prototype.resize=function(){};b.FlexLayer.prototype.debug=function(){this.game.debug.text(this.bounds.width+
" x "+this.bounds.height,this.bounds.x+4,this.bounds.y+16);this.game.debug.geom(this.bounds,"rgba(0,0,255,0.9",!1);this.game.debug.geom(this.topLeft,"rgba(255,255,255,0.9");this.game.debug.geom(this.topMiddle,"rgba(255,255,255,0.9");this.game.debug.geom(this.topRight,"rgba(255,255,255,0.9")};b.Color={packPixel:function(a,c,d,e){return b.Device.LITTLE_ENDIAN?(e<<24|d<<16|c<<8|a)>>>0:(a<<24|c<<16|d<<8|e)>>>0},unpackPixel:function(a,c,d,e){if(void 0===c||null===c)c=b.Color.createColor();if(void 0===
d||null===d)d=!1;if(void 0===e||null===e)e=!1;b.Device.LITTLE_ENDIAN?(c.a=(a&4278190080)>>>24,c.b=(a&16711680)>>>16,c.g=(a&65280)>>>8,c.r=a&255):(c.r=(a&4278190080)>>>24,c.g=(a&16711680)>>>16,c.b=(a&65280)>>>8,c.a=a&255);c.color=a;c.rgba="rgba("+c.r+","+c.g+","+c.b+","+c.a/255+")";d&&b.Color.RGBtoHSL(c.r,c.g,c.b,c);e&&b.Color.RGBtoHSV(c.r,c.g,c.b,c);return c},fromRGBA:function(a,c){c||(c=b.Color.createColor());c.r=(a&4278190080)>>>24;c.g=(a&16711680)>>>16;c.b=(a&65280)>>>8;c.a=a&255;c.rgba="rgba("+
c.r+","+c.g+","+c.b+","+c.a+")";return c},toRGBA:function(a,b,d,e){return a<<24|b<<16|d<<8|e},toABGR:function(a,b,d,e){return(e<<24|d<<16|b<<8|a)>>>0},RGBtoHSL:function(a,c,d,e){e||(e=b.Color.createColor(a,c,d,1));a/=255;c/=255;d/=255;var f=Math.min(a,c,d),g=Math.max(a,c,d);e.h=0;e.s=0;e.l=(g+f)/2;if(g!==f){var h=g-f;e.s=.5<e.l?h/(2-g-f):h/(g+f);g===a?e.h=(c-d)/h+(c<d?6:0):g===c?e.h=(d-a)/h+2:g===d&&(e.h=(a-c)/h+4);e.h/=6}return e},HSLtoRGB:function(a,c,d,e){e?(e.r=d,e.g=d,e.b=d):e=b.Color.createColor(d,
d,d);0!==c&&(c=.5>d?d*(1+c):d+c-d*c,d=2*d-c,e.r=b.Color.hueToColor(d,c,a+1/3),e.g=b.Color.hueToColor(d,c,a),e.b=b.Color.hueToColor(d,c,a-1/3));e.r=Math.floor(255*e.r|0);e.g=Math.floor(255*e.g|0);e.b=Math.floor(255*e.b|0);b.Color.updateColor(e);return e},RGBtoHSV:function(a,c,d,e){e||(e=b.Color.createColor(a,c,d,255));a/=255;c/=255;d/=255;var f=Math.min(a,c,d),g=Math.max(a,c,d),h=g-f;e.h=0;e.s=0===g?0:h/g;e.v=g;g!==f&&(g===a?e.h=(c-d)/h+(c<d?6:0):g===c?e.h=(d-a)/h+2:g===d&&(e.h=(a-c)/h+4),e.h/=6);
return e},HSVtoRGB:function(a,c,d,e){void 0===e&&(e=b.Color.createColor(0,0,0,1,a,c,0,d));var f=Math.floor(6*a),g=6*a-f;a=d*(1-c);var h=d*(1-g*c);c=d*(1-(1-g)*c);switch(f%6){case 0:var l=d;var n=c;var p=a;break;case 1:l=h;n=d;p=a;break;case 2:l=a;n=d;p=c;break;case 3:l=a;n=h;p=d;break;case 4:l=c;n=a;p=d;break;case 5:l=d,n=a,p=h}e.r=Math.floor(255*l);e.g=Math.floor(255*n);e.b=Math.floor(255*p);b.Color.updateColor(e);return e},hueToColor:function(a,b,d){0>d&&(d+=1);1<d&&--d;return d<1/6?a+6*(b-a)*d:
.5>d?b:d<2/3?a+(b-a)*(2/3-d)*6:a},createColor:function(a,c,d,e,f,g,h,l){return b.Color.updateColor({r:a||0,g:c||0,b:d||0,a:e||1,h:f||0,s:g||0,l:h||0,v:l||0,color:0,color32:0,rgba:""})},updateColor:function(a){a.rgba="rgba("+a.r.toString()+","+a.g.toString()+","+a.b.toString()+","+a.a.toString()+")";a.color=b.Color.getColor(a.r,a.g,a.b);a.color32=b.Color.getColor32(255*a.a,a.r,a.g,a.b);return a},getColor32:function(a,b,d,e){return a<<24|b<<16|d<<8|e},getColor:function(a,b,d){return a<<16|b<<8|d},RGBtoString:function(a,
c,d,e,f){void 0===e&&(e=255);void 0===f&&(f="#");return"#"===f?"#"+(16777216+(a<<16)+(c<<8)+d).toString(16).slice(1):"0x"+b.Color.componentToHex(e)+b.Color.componentToHex(a)+b.Color.componentToHex(c)+b.Color.componentToHex(d)},hexToRGB:function(a){if(a=b.Color.hexToColor(a))return b.Color.getColor32(a.a,a.r,a.g,a.b)},hexToColor:function(a,c){a=a.replace(/^(?:#|0x)?([a-f\d])([a-f\d])([a-f\d])$/i,function(a,b,c,d){return b+b+c+c+d+d});var d=/^(?:#|0x)?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(a);
if(d){var e=parseInt(d[1],16),f=parseInt(d[2],16);d=parseInt(d[3],16);c?(c.r=e,c.g=f,c.b=d):c=b.Color.createColor(e,f,d)}return c},webToColor:function(a,c){c||(c=b.Color.createColor());var d=/^rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d+(?:\.\d+)?))?\s*\)$/.exec(a);d&&(c.r=parseInt(d[1],10),c.g=parseInt(d[2],10),c.b=parseInt(d[3],10),c.a=void 0!==d[4]?parseFloat(d[4]):1,b.Color.updateColor(c));return c},valueToColor:function(a,c){c||(c=b.Color.createColor());if("string"===typeof a){if(0===
a.indexOf("rgb"))return b.Color.webToColor(a,c);c.a=1;return b.Color.hexToColor(a,c)}if("number"===typeof a){var d=b.Color.getRGB(a);c.r=d.r;c.g=d.g;c.b=d.b;c.a=d.a/255}return c},componentToHex:function(a){a=a.toString(16);return 1===a.length?"0"+a:a},HSVColorWheel:function(a,c){void 0===a&&(a=1);void 0===c&&(c=1);for(var d=[],e=0;359>=e;e++)d.push(b.Color.HSVtoRGB(e/359,a,c));return d},HSLColorWheel:function(a,c){void 0===a&&(a=.5);void 0===c&&(c=.5);for(var d=[],e=0;359>=e;e++)d.push(b.Color.HSLtoRGB(e/
359,a,c));return d},interpolateColor:function(a,c,d,e,f){void 0===f&&(f=255);a=b.Color.getRGB(a);c=b.Color.getRGB(c);return b.Color.getColor32(f,(c.red-a.red)*e/d+a.red,(c.green-a.green)*e/d+a.green,(c.blue-a.blue)*e/d+a.blue)},interpolateColorWithRGB:function(a,c,d,e,f,g){a=b.Color.getRGB(a);return b.Color.getColor((c-a.red)*g/f+a.red,(d-a.green)*g/f+a.green,(e-a.blue)*g/f+a.blue)},interpolateRGB:function(a,c,d,e,f,g,h,l){return b.Color.getColor((e-a)*l/h+a,(f-c)*l/h+c,(g-d)*l/h+d)},getRandomColor:function(a,
c,d){void 0===a&&(a=0);void 0===c&&(c=255);void 0===d&&(d=255);return 255<c||a>c?b.Color.getColor(255,255,255):b.Color.getColor32(d,a+Math.round(Math.random()*(c-a)),a+Math.round(Math.random()*(c-a)),a+Math.round(Math.random()*(c-a)))},getRGB:function(a){return 16777215<a?{alpha:a>>>24,red:a>>16&255,green:a>>8&255,blue:a&255,a:a>>>24,r:a>>16&255,g:a>>8&255,b:a&255}:{alpha:255,red:a>>16&255,green:a>>8&255,blue:a&255,a:255,r:a>>16&255,g:a>>8&255,b:a&255}},getWebRGB:function(a){if("object"===typeof a)return"rgba("+
a.r.toString()+","+a.g.toString()+","+a.b.toString()+","+(a.a/255).toString()+")";a=b.Color.getRGB(a);return"rgba("+a.r.toString()+","+a.g.toString()+","+a.b.toString()+","+(a.a/255).toString()+")"},getAlpha:function(a){return a>>>24},getAlphaFloat:function(a){return(a>>>24)/255},getRed:function(a){return a>>16&255},getGreen:function(a){return a>>8&255},getBlue:function(a){return a&255},blendNormal:function(a){return a},blendLighten:function(a,b){return b>a?b:a},blendDarken:function(a,b){return b>
a?a:b},blendMultiply:function(a,b){return a*b/255},blendAverage:function(a,b){return(a+b)/2},blendAdd:function(a,b){return Math.min(255,a+b)},blendSubtract:function(a,b){return Math.max(0,a+b-255)},blendDifference:function(a,b){return Math.abs(a-b)},blendNegation:function(a,b){return 255-Math.abs(255-a-b)},blendScreen:function(a,b){return 255-((255-a)*(255-b)>>8)},blendExclusion:function(a,b){return a+b-2*a*b/255},blendOverlay:function(a,b){return 128>b?2*a*b/255:255-2*(255-a)*(255-b)/255},blendSoftLight:function(a,
b){return 128>b?b/255*((a>>1)+64)*2:255-2*(255-((a>>1)+64))*(255-b)/255},blendHardLight:function(a,c){return b.Color.blendOverlay(c,a)},blendColorDodge:function(a,b){return 255===b?b:Math.min(255,(a<<8)/(255-b))},blendColorBurn:function(a,b){return 0===b?b:Math.max(0,255-(255-a<<8)/b)},blendLinearDodge:function(a,c){return b.Color.blendAdd(a,c)},blendLinearBurn:function(a,c){return b.Color.blendSubtract(a,c)},blendLinearLight:function(a,c){return 128>c?b.Color.blendLinearBurn(a,2*c):b.Color.blendLinearDodge(a,
2*(c-128))},blendVividLight:function(a,c){return 128>c?b.Color.blendColorBurn(a,2*c):b.Color.blendColorDodge(a,2*(c-128))},blendPinLight:function(a,c){return 128>c?b.Color.blendDarken(a,2*c):b.Color.blendLighten(a,2*(c-128))},blendHardMix:function(a,c){return 128>b.Color.blendVividLight(a,c)?0:255},blendReflect:function(a,b){return 255===b?b:Math.min(255,a*a/(255-b))},blendGlow:function(a,c){return b.Color.blendReflect(c,a)},blendPhoenix:function(a,b){return Math.min(a,b)-Math.max(a,b)+255}};b.Physics=
function(a,b){b=b||{};this.game=a;this.config=b;this.matter=this.chipmunk=this.box2d=this.ninja=this.p2=this.arcade=null;this.parseConfig()};b.Physics.ARCADE=0;b.Physics.P2JS=1;b.Physics.NINJA=2;b.Physics.BOX2D=3;b.Physics.CHIPMUNK=4;b.Physics.MATTERJS=5;b.Physics.prototype={parseConfig:function(){this.config.hasOwnProperty("arcade")&&!0!==this.config.arcade||!b.Physics.hasOwnProperty("Arcade")||(this.arcade=new b.Physics.Arcade(this.game));this.config.hasOwnProperty("ninja")&&!0===this.config.ninja&&
b.Physics.hasOwnProperty("Ninja")&&(this.ninja=new b.Physics.Ninja(this.game));this.config.hasOwnProperty("p2")&&!0===this.config.p2&&b.Physics.hasOwnProperty("P2")&&(this.p2=new b.Physics.P2(this.game,this.config));this.config.hasOwnProperty("box2d")&&!0===this.config.box2d&&b.Physics.hasOwnProperty("BOX2D")&&(this.box2d=new b.Physics.BOX2D(this.game,this.config));this.config.hasOwnProperty("matter")&&!0===this.config.matter&&b.Physics.hasOwnProperty("Matter")&&(this.matter=new b.Physics.Matter(this.game,
this.config))},startSystem:function(a){a===b.Physics.ARCADE?this.arcade=new b.Physics.Arcade(this.game):a===b.Physics.P2JS?null===this.p2?this.p2=new b.Physics.P2(this.game,this.config):this.p2.reset():a===b.Physics.NINJA?this.ninja=new b.Physics.Ninja(this.game):a===b.Physics.BOX2D?null===this.box2d?this.box2d=new b.Physics.Box2D(this.game,this.config):this.box2d.reset():a===b.Physics.MATTERJS&&(null===this.matter?this.matter=new b.Physics.Matter(this.game,this.config):this.matter.reset())},enable:function(a,
c,d){void 0===c&&(c=b.Physics.ARCADE);void 0===d&&(d=!1);c===b.Physics.ARCADE?this.arcade.enable(a):c===b.Physics.P2JS&&this.p2?this.p2.enable(a,d):c===b.Physics.NINJA&&this.ninja?this.ninja.enableAABB(a):c===b.Physics.BOX2D&&this.box2d?this.box2d.enable(a):c===b.Physics.MATTERJS&&this.matter?this.matter.enable(a):console.warn(a.key+" is attempting to enable a physics body using an unknown physics system.")},preUpdate:function(){this.p2&&this.p2.preUpdate();this.box2d&&this.box2d.preUpdate();this.matter&&
this.matter.preUpdate()},update:function(){this.p2&&this.p2.update();this.box2d&&this.box2d.update();this.matter&&this.matter.update()},setBoundsToWorld:function(){this.arcade&&this.arcade.setBoundsToWorld();this.ninja&&this.ninja.setBoundsToWorld();this.p2&&this.p2.setBoundsToWorld();this.box2d&&this.box2d.setBoundsToWorld();this.matter&&this.matter.setBoundsToWorld()},clear:function(){this.p2&&this.p2.clear();this.box2d&&this.box2d.clear();this.matter&&this.matter.clear()},reset:function(){this.p2&&
this.p2.reset();this.box2d&&this.box2d.reset();this.matter&&this.matter.reset()},destroy:function(){this.p2&&this.p2.destroy();this.box2d&&this.box2d.destroy();this.matter&&this.matter.destroy();this.matter=this.box2d=this.p2=this.ninja=this.arcade=null}};b.Physics.prototype.constructor=b.Physics;b.Particles=function(a){this.game=a;this.emitters={};this.ID=0};b.Particles.prototype={add:function(a){return this.emitters[a.name]=a},remove:function(a){delete this.emitters[a.name]},update:function(){for(var a in this.emitters)this.emitters[a].exists&&
this.emitters[a].update()}};b.Particles.prototype.constructor=b.Particles;b.Video=function(a,c,d){void 0===c&&(c=null);void 0===d&&(d=null);this.game=a;this.key=c;this.height=this.width=0;this.type=b.VIDEO;this.touchLocked=this.disableTextureUpload=!1;this.onPlay=new b.Signal;this.onChangeSource=new b.Signal;this.onComplete=new b.Signal;this.onAccess=new b.Signal;this.onError=new b.Signal;this.onTimeout=new b.Signal;this.timeout=15E3;this.videoStream=this.video=this._timeOutID=null;this.isStreaming=
!1;this.retryLimit=20;this.retry=0;this.retryInterval=500;this._retryID=null;this._autoplay=this._pending=this._paused=this._codePaused=this._muted=this._codeMuted=!1;this._playCallback=this._endCallback=null;if(c&&this.game.cache.checkVideoKey(c)){var e=this.game.cache.getVideo(c);e.isBlob?this.createVideoFromBlob(e.data):this.video=e.data;this.width=this.video.videoWidth;this.height=this.video.videoHeight}else d&&this.createVideoFromURL(d,!1);this.baseTexture=this.video&&!d?new PIXI.BaseTexture(this.video):
new PIXI.BaseTexture(b.Cache.DEFAULT.baseTexture.source);this.baseTexture.forceLoaded(this.width,this.height);this.texture=new PIXI.Texture(this.baseTexture);this.textureFrame=new b.Frame(0,0,0,this.width,this.height,"video");this.texture.setFrame(this.textureFrame);this.texture.valid=!1;null!==c&&this.video&&(this.texture.valid=this.video.canplay);this.snapshot=null;b.BitmapData&&(this.snapshot=new b.BitmapData(this.game,"",this.width,this.height));!this.game.device.cocoonJS&&(this.game.device.iOS||
this.game.device.android)||window.PhaserGlobal&&window.PhaserGlobal.fakeiOSTouchLock?this.setTouchLock():e&&(e.locked=!1)};b.Video.prototype={connectToMediaStream:function(a,b){a&&b&&(this.video=a,this.videoStream=b,this.isStreaming=!0,this.baseTexture.source=this.video,this.updateTexture(null,this.video.videoWidth,this.video.videoHeight),this.onAccess.dispatch(this));return this},startMediaStream:function(a,b,d){void 0===a&&(a=!1);void 0===b&&(b=null);void 0===d&&(d=null);if(!this.game.device.getUserMedia)return this.onError.dispatch(this,
"No getUserMedia"),!1;null!==this.videoStream&&(this.videoStream.active?this.videoStream.active=!1:this.videoStream.stop());this.removeVideoElement();this.video=document.createElement("video");this.video.setAttribute("autoplay","autoplay");null!==b&&(this.video.width=b);null!==d&&(this.video.height=d);this._timeOutID=window.setTimeout(this.getUserMediaTimeout.bind(this),this.timeout);try{navigator.getUserMedia({audio:a,video:!0},this.getUserMediaSuccess.bind(this),this.getUserMediaError.bind(this))}catch(e){this.getUserMediaError(e)}return this},
getUserMediaTimeout:function(){clearTimeout(this._timeOutID);this.onTimeout.dispatch(this)},getUserMediaError:function(a){clearTimeout(this._timeOutID);this.onError.dispatch(this,a)},getUserMediaSuccess:function(a){clearTimeout(this._timeOutID);this.videoStream=a;void 0!==this.video.mozSrcObject?this.video.mozSrcObject=a:this.video.src=window.URL&&window.URL.createObjectURL(a)||a;var b=this;this.video.onloadeddata=function(){function a(){if(0<c)if(0<b.video.videoWidth){var d=b.video.videoWidth,e=
b.video.videoHeight;isNaN(b.video.videoHeight)&&(e=d/(4/3));b.video.play();b.isStreaming=!0;b.baseTexture.source=b.video;b.updateTexture(null,d,e);b.onAccess.dispatch(b)}else window.setTimeout(a,500);else console.warn("Unable to connect to video stream. Webcam error?");c--}var c=10;a()}},createVideoFromBlob:function(a){var b=this;this.video=document.createElement("video");this.video.controls=!1;this.video.setAttribute("autoplay","autoplay");this.video.addEventListener("loadeddata",function(a){b.updateTexture(a)},
!0);this.video.src=window.URL.createObjectURL(a);this.video.canplay=!0;return this},createVideoFromURL:function(a,b){void 0===b&&(b=!1);this.texture&&(this.texture.valid=!1);this.video=document.createElement("video");this.video.controls=!1;b&&this.video.setAttribute("autoplay","autoplay");this.video.src=a;this.video.canplay=!0;this.video.load();this.retry=this.retryLimit;this._retryID=window.setTimeout(this.checkVideoProgress.bind(this),this.retryInterval);this.key=a;return this},updateTexture:function(a,
b,d){a=!1;if(void 0===b||null===b)b=this.video.videoWidth,a=!0;if(void 0===d||null===d)d=this.video.videoHeight;this.width=b;this.height=d;this.baseTexture.source!==this.video&&(this.baseTexture.source=this.video);this.baseTexture.forceLoaded(b,d);this.texture.frame.resize(b,d);this.texture.width=b;this.texture.height=d;this.texture.valid=!0;this.snapshot&&this.snapshot.resize(b,d);a&&null!==this.key&&(this.onChangeSource.dispatch(this,b,d),this._autoplay&&(this.video.play(),this.onPlay.dispatch(this,
this.loop,this.playbackRate)))},complete:function(){this.onComplete.dispatch(this)},play:function(a,b){void 0===a&&(a=!1);void 0===b&&(b=1);this.game.sound.onMute&&(this.game.sound.onMute.add(this.setMute,this),this.game.sound.onUnMute.add(this.unsetMute,this),this.game.sound.mute&&this.setMute());this.game.onPause.add(this.setPause,this);this.game.onResume.add(this.setResume,this);this._endCallback=this.complete.bind(this);this.video.addEventListener("ended",this._endCallback,!0);this.video.addEventListener("webkitendfullscreen",
this._endCallback,!0);this.video.loop=a?"loop":"";this.video.playbackRate=b;this.touchLocked?this._pending=!0:(this._pending=!1,null!==this.key&&(4!==this.video.readyState?(this.retry=this.retryLimit,this._retryID=window.setTimeout(this.checkVideoProgress.bind(this),this.retryInterval)):(this._playCallback=this.playHandler.bind(this),this.video.addEventListener("playing",this._playCallback,!0))),this.video.play(),this.onPlay.dispatch(this,a,b));return this},playHandler:function(){this.video.removeEventListener("playing",
this._playCallback,!0);this.updateTexture()},stop:function(){this.game.sound.onMute&&(this.game.sound.onMute.remove(this.setMute,this),this.game.sound.onUnMute.remove(this.unsetMute,this));this.game.onPause.remove(this.setPause,this);this.game.onResume.remove(this.setResume,this);this.isStreaming?(this.video.mozSrcObject?(this.video.mozSrcObject.stop(),this.video.src=null):(this.video.src="",this.videoStream.active?this.videoStream.active=!1:this.videoStream.getTracks?this.videoStream.getTracks().forEach(function(a){a.stop()}):
this.videoStream.stop()),this.videoStream=null,this.isStreaming=!1):(this.video.removeEventListener("ended",this._endCallback,!0),this.video.removeEventListener("webkitendfullscreen",this._endCallback,!0),this.video.removeEventListener("playing",this._playCallback,!0),this.touchLocked?this._pending=!1:this.video.pause());return this},add:function(a){if(Array.isArray(a))for(var b=0;b<a.length;b++)a[b].loadTexture&&a[b].loadTexture(this);else a.loadTexture(this);return this},addToWorld:function(a,b,
d,e,f,g){f=f||1;g=g||1;a=this.game.add.image(a,b,this);a.anchor.set(d,e);a.scale.set(f,g);return a},render:function(){!this.disableTextureUpload&&this.playing&&this.baseTexture.dirty()},setMute:function(){this._muted||(this._muted=!0,this.video.muted=!0)},unsetMute:function(){this._muted&&!this._codeMuted&&(this._muted=!1,this.video.muted=!1)},setPause:function(){this._paused||this.touchLocked||(this._paused=!0,this.video.pause())},setResume:function(){!this._paused||this._codePaused||this.touchLocked||
(this._paused=!1,this.video.ended||this.video.play())},changeSource:function(a,b){void 0===b&&(b=!0);this.texture.valid=!1;this.video.pause();this.retry=this.retryLimit;this._retryID=window.setTimeout(this.checkVideoProgress.bind(this),this.retryInterval);this.video.src=a;this.video.load();this._autoplay=b;b||(this.paused=!0);return this},checkVideoProgress:function(){4===this.video.readyState?this.updateTexture():(this.retry--,0<this.retry?this._retryID=window.setTimeout(this.checkVideoProgress.bind(this),
this.retryInterval):console.warn("Phaser.Video: Unable to start downloading video in time",this.isStreaming))},setTouchLock:function(){this.game.input.touch.addTouchLockCallback(this.unlock,this);this.touchLocked=!0},unlock:function(){this.touchLocked=!1;this.video.play();this.onPlay.dispatch(this,this.loop,this.playbackRate);if(this.key){var a=this.game.cache.getVideo(this.key);a&&!a.isBlob&&(a.locked=!1)}return!0},grab:function(a,b,d){void 0===a&&(a=!1);void 0===b&&(b=1);void 0===d&&(d=null);if(null===
this.snapshot)console.warn("Video.grab cannot run because Phaser.BitmapData is unavailable");else return a&&this.snapshot.cls(),this.snapshot.copy(this.video,0,0,this.width,this.height,0,0,this.width,this.height,0,0,0,1,1,b,d),this.snapshot},removeVideoElement:function(){if(this.video){for(this.video.parentNode&&this.video.parentNode.removeChild(this.video);this.video.hasChildNodes();)this.video.removeChild(this.video.firstChild);this.video.removeAttribute("autoplay");this.video.removeAttribute("src");
this.video=null}},destroy:function(){this.stop();this.removeVideoElement();this.touchLocked&&this.game.input.touch.removeTouchLockCallback(this.unlock,this);this._retryID&&window.clearTimeout(this._retryID)}};Object.defineProperty(b.Video.prototype,"currentTime",{get:function(){return this.video?this.video.currentTime:0},set:function(a){this.video.currentTime=a}});Object.defineProperty(b.Video.prototype,"duration",{get:function(){return this.video?this.video.duration:0}});Object.defineProperty(b.Video.prototype,
"progress",{get:function(){return this.video?this.video.currentTime/this.video.duration:0}});Object.defineProperty(b.Video.prototype,"mute",{get:function(){return this._muted},set:function(a){a?this._muted||(this._codeMuted=!0,this.setMute()):this._muted&&(this._codeMuted=!1,this.unsetMute())}});Object.defineProperty(b.Video.prototype,"paused",{get:function(){return this._paused},set:function(a){this.touchLocked||(a?this._paused||(this._codePaused=!0,this.setPause()):this._paused&&(this._codePaused=
!1,this.setResume()))}});Object.defineProperty(b.Video.prototype,"volume",{get:function(){return this.video?this.video.volume:1},set:function(a){0>a?a=0:1<a&&(a=1);this.video&&(this.video.volume=a)}});Object.defineProperty(b.Video.prototype,"playbackRate",{get:function(){return this.video?this.video.playbackRate:1},set:function(a){this.video&&(this.video.playbackRate=a)}});Object.defineProperty(b.Video.prototype,"loop",{get:function(){return this.video?this.video.loop:!1},set:function(a){a&&this.video?
this.video.loop="loop":this.video&&(this.video.loop="")}});Object.defineProperty(b.Video.prototype,"playing",{get:function(){return!(this.video.paused&&this.video.ended)}});b.Video.prototype.constructor=b.Video;void 0===PIXI.blendModes&&(PIXI.blendModes=b.blendModes);void 0===PIXI.scaleModes&&(PIXI.scaleModes=b.scaleModes);void 0===PIXI.Texture.emptyTexture&&(PIXI.Texture.emptyTexture=new PIXI.Texture(new PIXI.BaseTexture));void 0===PIXI.DisplayObject._tempMatrix&&(PIXI.DisplayObject._tempMatrix=
new PIXI.Matrix);void 0===PIXI.RenderTexture.tempMatrix&&(PIXI.RenderTexture.tempMatrix=new PIXI.Matrix);PIXI.Graphics&&void 0===PIXI.Graphics.POLY&&(PIXI.Graphics.POLY=b.POLYGON,PIXI.Graphics.RECT=b.RECTANGLE,PIXI.Graphics.CIRC=b.CIRCLE,PIXI.Graphics.ELIP=b.ELLIPSE,PIXI.Graphics.RREC=b.ROUNDEDRECTANGLE);PIXI.TextureSilentFail=!0;"undefined"!==typeof exports?("undefined"!==typeof module&&module.exports&&(exports=module.exports=b),exports.Phaser=b):"undefined"!==typeof define&&define.amd?define("Phaser",
this.Phaser=b):this.Phaser=b;return b}).call(this);